[{"id":"2ea7fd8b.7e0bb2","type":"tab","label":"Occupancy","disabled":false,"info":""},{"id":"444fced8.33ecb","type":"tab","label":"Alexa","disabled":false,"info":""},{"id":"4c9c764d.9c4468","type":"tab","label":"Geral","disabled":false,"info":""},{"id":"e7cd1901.ee2408","type":"tab","label":"Sala","disabled":false,"info":""},{"id":"5767c936.cabd18","type":"tab","label":"Escritorio","disabled":false,"info":""},{"id":"859b066a.dd8128","type":"tab","label":"Quarto Nédi","disabled":false,"info":""},{"id":"ec27da7d.cad118","type":"tab","label":"Quarto Maria","disabled":false,"info":""},{"id":"de7173c1.b1a8c","type":"tab","label":"Cozinha","disabled":false,"info":""},{"id":"bbb64533.9844f8","type":"tab","label":"Cantinho & Sacada","disabled":false,"info":""},{"id":"d3db5d74.fb8fa","type":"tab","label":"Aqara Sensores","disabled":false,"info":""},{"id":"d67ca66.293d758","type":"tab","label":"Home Assistant","disabled":false,"info":""},{"id":"554bb518.994efc","type":"tab","label":"Funcoes Auxiliares","disabled":false,"info":""},{"id":"7b0de646.c85c78","type":"tab","label":"Spotify Helpers","disabled":false,"info":""},{"id":"c3fa9bdb.b5c4c8","type":"tab","label":"Tarefas","disabled":false,"info":""},{"id":"2bbba447.a4759c","type":"tab","label":"Banheiro","disabled":false,"info":""},{"id":"64936db9.640564","type":"mqtt-broker","name":"MQTT","broker":"raspberrypi.local","port":"1883","clientid":"Node-Red","usetls":false,"compatmode":false,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthRetain":"false","birthPayload":"","closeTopic":"","closeQos":"0","closeRetain":"false","closePayload":"","willTopic":"","willQos":"0","willRetain":"false","willPayload":""},{"id":"d14d7300.ae20c","type":"server","name":"Home Assistant","legacy":false,"addon":false,"rejectUnauthorizedCerts":false,"ha_boolean":"y|yes|true|on|home|open","connectionDelay":true,"cacheJson":true},{"id":"1e751e4e.9c7702","type":"hb-conf","username":"373-28-172"},{"id":"421d4b0d.32a884","type":"alexa-remote-account","name":"Alexa","authMethod":"proxy","proxyOwnIp":"raspberrypi.local","proxyPort":"3456","cookieFile":"/home/homeassistant/homeassistant/alexaauxiliar","refreshInterval":"3","alexaServiceHost":"pitangui.amazon.com","amazonPage":"amazon.com","acceptLanguage":"en-US","userAgent":"","useWsMqtt":"on","autoInit":"on"},{"id":"8f012b2f.669ef8","type":"darksky-credentials","key_identifier":"DarkSky"},{"id":"5a8bf4db.2d6bcc","type":"yeelight-compat-hue-config","hostname":"YeelightColorBulb-098F.local","port":"55443","name":"Luz da Sala"},{"id":"2db68ab1.bee496","type":"yeelight-compat-hue-config","hostname":"YeelightColorBulb-023F.local","port":"55443","name":"Luz do Escritório 1"},{"id":"efa96182.3c09a","type":"pushbullet-config","name":"Pushbullet"},{"id":"56814891.18c868","type":"yeelight-compat-hue-config","hostname":"YeelightColorBulb-235A.local","port":"55443","name":"Luz da Entrada"},{"id":"3b9d50b6.bca4e","type":"spotify-auth","name":"Spotify","scope":"ugc-image-upload\nuser-read-recently-played\nuser-top-read\nuser-read-playback-position\nuser-read-playback-state\nuser-modify-playback-state\nuser-read-currently-playing\napp-remote-control\nstreaming\nplaylist-modify-public\nplaylist-modify-private\nplaylist-read-private\nplaylist-read-collaborative\nuser-follow-modify\nuser-follow-read\nuser-library-modify\nuser-library-read\nuser-read-email\nuser-read-private"},{"id":"14b837c9.ab10c","type":"yeelight-compat-hue-config","hostname":"192.168.0.7","port":"55443","name":"Luz do Escritório 2"},{"id":"3e6ae01c.bd204","type":"yeelight-compat-hue-config","hostname":"192.168.0.12","port":"55443","name":"Luz do Quarto Maria"},{"id":"e588ecf4.3d63d","type":"function","z":"2ea7fd8b.7e0bb2","name":"True?","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":530,"y":220,"wires":[["2f7e965e.742a2a"]]},{"id":"250cb2cf.f20f0e","type":"function","z":"2ea7fd8b.7e0bb2","name":"Detected?","func":"if(msg.payload.OccupancyDetected === 1){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":530,"y":160,"wires":[["2f7e965e.742a2a"]]},{"id":"19554fb4.898e3","type":"function","z":"4c9c764d.9c4468","name":"Hora do Filme?","func":"var ocupado = global.get(\"horaDoFilme\");\nglobal.set(\"SalaOnFirstTime\", true);\nglobal.set(\"SalaOn\",false);\nglobal.set(\"EscritorioOnFirstTime\", true);\nif(     msg.payload === \"playing\" \n    ){\n    if(ocupado === false){\n        global.set(\"horaDoFilme\", true);\n        var date = new Date();\n        var Day = date.getDay(); \n        var Hour = date.getHours();\n        if(Day === 0 || Day === 6 || (Day < 6 && Day > 0)&& Hour >18) {\n                var newMsg;\n                newMsg = {payload: {\"On\":true}};\n                \n                node.status({fill:\"green\",shape:\"dot\",text:\"Movie Night On\"});\n                node.send(newMsg);\n                setTimeout(function(){\n                node.status({text:\"\"});\n                }, 15000);\n            }\n        }\n}\nif(\n    msg.payload.horaDoFilme === true\n    ){\n    return {payload: {\"On\":true}};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":660,"y":1160,"wires":[["863a7cae.0b5e3","169e61b.b1afd9e","af42afe3.f58c7","56cf118.6c95df","2d40431.6363ebc","a15f542b.7479e8","c4d0a5ba.4a5f78"]]},{"id":"bd53e302.56acc","type":"function","z":"4c9c764d.9c4468","name":"Escuro?","func":"if(msg.payload < 35 && msg.payload > 0){\n                global.set(\"salaEscura\", true);\n                node.status({fill:\"green\",shape:\"dot\",text:\"SalaEscura true\"});\n                flow.set(\"triggered\", true);\n                node.send(msg);\n}\nelse if(msg.payload > 200){\n                global.set(\"salaEscura\", false);\n                node.status({fill:\"yellow\",shape:\"dot\",text:\"SalaEscura false\"});\n}\nif(msg.payload < 100 && msg.payload > 0){\n                global.set(\"escritorioEscuro\", true);\n                node.status({fill:\"green\",shape:\"dot\",text:\"EscritorioEscuro true\"});\n                flow.set(\"triggered\", true);\n                node.send(msg);\n}\nelse if(msg.payload > 200){\n                global.set(\"escritorioEscuro\", false);\n                node.status({fill:\"yellow\",shape:\"dot\",text:\"EscritorioEscuro false\"});\n}\n\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":740,"y":360,"wires":[["55f5a77a.253908"]]},{"id":"a2a4940d.a23088","type":"function","z":"4c9c764d.9c4468","name":"Sala On","func":"if(msg.payload === true){\n    var date = new Date();\n    var Hour = date.getHours(); //hours in 0-23\n    var minutes = \"0\" + date.getMinutes();\n    minutes = parseInt(minutes.substr(-2), 10);\n    var seconds = \"0\" + date.getSeconds();\n    seconds = parseInt(seconds.substr(-2), 10);\n    global.set(\"lastChangeSec\", seconds);\n    global.set(\"lastChangeMinute\", minutes);\n    var salaEscura = global.get(\"salaEscura\");\n    if(Hour > 15 && Hour < 23 && salaEscura === true){\n        if(global.get(\"desabilitaAutomacao\") === false){\n            if(global.get(\"SalaOn\") === false){\n                global.set(\"SalaOn\",true);\n                msg = {\"payload\": {\"On\":true}};\n                node.status({fill:\"green\",shape:\"dot\",text:\"Sala On\"});\n                node.send(msg);\n            }\n        }\n    }\n    setTimeout(function(){\n        node.status({text:\"\"});\n    }, 15000);\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1540,"y":340,"wires":[["2d1b0bfd.410a84"]]},{"id":"dbdc7788.7a4228","type":"mqtt in","z":"4c9c764d.9c4468","name":"Sensor Luz Sala","topic":"Sala/currentLight","qos":"0","datatype":"json","broker":"64936db9.640564","x":220,"y":360,"wires":[["6f27f94e.d021f8"]]},{"id":"40d8ecc9.126694","type":"function","z":"4c9c764d.9c4468","name":"Sunset?","func":"\nif(msg.payload === \"sunsetStart\" || \nmsg.payload === \"sunset\"|| \nmsg.payload === \"goldenHour\"|| \nmsg.payload ===\"dusk\"){\n    node.status({fill:\"green\",shape:\"dot\",text:\"Sunset started\"});\n    flow.set(\"triggered\", true);\n    node.send(msg);\n    global.set(\"escritorioEscuro\", true);\n    global.set(\"salaEscura\", true);\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":740,"y":420,"wires":[["55f5a77a.253908"]]},{"id":"e53fd18b.10dd3","type":"function","z":"4c9c764d.9c4468","name":"Escritório On","func":"var contEscritorio = global.get(\"contEscritorio\");\nvar overrideEscritorio = global.get(\"overrideEscritorio\");\nvar escritorioEscuro = global.get(\"escritorioEscuro\");\nif(msg.payload === true){\n    if((contEscritorio < 2700 || overrideEscritorio === true) && escritorioEscuro === true){\n        var date = new Date();\n        var Day = date.getDay(); \n        var Hour = date.getHours();\n        if(Hour > 8 && global.get(\"auxTurnOnEscritorio\") === true){\n            if(global.get(\"EscritorioOn\") === false){\n                if(global.get(\"desabilitaAutomacao\") === false){\n                        global.set(\"EscritorioOn\",true);\n                        node.status({fill:\"green\",shape:\"dot\",text:\"Escritorio On\"});\n                        msg.payload = {\"On\":true};\n                        node.send(msg);\n                }\n                \n            }\n            setTimeout(function(){\n                node.status({text:\"\"});\n            }, 15000);\n        }\n        if(Hour > 16){\n                if(global.get(\"EscritorioOn\") === false){\n                    if(global.get(\"desabilitaAutomacao\") === false){\n                        global.set(\"EscritorioOn\",true);\n                        node.status({fill:\"green\",shape:\"dot\",text:\"Escritorio On\"});\n                        msg.payload = {\"On\":true};\n                        node.send(msg);\n                    }\n                \n            }\n            setTimeout(function(){\n                node.status({text:\"\"});\n            }, 15000);\n        }\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1230,"y":400,"wires":[["c2b484f3.fef7d8"]]},{"id":"69bf8dca.b2b8a4","type":"switch","z":"554bb518.994efc","d":true,"name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"week day","vt":"str"},{"t":"eq","v":"weekend","vt":"str"},{"t":"eq","v":"any day","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":310,"y":120,"wires":[[],[],[]]},{"id":"a482cdd7.048bd","type":"function","z":"554bb518.994efc","d":true,"name":"","func":"var date = new Date();\nvar Day = date.getDay(); // sunday is 0 saturday is 6\nvar Hour = date.getHours(); //hours in 0-23\nif((Day < 6 && Day > 0)){\n    return \"week day\";\n}\nif(Day === 0 || Day === 6){\n    return \"weekend\";\n}\nelse\n    return \"any day\";","outputs":1,"noerr":0,"x":170,"y":120,"wires":[["69bf8dca.b2b8a4"]]},{"id":"80fbee9c.0c947","type":"comment","z":"554bb518.994efc","name":"Dia da semana","info":"","x":120,"y":80,"wires":[]},{"id":"f03bc12c.2a5a6","type":"inject","z":"554bb518.994efc","d":true,"name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":170,"y":340,"wires":[["e6cd5785.820048"]]},{"id":"9e538973.59fd68","type":"comment","z":"554bb518.994efc","name":"Alexa diz Oi","info":"","x":110,"y":300,"wires":[]},{"id":"2d1b0bfd.410a84","type":"link out","z":"4c9c764d.9c4468","name":"Sala On","links":["f438fd80.ae3b"],"x":1635,"y":420,"wires":[]},{"id":"c2b484f3.fef7d8","type":"link out","z":"4c9c764d.9c4468","name":"Escritorio On","links":["a47983c5.55204","b41dbb9c.dc0e58"],"x":1395,"y":420,"wires":[]},{"id":"863a7cae.0b5e3","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"hours","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":940,"y":1080,"wires":[["470a254d.4cc45c"]]},{"id":"470a254d.4cc45c","type":"function","z":"4c9c764d.9c4468","name":"horaDoFilme False","func":"global.set(\"horaDoFilme\", false);\nglobal.set(\"desabilitaAutomacao\", false);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1110,"y":1080,"wires":[[]]},{"id":"b4038cea.b3677","type":"function","z":"2bbba447.a4759c","name":"","func":"var ocupado = global.get(\"BanheiroOcupado\");\nvar portaAberta = global.get(\"portaAbertaBanheiro\");\nvar newMsg;\nnewMsg = {\"payload\" : {\"On\":true}, delay: 2700000};\nglobal.set(\"isOnBanheiro\", true);\nglobal.set(\"BanheiroOcupado\", true);\nnode.send(newMsg);\nnode.status({fill:\"green\",shape:\"dot\",text:\"Ocupado: \"+ ocupado});\nsetTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1800,"y":280,"wires":[["ba04b092.60bc8","8e6d6d01.463f3","d0ddc950.fa7118"]]},{"id":"ba04b092.60bc8","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"delayv","timeout":"45","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2180,"y":300,"wires":[["a2c55b1b.216528","3665f12e.70f2ee"]]},{"id":"8e6d6d01.463f3","type":"function","z":"2bbba447.a4759c","name":"Turn On","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\n\n//if(Hour > 16 || Hour < 8 || \n//    global.get(\"botaoBanheiro\")=== true){\n    if(msg.payload.On === true){\n            var newMsg;\n            newMsg = {payload: {\"on\":true}};\n            return newMsg;\n    }\n//}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2200,"y":360,"wires":[["8073258b.621728"]]},{"id":"f438fd80.ae3b","type":"link in","z":"e7cd1901.ee2408","name":"Sala On","links":["2d1b0bfd.410a84"],"x":115,"y":240,"wires":[["44a26901.b5a568","3ce0001a.577de"]]},{"id":"b41dbb9c.dc0e58","type":"link in","z":"5767c936.cabd18","name":"Escritorio On","links":["c2b484f3.fef7d8"],"x":135,"y":460,"wires":[["82188a35.1349f8","8a61a341.0fa5d"]]},{"id":"9b49a101.0f52c","type":"change","z":"e7cd1901.ee2408","name":"Turn On","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"On\": true} ","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":400,"y":440,"wires":[["a82fb664.7fec48"]]},{"id":"723cac3c.588f44","type":"change","z":"5767c936.cabd18","name":"Turn On","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"On\": true} ","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":460,"wires":[["9692d760.196b88"]]},{"id":"ab2e6085.0b03d","type":"inject","z":"4c9c764d.9c4468","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":" {\"On\":true}","payloadType":"json","x":1240,"y":500,"wires":[["2d1b0bfd.410a84","c2b484f3.fef7d8"]]},{"id":"82188a35.1349f8","type":"function","z":"5767c936.cabd18","name":"Set Flow Variables","func":"\n\nif(global.get(\"EscritorioOnFirstTime\") === true){\n    global.set(\"EscritorioOnFirstTime\", false);    \n    \n    var date = new Date();\n    var hours = date.getHours(); //hourss in 0-23\n    var minutes = \"0\" + date.getMinutes();\n    minutes = parseInt(minutes.substr(-2), 10);\n    var seconds = \"0\" + date.getSeconds();\n    seconds = parseInt(seconds.substr(-2), 10);\n\n    flow.set(\"lastChangeSec\", seconds);\n    flow.set(\"lastChangeMinute\", minutes);\n    flow.set(\"lastChangeHour\", hours);\n    \n    flow.set(\"countBrightnessLuz\", 1);\n    flow.set(\"increasing\", true);\n    flow.set(\"auxCT\", 6100);\n    return {\"ajuda\": 1};\n}\nif(global.get(\"EscritorioOnFirstTime\") === false){\n    return {\"ajuda\": 2};\n}\nelse{\n    return {\"ajuda\": 3};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":310,"y":240,"wires":[["37b6f853.dc8188"]]},{"id":"ba6a4e16.62ac7","type":"trigger","z":"5767c936.cabd18","name":"","op1":"true","op2":"0","op1type":"json","op2type":"str","duration":"-15","extend":false,"overrideDelay":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":1010,"y":320,"wires":[["4c385597.4d019c"]]},{"id":"7eb5668e.10c808","type":"function","z":"5767c936.cabd18","name":"Turn On","func":"var date = new Date();\nvar hours = date.getHours(); //hourss in 0-23\nvar minutes = \"0\" + date.getMinutes();\nminutes = parseInt(minutes.substr(-2), 10);\nvar seconds = \"0\" + date.getSeconds();\nseconds = parseInt(seconds.substr(-2), 10);\nvar secondsLast = flow.get(\"lastChangeSec\");\nvar minutesLast = flow.get(\"lastChangeMinute\");\nvar hoursLast = flow.get(\"lastChangeHour\");\nvar increasing = flow.get(\"increasing\");\nvar auxBrightness = flow.get(\"countBrightnessLuz\");\nvar auxCT = flow.get(\"auxCT\");\nif(hours >= 20){\n        increasing = false;\n        flow.set(\"increasing\", false)\n}\nif(msg.ajuda === 1){\n      msg.payload =\n        {\n        \"on\": true,\n        \"bri\": auxBrightness,\n        \"ct\": auxCT\n        };\n        flow.set(\"lastChangeSec\", seconds);\n        flow.set(\"lastChangeMinute\", minutes);\n        flow.set(\"lastChangeHour\", hours);\n        return msg;\n}\nif(hours > hoursLast || seconds > secondsLast+20 || minutes > minutesLast){\n\n    if(auxBrightness < msg.payload.state.bri-20 || auxBrightness > msg.payload.state.bri+20){\n        auxBrightness = msg.payload.state.bri;\n        flow.set(\"countBrightnessLuz\", auxBrightness);\n        \n    }    \n    if(auxCT < msg.payload.state.ct-100 || auxCT > msg.payload.state.ct+100){\n        auxCT = msg.payload.state.ct;\n        flow.set(\"auxCT\", auxCT);\n        \n    }\n    if(auxBrightness < 256 && increasing === true){\n        auxBrightness = auxBrightness + 1;\n        flow.set(\"countBrightnessLuz\",auxBrightness);\n    }\n    \n    if(auxCT < 6100 && increasing === true){\n        auxCT = auxCT +5;\n        flow.set(\"auxCT\", auxCT);\n    }\n    if(auxBrightness >192 && increasing === false){\n        auxBrightness = auxBrightness - 1;\n        flow.set(\"countBrightnessLuz\",auxBrightness);\n    }\n    if(auxCT > 3500 && increasing === false){\n        auxCT = auxCT -5;\n        flow.set(\"auxCT\", auxCT);\n    }\n    \n    msg.payload =\n        {\n        \"on\": true,\n        \"bri\": auxBrightness,\n        \"ct\": auxCT\n        };\n    flow.set(\"lastChangeSec\", seconds);\n    flow.set(\"lastChangeMinute\", minutes);\n    flow.set(\"lastChangeHour\", hours);    \n    if(auxBrightness > 254 && auxCT > 6100 && increasing === true){\n        msg.reset = 1;\n    }  \n    if(auxBrightness < 192 && auxCT < 2550 && increasing === false){\n        msg.reset = 1;\n    }\n    global.set(\"EscritorioOnFirstTime\", false);\n    global.set(\"EscritorioOn\", true);\n    return msg;\n    \n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3020,"y":220,"wires":[["716a6073.796fd","2a719e87.b34be2","833e30e1.2f909"]]},{"id":"44a26901.b5a568","type":"function","z":"e7cd1901.ee2408","name":"Set Flow Variables","func":"\nif(global.get(\"SalaOnFirstTime\") === true){\n    global.set(\"SalaOnFirstTime\", false);\n    \n    var date = new Date();\n    var hours = date.getHours(); //hourss in 0-23\n    var minutes = \"0\" + date.getMinutes();\n    minutes = parseInt(minutes.substr(-2), 10);\n    var seconds = \"0\" + date.getSeconds();\n    seconds = parseInt(seconds.substr(-2), 10);\n\n    flow.set(\"lastChangeSec\", seconds);\n    flow.set(\"lastChangeMinute\", minutes);\n    flow.set(\"lastChangeHour\", hours);\n    \n    flow.set(\"countBrightness\", 1);\n    flow.set(\"increasing\", true);\n    flow.set(\"auxCT\", 6100);\n    return {\"ajuda\": 1};\n}\nif(global.get(\"SalaOnFirstTime\") === false){\n    return {\"ajuda\": 2};\n}\nelse{\n    return {\"ajuda\": 3};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":270,"y":180,"wires":[["f6750518.b798d8"]]},{"id":"b2a76711.ae4398","type":"trigger","z":"e7cd1901.ee2408","name":"","op1":"true","op2":"0","op1type":"json","op2type":"str","duration":"-15","extend":false,"overrideDelay":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":990,"y":240,"wires":[["2389b8f5.93f1f8"]]},{"id":"df00c052.2c6a1","type":"function","z":"e7cd1901.ee2408","name":"Turn On","func":"var date = new Date();\nvar hours = date.getHours(); //hourss in 0-23\nvar minutes = \"0\" + date.getMinutes();\nminutes = parseInt(minutes.substr(-2), 10);\nvar seconds = \"0\" + date.getSeconds();\nseconds = parseInt(seconds.substr(-2), 10);\nvar hoursLast = flow.get(\"lastChangeHour\");\nvar secondsLast = flow.get(\"lastChangeSec\");\nvar minutesLast = flow.get(\"lastChangeMinute\");\nvar increasing = flow.get(\"increasing\");\nvar auxBrightness = flow.get(\"countBrightness\");\nvar auxCT = flow.get(\"auxCT\");\nif(hours >= 20){\n        increasing = false;\n        flow.set(\"increasing\", false)\n}\nif(msg.ajuda === 1){\n        msg.payload =\n        {\n        \"on\": true,\n        \"bri\": auxBrightness,\n        \"ct\": auxCT\n        };\n        flow.set(\"lastChangeSec\", seconds);\n        flow.set(\"lastChangeMinute\", minutes);\n        flow.set(\"lastChangeHour\", hours);\n        return msg;\n}\nif(hours > hoursLast || seconds > secondsLast+20 || minutes > minutesLast){\n\n    if(auxBrightness < msg.payload.state.bri-20 || auxBrightness > msg.payload.state.bri+20){\n        auxBrightness = msg.payload.state.bri;\n        flow.set(\"countBrightness\", auxBrightness);\n        \n    }    \n    if(auxCT < msg.payload.state.ct-100 || auxCT > msg.payload.state.ct+100){\n        auxCT = msg.payload.state.ct;\n        flow.set(\"auxCT\", auxCT);\n        \n    }\n    if(auxBrightness < 256 && increasing === true){\n        auxBrightness = auxBrightness + 1;\n        flow.set(\"countBrightness\",auxBrightness);\n    }\n    \n    if(auxCT < 6100 && increasing === true){\n        auxCT = auxCT +5;\n        flow.set(\"auxCT\", auxCT);\n    }\n    if(auxBrightness >128 && increasing === false){\n        auxBrightness = auxBrightness - 1;\n        flow.set(\"countBrightness\",auxBrightness);\n    }\n    if(auxCT > 2500 && increasing === false){\n        auxCT = auxCT -5;\n        flow.set(\"auxCT\", auxCT);\n    }\n    \n    flow.set(\"lastChangeSec\", seconds);\n    flow.set(\"lastChangeMinute\", minutes);\n    flow.set(\"lastChangeHour\", hours);\n    \n    msg.payload =\n        {\n        \"on\": true,\n        \"bri\": auxBrightness,\n        \"ct\": auxCT\n        };\n    if(auxBrightness > 254 && auxCT > 6000 && increasing === true){\n        msg.reset = 1;\n    }  \n    if(auxBrightness < 128 && auxCT < 2550 && increasing === false){\n        msg.reset = 1;\n    }\n    \n    global.set(\"SalaOnFirstTime\", false);\n    global.set(\"SalaOn\", true);\n    \n    return msg;\n    \n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2960,"y":160,"wires":[["a375134b.1d234","9cb07780.bcfb08","fdaa18d0.27a2c8"]]},{"id":"5349675d.bda988","type":"switch","z":"5767c936.cabd18","name":"","property":"payload.resetar","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":2270,"y":320,"wires":[["70421787.bbae78"],["34650f4f.5e35c"]]},{"id":"c3ea9f65.00d64","type":"change","z":"5767c936.cabd18","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":3575,"y":384,"wires":[["5ec55b77.d22a14"]]},{"id":"cd51c7bb.dfa688","type":"inject","z":"5767c936.cabd18","name":"Turn lights warmer and dimmer","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/20 22 * * *","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":390,"y":80,"wires":[["62da1cb0.8b2cd4","f0109079.cd84","950bacc8.dd4ff"]]},{"id":"37b6f853.dc8188","type":"switch","z":"5767c936.cabd18","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":495,"y":236,"wires":[["db6caf2c.e2ac4","f0109079.cd84","62da1cb0.8b2cd4","950bacc8.dd4ff"],["62da1cb0.8b2cd4","950bacc8.dd4ff"]]},{"id":"dcd2984c.8ee318","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":840,"y":260,"wires":[["ba6a4e16.62ac7"]]},{"id":"a6f0a69b.827558","type":"inject","z":"e7cd1901.ee2408","name":"Turn lights warmer and dimmer","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/20 21 * * *","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":330,"y":300,"wires":[["aa48fad2.d67908","4d99acb0.658954","190248cb.085527"]]},{"id":"f6750518.b798d8","type":"switch","z":"e7cd1901.ee2408","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":430,"y":180,"wires":[["e70cfc56.e6d9a","4d99acb0.658954"],["b2a76711.ae4398","aa48fad2.d67908","190248cb.085527"]]},{"id":"9f86e19e.674de","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":740,"y":120,"wires":[["b2a76711.ae4398","aa48fad2.d67908","190248cb.085527"]]},{"id":"eb4434ec.ed1628","type":"function","z":"2bbba447.a4759c","name":"Turn On/Off","func":"//diferentes brightness dependendo da hora\nvar date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nvar newMsg;\nnewMsg = {payload:{}};\nif(msg.payload.on === true){\n    if(Hour === 23){\n            newMsg.payload =\n            {\n            \"on\": true,\n            \"bri\": 50,\n            \"ct\": 5000\n            };\n            global.set(\"isOnBanheiro\", true);\n            \n            node.status({fill:\"green\",shape:\"dot\",text:\"Liga\"});\n            node.send(newMsg);\n            \n    }\n    if(Hour >= 0 && Hour < 8){\n            newMsg.payload =\n            {\n            \"on\": true,\n            \"bri\": 30,\n            \"ct\": 2500\n            };\n            global.set(\"isOnBanheiro\", true);\n            \n            node.status({fill:\"green\",shape:\"dot\",text:\"Liga\"});\n            node.send(newMsg);\n            \n    }\n    if((Hour > 17 && Hour < 22) || \n            global.get(\"botaoBanheiro\") === true){\n            global.set(\"botaoBanheiro\", false);\n            global.set(\"isOnBanheiro\", true);\n            newMsg.payload = \n                {\n                \"on\": true,\n                \"bri\": 255,\n                \"ct\": 6200\n                \n    };\n    node.status({fill:\"green\",shape:\"dot\",text:\"Liga\"});\n    node.send(newMsg);\n}\nelse{\n    newMsg.payload.on = false\n    node.status({fill:\"green\",shape:\"dot\",text:\"Desliga\"});\n    node.send(newMsg);\n}\nsetTimeout(function(){\n            node.status({text:\"\"});\n            }, 15000);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3110,"y":360,"wires":[["2aeb6d7.b81e592"]]},{"id":"bbb346a4.f7ad58","type":"inject","z":"554bb518.994efc","d":true,"name":"Turn lights warmer and dimmer","repeat":"","crontab":"00 21 * * *","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":230,"y":500,"wires":[[]]},{"id":"80760c35.5968d","type":"function","z":"4c9c764d.9c4468","name":"Sunset?","func":"var dateNow = new Date();\nvar hoursNow = dateNow.getHours();\nvar minutesNow = \"0\" + dateNow.getMinutes();\nminutesNow = minutesNow.substr(-2)\nvar auxTime;\nif(msg.data.currently.summary.includes(\"cloudy\") === true ||\n    msg.data.currently.summary.includes(\"Cloudy\")=== true ||\n    msg.data.currently.summary.includes(\"rain\")=== true ||\n    msg.data.currently.summary.includes(\"Rain\")=== true  ||\n    msg.payload.clouds === 1){\n    auxTime = 2000;\n}\nelse{\n    auxTime = 1500;\n}\nvar dateSunset = new Date((msg.data.daily.data[0].sunsetTime-auxTime) * 1000);\nvar hoursSunset = dateSunset.getHours();\nvar minutesSunset = \"0\" + dateSunset.getMinutes();\nminutesSunset = minutesSunset.substr(-2)\n//msg = {payload: hoursSunset+\":\"+minutesSunset};\nif(hoursNow >= hoursSunset && minutesNow >= minutesSunset){\n    node.status({fill:\"green\",shape:\"dot\",text:\"Sunset started\"});\n    flow.set(\"triggered\", true);\n    node.send(msg);\n    global.set(\"escritorioEscuro\", true);\n    global.set(\"salaEscura\", true);\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":740,"y":480,"wires":[["55f5a77a.253908"]]},{"id":"75fea52c.e1a99c","type":"link in","z":"859b066a.dd8128","name":"Quarto On","links":["e434c7b2.a0c848"],"x":75,"y":220,"wires":[["4486ff2d.764ba"]]},{"id":"af808a53.16f078","type":"function","z":"5767c936.cabd18","name":"Begin Luz","func":"if(flow.get(\"triggered5\")=== true){\n    flow.set(\"triggered5\", false);\n    if(global.get(\"desabilitaAutomacao\") === false){\n        if(msg.payload.state.on === true){\n            flow.set(\"auxCT\",msg.payload.state.ct);\n            flow.set(\"countBrightnessLuz\",msg.payload.state.bri);\n            msg = {\"payload\":{\"state\":{\"on\":true,\"bri\" : msg.payload.state.bri+1, \"ct\":msg.payload.state.ct+5}}, \"ajuda\": 1}\n            flow.set(\"auxEmissor\", \"Yeelight\");\n            return msg;\n        }\n        else{\n            flow.set(\"auxCT\", 6100);\n            flow.set(\"countBrightnessLuz\", 1);\n            msg = {\"payload\":{\"state\":{\"on\":true,\"bri\" : 1, \"ct\":6100}}, \"ajuda\": 1}\n            flow.set(\"auxEmissor\", \"Yeelight\");\n            return msg;\n        }\n    }\n}\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1640,"y":220,"wires":[["7eb5668e.10c808","df23e8e7.d31c08"]]},{"id":"5276a510.bf584c","type":"function","z":"859b066a.dd8128","name":"Time Check","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\n\nif((Hour >= 16 && Hour < 22)){\n    msg = {\"payload\": 1};\n    return msg;\n}\nelse if((Hour <= 8 && Hour >= 22)){\n    msg = {\"payload\": 2};\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2470,"y":240,"wires":[["292a71aa.8f158e","d685bbde.8cfa28"]]},{"id":"292a71aa.8f158e","type":"switch","z":"859b066a.dd8128","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":2640,"y":260,"wires":[["b61e9737.cbda68","f68bd53d.9d4a18"],["afe62e37.a0aa2","5b3cbd6e.8fb344"]]},{"id":"e2b2e733.f96968","type":"comment","z":"859b066a.dd8128","name":"Alguém entrou no quarto","info":"Alguém entrou no quarto e estava com as luzes desligada.","x":1140,"y":160,"wires":[]},{"id":"cc9f5a0e.42b368","type":"comment","z":"554bb518.994efc","name":"Injetar numa hora do dia","info":"","x":150,"y":460,"wires":[]},{"id":"649bafb7.e3ae3","type":"link in","z":"859b066a.dd8128","name":"Quarto On Boa Noite","links":["9eaa34e7.a346b8"],"x":175,"y":760,"wires":[["ca07e16b.baa1b"]]},{"id":"54319b5c.acc874","type":"comment","z":"859b066a.dd8128","name":"Ligar a luz baixinho e desligar logo depois","info":"","x":420,"y":680,"wires":[]},{"id":"4a3016b4.a521c8","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"10","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1370,"y":920,"wires":[["a370477f.87b298","7c0834d7.4a132c","cb05467a.0397d8"]]},{"id":"fd265517.bf6a28","type":"catch","z":"859b066a.dd8128","name":"","scope":null,"uncaught":false,"x":260,"y":3720,"wires":[["3ba6112b.c647ce","87d03259.0b985"]]},{"id":"afa730cd.3a975","type":"function","z":"859b066a.dd8128","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no Quarto Automation.\"});\n\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            msg.payload = msg.payload + \"Erro numero \"+ i +\n            \"id: \" + msg.error[i].source.id+\". \"+\n            msg.error[i].source.name+ \". Tipo de erro:\" + \n            msg.error[i].source.type + \". Mensagem: \" +\n            msg.error[i].message + \"\\n\\n\";\n            \n        }\n    }\n    else{\n        msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n        msg.error.source.name+ \". Tipo de erro:\" + \n        msg.error.source.type + \". Mensagem: \" +\n        msg.error.message;\n    }\n   \n        return msg;\n}\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"x":1010,"y":3700,"wires":[["c853cb4a.0f97e8","181802f.9d709fd","56750238.a127ac"]]},{"id":"3ba6112b.c647ce","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":370,"y":3820,"wires":[["9d033a12.67a0b8"]]},{"id":"9d033a12.67a0b8","type":"function","z":"859b066a.dd8128","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);\nglobal.set(\"ContCatchErrors\", 0);","outputs":0,"noerr":0,"x":600,"y":3820,"wires":[]},{"id":"3be32b3b.50c3b4","type":"catch","z":"5767c936.cabd18","name":"","scope":null,"uncaught":false,"x":345,"y":2076,"wires":[["33d7c27e.598f5e","b56501ec.610c1"]]},{"id":"62e833ea.f66b1c","type":"function","z":"5767c936.cabd18","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no Escritório Automation.\"});\n\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            msg.payload = msg.payload + \"Erro numero \"+ i +\n            \"id: \" + msg.error[i].source.id+\". \"+\n            msg.error[i].source.name+ \". Tipo de erro:\" + \n            msg.error[i].source.type + \". Mensagem: \" +\n            msg.error[i].message + \"\\n\\n\";\n            \n        }\n    }\n    else{\n        msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n        msg.error.source.name+ \". Tipo de erro:\" + \n        msg.error.source.type + \". Mensagem: \" +\n        msg.error.message;\n    }\n   \n        return msg;\n}\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"x":1135,"y":2076,"wires":[["f83d952e.27ae68","6ff94495.22d69c","6f662fa4.16836"]]},{"id":"33d7c27e.598f5e","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":355,"y":2196,"wires":[["7038fa42.9e0d84"]]},{"id":"7038fa42.9e0d84","type":"function","z":"5767c936.cabd18","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":0,"noerr":0,"x":585,"y":2196,"wires":[]},{"id":"e7322349.d3431","type":"catch","z":"e7cd1901.ee2408","name":"","scope":null,"uncaught":false,"x":240,"y":1300,"wires":[["30279141.8e593e","406176e6.6856c8"]]},{"id":"d49980.2763d68","type":"function","z":"e7cd1901.ee2408","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no Sala Automation.\"});\n\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            msg.payload = msg.payload + \"Erro numero \"+ i +\n            \"id: \" + msg.error[i].source.id+\". \"+\n            msg.error[i].source.name+ \". Tipo de erro:\" + \n            msg.error[i].source.type + \". Mensagem: \" +\n            msg.error[i].message + \"\\n\\n\";\n            \n        }\n    }\n    else{\n        msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n        msg.error.source.name+ \". Tipo de erro:\" + \n        msg.error.source.type + \". Mensagem: \" +\n        msg.error.message;\n    }\n   \n        return msg;\n}\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"x":1080,"y":1300,"wires":[["2fecdaad.39a646","90ac006a.915e5","22e8c512.56e11a"]]},{"id":"30279141.8e593e","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":270,"y":1400,"wires":[["696decb3.d48c04"]]},{"id":"696decb3.d48c04","type":"function","z":"e7cd1901.ee2408","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":0,"noerr":0,"x":470,"y":1400,"wires":[]},{"id":"e2748376.9b2ff","type":"catch","z":"4c9c764d.9c4468","name":"","scope":null,"uncaught":false,"x":220,"y":4780,"wires":[["f60cc26b.39fc4","ab16533d.36a69"]]},{"id":"15278717.eb0cf9","type":"function","z":"4c9c764d.9c4468","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no HomeKit Automation.\"});\n\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            msg.payload = msg.payload + \"Erro numero \"+ i +\n            \"id: \" + msg.error[i].source.id+\". \"+\n            msg.error[i].source.name+ \". Tipo de erro:\" + \n            msg.error[i].source.type + \". Mensagem: \" +\n            msg.error[i].message + \"\\n\\n\";\n            \n        }\n    }\n    else{\n        msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n        msg.error.source.name+ \". Tipo de erro:\" + \n        msg.error.source.type + \". Mensagem: \" +\n        msg.error.message;\n    }\n   \n        return msg;\n}\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"x":960,"y":4780,"wires":[["4814f202.46ea2c","d6b32035.1477","d97529c0.f2bc68"]]},{"id":"f60cc26b.39fc4","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":370,"y":4860,"wires":[["4b5b4751.958bb8"]]},{"id":"4b5b4751.958bb8","type":"function","z":"4c9c764d.9c4468","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);","outputs":0,"noerr":0,"x":570,"y":4860,"wires":[]},{"id":"d5cfe4d1.5aaeb8","type":"switch","z":"859b066a.dd8128","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":730,"y":3720,"wires":[["afa730cd.3a975"],["d9115222.59d29"]]},{"id":"1dc7a307.88d84d","type":"function","z":"859b066a.dd8128","name":"Cont++","func":"if(global.get(\"ContCatchErrors\") === 0){\n\n    global.set(\"ContCatchErrors\", 1);\n    msg = Object.assign({}, msg, {ajuda:1});\n    return msg;\n}\nif(global.get(\"ContCatchErrors\") > 0){\n    global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n\n    msg = Object.assign({}, msg, {ajuda:2});\n    return msg;\n    \n}\n","outputs":1,"noerr":0,"x":580,"y":3720,"wires":[["d5cfe4d1.5aaeb8"]]},{"id":"d9115222.59d29","type":"join","z":"859b066a.dd8128","name":"","mode":"custom","build":"array","property":"error","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":850,"y":3740,"wires":[["afa730cd.3a975"]]},{"id":"6e501955.9ec438","type":"join","z":"5767c936.cabd18","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":935,"y":2116,"wires":[["62e833ea.f66b1c"]]},{"id":"2d5a9b35.09bd54","type":"switch","z":"5767c936.cabd18","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":815,"y":2076,"wires":[["62e833ea.f66b1c"],["6e501955.9ec438"]]},{"id":"a3d0a93.6515e58","type":"function","z":"5767c936.cabd18","name":"Cont++","func":"if(global.get(\"ContCatchErrors\") === 0){\n\n    global.set(\"ContCatchErrors\", 1);\n    msg.ajuda = 1;    \n    return msg;\n}\nif(global.get(\"ContCatchErrors\") > 0){\n    global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n    msg.ajuda = 2;\n    return msg;\n    \n}\n","outputs":1,"noerr":0,"x":685,"y":2076,"wires":[["2d5a9b35.09bd54"]]},{"id":"25a88406.78639c","type":"join","z":"e7cd1901.ee2408","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":890,"y":1340,"wires":[["d49980.2763d68"]]},{"id":"f8f033ae.d265c","type":"switch","z":"e7cd1901.ee2408","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":750,"y":1300,"wires":[["d49980.2763d68"],["25a88406.78639c"]]},{"id":"2f85fde6.8ac3b2","type":"function","z":"e7cd1901.ee2408","name":"Cont++","func":"if(global.get(\"ContCatchErrors\") === 0){\n\n    global.set(\"ContCatchErrors\", 1);\n    msg.ajuda = 1;    \n    return msg;\n}\nif(global.get(\"ContCatchErrors\") > 0){\n    global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n    msg.ajuda = 2;\n    return msg;\n    \n}\n","outputs":1,"noerr":0,"x":580,"y":1300,"wires":[["f8f033ae.d265c"]]},{"id":"af4d2af0.c1d0e8","type":"join","z":"4c9c764d.9c4468","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":770,"y":4820,"wires":[["15278717.eb0cf9"]]},{"id":"23d64f47.19d9e","type":"switch","z":"4c9c764d.9c4468","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":650,"y":4780,"wires":[["15278717.eb0cf9"],["af4d2af0.c1d0e8"]]},{"id":"6f5ac1c8.1469a","type":"function","z":"4c9c764d.9c4468","name":"Cont++","func":"if(global.get(\"ContCatchErrors\") === 0){\n\n    global.set(\"ContCatchErrors\", 1);\n    msg.ajuda = 1;    \n    return msg;\n}\nif(global.get(\"ContCatchErrors\") > 0){\n    global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n    msg.ajuda = 2;\n    return msg;\n    \n}\n","outputs":1,"noerr":0,"x":520,"y":4780,"wires":[["23d64f47.19d9e"]]},{"id":"ad1d3dc3.760cf","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1050,"y":80,"wires":[["889f8e96.2787a"]]},{"id":"889f8e96.2787a","type":"function","z":"554bb518.994efc","name":"","func":"global.set(\"CatchErrors\",false);\nglobal.set(\"ContCatchErrors\", 0);","outputs":0,"noerr":0,"x":1190,"y":120,"wires":[]},{"id":"e9ee7b98.efc5d8","type":"function","z":"554bb518.994efc","name":"","func":"global.set(\"SalaOnFirstTime\", true);\nglobal.set(\"SalaOn\",false);\nglobal.set(\"salaEscura\",false);\nglobal.set(\"luzDaMesaOn\", false);\n        \nglobal.set(\"EscritorioOnFirstTime\", true);\nglobal.set(\"EscritorioOn\",false);\nglobal.set(\"escritorioEscuro\",false);\nglobal.set(\"overrideEscritorio\",false);\nglobal.set(\"contEscritorio\", 0); \nglobal.set(\"auxTurnOnEscritorio\", false);\n\nglobal.set(\"contBanheiro\", 0); \nglobal.set(\"botaoBanheiro\", false); \nglobal.set(\"abertaMuitoTempo\", false); \nglobal.set(\"portaAbertaBanheiro\", false);\n\nglobal.set(\"LampadaOn\", false); \nglobal.set(\"turnOffDelay\", false); \nglobal.set(\"vouDormir\", false); \nglobal.set(\"botaoQuarto\", false); \nglobal.set(\"quartoOn\",false);\nglobal.set(\"fireTVNediAtividade\", false)\n\nglobal.set(\"fireTVMariaAtividade\", false);\n\nglobal.set(\"horaDoFilme\", false);\nglobal.set(\"tvAuxFilme\", false);\nglobal.set(\"alexaCafeAux\", false);\nglobal.set(\"auxContStatus\", 0);\n\nglobal.set(\"chuvaAux\", false);\nglobal.set(\"ventoAux\", false);\nglobal.set(\"chuvaNotifAux\", false);\n\nglobal.set(\"desabilitaAutomacao\", false);\n\n","outputs":0,"noerr":0,"initialize":"","finalize":"","x":1370,"y":440,"wires":[]},{"id":"3b4f20b5.427b5","type":"inject","z":"554bb518.994efc","name":"Restart variables in the morning","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/30 6-7 * * *","once":true,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":1140,"y":400,"wires":[["e9ee7b98.efc5d8"]]},{"id":"361835ca.3bf73a","type":"comment","z":"554bb518.994efc","name":"CatchErrors setup","info":"","x":1050,"y":40,"wires":[]},{"id":"9c4c4122.9a59b","type":"comment","z":"554bb518.994efc","name":"Alexa Activity","info":"On Device Activity\nalexa-remote-event\n\n\n//input:\nmsg.payload.domainAttributes.nBestList[0].questionText;\n//or \nmsg.payload.description.summary;\n\n//alexa answer \nmsg.payload.domainAttributes.nBestList[0].answerText;\nreturn msg;\n\n\n","x":120,"y":600,"wires":[]},{"id":"22e8c512.56e11a","type":"function","z":"e7cd1901.ee2408","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"x":1320,"y":1240,"wires":[["f389a2c9.12d75","99b4f182.7f4d5"]]},{"id":"6f662fa4.16836","type":"function","z":"5767c936.cabd18","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"x":1315,"y":2016,"wires":[["b2bff029.0ca5","6beee360.62d28c"]]},{"id":"56750238.a127ac","type":"function","z":"859b066a.dd8128","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"x":1230,"y":3640,"wires":[["b22531d9.33f41","3356bfbf.36519"]]},{"id":"d97529c0.f2bc68","type":"function","z":"4c9c764d.9c4468","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"x":1180,"y":4720,"wires":[["cc01888e.654468","e5fcaac6.027588"]]},{"id":"513bcfbd.260c2","type":"catch","z":"2bbba447.a4759c","d":true,"name":"","scope":null,"uncaught":false,"x":220,"y":1160,"wires":[["d19fe0be.7ccbf","7507e100.92d15"]]},{"id":"e5ea72a7.dabbc","type":"function","z":"2bbba447.a4759c","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no Banheiro Automation.\"});\n\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            msg.payload = msg.payload + \"Erro numero \"+ i +\n            \"id: \" + msg.error[i].source.id+\". \"+\n            msg.error[i].source.name+ \". Tipo de erro:\" + \n            msg.error[i].source.type + \". Mensagem: \" +\n            msg.error[i].message + \"\\n\\n\";\n            \n        }\n    }\n    else{\n        msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n        msg.error.source.name+ \". Tipo de erro:\" + \n        msg.error.source.type + \". Mensagem: \" +\n        msg.error.message;\n    }\n   \n        return msg;\n}\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"x":1040,"y":1140,"wires":[["dd589a32.8ce048","6b52e091.61a56","5f0444a0.2d4bec"]]},{"id":"d19fe0be.7ccbf","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":290,"y":1280,"wires":[["aad8173d.b06638"]]},{"id":"aad8173d.b06638","type":"function","z":"2bbba447.a4759c","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);\nglobal.set(\"ContCatchErrors\", 0);\n","outputs":1,"noerr":0,"x":470,"y":1280,"wires":[[]]},{"id":"2669e0bb.35eb8","type":"join","z":"2bbba447.a4759c","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":870,"y":1200,"wires":[["e5ea72a7.dabbc"]]},{"id":"c7d4afb4.22d4c","type":"switch","z":"2bbba447.a4759c","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":730,"y":1160,"wires":[["e5ea72a7.dabbc"],["2669e0bb.35eb8"]]},{"id":"d716cb61.3b71c8","type":"function","z":"2bbba447.a4759c","name":"Cont++","func":"if(global.get(\"ContCatchErrors\") === 0){\n\n    global.set(\"ContCatchErrors\", 1);\n    msg.ajuda = 1;    \n    return msg;\n}\nif(global.get(\"ContCatchErrors\") > 0){\n    global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n    msg.ajuda = 2;\n    return msg;\n    \n}\n","outputs":1,"noerr":0,"x":510,"y":1160,"wires":[["c7d4afb4.22d4c"]]},{"id":"5f0444a0.2d4bec","type":"function","z":"2bbba447.a4759c","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"x":1230,"y":1100,"wires":[["3a01f365.64a05c","1ebc21da.add7ee"]]},{"id":"9f8391be.fe414","type":"comment","z":"4c9c764d.9c4468","name":"Automações do Escritório e Sala","info":"","x":290,"y":80,"wires":[]},{"id":"f77deeee.76d3","type":"comment","z":"4c9c764d.9c4468","name":"Automações do Movie Night","info":"","x":320,"y":1020,"wires":[]},{"id":"4725f860.704098","type":"comment","z":"2bbba447.a4759c","name":"Catching Errors and notifying","info":"","x":260,"y":1100,"wires":[]},{"id":"6d6589bb.0e28d8","type":"comment","z":"e7cd1901.ee2408","name":"Catching Errors and notifying","info":"","x":260,"y":1260,"wires":[]},{"id":"37b1d63c.abb3ea","type":"comment","z":"5767c936.cabd18","name":"Catching Errors and notifying","info":"","x":305,"y":2036,"wires":[]},{"id":"6a750461.d877fc","type":"comment","z":"859b066a.dd8128","name":"Catching Errors and notifying","info":"","x":320,"y":3660,"wires":[]},{"id":"338770dd.53918","type":"comment","z":"4c9c764d.9c4468","name":"Catching Errors and notifying","info":"","x":320,"y":4700,"wires":[]},{"id":"ddadea9.4332e18","type":"inject","z":"554bb518.994efc","name":"Started!","repeat":"","crontab":"","once":true,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":1060,"y":260,"wires":[["ce0283b8.18c0d","1c697dc3.2f69f2"]]},{"id":"182b364d.d4e2ea","type":"comment","z":"554bb518.994efc","name":"Start variables","info":"","x":1030,"y":200,"wires":[]},{"id":"ce0283b8.18c0d","type":"function","z":"554bb518.994efc","name":"","func":"//Errors Variables\nglobal.set(\"CatchErrors\",false);\nglobal.set(\"ContCatchErrors\", 0);\n\n//Quarto Nedi Variables\nglobal.set(\"turnOffDelay\", false);\nglobal.set(\"quartoOn\", false);\nglobal.set(\"vouDormir\", false);\nglobal.set(\"botaoQuarto\", false);\nglobal.set(\"luxQuarto\", 25); \nglobal.set(\"fireTVNediAtividade\", false)\n\n//Quarto Maria Variables\nglobal.set(\"horaDoSonoMaria\", false);\nglobal.set(\"fireTVMariaAtividade\", false);\n\n//Hora do filme Variables\nglobal.set(\"horaDoFilme\", false);\n\n//Sala and Escritorio Variables\nvar date = new Date();\nvar hours = date.getHours();\nvar minutes = \"0\" + date.getMinutes();\nminutes = parseInt(minutes.substr(-2), 10);\nvar seconds = \"0\" + date.getSeconds();\nseconds = parseInt(seconds.substr(-2), 10);\nglobal.set(\"lastChangeSec\", seconds);\nglobal.set(\"lastChangeMinute\", minutes);\nglobal.set(\"lastChangeHour\", hours);\nglobal.set(\"SalaOnFirstTime\", true);\nglobal.set(\"SalaOn\",false);\nglobal.set(\"EscritorioOnFirstTime\", true);\nglobal.set(\"EscritorioOn\",false);\nglobal.set(\"salaEscura\",false);\nglobal.set(\"escritorioEscuro\",false);\nglobal.set(\"overrideEscritorio\", true);\nglobal.set(\"contEscritorio\", 0);\nglobal.set(\"luzDaMesaOn\", false);\nglobal.set(\"auxTurnOnEscritorio\", false);\n\n//Banheiro variables\nglobal.set(\"BanheiroOcupado\", false);\nglobal.set(\"contBanheiro\", 0);\nglobal.set(\"botaoBanheiro\", false);\nglobal.set(\"auxEmissorBanheiro\", \"\");\nglobal.set(\"isOnBanheiro\", false);\nglobal.set(\"abertaMuitoTempo\", false);\nglobal.set(\"portaAbertaBanheiro\", false);\n\nglobal.set(\"auxContStatus\", 0);\nglobal.set(\"alexaCafeAux\", false);\nglobal.set(\"tvAuxFilme\", false);\nglobal.set(\"tvAuxPlay\", false);\n\nglobal.set(\"chuvaAux\", false);\nglobal.set(\"ventoAux\", false);\nglobal.set(\"chuvaNotifAux\", false);\n\nglobal.set(\"desabilitaAutomacao\", false);","outputs":0,"noerr":0,"initialize":"","finalize":"","x":1240,"y":280,"wires":[]},{"id":"53ffdf0c.5803c","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"10","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2800,"y":280,"wires":[["7eb5668e.10c808"]]},{"id":"bceedc42.6aad4","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"10","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2800,"y":200,"wires":[["df00c052.2c6a1","3001e3b1.19278c"]]},{"id":"d4569428.841038","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"40","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":720,"y":1500,"wires":[["8d51d582.5ce628"]]},{"id":"718583b3.1d2c4c","type":"comment","z":"859b066a.dd8128","name":"Ligar as luzes de manha","info":"Ligar as luzes de manha caso o quarto esteja muito escuro.","x":310,"y":1960,"wires":[]},{"id":"882c55b.9a7d9a8","type":"inject","z":"859b066a.dd8128","name":"Turn lights in the morning","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"30 09 * * 1,2,3,4,5,6","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":340,"y":2040,"wires":[["ea6f97d8.d53738"]]},{"id":"407ae073.bab95","type":"function","z":"859b066a.dd8128","name":"","func":"var luxQuarto = global.get(\"luxQuarto\");\nif(luxQuarto < 50 && luxQuarto > 0){\n    msg = {payload: {\"On\":true}};\n    return msg;\n\n}","outputs":1,"noerr":0,"x":770,"y":2040,"wires":[["761491ab.47174"]]},{"id":"724fd675.fd5e88","type":"mqtt out","z":"859b066a.dd8128","name":"setOn RGB Strip","topic":"QuartoNedi/setOnRGB","qos":"","retain":"","broker":"64936db9.640564","x":1550,"y":2040,"wires":[]},{"id":"72871881.f1e7e8","type":"mqtt out","z":"859b066a.dd8128","name":"setRGB RGB Strip","topic":"QuartoNedi/setRGB","qos":"","retain":"","broker":"64936db9.640564","x":1730,"y":2100,"wires":[]},{"id":"ffeae1f.5cc272","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"msg = {payload:1};\nreturn msg;","outputs":1,"noerr":0,"x":1330,"y":2080,"wires":[["724fd675.fd5e88","3cec2fe.6ac6ed"]]},{"id":"3cec2fe.6ac6ed","type":"function","z":"859b066a.dd8128","name":"White","func":"msg = {payload:\"FFFFFF\"};\nreturn msg;","outputs":1,"noerr":0,"x":1520,"y":2120,"wires":[["72871881.f1e7e8"]]},{"id":"169e61b.b1afd9e","type":"function","z":"4c9c764d.9c4468","name":"Anunciar Bom Filme","func":"var date = new Date();\nvar Day = date.getDay(); \nvar Hour = date.getHours();\nif(Hour >16 && Hour <5) {\n                msg = {payload: {\"On\":true}};\n                \n    node.send(msg);\n    node.status({text:\"Enviou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":980,"y":1160,"wires":[["45637419.03f15c","38d3b187.edba4e"]]},{"id":"d3645fef.a44f5","type":"switch","z":"4c9c764d.9c4468","name":"","property":"payload.state.on","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1479,"y":1500,"wires":[["afb74b1c.399c78"],["cec68f9.efd5a7","117d06e2.d815f9"]]},{"id":"afb74b1c.399c78","type":"function","z":"4c9c764d.9c4468","name":"Turn On Dim","func":"msg.payload = {\"on\": true,\"bri\":25, \"ct\": 3500};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1659,"y":1480,"wires":[["f127ac0f.face3"]]},{"id":"af42afe3.f58c7","type":"function","z":"4c9c764d.9c4468","d":true,"name":"Turn On Dim","func":"msg.payload = { On: true, Hue: 170, Saturation: 96, Brightness: 35 };\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":950,"y":1440,"wires":[["f4905f09.cfce1"]]},{"id":"bee5557c.627e48","type":"function","z":"859b066a.dd8128","name":"","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg = {payload: {\"On\":true}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1100,"y":2040,"wires":[["ffeae1f.5cc272","e5fea666.eaa338","3ee9b545.16afba"]]},{"id":"250ab27.747084e","type":"function","z":"2bbba447.a4759c","name":"","func":"var newMsg;\nnewMsg = {\"payload\": {\"On\": false}};\nglobal.set(\"isOnBanheiro\", false);\nglobal.set(\"BanheiroOcupado\", false);\nreturn newMsg;\n","outputs":1,"noerr":0,"x":1800,"y":220,"wires":[["3665f12e.70f2ee","a2c55b1b.216528"]]},{"id":"b61e9737.cbda68","type":"function","z":"859b066a.dd8128","d":true,"name":"","func":"var aux = [{},{},{}]\naux[0].entity = \"Luz do Quarto\";\naux[0].action = \"setColorTemperature\";\naux[0].value = \"cool\";\n\naux[1].entity = \"Luz do Quarto\";\naux[1].action = \"setBrightness\";\naux[1].value = 100;\n\naux[2].entity = \"Luz do Quarto\";\naux[2].action = \"turnOn\";\n\nmsg.payload = aux;\nreturn msg;","outputs":1,"noerr":0,"x":2818,"y":120,"wires":[["10c8544d.2497dc"]]},{"id":"afe62e37.a0aa2","type":"function","z":"859b066a.dd8128","d":true,"name":"","func":"var aux = [{},{},{}]\naux[0].entity = \"Luz do Quarto\";\naux[0].action = \"setColorTemperature\";\naux[0].value = \"warm_white\";\n\naux[1].entity = \"Luz do Quarto\";\naux[1].action = \"setBrightness\";\naux[1].value = 20;\n\naux[2].entity = \"Luz do Quarto\";\naux[2].action = \"turnOn\";\n\nmsg.payload = aux;\nreturn msg;","outputs":1,"noerr":0,"x":2820,"y":180,"wires":[["f31d5496.2b7e18"]]},{"id":"a87e7163.650af","type":"switch","z":"2bbba447.a4759c","name":"","property":"payload.state.on","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1410,"y":200,"wires":[["3180f91a.e24496"],["439df96c.0e4a48"]]},{"id":"71ba2d22.7c82a4","type":"function","z":"e7cd1901.ee2408","name":"Start","func":"\n    return msg;","outputs":1,"noerr":0,"x":390,"y":860,"wires":[["c7ff1e9c.b4318","a4b1a47.d185b58","33a3a6e2.a907ca"]]},{"id":"78eed8d.a5d0028","type":"function","z":"e7cd1901.ee2408","name":"Turn Off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg = {payload : {\"On\": false, \"on\": false}};\n    global.set(\"SalaOn\", false);\n    global.set(\"SalaEscura\", false);\n    return newMsg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2030,"y":800,"wires":[["b0620f12.25b7d","79c5edf6.bf7ca4","83022ff1.d18fb","8ec1a11b.56e75","44c5f3b7.f04ac4","33d7f2cf.e657ee","ddbd9add.1002e8","4c93361b.8a2798"]]},{"id":"465bdde4.286d34","type":"function","z":"e7cd1901.ee2408","name":"Turn On","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg = {payload : {\n        \"on\": true,\n        \"bri\": 255,\n        \"ct\": 6100,\n        \"duration\": 2000\n    }};\n    global.set(\"SalaOn\", true);\n    return newMsg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2030,"y":860,"wires":[["b0620f12.25b7d","a363d670.bc5818","44c5f3b7.f04ac4","ab61f5d5.6dc488","544a034e.fdb21c"]]},{"id":"b4ab05eb.477fe8","type":"comment","z":"e7cd1901.ee2408","name":"Botao sala foi clicado","info":"","x":240,"y":780,"wires":[]},{"id":"9802b432.06b398","type":"function","z":"5767c936.cabd18","name":"Turn On","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg = {payload : {\n        \"on\": true,\n        \"bri\": 255,\n        \"ct\": 6100,\n        \"duration\": 2000\n    }};\n    global.set(\"EscritorioOn\", true);\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2100,"y":760,"wires":[["e432c868.e95268","1af7a9e4.d79636","173b8a0d.bb1566","f3e49289.041b7","f085972.585a668"]]},{"id":"3914d48b.1018fc","type":"function","z":"5767c936.cabd18","name":"Start","func":"return msg;\n","outputs":1,"noerr":0,"x":410,"y":760,"wires":[["684afb0c.39a754","b4ad0947.84e188","44824a8e.596a94"]]},{"id":"c467e8cb.1f49f8","type":"comment","z":"5767c936.cabd18","name":"Botao escritorio foi clicado","info":"","x":270,"y":660,"wires":[]},{"id":"f75f5e50.13d69","type":"switch","z":"859b066a.dd8128","name":"","property":"payload.On","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":530,"y":1507,"wires":[["d4569428.841038","bbc2df9b.e0d17"]]},{"id":"3356bfbf.36519","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"8","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1380,"y":3640,"wires":[["de9d3923.5e5748"]]},{"id":"6beee360.62d28c","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"8","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1505,"y":2016,"wires":[["dd8da4a9.c4e8c8"]]},{"id":"99b4f182.7f4d5","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"8","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1500,"y":1240,"wires":[["8a518d3e.49bc2"]]},{"id":"1ebc21da.add7ee","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"delay","timeout":"8","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1420,"y":1100,"wires":[["fe6c172a.add0a8"]]},{"id":"e5fcaac6.027588","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"8","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1340,"y":4740,"wires":[["84d22155.c9a92"]]},{"id":"38d3b187.edba4e","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1340,"y":1200,"wires":[["964f049b.68d9e8"]]},{"id":"7cd3a616.9bfae8","type":"function","z":"859b066a.dd8128","name":"Check if it's already On","func":"if(msg.payload.On === false){\n    flow.set(\"iterFitaDoQuartoInc\", 1);\n    return msg;\n}","outputs":1,"noerr":0,"x":2360,"y":420,"wires":[["7f96e993.e00fc8"]]},{"id":"badfa912.45dbf8","type":"function","z":"2bbba447.a4759c","name":"Set Triggered","func":"global.set(\"contBanheiro\", 0);\nflow.set(\"triggered1\", true);\nvar date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\n\n//if(Hour < 18 && Hour > 7){\n//    msg.isDay = true;\n//} else{\n//    msg.isDay = false\n//}\nmsg.isDay = true;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":400,"y":360,"wires":[["6e07605b.68b1c"]]},{"id":"f3d623af.878a1","type":"switch","z":"2bbba447.a4759c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"ON","vt":"str"},{"t":"eq","v":"OFF","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1410,"y":280,"wires":[["a78b03ac.299d4"],["1aae8118.22a5ff"]]},{"id":"c96db932.46c878","type":"function","z":"2bbba447.a4759c","name":"Turn On","func":"//diferentes brightness dependendo da hora\nvar date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(typeof msg.payload.on === \"undefined\"){\n    msg.payload ={\"on\": msg.payload.On};\n}\n\nif(typeof msg.payload.On === \"undefined\"){\n    msg.payload = {\"On\": msg.payload.on};\n}\n\nif(msg.payload.on === true || msg.payload.On === true ){\n    if(Hour > 17 && Hour < 22){\n        msg.payload = \n            {\n            \"powerState\": \"ON\",\n            \"brightness\": 255,\n            \"colorTemperatureInKelvin\": 6200\n            \n            };\n            \n    }\n    if(Hour === 23){\n        msg.payload =\n        {\n        \"powerState\": \"ON\",\n        \"brightness\": 50,\n        \"colorTemperatureInKelvin\": 5000\n        };\n    }\n    if(Hour >= 0 && Hour < 8){\n        msg.payload =\n        {\n        \"powerState\": \"ON\",\n        \"brightness\": 30,\n        \"colorTemperatureInKelvin\": 2500\n        };\n        \n    }\n    var aux = [{},{},{}]\n    aux[0].entity = \"Luz do Banheiro\";\n    aux[0].action = \"setColorTemperature\";\n    aux[0].value = msg.payload.colorTemperatureInKelvin;\n    \n    aux[1].entity = \"Luz do Banheiro\";\n    aux[1].action = \"setBrightness\";\n    aux[1].value = msg.payload.brightness;\n    \n    \n    aux[2].entity = \"Luz do Banheiro\";\n    aux[2].action = \"turnOn\";\n    \n    msg.payload = aux;\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3240,"y":180,"wires":[["a3b3a99d.ff7468","4c0810be.0e397"]]},{"id":"3665f12e.70f2ee","type":"function","z":"2bbba447.a4759c","name":"Turn Off","func":"var newMsg;\nnewMsg = { \"payload\" : {\"on\":false}};\nnode.status({fill:\"green\",shape:\"dot\",text:\"Desliga\"});\nnode.send(newMsg);    \nglobal.set(\"botaoBanheiro\", false);\nglobal.set(\"BanheiroOcupado\", false);\nglobal.set(\"isOnBanheiro\", false);\nsetTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2500,"y":280,"wires":[["5797c620.129498","1004281c.91e608"]]},{"id":"fe5dc8bd.a35d18","type":"function","z":"2bbba447.a4759c","name":"Query","func":"var aux = [{}]\naux[0].entity = \"SKILL_eyJza2lsbElkIjoiYW16bjEuYXNrLnNraWxsLjZiYjkxNzE0LWFiNWQtNDFiOS1hYzI5LWI3ZWQ4YWFiNmNjNCIsInN0YWdlIjoibGl2ZSJ9_312904351\";\naux[0].property = \"powerState\";\nmsg.payload = aux;\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":360,"wires":[["9eb428b1.d1d508"]]},{"id":"6f27f94e.d021f8","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":400,"y":360,"wires":[["940ee253.3159e"]]},{"id":"87d03259.0b985","type":"switch","z":"859b066a.dd8128","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":430,"y":3720,"wires":[[],["1dc7a307.88d84d"]]},{"id":"b56501ec.610c1","type":"switch","z":"5767c936.cabd18","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":535,"y":2076,"wires":[[],["a3d0a93.6515e58"]]},{"id":"406176e6.6856c8","type":"switch","z":"e7cd1901.ee2408","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":410,"y":1300,"wires":[[],["2f85fde6.8ac3b2"]]},{"id":"7507e100.92d15","type":"switch","z":"2bbba447.a4759c","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":370,"y":1160,"wires":[[],["d716cb61.3b71c8"]]},{"id":"ab16533d.36a69","type":"switch","z":"4c9c764d.9c4468","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":370,"y":4780,"wires":[[],["6f5ac1c8.1469a"]]},{"id":"cd61a227.139cd","type":"function","z":"e7cd1901.ee2408","name":"Begin Luz","func":"if(flow.get(\"triggered4\")=== true){\n    flow.set(\"triggered4\", false);\n    if(global.get(\"desabilitaAutomacao\") === false){\n        if(msg.payload.state.on === true){\n            flow.set(\"auxCT\",msg.payload.state.ct);\n            flow.set(\"countBrightness\",msg.payload.state.bri);\n            msg = {\"payload\":{\"state\":{\"on\":true,\"bri\" : msg.payload.state.bri+1, \"ct\":msg.payload.state.ct+5}}, \"ajuda\": 1}\n            flow.set(\"auxEmissor\", \"Yeelight\");\n            return msg;\n        }\n        else{\n            flow.set(\"auxCT\", 6100);\n            flow.set(\"countBrightness\", 1);\n            msg = {\"payload\":{\"state\":{\"on\":true,\"bri\" : 1, \"ct\":6100}}, \"ajuda\": 1}\n            flow.set(\"auxEmissor\", \"Yeelight\");\n            return msg;\n        }\n    }\n}\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1360,"y":160,"wires":[["df00c052.2c6a1"]]},{"id":"cec68f9.efd5a7","type":"function","z":"4c9c764d.9c4468","name":"Turn On Dimmer","func":"msg.payload = {\"on\": true, \"bri\":5, \"ct\": 3500};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"x":1679,"y":1540,"wires":[["bdf393b7.4aafb"]]},{"id":"e9a26eb1.91f87","type":"function","z":"859b066a.dd8128","d":true,"name":"","func":"var aux = [{},{},{}]\naux[0].entity = \"Luz do Quarto\";\naux[0].action = \"setColorTemperature\";\naux[0].value = \"3000\";\n\naux[1].entity = \"Luz do Quarto\";\naux[1].action = \"setBrightness\";\naux[1].value = 25;\n\naux[2].entity = \"Luz do Quarto\";\naux[2].action = \"turnOn\";\n\nmsg.payload = aux;\nreturn msg;","outputs":1,"noerr":0,"x":940,"y":960,"wires":[["47f62cef.700a54"]]},{"id":"a32a9915.70db78","type":"switch","z":"859b066a.dd8128","name":"","property":"payload.On","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":630,"y":2700,"wires":[["465e6f86.2aa25","d05f28c5.230358","48eda273.47b84c","32a79da4.741ed2","52b1861d.d051a8","45041c52.418684","2007e720.2de1f8","e3bf4b20.84c2c8","d1df1e50.00d2","e7f7c710.d118d8","5be8420e.25cb1c"],["9d539b87.6c8318"]]},{"id":"465e6f86.2aa25","type":"function","z":"859b066a.dd8128","d":true,"name":"","func":"global.set(\"vouDormir\", true);\nvar aux = [{}, {}]\naux[0].entity = \"Fita do Quarto\";\naux[0].action = \"turnOff\";\n\naux[1].entity = \"Fita do Quarto\";\naux[1].action = \"turnOff\";\n\nmsg.payload = aux;\nreturn msg;","outputs":1,"noerr":0,"x":830,"y":2680,"wires":[["27cc348a.a12c9c"]]},{"id":"f478af2b.e1114","type":"mqtt out","z":"859b066a.dd8128","name":"setOn","topic":"QuartoNedi/setOnRGB","qos":"","retain":"","broker":"64936db9.640564","x":1030,"y":2740,"wires":[]},{"id":"d05f28c5.230358","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"msg = {payload:0};\nreturn msg;","outputs":1,"noerr":0,"x":890,"y":2740,"wires":[["f478af2b.e1114"]]},{"id":"9d539b87.6c8318","type":"function","z":"859b066a.dd8128","name":"","func":"global.set(\"vouDormir\", false);\nglobal.set(\"botaoQuarto\", false);","outputs":0,"noerr":0,"x":740,"y":2840,"wires":[]},{"id":"d851d997.3c2738","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1240,"y":320,"wires":[["a87e7163.650af","f3d623af.878a1","e3f28710.c14ba8"]]},{"id":"8073258b.621728","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2460,"y":360,"wires":[["13788a95.fdf4b5","7b3ccae7.cb3de4"]]},{"id":"5797c620.129498","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2700,"y":280,"wires":[["7b3ccae7.cb3de4"]]},{"id":"4532ff26.67bba","type":"function","z":"2bbba447.a4759c","name":"Turn Off","func":"if(typeof msg.payload.on === \"undefined\"){\n    msg.payload ={ \"on\": msg.payload.On};\n}\nelse{\n    if(typeof msg.payload.On === \"undefined\"){\n        msg.payload = {\"On\": msg.payload.on};\n    }\n}\nif(msg.payload.on === false || msg.payload.On === false ){\n    var aux = [{}];\n    \n    aux[0].entity = \"Luz do Banheiro\";\n    aux[0].action = \"turnOff\";\n    \n    msg.payload = aux;\n    return msg;\n}","outputs":1,"noerr":0,"x":3240,"y":260,"wires":[["d588617e.d700b","906d3b33.1f3308"]]},{"id":"4c0810be.0e397","type":"debug","z":"2bbba447.a4759c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3310,"y":140,"wires":[]},{"id":"906d3b33.1f3308","type":"debug","z":"2bbba447.a4759c","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3390,"y":240,"wires":[]},{"id":"fa56b44c.6d8ce8","type":"trigger","z":"2bbba447.a4759c","name":"","op1":"1","op2":"0","op1type":"num","op2type":"str","duration":"-10","extend":false,"overrideDelay":false,"units":"s","reset":"reset","bytopic":"all","topic":"topic","outputs":1,"x":2130,"y":580,"wires":[["ece6e1e6.9f9c1"]]},{"id":"48a71a45.f09914","type":"function","z":"2bbba447.a4759c","name":"Cont++","func":"var contBanheiro = global.get(\"contBanheiro\");\nvar portaAberta = global.get(\"portaAbertaBanheiro\");\nvar newMsg;\nif(portaAberta === false || msg.reset === true){\n    newMsg = {\"reset\" : 1};\n    global.set(\"contBanheiro\", 0);        \n    node.send(newMsg);\n    global.set(\"abertoMuitoTempo\", false);\n    node.status({fill:\"green\",shape:\"dot\",text:\"Porta aberta\"});\n}\nelse{\n    if(contBanheiro >= 300){\n        newMsg = {\"payload\" : {\"On\":false}, \"ajuda\": 1};\n        global.set(\"contBanheiro\", contBanheiro+10)   \n        node.send(newMsg);\n        node.status({fill:\"green\",shape:\"dot\",text:\"Desliga corredor\"});\n        \n    }\n    else if(contBanheiro >= 1200){\n        newMsg = {\"payload\" : {\"On\":false}, \"ajuda\": 2};\n        global.set(\"contBanheiro\", contBanheiro+10)   \n        node.send(newMsg);\n        node.status({fill:\"green\",shape:\"dot\",text:\"Desliga corredor\"});\n        \n    }\n    else if(contBanheiro >= 2400){\n        newMsg = {\"reset\" : 1};\n        global.set(\"contBanheiro\", 0);\n        global.set(\"abertoMuitoTempo\", true);\n        node.send(newMsg);\n        node.status({fill:\"green\",shape:\"dot\",text:\"Desliga a luz\"});\n        \n    }\n    else{\n        global.set(\"contBanheiro\", contBanheiro+10)   \n        newMsg = {payload: true}\n        node.send(newMsg);\n        node.status({fill:\"green\",shape:\"dot\",text:\"cont\"+contBanheiro});\n    }\n}\nsetTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2040,"y":480,"wires":[["48bf75a2.de0a2c","c1b62f28.bfdd7","eaf959ca.c2b768"]]},{"id":"30379d06.5c9d22","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"10","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":3375,"y":384,"wires":[["c3ea9f65.00d64"]]},{"id":"895843e4.08998","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"30","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1790,"y":220,"wires":[["4f0c4b24.f771a4","b7254c11.8a6fe"]]},{"id":"8f68046c.7fa428","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"30","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":740,"y":760,"wires":[["e9a26eb1.91f87","f54150fe.25a9","9f29212.a7843e"]]},{"id":"ea6f97d8.d53738","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"30","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":600,"y":2040,"wires":[["407ae073.bab95"]]},{"id":"98a685fb.a9a358","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"10","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":460,"y":2660,"wires":[["a32a9915.70db78"]]},{"id":"78d25414.be2c8c","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":230,"y":360,"wires":[["badfa912.45dbf8"]]},{"id":"e740020e.82078","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":360,"y":1507,"wires":[["f75f5e50.13d69"]]},{"id":"17b7df66.4128b1","type":"link in","z":"859b066a.dd8128","name":"Vou dormir","links":["182aa26e.838abe","1162d52e.d59a7b","3e659e3a.ee1442","54089fcf.dd297"],"x":295,"y":2540,"wires":[["98a685fb.a9a358"]]},{"id":"7b3ccae7.cb3de4","type":"switch","z":"2bbba447.a4759c","d":true,"name":"","property":"auxEmissorBanheiro","propertyType":"global","rules":[{"t":"eq","v":"Alexa","vt":"str"},{"t":"eq","v":"Yeelight","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":2910,"y":320,"wires":[["c7b58f47.7b00b","a2739762.e57528"],["f4e44398.a95af","ddad8255.72c54","eb4434ec.ed1628"]]},{"id":"c7b58f47.7b00b","type":"switch","z":"2bbba447.a4759c","name":"","property":"isOnBanheiro","propertyType":"global","rules":[{"t":"false"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":3090,"y":240,"wires":[["c96db932.46c878"],["4532ff26.67bba"]]},{"id":"3180f91a.e24496","type":"change","z":"2bbba447.a4759c","name":"set aux","rules":[{"t":"set","p":"auxEmissorBanheiro","pt":"global","to":"Yeelight","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":160,"wires":[["250ab27.747084e"]]},{"id":"439df96c.0e4a48","type":"change","z":"2bbba447.a4759c","name":"set aux","rules":[{"t":"set","p":"auxEmissorBanheiro","pt":"global","to":"Yeelight","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":200,"wires":[["b4038cea.b3677"]]},{"id":"fb61a0f6.7dc42","type":"function","z":"444fced8.33ecb","name":"Cozy time","func":"if(\n    msg.payload.name===\"Echo Dot do Quarto Nédi\" &&(\n    \n    msg.payload.description.summary.includes('vou')===true && \n    (\n    msg.payload.description.summary.includes('descansar')===true || \n    msg.payload.description.summary.includes('descansa')===true || \n    msg.payload.description.summary.includes('cama')===true\n    ))){\n\n    global.set(\"turnOffDelay\", true);\n    var newMsg;\n    newMsg = {\"payload\": {\"On\": true}};\n    return newMsg;\n    \n    \n    \n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":740,"wires":[["5790296f.677688","44d8cef9.74ca3"]]},{"id":"cc00dde9.77d34","type":"comment","z":"554bb518.994efc","name":"Javascript helpers","info":"if(typeof Variable !== \"undefined\"){\n}","x":510,"y":620,"wires":[]},{"id":"4c385597.4d019c","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"10","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1200,"y":320,"wires":[["335a614.475419e"]]},{"id":"c7025749.a03158","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"10","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1380,"y":240,"wires":[["d36d2c87.c9cc8","dea9e275.a6cd1"]]},{"id":"8d51d582.5ce628","type":"change","z":"859b066a.dd8128","name":"","rules":[{"t":"set","p":"botaoQuarto","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"turnOffDelay","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":900,"y":1500,"wires":[[]]},{"id":"bbc2df9b.e0d17","type":"change","z":"859b066a.dd8128","name":"","rules":[{"t":"set","p":"botaoQuarto","pt":"global","to":"true","tot":"bool"},{"t":"set","p":"turnOffDelay","pt":"global","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":720,"y":1560,"wires":[[]]},{"id":"bbdbe498.e75468","type":"function","z":"5767c936.cabd18","name":"auxCT","func":"if(flow.get(\"triggered2\")===true){\n    flow.set(\"triggered2\", false);\n    if(msg.payload.state.on === true){\n        flow.set(\"auxCT\",msg.payload.state.ct);\n        if(!msg.payload.state.ct){\n            flow.set(\"auxCT\",parseInt(msg.payload.raw.ct));\n        }\n        if(!msg.payload.raw.ct){\n            flow.set(\"auxCT\",6100);\n        }\n        flow.set(\"countBrightnessLuz\",msg.payload.state.bri);\n    }\n}","outputs":0,"noerr":0,"initialize":"","finalize":"","x":1230,"y":60,"wires":[]},{"id":"be6ae750.e08a88","type":"function","z":"e7cd1901.ee2408","name":"auxCT","func":"if(flow.get(\"triggered2\")=== true){\n    flow.set(\"triggered2\", false);\n    if(msg.payload.state.on === true){\n        flow.set(\"auxCT\",msg.payload.state.ct);\n        flow.set(\"countBrightness\",msg.payload.state.bri);\n    }\n}\n\n","outputs":0,"noerr":0,"initialize":"","finalize":"","x":1330,"y":320,"wires":[]},{"id":"b3cdb622.ddf5c8","type":"function","z":"d3db5d74.fb8fa","name":"Botão Quarto Nédi Click","func":"if(msg.payload.entity_id === \"binary_sensor.botao_quarto_nedi\" && msg.payload.event.click_type === \"single\"){\n\n    global.set(\"botaoQuarto\",true);\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":280,"wires":[["c1f2906e.f1bc6"]]},{"id":"c1f2906e.f1bc6","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Clique Quarto Nédi","links":["fda88def.b69f6","51fa6e7f.a5e2f"],"x":715,"y":280,"wires":[]},{"id":"e2812321.99f76","type":"function","z":"d3db5d74.fb8fa","name":"Botão Quarto Nédi Double","func":"if(msg.payload.entity_id === \"binary_sensor.botao_quarto_nedi\" && msg.payload.event.click_type === \"double\"){\n\n    \n    global.set(\"botaoQuarto\",true);\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"x":540,"y":320,"wires":[["3e659e3a.ee1442"]]},{"id":"3e659e3a.ee1442","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Duplo Clique Quarto Nédi","links":["17b7df66.4128b1"],"x":715,"y":320,"wires":[]},{"id":"31339c0.ecc2764","type":"function","z":"d3db5d74.fb8fa","name":"Movimento Quarto Nédi","func":"if(msg.payload.entity_id === \"binary_sensor.movimento_quarto_nedi\"){\n        var newMsg;\n        newMsg = {payload:{On : true}};\n        return newMsg;\n}\n//sensor_motion.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":840,"wires":[["e434c7b2.a0c848"]]},{"id":"e434c7b2.a0c848","type":"link out","z":"d3db5d74.fb8fa","name":"Movimento Quarto Nédi","links":["45668a49.9722e4","75fea52c.e1a99c"],"x":715,"y":840,"wires":[]},{"id":"910ee8ec.c1bba8","type":"function","z":"d3db5d74.fb8fa","name":"Botão Cozy Time Click","func":"if(msg.payload.entity_id === \"binary_sensor.botao_cozy_time\" && msg.payload.event.click_type === \"single\"){\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":360,"wires":[["36ae8580.9cd94a"]]},{"id":"1849eadb.cfb485","type":"function","z":"d3db5d74.fb8fa","name":"Botão Cozy Time Double","func":"if(msg.payload.entity_id === \"binary_sensor.botao_cozy_time\" && msg.payload.event.click_type === \"double\"){\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":400,"wires":[["dffc58c5.987c58"]]},{"id":"36ae8580.9cd94a","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Clique Cozy Time","links":["56beed64.231ab4"],"x":715,"y":360,"wires":[]},{"id":"182aa26e.838abe","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Duplo Clique Cozy Time","links":["17b7df66.4128b1"],"x":835,"y":420,"wires":[]},{"id":"451128d7.e51fd8","type":"comment","z":"d3db5d74.fb8fa","name":"Mensagens do Aqara","info":"Clique do botão:\n\n    fromip: \"192.168.0.56:4321\"\n    ip: \"192.168.0.56\"\n    port: 4321\n    payload: object\n    cmd: \"report\"\n    model: \"sensor_switch.aq2\"\n    sid: \"158d00023e8629\"\n    params: array[1]\n    0: object\n    button_0: \"click\"\n    _msgid: \"1203d8b7.5ccdd7\"\n    \nDuplo clique do botão:\n    fromip: \"192.168.0.56:4321\"\n    ip: \"192.168.0.56\"\n    port: 4321\n    payload: object\n    cmd: \"report\"\n    model: \"sensor_switch.aq2\"\n    sid: \"158d00023e8629\"\n    params: array[1]\n    0: object\n    button_0: \"double_click\"\n    _msgid: \"ebe10ada.859dd8\"\n\nSensor de movimento:\n    fromip: \"192.168.0.56:4321\"\n    ip: \"192.168.0.56\"\n    port: 4321\n    payload: object\n    cmd: \"report\"\n    model: \"sensor_motion.aq2\"\n    sid: \"158d00035feb3d\"\n    params: array[2]\n    0: object\n    illumination: 0\n    1: object\n    lux: 0\n    _msgid: \"d9c2a184.98232\"\n    \n    fromip: \"192.168.0.56:4321\"\n    ip: \"192.168.0.56\"\n    port: 4321\n    payload: object\n    cmd: \"report\"\n    model: \"sensor_motion.aq2\"\n    sid: \"158d00035feb3d\"\n    params: array[1]\n    0: object\n    motion_status: \"motion\"\n    _msgid: \"f691105f.78934\"\n        ","x":240,"y":300,"wires":[]},{"id":"14440e93.eb1131","type":"link out","z":"d3db5d74.fb8fa","name":"Movimento Cozinha","links":["25bef91.7b6ff06"],"x":715,"y":900,"wires":[]},{"id":"97ed078d.d825b8","type":"function","z":"d3db5d74.fb8fa","name":"Movimento Cozinha","func":"if(msg.payload.entity_id === \"binary_sensor.movimento_cozinha\"){\n        var newMsg;\n        newMsg = {payload:{On : true}};\n        return newMsg;\n}\n//sensor_motion.aq2","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":900,"wires":[["14440e93.eb1131"]]},{"id":"b7edb068.d2035","type":"function","z":"d3db5d74.fb8fa","name":"Botão Sala Double","func":"if(msg.payload.entity_id === \"binary_sensor.botao_sala\"){\n    if(msg.payload.event.click_type === \"double\"){\n        return msg;\n    }\n}\n//remote.b286acn01\n\n","outputs":1,"noerr":0,"x":510,"y":600,"wires":[["4b42a86c.e9e038"]]},{"id":"38389231.38335e","type":"function","z":"d3db5d74.fb8fa","name":"Botão Sala Click","func":"if(msg.payload.entity_id === \"binary_sensor.botao_sala\"){\n    if(msg.payload.event.click_type === \"single\"){\n        return msg;\n    }\n}\n//remote.b286acn01\n\n","outputs":1,"noerr":0,"x":500,"y":560,"wires":[["45609596.267fbc"]]},{"id":"45609596.267fbc","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Clique Sala","links":["89389c62.930d4"],"x":715,"y":560,"wires":[]},{"id":"4b42a86c.e9e038","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Duplo Clique Sala","links":["a1715e17.4597b"],"x":715,"y":600,"wires":[]},{"id":"968300f.8aadb","type":"function","z":"d3db5d74.fb8fa","name":"Porta Fechada","func":"if(msg.topic === \"binary_sensor.porta_banheiro\"){\n    if(msg.payload === false){\n        global.set(\"portaAbertaBanheiro\",false);\n        //abriu\n        return msg;\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":1420,"wires":[["a1db54df.1c33d8"]]},{"id":"8cd6b99e.6b2b18","type":"function","z":"d3db5d74.fb8fa","name":"Porta Aberta","func":"if(msg.topic === \"binary_sensor.porta_banheiro\"){\n    if(msg.payload === true){\n        global.set(\"portaAbertaBanheiro\",true);\n        msg = {payload: {ContactSensorState : false}}\n        //abriu\n        return msg;\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":510,"y":1360,"wires":[["42528d90.963b34"]]},{"id":"42528d90.963b34","type":"link out","z":"d3db5d74.fb8fa","name":"Porta Banheiro Aberta","links":["afeb6c53.3a416","c21ba8da.c2fe28","2888f5bb.ace53a"],"x":715,"y":1360,"wires":[]},{"id":"a1db54df.1c33d8","type":"link out","z":"d3db5d74.fb8fa","name":"Porta Banheiro Fechada","links":["9c30b842.8e9818","939f7c5f.f82bb"],"x":715,"y":1420,"wires":[]},{"id":"f762ec29.df263","type":"function","z":"d3db5d74.fb8fa","name":"Botão Escritório Double","func":"if(msg.payload.entity_id === \"binary_sensor.botao_escritorio\"){\n    if(msg.payload.event.click_type === \"double\"){\n        return msg;\n    }\n}\n//remote.b286acn01\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":680,"wires":[["1b8c3fb3.a193c"]]},{"id":"153e6887.fab7b7","type":"function","z":"d3db5d74.fb8fa","name":"Botão Escritório Click","func":"if(msg.payload.entity_id === \"binary_sensor.botao_escritorio\"){\n    if(msg.payload.event.click_type === \"single\"){\n        return msg;\n    }\n}\n//remote.b286acn01\n\n","outputs":1,"noerr":0,"x":520,"y":640,"wires":[["d7eca66b.88bb28"]]},{"id":"d7eca66b.88bb28","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Clique Escritorio","links":["6e3aee4a.c5c39","62256981.1a5a98"],"x":715,"y":640,"wires":[]},{"id":"1b8c3fb3.a193c","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Duplo Clique Escritorio","links":["a1715e17.4597b"],"x":715,"y":680,"wires":[]},{"id":"debd4025.dcc25","type":"function","z":"d3db5d74.fb8fa","name":"Botão Entrada Double","func":"if(msg.payload.entity_id === \"binary_sensor.botao_entrada\" && msg.payload.event.click_type === \"double\"){\n\n    global.set(\"botaoBanheiro\", true);\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":760,"wires":[["d57439e1.373828"]]},{"id":"bbc954fe.34ca28","type":"function","z":"d3db5d74.fb8fa","name":"Botão Entrada Click","func":"if(msg.payload.entity_id === \"binary_sensor.botao_entrada\" && msg.payload.event.click_type === \"single\"){\n\n    global.set(\"botaoBanheiro\", true);\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":720,"wires":[["9e3b29f6.ffe448"]]},{"id":"9e3b29f6.ffe448","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Clique Entrada","links":["6e3aee4a.c5c39","89389c62.930d4","62256981.1a5a98"],"x":715,"y":720,"wires":[]},{"id":"d57439e1.373828","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Duplo Clique Entrada","links":["5ff82e19.d35f4"],"x":715,"y":760,"wires":[]},{"id":"7a2d4a63.4ad274","type":"link in","z":"2bbba447.a4759c","name":"Botao Banheiro","links":[],"x":115,"y":329,"wires":[["78d25414.be2c8c"]]},{"id":"c21ba8da.c2fe28","type":"link in","z":"2bbba447.a4759c","name":"Porta Banheiro Aberta","links":["42528d90.963b34"],"x":115,"y":389,"wires":[["78d25414.be2c8c"]]},{"id":"89389c62.930d4","type":"link in","z":"e7cd1901.ee2408","name":"Botao Clique Sala","links":["45609596.267fbc","9e3b29f6.ffe448"],"x":255,"y":820,"wires":[["71ba2d22.7c82a4"]]},{"id":"6e3aee4a.c5c39","type":"link in","z":"5767c936.cabd18","name":"Botao Clique Escritorio ","links":["d7eca66b.88bb28","9e3b29f6.ffe448"],"x":275,"y":760,"wires":[["3914d48b.1018fc"]]},{"id":"56beed64.231ab4","type":"link in","z":"444fced8.33ecb","name":"Cozy Time","links":["36ae8580.9cd94a","b97bc34b.2fbc2"],"x":655,"y":660,"wires":[["44d8cef9.74ca3"]]},{"id":"44d8cef9.74ca3","type":"change","z":"444fced8.33ecb","name":"","rules":[{"t":"delete","p":"payload","pt":"msg"},{"t":"set","p":"payload.On","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":820,"y":700,"wires":[["d89ac13d.3cb76","916a8285.b1508","4498bacc.ae0994","4842b291.bdecdc","270b57cf.3bbcb8","b09a970.3afbe68","d999e68c.efcaf8","3b2f97c2.59f538"]]},{"id":"36bb604a.83da8","type":"function","z":"d3db5d74.fb8fa","name":"","func":"if(msg.payload.event.entity_id === \"binary_sensor.vibration\"){\n    if(msg.payload.event.new_state.state === \"on\"){\n        //movimento\n    }\n    if(msg.payload.event.new_state.state === \"off\"){\n        //movimento parou\n        \n    }\n    return msg;\n}\n//vibration.aq1\n","outputs":1,"noerr":0,"x":440,"y":1500,"wires":[[]]},{"id":"a78b03ac.299d4","type":"change","z":"2bbba447.a4759c","name":"set aux","rules":[{"t":"set","p":"auxEmissorBanheiro","pt":"global","to":"Alexa","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":240,"wires":[["250ab27.747084e"]]},{"id":"1aae8118.22a5ff","type":"change","z":"2bbba447.a4759c","name":"set aux","rules":[{"t":"set","p":"auxEmissorBanheiro","pt":"global","to":"Alexa","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":280,"wires":[["b4038cea.b3677"]]},{"id":"9c30b842.8e9818","type":"link in","z":"2bbba447.a4759c","name":"Porta Fechada","links":["a1db54df.1c33d8"],"x":1415,"y":580,"wires":[["e02f792c.1a72b8","5f7a4469.0f7a3c"]]},{"id":"afeb6c53.3a416","type":"link in","z":"2bbba447.a4759c","name":"Porta Banheiro Aberta","links":["42528d90.963b34","2cac04a0.1e088c"],"x":1575,"y":480,"wires":[["c4a667ef.36ae08"]]},{"id":"c4a667ef.36ae08","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1690,"y":480,"wires":[["48a71a45.f09914"]]},{"id":"5f7a4469.0f7a3c","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1570,"y":580,"wires":[["91868a33.c4af98"]]},{"id":"30922957.6bfc26","type":"function","z":"2bbba447.a4759c","name":"Triggered?","func":"if(flow.get(\"triggered1\")===true){\n    flow.set(\"triggered1\", false);\n    return msg;\n}","outputs":1,"noerr":0,"x":1010,"y":300,"wires":[["d851d997.3c2738"]]},{"id":"f39ad338.f1792","type":"function","z":"2bbba447.a4759c","name":"Triggered?","func":"if(flow.get(\"triggered1\")===true){\n    flow.set(\"triggered1\", false);\n    return msg;\n}","outputs":1,"noerr":0,"x":1010,"y":360,"wires":[["d851d997.3c2738"]]},{"id":"aa48fad2.d67908","type":"change","z":"e7cd1901.ee2408","name":"","rules":[{"t":"set","p":"triggered2","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":990,"y":320,"wires":[["adfe724a.6dadc"]]},{"id":"2389b8f5.93f1f8","type":"change","z":"e7cd1901.ee2408","name":"","rules":[{"t":"set","p":"triggered1","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1190,"y":240,"wires":[["c7025749.a03158"]]},{"id":"c7ff1e9c.b4318","type":"change","z":"e7cd1901.ee2408","name":"","rules":[{"t":"set","p":"triggered3","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":800,"wires":[["4933329e.0da91c","b0f9627e.ecf18"]]},{"id":"b0fd8aa9.65c008","type":"function","z":"e7cd1901.ee2408","name":"Add Topic","func":"var newMsg;\nif(typeof msg.ajuda !== \"undefined\"){\n    if(msg.ajuda === 1){\n        newMsg = {\"topic\":\"LuzSala\", \"payload\": true};\n        flow.set(\"triggered3\", false);\n        return newMsg;\n    }\n}\nif(flow.get(\"triggered3\")===true){\n    flow.set(\"triggered3\", false);\n        if(msg.payload.state.on === true)\n        {\n            newMsg = {\"topic\":\"LuzSala\", \"payload\": true};\n            return newMsg;\n        }\n        if(msg.payload.state.on === false)\n        {\n            newMsg = {\"topic\":\"LuzSala\",\"payload\": false};\n            return newMsg;\n        }\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1120,"y":800,"wires":[["b6f15c21.550fa"]]},{"id":"5d67fe55.6d3b9","type":"function","z":"5767c936.cabd18","name":"Add Topic","func":"var newMsg;\nif(typeof msg.ajuda !== \"undefined\"){\n    if(msg.ajuda === 1){\n        newMsg = {\"topic\":\"Luz1\", \"payload\": true};\n        flow.set(\"triggered3\", false);\n        return newMsg;\n    }\n}\nif(flow.get(\"triggered3\")===true){\n    flow.set(\"triggered3\", false);\n    if(msg.payload.state.on === true)\n    {\n        newMsg = {\"topic\":\"Luz1\", \"payload\": true};\n        return newMsg;\n    }\n    if(msg.payload.state.on === false)\n    {\n        newMsg = {\"topic\":\"Luz1\",\"payload\": false};\n        return newMsg;\n    }\n\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1100,"y":660,"wires":[["5d29cf32.e961"]]},{"id":"684afb0c.39a754","type":"change","z":"5767c936.cabd18","name":"","rules":[{"t":"set","p":"triggered3","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":650,"y":660,"wires":[["64ff672c.ba8d78","7bf37992.695728"]]},{"id":"62da1cb0.8b2cd4","type":"change","z":"5767c936.cabd18","name":"","rules":[{"t":"set","p":"triggered2","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":60,"wires":[["33280499.5ea6bc"]]},{"id":"335a614.475419e","type":"change","z":"5767c936.cabd18","name":"","rules":[{"t":"set","p":"triggered1","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1390,"y":320,"wires":[["22c1a09f.a9a0d","41b9df88.d6a34"]]},{"id":"9d786bf9.924af8","type":"function","z":"5767c936.cabd18","name":"was triggered?","func":"if(flow.get(\"triggered1\")===true){\n    flow.set(\"triggered1\", false);\n    var newMsg;\n    if(msg.payload.state.on === true){\n        newMsg = {payload:{state:{bri:msg.payload.state.bri,\n                                  ct: msg.payload.state.ct\n                                  }\n                            },\n                            came: \"Yeelight\"\n        };\n        return newMsg;\n    }\n    if(msg.payload.state.on === false){\n        newMsg = {payload:{resetar: true}};\n        return newMsg;\n    }\n}","outputs":1,"noerr":0,"x":1780,"y":340,"wires":[["7ac2d25c.e13b9c"]]},{"id":"81c6103f.955f9","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":2360,"y":360,"wires":[]},{"id":"5eb62a84.b20844","type":"function","z":"859b066a.dd8128","name":"","func":"var newMsg;\nnewMsg = {payload:\"on\",\n          data:{attributes:{brightness: 10}}};\nreturn newMsg;","outputs":1,"noerr":0,"x":350,"y":1400,"wires":[["c3c08b63.f7a388","67394ee5.2f77f","680d3cd7.7b3284"]]},{"id":"99a5588e.1075d8","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"if(msg.payload === true ){\n    global.set(\"quartoOn\",false);\n    var newMsg;\n    newMsg = {payload : {}};\n    newMsg.payload.On = false;\n    return newMsg;\n}","outputs":1,"noerr":0,"x":2585,"y":1280,"wires":[["365eb98e.8a42b6","75ef8d3.e961874","826e23d9.db504","85ac76bc.c20008","87921bf9.d6ed98","98cbcd2d.f7cd1","aa029cc1.d33f8","538cd4f9.edfb1c","a2eabe9.35fc44","d3e1203d.5d95a","a640dc34.316c7","1d4e741f.f8d3ac","30734ef7.3c4e82","d9d62bca.20a008","e4df9aa7.6a4368","8d7bb5c9.c6fab8"]]},{"id":"5a4c186.69fb7e8","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"if(msg.payload === false){\n        \n    global.set(\"quartoOn\",true);\n    var newMsg;\n    newMsg = {payload : {}};\n    newMsg.payload.On = true;\n    return newMsg;\n}","outputs":1,"noerr":0,"x":2580,"y":1340,"wires":[["1aefed56.9e94f3","67fa9bad.4e0854","afab0c06.ceb72","7332e558.4e464c","df106a4d.b38fe8","7e122029.95ec1"]]},{"id":"365eb98e.8a42b6","type":"function","z":"859b066a.dd8128","d":true,"name":"","func":"global.set(\"vouDormir\", true);\nvar aux = [{}]\naux[0].entity = \"Luz do Quarto\";\naux[0].action = \"turnOff\";\n\nvar newMsg;\nnewMsg = { payload: aux};\nreturn newMsg;","outputs":1,"noerr":0,"x":2940,"y":1560,"wires":[["96e8b4ab.c18ff8"]]},{"id":"1aefed56.9e94f3","type":"function","z":"859b066a.dd8128","d":true,"name":"","func":"var aux = [{},{},{}]\naux[0].entity = \"Luz do Quarto\";\naux[0].action = \"setColorTemperature\";\naux[0].value = \"cool\";\n\naux[1].entity = \"Luz do Quarto\";\naux[1].action = \"setBrightness\";\naux[1].value = 100;\n\naux[2].entity = \"Luz do Quarto\";\naux[2].action = \"turnOn\";\nvar newMsg;\nnewMsg = { payload: aux};\nreturn newMsg;","outputs":1,"noerr":0,"x":2940,"y":1500,"wires":[["d4386d44.5a3ad"]]},{"id":"ba1ec2e9.d82c8","type":"mqtt out","z":"859b066a.dd8128","name":"setOn RGB Strip","topic":"QuartoNedi/setOnRGB","qos":"","retain":"","broker":"64936db9.640564","x":3150,"y":1060,"wires":[]},{"id":"75ef8d3.e961874","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"msg = {payload:0};\nreturn msg;","outputs":1,"noerr":0,"x":2940,"y":1060,"wires":[["ba1ec2e9.d82c8"]]},{"id":"dffc58c5.987c58","type":"function","z":"d3db5d74.fb8fa","name":"Turn On","func":"msg.payload = {\"On\":true};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":720,"y":420,"wires":[["182aa26e.838abe"]]},{"id":"40f34731.622338","type":"comment","z":"859b066a.dd8128","name":"Se luz do quarto estiver ligada baixinho, aumentar o brilho","info":"","x":2210,"y":1660,"wires":[]},{"id":"1bf5970a.d99939","type":"function","z":"859b066a.dd8128","name":"","func":"if(msg.payload === \"on\"){\n        if(msg.data.attributes.brightness < 128)\n        {\n            msg.ajuda = 1;\n            return msg;\n        }\n        else{\n            \n            msg.ajuda = 2;\n            return msg;\n        }\n}\nelse{\n    \n            msg.ajuda = 1;\n            return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":720,"y":1360,"wires":[["e7d4293b.647048","6adec2d1.8d8afc"]]},{"id":"7a532c43.3150c4","type":"switch","z":"859b066a.dd8128","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"2","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":1130,"y":1360,"wires":[["7a7d2b89.5f2054","74c414e5.0afb0c","97a94c63.cf63d","8a64803e.2782f","bd1f6328.84ca2"],["df7f6951.f1f2f8"]]},{"id":"b388fc68.7a0cc","type":"function","z":"859b066a.dd8128","d":true,"name":"","func":"var aux = [{},{},{}]\naux[0].entity = \"Luz do Quarto\";\naux[0].action = \"setColorTemperature\";\naux[0].value = \"cool\";\n\naux[1].entity = \"Luz do Quarto\";\naux[1].action = \"setBrightness\";\naux[1].value = 100;\n\naux[2].entity = \"Luz do Quarto\";\naux[2].action = \"turnOn\";\n\nmsg.payload = aux;\nreturn msg;","outputs":1,"noerr":0,"x":1670,"y":1660,"wires":[["52bf523a.a2e16c"]]},{"id":"3c7f99bb.540f26","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"msg.payload = {};\nmsg.payload.On = true;\nreturn msg;","outputs":1,"noerr":0,"x":1670,"y":1600,"wires":[[]]},{"id":"826e23d9.db504","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2930,"y":600,"wires":[]},{"id":"7a7d2b89.5f2054","type":"function","z":"859b066a.dd8128","name":"Luz do Quarto Topic","func":"var newMsg;\nif(msg.payload === \"on\")\n{\n    global.set(\"quartoOn\",true);\n    newMsg = {\"topic\":\"Luz\",\"payload\": true};\n    return newMsg;\n}\nif(msg.payload === \"off\")\n{\n    newMsg = {\"topic\":\"Luz\",\"payload\": false};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":1380,"y":1460,"wires":[["5c2709a1.4dc318"]]},{"id":"4cf5516a.7f55","type":"function","z":"859b066a.dd8128","name":"","func":"var newMsg;\nif(msg.payload.On === true)\n{\n    global.set(\"quartoOn\",true);\n    newMsg = {\"topic\":\"Projetor Ceu\",\"payload\": true};\n    return newMsg;\n}\nif(msg.payload.On === false)\n{\n    newMsg = {\"topic\":\"Projetor Ceu\",\"payload\": false};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1640,"y":1400,"wires":[["bc66085.c4e0af8"]]},{"id":"ce1bcdf1.593cb","type":"function","z":"859b066a.dd8128","name":"","func":"var newMsg;\nif(msg.payload === true){\n        newMsg = {\"topic\":\"RGB Strip\",\n                \"payload\": true\n        };\n        return newMsg;\n    \n}\nif(msg.payload ===false){\n        newMsg = {\"topic\":\"RGB Strip\",\n                \"payload\": false\n        };\n        return newMsg;\n    \n}\nvar homeassistant = global.get(\"homeassistant\");\nif(homeassistant.homeAssistant.states[\"light.rgb_strip\"].state === \"on\"){\n        newMsg = {\"topic\":\"RGB Strip\",\n                \"payload\": true\n        };\n        return newMsg;\n}\nelse{\n        newMsg = {\"topic\":\"RGB Strip\",\n                \"payload\": false\n        };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1640,"y":1280,"wires":[["87b5da0b.2e59c8"]]},{"id":"87b5da0b.2e59c8","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1800,"y":1280,"wires":[["980435a0.32ea78"]]},{"id":"bc66085.c4e0af8","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1800,"y":1400,"wires":[["980435a0.32ea78"]]},{"id":"5c2709a1.4dc318","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1800,"y":1460,"wires":[["980435a0.32ea78"]]},{"id":"703ec7a2.e01c68","type":"function","z":"5767c936.cabd18","name":"Turn Off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg = {payload : {\"On\": false, \"on\": false}};\n    global.set(\"EscritorioOn\", false);\n    global.set(\"EscritorioEscuro\", false);\n    return newMsg;\n}","outputs":1,"noerr":0,"x":2100,"y":700,"wires":[["e432c868.e95268","d7677e76.e2922","3c34f863.bc1ac8","1af7a9e4.d79636","2c5d9c1c.9be264"]]},{"id":"67fa9bad.4e0854","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2930,"y":1920,"wires":[]},{"id":"5bbc4c76.3271a4","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2250,"y":1220,"wires":[]},{"id":"9c786f0f.566a","type":"inject","z":"e7cd1901.ee2408","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":240,"y":920,"wires":[["71ba2d22.7c82a4"]]},{"id":"2f79ea48.43b926","type":"inject","z":"5767c936.cabd18","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":260,"y":820,"wires":[["3914d48b.1018fc"]]},{"id":"7bf37992.695728","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":820,"y":600,"wires":[["c1a0492a.9440f8"]]},{"id":"c1a0492a.9440f8","type":"function","z":"5767c936.cabd18","name":"In Case of Error","func":"msg.ajuda = 1;\nreturn msg;","outputs":1,"noerr":0,"x":980,"y":600,"wires":[["5d67fe55.6d3b9"]]},{"id":"4e1799e9.3bd0f8","type":"function","z":"e7cd1901.ee2408","name":"In Case of Error","func":"msg.ajuda = 1;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":960,"y":760,"wires":[["b0fd8aa9.65c008"]]},{"id":"b0f9627e.ecf18","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":800,"y":760,"wires":[["4e1799e9.3bd0f8"]]},{"id":"d64c8331.8f764","type":"debug","z":"5767c936.cabd18","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1750,"y":680,"wires":[]},{"id":"67394ee5.2f77f","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":540,"y":1420,"wires":[["1bf5970a.d99939"]]},{"id":"da6218d6.54b928","type":"function","z":"859b066a.dd8128","name":"","func":"flow.set(\"respondeu\", true);\nreturn msg;","outputs":1,"noerr":0,"x":710,"y":1300,"wires":[[]]},{"id":"d29ab4df.b0de28","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2415,"y":1280,"wires":[["99a5588e.1075d8"]]},{"id":"a50d5f5c.46e0d","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2420,"y":1340,"wires":[["5a4c186.69fb7e8"]]},{"id":"df7f6951.f1f2f8","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1360,"y":1540,"wires":[["3c7f99bb.540f26","b388fc68.7a0cc","4ebded05.27faf4"]]},{"id":"e7d4293b.647048","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":920,"y":1360,"wires":[["7a532c43.3150c4"]]},{"id":"f4e44398.a95af","type":"debug","z":"2bbba447.a4759c","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3090,"y":300,"wires":[]},{"id":"a2739762.e57528","type":"debug","z":"2bbba447.a4759c","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3090,"y":180,"wires":[]},{"id":"3e5f80d2.529f1","type":"link out","z":"d3db5d74.fb8fa","name":"Movimento Escritório","links":["291b7897.febc08","dacc485e.2fb2e8","b3061b2a.42a488"],"x":715,"y":1040,"wires":[]},{"id":"87bc8837.99e6a8","type":"function","z":"d3db5d74.fb8fa","name":"Movimento Escritório","func":"if(msg.payload.entity_id === \"binary_sensor.movimento_escritorio\"){\n    var newMsg = {payload: {MotionDetected: true}}\n    return newMsg;\n}\n//sensor_motion.aq2","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":1040,"wires":[["3e5f80d2.529f1"]]},{"id":"95d42658.d910a8","type":"trigger","z":"5767c936.cabd18","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-30","extend":false,"overrideDelay":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":850,"y":1320,"wires":[["fc6f1fdc.13022","3290497e.d5f816"]]},{"id":"fc6f1fdc.13022","type":"function","z":"5767c936.cabd18","name":"Cont++","func":"var contEscritorio = global.get(\"contEscritorio\");\nif(msg.payload.MotionDetected === true){\n    global.set(\"contEscritorio\", 0);   \n    node.send(msg);\n    node.status({fill:\"green\",shape:\"dot\",text:\"Movimento no Escritório\"});\n\n}\nelse{\n    if(contEscritorio >= 2700){\n        msg.reset = 1;\n        global.set(\"contEscritorio\", 2700)\n        global.set(\"overrideEscritorio\",false);\n        node.send(msg);\n        node.status({fill:\"green\",shape:\"dot\",text:\"Sem movimento, \"});\n        \n    }\n    else{\n        global.set(\"contEscritorio\", contEscritorio+30);\n        node.status({fill:\"green\",shape:\"dot\",text:\"cont\"+(contEscritorio+30)});\n    }\n}\nsetTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);\n    \n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":870,"y":1240,"wires":[["c6329c13.8e51a","48b7cd69.dc86b4"]]},{"id":"9ee7bdef.1a795","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":530,"y":1240,"wires":[["918b34b6.280628"]]},{"id":"291b7897.febc08","type":"link in","z":"5767c936.cabd18","name":"Movimento Escritório","links":["3e5f80d2.529f1","1f03bb0a.233655"],"x":275,"y":1240,"wires":[["9ee7bdef.1a795"]]},{"id":"6db289b5.2e7be8","type":"link in","z":"4c9c764d.9c4468","name":"Movimento Escritório Escuro","links":["9197a5aa.eb55d8","cc911481.98c798"],"x":788,"y":524,"wires":[["55f5a77a.253908"]]},{"id":"9197a5aa.eb55d8","type":"link out","z":"5767c936.cabd18","name":"Escritorio Movimento Escuro","links":["6db289b5.2e7be8"],"x":1235,"y":1240,"wires":[]},{"id":"48b7cd69.dc86b4","type":"function","z":"5767c936.cabd18","name":"Motion Detected","func":"if(msg.payload.MotionDetected === true){\n    if(!msg.reset){\n        if(global.get(\"escritorioEscuro\")===true && global.get(\"EscritorioOn\")=== false){\n            if(global.get(\"auxTurnOnEscritorio\") === true){ \n                global.set(\"auxTurnOnEscritorio\", false);\n                global.set(\"overrideEscritorio\",true);\n                return msg;\n            } \n        }\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1100,"y":1240,"wires":[["9197a5aa.eb55d8"]]},{"id":"c26cc436.d71418","type":"function","z":"d67ca66.293d758","name":"set aux","func":"var newMsg;\nnewMsg = {payload: {}};\nif(msg.payload === true){\n    global.set(\"LampadaOn\", true);\n    newMsg.payload = {\"On\": true};\n    \n}\nif(msg.payload === false){\n    global.set(\"LampadaOn\", false);\n    newMsg.payload = {\"On\": false};\n}   \n    \nreturn newMsg;","outputs":1,"noerr":0,"x":440,"y":160,"wires":[[]]},{"id":"70ce4b62.b3fb04","type":"function","z":"d67ca66.293d758","name":"set aux","func":"var newMsg;\nnewMsg = {payload: {}};\nif(msg.payload === true){\n    global.set(\"AbajurOn\", true);\n    newMsg.payload = {\"On\": true};\n    \n}\nif(msg.payload === false){\n    global.set(\"AbajurOn\", false);\n    newMsg.payload = {\"On\": false};\n}   \n    \nreturn newMsg;","outputs":1,"noerr":0,"x":440,"y":260,"wires":[[]]},{"id":"6f521a81.1652e4","type":"function","z":"d67ca66.293d758","name":"nothing yet","func":"var newMsg;\nnewMsg = {payload: {}};\nif(msg.payload === true){\n    newMsg.payload = {\"On\": true};\n    \n}\nif(msg.payload === false){\n    newMsg.payload = {\"On\": false};\n}   \n    \nreturn newMsg;","outputs":1,"noerr":0,"x":450,"y":480,"wires":[[]]},{"id":"817677be.bad9f8","type":"link in","z":"d67ca66.293d758","name":"AbajurOnOff","links":["9f17c2d.3ee754","9692d760.196b88","d6f65d1a.11585"],"x":545,"y":280,"wires":[["3839ca65.d6d486"]]},{"id":"370f5c21.73ee24","type":"link in","z":"d67ca66.293d758","name":"LampadaOnOff","links":["16e2dd57.1adedb","d3019078.3bcd6","48f14eb9.c3d7b","90f01dce.bf0b6","9c5bc3c7.af81a","e2a9b07f.fead7","197e141e.eb899c"],"x":545,"y":180,"wires":[["86b28ff5.8e8df"]]},{"id":"f034d649.4c2da8","type":"function","z":"d67ca66.293d758","name":"","func":"var newMsg;\n    newMsg = {payload:{}}\n    if(msg.payload.On === true){\n        newMsg.payload = {\n            \n          \"domain\": \"switch\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"switch.lampada\",\n\n        }\n    }\n    if(msg.payload.On === false){\n        newMsg.payload = {\n          \"domain\": \"switch\",\n          \"service\": \"turn_off\",\n          \"entity_id\": \"switch.lampada\",\n\n        }\n    }\n    return newMsg;\n","outputs":1,"noerr":0,"x":840,"y":180,"wires":[["1ec5d52d.21f41b"]]},{"id":"8c0cc7c1.3bbbb8","type":"function","z":"d67ca66.293d758","name":"","func":"var newMsg\n    newMsg = {payload:{}}\n    if(msg.payload.On === true){\n        newMsg.payload = {\n            \n          \"domain\": \"switch\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"switch.abajur_direita\",\n\n        }\n        node.send(newMsg);\n        \n        newMsg.payload = {\n            \n          \"domain\": \"switch\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"switch.abajur_esquerda\",\n\n        }\n        return newMsg;\n    }\n    if(msg.payload.On === false){\n        newMsg.payload = {\n            \n          \"domain\": \"switch\",\n          \"service\": \"turn_off\",\n          \"entity_id\": \"switch.abajur_esquerda\",\n\n        }\n        node.send(newMsg);\n        newMsg.payload = {\n            \n          \"domain\": \"switch\",\n          \"service\": \"turn_off\",\n          \"entity_id\": \"switch.abajur_direita\",\n\n        }\n        return newMsg;\n    }\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":840,"y":280,"wires":[["f057b86c.5276b8"]]},{"id":"86b28ff5.8e8df","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":670,"y":180,"wires":[["f034d649.4c2da8"]]},{"id":"3839ca65.d6d486","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":670,"y":280,"wires":[["8c0cc7c1.3bbbb8"]]},{"id":"3f571f9d.54986","type":"mqtt out","z":"444fced8.33ecb","name":"Rainbow Slow","topic":"QuartoNedi/setMode08","qos":"0","retain":"false","broker":"64936db9.640564","x":1420,"y":440,"wires":[]},{"id":"d89ac13d.3cb76","type":"function","z":"444fced8.33ecb","d":true,"name":"Liga","func":"msg = {payload:1};\nreturn msg;","outputs":1,"noerr":0,"x":1219,"y":440,"wires":[["3f571f9d.54986"]]},{"id":"916a8285.b1508","type":"function","z":"444fced8.33ecb","d":true,"name":"Menos Brilho & Turquesa","func":"msg.payload = {\n    \"On\" : true,\n    \"Hue\" : 174,\n    \"Saturation\" : 100,\n    \"Brightness\" : 10\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1282,"y":560,"wires":[["b5177da.2e63d8"]]},{"id":"a82fb664.7fec48","type":"link out","z":"e7cd1901.ee2408","name":"TunelOnOff","links":["33f61486.af8adc"],"x":495,"y":440,"wires":[]},{"id":"9692d760.196b88","type":"link out","z":"5767c936.cabd18","name":"AbajurOn","links":["817677be.bad9f8"],"x":1315,"y":460,"wires":[]},{"id":"e340c5bc.183728","type":"link in","z":"4c9c764d.9c4468","name":"Sun down","links":["ea8f030f.c171c","e22ed624.8805a8"],"x":788,"y":568,"wires":[["55f5a77a.253908"]]},{"id":"e02f792c.1a72b8","type":"function","z":"2bbba447.a4759c","name":"Aberto Muito Tempo","func":"var abertoMuitoTempo = global.get(\"abertoMuitoTempo\");\nif(msg.payload.ContactSensorState === false){\n    if(abertoMuitoTempo === true){\n        global.set(\"auxEmissorBanheiro\", \"Yeelight\");\n        global.set(\"isOnBanheiro\", false);\n        msg.ajuda = 1;\n        return msg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1600,"y":440,"wires":[["b4038cea.b3677"]]},{"id":"962c7f2a.f157e","type":"switch","z":"2bbba447.a4759c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"off","vt":"str"},{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":2210,"y":420,"wires":[["3665f12e.70f2ee","1004281c.91e608"],["13788a95.fdf4b5"]]},{"id":"2e96e8b1.fd1438","type":"comment","z":"2bbba447.a4759c","name":"Se a porta fecha com a luz desligada há muito tempo, a luz liga","info":"","x":1810,"y":620,"wires":[]},{"id":"a8183221.9ddba","type":"comment","z":"2bbba447.a4759c","name":"Se a porta fica aberta com a luz ligada há muito tempo, a luz desliga","info":"","x":1820,"y":660,"wires":[]},{"id":"c2a88c88.89825","type":"comment","z":"2bbba447.a4759c","name":"Botão foi clicado","info":"","x":180,"y":269,"wires":[]},{"id":"32a486b0.f5765a","type":"comment","z":"2bbba447.a4759c","name":"A porta foi aberta.","info":"","x":190,"y":449,"wires":[]},{"id":"dea6b65d.76e218","type":"comment","z":"2bbba447.a4759c","name":"Check se a luz do banheiro está ligada","info":"","x":810,"y":120,"wires":[]},{"id":"15f12ff4.d0e12","type":"comment","z":"2bbba447.a4759c","name":"Liga ou desliga a luz conforme a lógica","info":"","x":2870,"y":140,"wires":[]},{"id":"918b34b6.280628","type":"function","z":"5767c936.cabd18","name":"Start Cont","func":"if(msg.payload.MotionDetected === true){\n    if(global.set(\"contEscritorio\") > 1500){        \n        if(global.get(\"auxTurnOnEscritorio\") === false){ \n            global.set(\"auxTurnOnEscritorio\", true);\n        }\n}\n}\nglobal.set(\"contEscritorio\", 0);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":710,"y":1240,"wires":[["fc6f1fdc.13022"]]},{"id":"e294467e.db1708","type":"function","z":"859b066a.dd8128","name":"Turn On Bright","func":"var i = parseInt(flow.get(\"iterLuzDoQuartoInc\"));\nvar newMsg;\nif (i > 255) {\n        /*newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.luz_do_quarto_nedi\",\n                \"brightness\": 255,\n                \"rgb_color\": [255, 255, 255]\n            }\n        }};\n        */\n        //node.send(newMsg);\n        newMsg={reset: true};    \n        return newMsg;\n}\nnewMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.luz_do_quarto_nedi\",\n                \"brightness\": i,\n                \"rgb_color\": [i, i, i]\n            }\n}};    \ni += 35\nflow.set(\"iterLuzDoQuartoInc\", i);\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3230,"y":240,"wires":[["c649377c.e77e58","65f2e1b5.e39a7"]]},{"id":"b6213a32.33a3d8","type":"function","z":"859b066a.dd8128","name":"Turn On Dim","func":"var i = parseInt(flow.get(\"iterLuzDoQuartoInc\"));\nvar newMsg;\nif (i > 255) {\n        return {reset: true};\n}\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_nedi\",\n            \"brightness\": parseInt(i/15),\n            \"rgb_color\": [255, 181, 107]\n        }\n    }};\ni += 50\nflow.set(\"iterLuzDoQuartoInc\", i);\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3220,"y":320,"wires":[["c14458a8.5a2408"]]},{"id":"1004281c.91e608","type":"function","z":"2bbba447.a4759c","name":"Turn On Verde","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nglobal.set(\"BanheiroOcupado\", false);\nif(Hour < 20 && Hour > 6){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \"entity_id\": \"light.aqara_hub\",\n            \"brightness\": 6,\n            \"rgb_color\": [0,10,0]\n        }\n    }};\n    newMsg.delay = 600000\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2700,"y":480,"wires":[["5420eb2f.585104","2bf5265d.fc73fa"]]},{"id":"13788a95.fdf4b5","type":"function","z":"2bbba447.a4759c","name":"Turn On Vermelho","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nglobal.set(\"BanheiroOcupado\", true);\n\nif(Hour < 20 && Hour > 6){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \"entity_id\": \"light.aqara_hub\",\n            \"brightness\": 6,\n            \"rgb_color\": [10,0,0]\n        }\n    }};\n    newMsg.delay = 600000\n    \n    return newMsg;\n} ","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2710,"y":600,"wires":[["5420eb2f.585104","2bf5265d.fc73fa"]]},{"id":"81a6fdf6.25452","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":670,"y":1240,"wires":[]},{"id":"f97d7621.b40a68","type":"inject","z":"859b066a.dd8128","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":260,"y":1260,"wires":[["5eb62a84.b20844"]]},{"id":"4498bacc.ae0994","type":"function","z":"444fced8.33ecb","name":"Pouco brilho e turquesa","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.luz_do_quarto_nedi\",\n        \"brightness\": 30,\n        \"rgb_color\": [0,216,255]\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1280,"y":680,"wires":[["d81c8d41.b658f"]]},{"id":"5dbf333.b939dcc","type":"function","z":"444fced8.33ecb","name":"Hora do Filme","func":"if(\n    \n    msg.payload.name===\"Echo Dot da Sala\" &&(\n    msg.payload.description.summary.includes('hora do filme')===true||\n    msg.payload.description.summary.includes('filme')===true\n    \n    )){\n    var newMsg;\n    newMsg = {\"payload\": {\"horaDoFilme\": true}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":2260,"wires":[["c2eda9b.cf38a58","6f4a0d7c.b00f04"]]},{"id":"c2eda9b.cf38a58","type":"link out","z":"444fced8.33ecb","name":"Hora do filme","links":["a3cf5b54.d11ca8"],"x":655,"y":2260,"wires":[]},{"id":"a3cf5b54.d11ca8","type":"link in","z":"4c9c764d.9c4468","name":"Hora do Filme","links":["c2eda9b.cf38a58","9a1c72b3.da05c"],"x":335,"y":1100,"wires":[["19554fb4.898e3","7fd58a3e.124184","fdb87cd7.4a536","c4d0a5ba.4a5f78","d86e7a62.6c6db8"]]},{"id":"247b7d18.10da82","type":"function","z":"444fced8.33ecb","name":"Luz do Quarto On/Off","func":"var newMsg;\nif(msg.payload.description.summary.includes('liga a luz do quarto')===true||\n    msg.payload.description.summary.includes('acende luz do quarto')===true||\n    msg.payload.description.summary.includes('liga luz do quarto')===true||\n    msg.payload.description.summary.includes('liga as luzes do quarto')===true||\n    msg.payload.description.summary.includes('liga luzes do quarto')===true ||\n    msg.payload.description.summary.includes('ligar a luz do quarto')===true||\n    msg.payload.description.summary.includes('ligar luz do quarto')===true||\n    msg.payload.description.summary.includes('ligar as luzes do quarto')===true||\n    msg.payload.description.summary.includes('ligar luzes do quarto')===true ||\n    msg.payload.description.summary.includes('acende a luz do quarto')===true||\n    msg.payload.description.summary.includes('acende as luzes do quarto')===true||\n    msg.payload.description.summary.includes('ligue a luz do quarto')===true||\n    msg.payload.description.summary.includes('ligue luz do quarto')===true||\n    msg.payload.description.summary.includes('ligue as luzes do quarto')===true||\n    msg.payload.description.summary.includes('ligue luzes do quarto')===true ||\n    (msg.payload.name===\"Echo Dot do Quarto Nédi\" &&\n       (\n       msg.payload.description.summary.includes('acende a luz')===true ||\n       msg.payload.description.summary.includes('liga a luz')===true ||\n       msg.payload.description.summary.includes('liga luz')===true||\n       msg.payload.description.summary.includes('liga luzes')===true ||\n       msg.payload.description.summary.includes('liga as luzes')===true ||\n       msg.payload.description.summary.includes('ligar a luz')===true ||\n       msg.payload.description.summary.includes('ligar luz')===true||\n       msg.payload.description.summary.includes('ligar luzes')===true ||\n       msg.payload.description.summary.includes('ligar as luzes')===true||\n       msg.payload.description.summary.includes('ligue a luz')===true ||\n       msg.payload.description.summary.includes('ligue luz')===true||\n       msg.payload.description.summary.includes('ligue luzes')===true ||\n       msg.payload.description.summary.includes('ligue as luzes')===true\n       ))\n    ){\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_nedi\",\n            \"rgb_color\": [255, 255, 255],\n            \"brightness\": 255,\n            \"transition\": 20\n        }\n    }};\n    \n    return newMsg;\n}\nif(msg.payload.description.summary.includes('desliga a luz do quarto')===true||\n    msg.payload.description.summary.includes('desliga luz do quarto')===true||\n    msg.payload.description.summary.includes('desliga as luzes do quarto')===true||\n    msg.payload.description.summary.includes('desliga luzes do quarto')===true ||\n    msg.payload.description.summary.includes('desligar a luz do quarto')===true||\n    msg.payload.description.summary.includes('desligar luz do quarto')===true||\n    msg.payload.description.summary.includes('desligar as luzes do quarto')===true||\n    msg.payload.description.summary.includes('desligar luzes do quarto')===true ||\n    msg.payload.description.summary.includes('desligue a luz do quarto')===true||\n    msg.payload.description.summary.includes('desligue luz do quarto')===true||\n    msg.payload.description.summary.includes('desligue as luzes do quarto')===true||\n    msg.payload.description.summary.includes('desligue luzes do quarto')===true ||\n    (msg.payload.name===\"Echo Dot do Quarto Nédi\" &&\n       (\n       msg.payload.description.summary.includes('desliga a luz')===true ||\n       msg.payload.description.summary.includes('desliga luz')===true||\n       msg.payload.description.summary.includes('desliga luzes')===true ||\n       msg.payload.description.summary.includes('desliga as luzes')===true ||\n       msg.payload.description.summary.includes('desligar a luz')===true ||\n       msg.payload.description.summary.includes('desligar luz')===true||\n       msg.payload.description.summary.includes('desligar luzes')===true ||\n       msg.payload.description.summary.includes('desligar as luzes')===true || \n       msg.payload.description.summary.includes('desligue a luz')===true ||\n       msg.payload.description.summary.includes('desligue luz')===true||\n       msg.payload.description.summary.includes('desligue luzes')===true ||\n       msg.payload.description.summary.includes('desligue as luzes')===true\n       ))\n    ){\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"light.luz_do_quarto_nedi\"\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":540,"y":1580,"wires":[["d49ef7c3.77a7c8","ebdf5687.a38418"]]},{"id":"ef9cc054.943","type":"function","z":"d67ca66.293d758","name":"Sunset","func":"\nif(msg.data.new_state.attributes.elevation < 4){\n        return msg;\n}\n//Sunset","outputs":1,"noerr":0,"x":470,"y":880,"wires":[["ff66883f.0ea258","f7d3c69.eeaf438"]]},{"id":"f7d3c69.eeaf438","type":"function","z":"d67ca66.293d758","name":"","func":"msg.payload = \"Sunset \" + msg.data.new_state.attributes.elevation;\nmsg.topic = \"Sunset\";\nglobal.set(\"salaEscura\", true);\nglobal.set(\"escritorioEscuro\", true);\nreturn msg;","outputs":1,"noerr":0,"x":620,"y":860,"wires":[["e22ed624.8805a8"]]},{"id":"ff66883f.0ea258","type":"debug","z":"d67ca66.293d758","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":600,"y":920,"wires":[]},{"id":"e22ed624.8805a8","type":"link out","z":"d67ca66.293d758","name":"Sun down","links":["e340c5bc.183728"],"x":725,"y":860,"wires":[]},{"id":"dcf3f583.9a5608","type":"inject","z":"2bbba447.a4759c","name":"Passou das 20h","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 20 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":2930,"y":460,"wires":[["a1e68de0.e2c7"]]},{"id":"6cc082a4.cebc2c","type":"function","z":"444fced8.33ecb","name":"Globo","func":"if(\n   (msg.payload.name===\"Echo Dot da Sala\" && \n    msg.payload.description.summary.includes('globo')===true ||\n    msg.payload.description.summary.includes('novela')===true||\n    msg.payload.description.summary.includes('jornal')===true\n    )\n   ){\n    var newMsg;\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_on\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_TV\"\n        }\n    }\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\",\n            \"media_content_id\": 12,\n            \"media_content_type\": \"channel\"\n        }\n    }};\n    \n    node.send(newMsg);\n    return;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":490,"y":2400,"wires":[["4be760da.d877"]]},{"id":"ddad8255.72c54","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3100,"y":420,"wires":[["7786e05.84eaa2"]]},{"id":"7786e05.84eaa2","type":"function","z":"2bbba447.a4759c","name":"Make sure it turned off","func":"flow.set(\"triggered2\", true);\nflow.set(\"didItTurnOffCheck\",msg.payload.on);\nreturn msg;\n","outputs":1,"noerr":0,"x":3290,"y":420,"wires":[["89308aa8.40e6a8"]]},{"id":"57b1a1b4.9a528","type":"function","z":"2bbba447.a4759c","name":"Turn Off","func":"if(flow.get(\"triggered2\")===true){\n    var newMsg;\n    flow.set(\"triggered2\", false);\n    if(flow.get(\"didItTurnOffCheck\")===false){\n        newMsg = { payload : {\"on\":false}};\n        node.status({fill:\"green\",shape:\"dot\",text:\"Desliga\"});\n        node.send(newMsg);   \n    }\n}","outputs":1,"noerr":0,"x":3680,"y":420,"wires":[["e1ea9a2.31bd168"]]},{"id":"24d07955.b49ff6","type":"function","z":"444fced8.33ecb","name":"Volume -","func":"if(               (msg.payload.name===\"Echo Dot da Sala\" && (\n        msg.payload.description.summary.includes('muito alto')===true||\n        msg.payload.description.summary.includes('abaixa o volume')===true||\n        msg.payload.description.summary.includes('baixa o volume')===true||\n        msg.payload.description.summary.includes('abaixa volume')===true||\n        msg.payload.description.summary.includes('baixa volume')===true||\n        msg.payload.description.summary.includes('abaixe o volume')===true||\n        msg.payload.description.summary.includes('baixe o volume')===true||\n        msg.payload.description.summary.includes('abaixe volume')===true||\n        msg.payload.description.summary.includes('baixe volume')===true\n    ))){\n    for(var i = 0 ; i < 7 ; i++){\n        newMsg= {payload : {\n            \"domain\": \"media_player\",\n            \"service\": \"volume_down\",\n            \"data\":{\n                \"entity_id\": \"media_player.tv_da_sala\"\n            }\n        }};\n        \n        node.send(newMsg);\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":2520,"wires":[["4be760da.d877"]]},{"id":"225c0d0d.39b7a2","type":"function","z":"444fced8.33ecb","name":"Volume + ","func":"if(          (msg.payload.name===\"Echo Dot da Sala\" && (\n        msg.payload.description.summary.includes('muito baixo')===true||\n        msg.payload.description.summary.includes('aumenta o volume')===true||\n        msg.payload.description.summary.includes('aumenta volume')===true\n    ))){\n    var newMsg;\n    for(var i = 0 ; i < 7 ; i++){\n        newMsg= {payload : {\n            \"domain\": \"media_player\",\n            \"service\": \"volume_up\",\n            \"data\":{\n                \"entity_id\": \"media_player.tv_da_sala\"\n            }\n        }};\n        \n        node.send(newMsg);\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":2580,"wires":[["4be760da.d877"]]},{"id":"69eec2df.5b7ccc","type":"comment","z":"444fced8.33ecb","name":"Abaixa o volume","info":"","x":280,"y":2480,"wires":[]},{"id":"554f8a3e.a570c4","type":"comment","z":"444fced8.33ecb","name":"Aumenta o volume","info":"","x":270,"y":2540,"wires":[]},{"id":"e6bedbb4.585b48","type":"comment","z":"444fced8.33ecb","name":"Troca de canal","info":"","x":280,"y":2360,"wires":[]},{"id":"ae466c3b.c0827","type":"function","z":"444fced8.33ecb","name":"Pausar","func":"if((msg.payload.name===\"Echo Dot do Sala\" && (\n        msg.payload.description.summary.includes('pausa')===true||\n        msg.payload.description.summary.includes('pausar')===true||\n        msg.payload.description.summary.includes('já volto')===true||\n        msg.payload.description.summary.includes('vou ao banheiro')===true||\n        msg.payload.description.summary.includes('vou no banheiro')===true\n    ))){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"media_stop\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\"\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":2640,"wires":[["c682411d.2f234","4be760da.d877"]]},{"id":"c682411d.2f234","type":"function","z":"444fced8.33ecb","name":"","func":"\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"media_play_pause\",\n        \"data\":{\n            \"entity_id\": \"media_player.apple_tv\"\n        }\n    }};\n    return newMsg;","outputs":1,"noerr":0,"x":690,"y":2640,"wires":[["2a0e2015.b584f"]]},{"id":"1e067aee.66c0b5","type":"function","z":"444fced8.33ecb","name":"Mute TV","func":"var newMsg;\nif(     (msg.payload.name===\"Echo Dot do Sala\" && (\n        msg.payload.description.summary.includes('silêncio')===true||\n        msg.payload.description.summary.includes('silencio')===true||\n        msg.payload.description.summary.includes('silencia')===true||\n        msg.payload.description.summary.includes('silenciar')===true||\n        msg.payload.description.summary.includes('mudo')===true||\n        msg.payload.description.summary.includes('vaca amarela')===true\n    ))){\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"volume_mute\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\",\n            \"is_volume_muted\": false\n        }\n    }};\n    \n    return newMsg;\n}\n\nif(     (msg.payload.name===\"Echo Dot do Sala\" && ( \n        msg.payload.description.summary.includes('volta ao normal')===true||\n        msg.payload.description.summary.includes('normal')===true||\n        msg.payload.description.summary.includes('silencia')===true||\n        msg.payload.description.summary.includes('silenciar')===true||\n        msg.payload.description.summary.includes('mudo')===true||\n        msg.payload.description.summary.includes('vaca amarela')===true\n    ))){\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"volume_mute\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\",\n            \"is_volume_muted\": true\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":2700,"wires":[["4be760da.d877"]]},{"id":"99b28482.d3f3d8","type":"function","z":"554bb518.994efc","name":"Tocar ringtone no acpartner","func":"\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"xiaomi_aqara\",\n        \"service\": \"play_ringtone\",\n        \"data\":{\n            \"gw_mac\": \"44237c81c932\",\n            \"ringtone_id\": 11,\n            \"ringtone_vol\": 100\n\n        }\n    }};\n    return newMsg;\n    \n/*\nAlarms\n    0 - Police car 1\n    1 - Police car 2\n    2 - Accident\n    3 - Countdown\n    4 - Ghost\n    5 - Sniper rifle\n    6 - Battle\n    7 - Air raid\n    8 - Bark\nDoorbells\n    10 - Doorbell\n    11 - Knock at a door\n    12 - Amuse\n    13 - Alarm clock\nAlarm clock\n    20 - MiMix\n    21 - Enthusiastic\n    22 - GuitarClassic\n    23 - IceWorldPiano\n    24 - LeisureTime\n    25 - ChildHood\n    26 - MorningStreamLiet\n    27 - MusicBox\n    28 - Orange\n    29 - Thinker\n*/","outputs":1,"noerr":0,"initialize":"","finalize":"","x":400,"y":700,"wires":[["293815f6.1c67ea"]]},{"id":"7eac7957.0a0eb8","type":"debug","z":"d3db5d74.fb8fa","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":430,"y":1560,"wires":[]},{"id":"9542dcaf.e3052","type":"function","z":"d3db5d74.fb8fa","name":"Movimento Corredor","func":"if(msg.payload.entity_id === \"binary_sensor.movimento_corredor\"){\n    var newMsg;\n    newMsg = {payload:{entity_id:\"sensor.sensor_de_luz_corredor\"}};\n    return newMsg;\n}\n//sensor_motion.aq2","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":1100,"wires":[["b19f1845.20a6e8","4f18b6c5.078a28"]]},{"id":"eb38b384.65fda","type":"function","z":"d3db5d74.fb8fa","name":"Turn On","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nvar banheiroOcupado = global.get(\"BanheiroOcupado\");\nvar newMsg;\nif(Hour > 18 ||Hour < 7 || msg.payload < 5){\n    if(Hour < 18 && Hour > 6){ \n        if(banheiroOcupado === false){\n            \n            newMsg= {payload : {\n                \"domain\": \"light\",\n                \"service\": \"turn_on\",\n                data:{\n                    \"entity_id\": \"light.aqara_hub\",\n                    \"brightness\": 6,\n                    \"rgb_color\": [0,10,0]\n                }\n            }};\n        \n            return newMsg;\n        }\n        \n        if(banheiroOcupado === true){\n            \n            newMsg= {payload : {\n                \"domain\": \"light\",\n                \"service\": \"turn_on\",\n                data:{\n                    \"entity_id\": \"light.aqara_hub\",\n                    \"brightness\": 6,\n                    \"rgb_color\": [10,0,0]\n                }\n            }};\n        \n            return newMsg;\n        }\n    }\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \"entity_id\": \"light.aqara_hub\",\n            \"brightness\": 30,\n            \"rgb_color\": [255,255,255]\n        }\n    }};\n    \n    return newMsg;\n} ","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":1100,"wires":[["5e4ab241.037a1c"]]},{"id":"d56aaec0.5c80a","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delayv","timeout":"5","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":860,"y":1160,"wires":[["9318bc52.48ab4"]]},{"id":"b27ad273.029bd","type":"function","z":"d3db5d74.fb8fa","name":"Turn Off","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour > 18){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"light.aqara_hub\",\n        }\n    }};\n    \n    return newMsg;\n} ","outputs":1,"noerr":0,"x":1200,"y":1160,"wires":[["720b2e2a.c4b74"]]},{"id":"b09d4ce2.2903e","type":"debug","z":"d3db5d74.fb8fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":470,"y":1260,"wires":[]},{"id":"935d70a4.0388a","type":"debug","z":"d3db5d74.fb8fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":470,"y":120,"wires":[]},{"id":"7fd58a3e.124184","type":"function","z":"4c9c764d.9c4468","name":"Liga a TV","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"media_player\",\n    \"service\": \"turn_on\",\n    \"data\":{\n        \"entity_id\": \"media_player.tv_da_sala\"\n    }\n}};\n    \nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":1020,"wires":[["f241c1a3.11968"]]},{"id":"4892980c.666928","type":"function","z":"5767c936.cabd18","name":"Turned off, reset cont","func":"var date = new Date();\nvar Hour = date.getHours();\nif(Hour >= 19 && Hour < 23){\n    if(msg.payload.state.on === false){\n        msg.reset = 1;\n        return msg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":615,"y":1384,"wires":[["95d42658.d910a8"]]},{"id":"3e558710.fd6088","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":3620,"y":1260,"wires":[["feda9f09.b20c3"]]},{"id":"e4c39e8a.03b69","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":3620,"y":1320,"wires":[["9e6274be.3bb758"]]},{"id":"bd6de044.fc78b","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":3620,"y":1380,"wires":[["7bf2c203.2a37ec"]]},{"id":"dd5709cd.1ef668","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":3620,"y":1440,"wires":[["8644d282.30e27"]]},{"id":"cdf584bf.fd3ef8","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":3620,"y":1500,"wires":[["52335afb.7478b4","f28a3cbf.bb903","d435f6dd.c9b3b8"]]},{"id":"ff6e3dc5.4bb3d","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":3620,"y":1600,"wires":[["d03e26a5.493c88"]]},{"id":"f28a3cbf.bb903","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3920,"y":1560,"wires":[["487163d2.483a7c"]]},{"id":"d435f6dd.c9b3b8","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":4040,"y":1460,"wires":[["4f475e29.5a0a5"]]},{"id":"16143090.71451f","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":3620,"y":1660,"wires":[["85e24233.c7501"]]},{"id":"35d81f25.70efe","type":"switch","z":"2bbba447.a4759c","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"2","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":2450,"y":480,"wires":[["3665f12e.70f2ee","a2c55b1b.216528"],["1004281c.91e608"]]},{"id":"850c5203.11224","type":"comment","z":"859b066a.dd8128","name":"Botão foi clicado","info":"Ligar as luzes se estiverem desligadas\nDesligar as luzes se estiverem ligadas e acima de 50% de brilho\nAumentar o brilho caso estiverem abaixo de 50%","x":260,"y":1200,"wires":[]},{"id":"2c66b73a.38dde8","type":"inject","z":"d67ca66.293d758","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 23 * * 1,2,3,4,0","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":310,"y":1340,"wires":[["c6b71da4.2c7e9"]]},{"id":"22707317.1314ac","type":"inject","z":"d67ca66.293d758","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 22 * * 1,2,3,4,0","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":310,"y":1220,"wires":[["65c3a007.04cbf"]]},{"id":"5f47a6a3.438368","type":"inject","z":"d67ca66.293d758","name":"","repeat":"","crontab":"30 22 * * 1,2,3,4,0","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":310,"y":1280,"wires":[["728d2cc5.4c4054"]]},{"id":"13e736de.8dd489","type":"inject","z":"d67ca66.293d758","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"30 23 * * 1,2,3,4,0","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":310,"y":1400,"wires":[["bccea612.2ccc08"]]},{"id":"65c3a007.04cbf","type":"function","z":"d67ca66.293d758","name":"Volume 20","func":"if(global.get(\"horaDoFilme\") === false &&\n    global.get(\"tvAuxFilme\") === false &&\n    global.get(\"tvAuxPlay\") === false\n){\n    var newMsg;\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_VOL20\"\n        }\n    }\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":470,"y":1220,"wires":[["7511e273.ed96cc"]]},{"id":"728d2cc5.4c4054","type":"function","z":"d67ca66.293d758","name":"Volume 18","func":"if(global.get(\"horaDoFilme\") === false &&\n    global.get(\"tvAuxFilme\") === false &&\n    global.get(\"tvAuxPlay\") === false\n){\n    var newMsg;\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_VOL18\"\n        }\n    }\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":470,"y":1280,"wires":[["7511e273.ed96cc"]]},{"id":"c6b71da4.2c7e9","type":"function","z":"d67ca66.293d758","name":"Volume 16","func":"if(global.get(\"horaDoFilme\") === false &&\n    global.get(\"tvAuxFilme\") === false &&\n    global.get(\"tvAuxPlay\") === false\n){\n    var newMsg;\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_VOL16\"\n        }\n    }\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":470,"y":1340,"wires":[["7511e273.ed96cc"]]},{"id":"bccea612.2ccc08","type":"function","z":"d67ca66.293d758","name":"Volume 14","func":"if(global.get(\"horaDoFilme\") === false){\n    var newMsg;\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_VOL14\"\n        }\n    }\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":470,"y":1400,"wires":[["7511e273.ed96cc"]]},{"id":"56cf118.6c95df","type":"change","z":"4c9c764d.9c4468","name":"Turn Off","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"On\": false} ","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":940,"y":1320,"wires":[["d6f65d1a.11585"]]},{"id":"d6f65d1a.11585","type":"link out","z":"4c9c764d.9c4468","name":"AbajurOnOff","links":["817677be.bad9f8"],"x":1031,"y":1320,"wires":[]},{"id":"b0a4829f.24c6b","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":680,"wires":[["99b28482.d3f3d8"]]},{"id":"80088c33.a8a6e","type":"function","z":"554bb518.994efc","name":"Yeelight modes","func":"\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"xiaomi_aqara\",\n        \"service\": \"play_ringtone\",\n        \"data\":{\n            \"gw_mac\": \"44237c81c932\",\n            \"ringtone_id\": 10,\n            \"ringtone_vol\": 30\n\n        }\n    }};\n    return newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":360,"y":820,"wires":[["f21d5385.706d6"]]},{"id":"7fafbe1b.f5017","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":800,"wires":[["80088c33.a8a6e"]]},{"id":"37b09774.ccc7b8","type":"debug","z":"5767c936.cabd18","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1770,"y":380,"wires":[]},{"id":"716a6073.796fd","type":"debug","z":"5767c936.cabd18","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3170,"y":180,"wires":[]},{"id":"187514be.470c7b","type":"change","z":"5767c936.cabd18","name":"","rules":[{"t":"delete","p":"reset","pt":"msg"},{"t":"delete","p":"came","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":300,"wires":[["53ffdf0c.5803c"]]},{"id":"2a719e87.b34be2","type":"function","z":"5767c936.cabd18","name":"Reset","func":"if(msg.reset === 1){  \n    return {payload: true};\n}","outputs":1,"noerr":0,"x":3205,"y":384,"wires":[["30379d06.5c9d22"]]},{"id":"2c10f23c.fcb11e","type":"function","z":"e7cd1901.ee2408","name":"was triggered?","func":"if(flow.get(\"triggered1\")===true){\n    flow.set(\"triggered1\", false);\n    var newMsg;\n    if(msg.payload.state.on === true){\n        newMsg = {payload:{state:{bri:msg.payload.state.bri,\n                                  ct: msg.payload.state.ct\n                                  }\n                            },\n                            came: \"Yeelight\"\n        };\n        return newMsg;\n    }\n    if(msg.payload.state.on === false){\n        newMsg = {payload:{resetar: true}};\n        return newMsg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1740,"y":260,"wires":[["2d2b471d.051b18"]]},{"id":"2a05ae59.9f7e02","type":"switch","z":"e7cd1901.ee2408","name":"","property":"payload.resetar","propertyType":"msg","rules":[{"t":"istype","v":"undefined","vt":"undefined"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":2250,"y":260,"wires":[["94317e5a.295e5"],["5a48819f.5863b"]]},{"id":"a375134b.1d234","type":"function","z":"e7cd1901.ee2408","name":"Reset","func":"if(msg.reset === 1){  \n    return {payload: true};\n}","outputs":1,"noerr":0,"x":3130,"y":320,"wires":[["7a51d5af.d3467c"]]},{"id":"dd5a2759.0b99d8","type":"debug","z":"d3db5d74.fb8fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":490,"y":1320,"wires":[]},{"id":"18d78045.d4bfc","type":"function","z":"444fced8.33ecb","name":"Liga a Fire TV","func":"if(\n        msg.payload.description.summary.includes('liga a t. v. do quarto')===true ||\n        msg.payload.description.summary.includes('liga t. v. do quarto')===true||\n        msg.payload.description.summary.includes('ligue a t. v. do quarto')===true||\n        msg.payload.description.summary.includes('ligue t. v. do quarto')===true||       \n        (msg.payload.name===\"Echo Dot do Quarto Nédi\" && ((\n       (msg.payload.description.summary.includes('liga')===true) ||\n       (msg.payload.description.summary.includes('ligar')===true) ||\n       (msg.payload.description.summary.includes('ligue')===true) ) &&\n       msg.payload.description.summary.includes('t.')===true &&\n       msg.payload.description.summary.includes('v.')===true))\n    ){\n        var newMsg;\n        newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"light.luz_do_quarto_nedi\"\n            }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":2980,"wires":[["42be937b.e17c5c","650e012d.d0af3","a01e83c8.dd1b","c16309d1.f94448"]]},{"id":"817f8363.e868e","type":"function","z":"444fced8.33ecb","name":"Turn off Fire TV","func":"if(\n        msg.payload.description.summary.includes('desliga a t. v. do quarto')===true ||\n        msg.payload.description.summary.includes('desliga t. v. do quarto')===true||\n        msg.payload.description.summary.includes('desligar a t. v. do quarto')===true ||\n        msg.payload.description.summary.includes('desligar t. v. do quarto')===true||\n        msg.payload.description.summary.includes('desligue a t. v. do quarto')===true||\n        msg.payload.description.summary.includes('desligue t. v. do quarto')===true||\n       (msg.payload.name===\"Echo Dot do Quarto Nédi\" && ((\n       (msg.payload.description.summary.includes('desliga')===true) ||\n       (msg.payload.description.summary.includes('desligar')===true) ||\n       (msg.payload.description.summary.includes('desligue')===true) ) &&\n       msg.payload.description.summary.includes('t.')===true &&\n       msg.payload.description.summary.includes('v.')===true\n    ))){\n    var newMsg;\n    newMsg= {payload : \n                {\n                    \"domain\": \"media_player\",\n                    \"service\": \"turn_off\",\n                    \"data\":{\n                        \"entity_id\": \"media_player.fire_tv\"\n                    }\n                }\n            };\n    node.send(newMsg);\n    \n    newMsg= {payload : \n                {\n                    \"domain\": \"media_player\",\n                    \"service\": \"turn_off\",\n                    \"data\":{\n                        \"entity_id\": \"media_player.fire_tv_2\"\n                    }\n                }\n            };\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":3320,"wires":[["13cd65e3.056f3a","68868c0e.937504","e477db0a.b41ee8"]]},{"id":"72eb2504.4f5bfc","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload : \n            {\n                \"domain\": \"media_player\",\n                \"service\": \"volume_set\",\n                \"data\":{\n                    \"entity_id\": \"media_player.fire_tv\",\n                    \"volume_level\": 0.6\n                }\n            }\n        };\nnode.send(newMsg);\n\nnewMsg= {payload : \n            {\n                \"domain\": \"media_player\",\n                \"service\": \"volume_set\",\n                \"data\":{\n                    \"entity_id\": \"media_player.fire_tv_2\",\n                    \"volume_level\": 0.6\n                }\n            }\n        };\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":910,"y":3060,"wires":[["7275fc50.c70e94"]]},{"id":"c49663a7.22026","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload : \n            {\n                \"domain\": \"media_player\",\n                \"service\": \"select_source\",\n                \"data\":{\n                    \"entity_id\": \"media_player.fire_tv\",\n                    \"source\": 'com.netflix.ninja'\n                }\n            }\n        };\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":910,"y":3120,"wires":[["7275fc50.c70e94"]]},{"id":"999a7cb8.da7e9","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload : \n            {\n                \"domain\": \"media_player\",\n                \"service\": \"media_pause\",\n                \"data\":{\n                    \"entity_id\": \"media_player.fire_tv\"\n                }\n            }\n        };\nnode.send(newMsg);\n\nnewMsg= {payload : \n            {\n                \"domain\": \"media_player\",\n                \"service\": \"media_pause\",\n                \"data\":{\n                    \"entity_id\": \"media_player.fire_tv_2\"\n                }\n            }\n        };\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":720,"y":3380,"wires":[["13cd65e3.056f3a"]]},{"id":"6640a3fe.73843c","type":"function","z":"444fced8.33ecb","name":"Já volto / pausa","func":"if(\n    (msg.payload.name===\"Echo Dot do Quarto Nédi\" && \n        (msg.payload.description.summary.includes('já volto')===true || \n        msg.payload.description.summary.includes('pausa')===true || \n        msg.payload.description.summary.includes('pausar')===true\n        ))\n    ){\n        var newMsg;\n        newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            \"data\":{\n                \"entity_id\": \"light.luz_do_quarto_nedi\",\n                \"brightness\":50\n            }\n            }}; \n    node.send(newMsg); \n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":3380,"wires":[["999a7cb8.da7e9","c882366e.e8ab78","68868c0e.937504"]]},{"id":"3ce0001a.577de","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"8","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":260,"y":440,"wires":[["9b49a101.0f52c"]]},{"id":"dff2994.6096e68","type":"comment","z":"5767c936.cabd18","name":"Liga o escritório aos poucos","info":"","x":240,"y":180,"wires":[]},{"id":"1662b04f.e49fe","type":"comment","z":"e7cd1901.ee2408","name":"Liga a sala aos poucos","info":"","x":200,"y":120,"wires":[]},{"id":"ee178deb.261c6","type":"inject","z":"e7cd1901.ee2408","name":"Reset","props":[{"p":"payload"},{"p":"topic","vt":"str"},{"p":"reset","v":"true","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"reset","payload":"","payloadType":"str","x":390,"y":240,"wires":[["b2a76711.ae4398"]]},{"id":"377bc19e.e584ae","type":"inject","z":"5767c936.cabd18","name":"Reset","props":[{"p":"payload"},{"p":"topic","vt":"str"},{"p":"reset","v":"true","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"reset","payloadType":"str","x":530,"y":320,"wires":[["ba6a4e16.62ac7"]]},{"id":"9c98b28c.4c8bd","type":"function","z":"4c9c764d.9c4468","name":"Trigger","func":"flow.set(\"triggered\", true);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":939,"y":1500,"wires":[["25b6724e.fcf97e"]]},{"id":"b52cd23d.eabd2","type":"function","z":"4c9c764d.9c4468","name":"Was Triggered?","func":"if(flow.set(\"triggered\")===true){\n    flow.set(\"triggered\", false);\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1329,"y":1500,"wires":[["d3645fef.a44f5"]]},{"id":"57ed58fd.5a6c18","type":"function","z":"444fced8.33ecb","name":"Mute TV","func":"var newMsg;\nif(     (msg.payload.name===\"Echo Dot do Quarto Nédi\" && (\n        msg.payload.description.summary.includes('silêncio')===true||\n        msg.payload.description.summary.includes('silencio')===true||\n        msg.payload.description.summary.includes('silencia')===true||\n        msg.payload.description.summary.includes('silenciar')===true||\n        msg.payload.description.summary.includes('mudo')===true||\n        msg.payload.description.summary.includes('vaca amarela')===true\n    ))){\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"volume_mute\",\n        \"data\":{\n            \"entity_id\": \"media_player.fire_tv\",\n            \"is_volume_muted\": false\n        }\n    }};\n    node.send(newMsg);\n    \n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"volume_mute\",\n        \"data\":{\n            \"entity_id\": \"media_player.fire_tv_2\",\n            \"is_volume_muted\": false\n        }\n    }};\n    \n    return newMsg;\n}\n\nif(     (msg.payload.name===\"Echo Dot do Quarto\" && ( \n        msg.payload.description.summary.includes('volta ao normal')===true||\n        msg.payload.description.summary.includes('normal')===true\n    ))){\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"volume_mute\",\n        \"data\":{\n            \"entity_id\": \"media_player.fire_tv\",\n            \"is_volume_muted\": true\n        }\n    }};\n    node.send(newMsg);\n    \n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"volume_mute\",\n        \"data\":{\n            \"entity_id\": \"media_player.fire_tv_2\",\n            \"is_volume_muted\": true\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":3280,"wires":[["13cd65e3.056f3a","68868c0e.937504"]]},{"id":"a01e83c8.dd1b","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":720,"y":3100,"wires":[["72eb2504.4f5bfc","c49663a7.22026"]]},{"id":"470c17ea.7843e8","type":"function","z":"444fced8.33ecb","name":"Claro","func":"if(     (msg.payload.name===\"Echo Dot da Sala\" && ((\n        msg.payload.description.summary.includes('bota')===true ||\n        msg.payload.description.summary.includes('botar')===true ||\n        msg.payload.description.summary.includes('bote')===true) &&\n        msg.payload.description.summary.includes('claro')===true\n    ))){\n    var newMsg;\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_TV\"\n        }\n    }\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":490,"y":2740,"wires":[["4be760da.d877"]]},{"id":"4842b291.bdecdc","type":"function","z":"444fced8.33ecb","name":"Lampada Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"switch.lampada\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":1242,"y":740,"wires":[["cf707e94.e0dd8"]]},{"id":"7f30c5cb.ec303c","type":"change","z":"e7cd1901.ee2408","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":3550,"y":320,"wires":[["5b0dc24f.60623c"]]},{"id":"7a51d5af.d3467c","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"10","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":3330,"y":320,"wires":[["7f30c5cb.ec303c"]]},{"id":"2bf5265d.fc73fa","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"delayv","timeout":"10","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2900,"y":560,"wires":[["a1e68de0.e2c7"]]},{"id":"a1e68de0.e2c7","type":"function","z":"2bbba447.a4759c","name":"Turn Off","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour > 18){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"light.aqara_hub\",\n        }\n    }};\n    \n    return newMsg;\n} ","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3100,"y":560,"wires":[["5420eb2f.585104"]]},{"id":"92f82708.2d3838","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1030,"y":4540,"wires":[]},{"id":"a97fd117.493ab","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg = {};\nglobal.set(\"HA-ShoppingList-old\", msg.payload);\nvar shoppingListHA = msg.payload;\nvar shoppingListAlexa = global.get(\"Alexa-ShoppingList-aux\");\nvar adicionarFlag = 0;\nfor(var i = 0; i < shoppingListAlexa.length; i++){\n    if(shoppingListAlexa[i].completed === false){\n        for(var j = 0; j < shoppingListHA.length; j++){\n            if(shoppingListHA[j].name.toLowerCase() === shoppingListAlexa[i].value.toLowerCase()){\n                adicionarFlag = 1\n            }\n        }\n        if(adicionarFlag === 0){\n                newMsg = {payload : \n                    {\n                    \"domain\": \"shopping_list\",\n                    \"service\": \"add_item\",\n                    \"data\":{\n                        \"name\": shoppingListAlexa[i].value.charAt(0).toUpperCase() + shoppingListAlexa[i].value.slice(1)\n                        }\n                    }\n                }\n                node.send(newMsg);\n        }\n        adicionarFlag = 0;\n    }\n    else{\n        \n        for(var j = 0; j < shoppingListHA.length; j++){\n            if(shoppingListHA[j].name.toLowerCase() === shoppingListAlexa[i].value.toLowerCase()){\n                if(shoppingListHA[j].complete === false){\n                    newMsg = {payload : \n                        {\n                        \"domain\": \"shopping_list\",\n                        \"service\": \"complete_item\",\n                        \"data\":{\n                            \"name\": shoppingListHA[j].name\n                            }\n                        }\n                    }\n                    node.send(newMsg);\n                }\n            }\n        }\n    }\n}\n","outputs":1,"noerr":0,"x":1210,"y":4340,"wires":[["431cbd93.d5b3f4"]]},{"id":"7d63ea8e.4a9ef4","type":"function","z":"444fced8.33ecb","name":"Apple TV On","func":"if(msg.payload.description.summary.includes('apple')===true &&\n   msg.payload.description.summary.includes(\"sai da apple\") === false    \n    ){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"media_player.apple_tv\"\n        }\n    }};\n    node.send(newMsg);\n    \n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_HDMI2\"\n        }\n    }\n    node.send(newMsg);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":510,"y":1720,"wires":[["eb95127f.26f2d","8f85d735.b5c078"]]},{"id":"b33f043a.003cf8","type":"comment","z":"444fced8.33ecb","name":"Sincronizar a Lista Alexa com HA","info":"","x":350,"y":4300,"wires":[]},{"id":"72ca570b.9ae3d8","type":"debug","z":"d67ca66.293d758","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":420,"y":820,"wires":[]},{"id":"47d2250d.065b8c","type":"debug","z":"d67ca66.293d758","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":440,"y":920,"wires":[]},{"id":"42a9f340.1fc55c","type":"function","z":"444fced8.33ecb","name":"","func":"global.set(\"HA-ShoppingList-aux\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":1030,"y":4460,"wires":[["f490c4f5.2b7b38"]]},{"id":"b92c0f3f.12e8c","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"*/30 7-22 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":230,"y":4340,"wires":[["b0feba76.29ab18"]]},{"id":"62fba09.68b566","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":890,"y":4540,"wires":[["92f82708.2d3838"]]},{"id":"415161f9.53369","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":890,"y":4460,"wires":[["42a9f340.1fc55c"]]},{"id":"3929b2fd.756b8e","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":430,"y":4500,"wires":[["d5c139e2.85a738"]]},{"id":"a3321db6.f2b2e","type":"function","z":"444fced8.33ecb","name":"","func":"var shoppingListHA = global.get(\"HA-ShoppingList-aux\");\nvar shoppingListAlexa = msg.payload;\nvar newMsg;\nvar noNewItem = true;\nvar newItemPosition = [];\nvar i;\nfor(i = 0; i< shoppingListHA.length; i++){\n    for(var j = 0; j <shoppingListAlexa.length; j++){\n            if(\n                    shoppingListHA[i].name.toLowerCase() === shoppingListAlexa[j].value.toLowerCase()\n                ){\n                    \n                if(\n                    shoppingListHA[i].complete === true && \n                    shoppingListAlexa[j].completed === false\n                    ){\n                        newMsg = {payload:{\n                                  id: shoppingListAlexa[j].id,\n                                  item: shoppingListAlexa[j].value,\n                                  list: \"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0=\"\n                                },\n                                  id: shoppingListAlexa[j].id,\n                                  item: shoppingListAlexa[j].value,\n                                  list: \"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0=\",\n                                ajuda: true\n                        };\n                        node.send(newMsg);\n                    }\n                noNewItem = false;\n            }\n        }\n        if(noNewItem === true && shoppingListHA[i].complete === false){\n            newItemPosition.push(i);\n        }\n        noNewItem = true;\n}\nif(newItemPosition.length > 0){\n    for(i=0; i< newItemPosition.length; i++){\n        if(shoppingListHA[newItemPosition[i]].complete === false){\n            newMsg = {payload:{item: shoppingListHA[newItemPosition[i]].name, \n                      list: \"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0=\",\n                      ajuda: false}};\n            node.send(newMsg);\n        }\n    }\n}","outputs":1,"noerr":0,"x":1390,"y":4460,"wires":[["c5fd3cbd.356fb"]]},{"id":"87de823c.02e22","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":470,"y":4560,"wires":[]},{"id":"d5c139e2.85a738","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg = {payload: true};\nreturn newMsg;","outputs":1,"noerr":0,"x":590,"y":4500,"wires":[["4f152b26.364244"]]},{"id":"e6a01969.9876f8","type":"function","z":"444fced8.33ecb","name":"Desliga o escritório","func":"if(\n    ((msg.payload.description.summary.includes('desliga')===true ||\n    msg.payload.description.summary.includes('desligar')===true || \n    msg.payload.description.summary.includes('desligue')===true) &&\n    msg.payload.description.summary.includes('luz')===false &&\n    msg.payload.description.summary.includes('luzes')===false &&\n    (msg.payload.description.summary.includes('escritório')===true|| \n    msg.payload.description.summary.includes('escritorio')===true)) ||\n    \n    (msg.payload.description.summary.includes('desliga')===true || \n    msg.payload.description.summary.includes('desligue')===true  )&& \n    ((msg.payload.description.summary.includes('p.')===true && \n        msg.payload.description.summary.includes('c.')===true)  ||\n        msg.payload.description.summary.includes('p.c.')===true||\n        msg.payload.description.summary.includes('PC')===true\n    )\n        \n    ){\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n\n        \"topic\": \"iotlink/workgroup/soft-pc/commands/shutdown\",\n        \"payload\": \"\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":280,"wires":[["330dd2a9.829e9e"]]},{"id":"bf90c51a.246768","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2110,"y":4400,"wires":[]},{"id":"4c92db9c.4ac3b4","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":550,"y":4400,"wires":[]},{"id":"2b507ce1.829ea4","type":"function","z":"554bb518.994efc","name":"","func":"global.set(\"HA-ShoppingList-old\", msg.payload);\nvar newMsg;\nnewMsg = {payload: true};\nreturn newMsg;","outputs":1,"noerr":0,"x":1580,"y":340,"wires":[[]]},{"id":"a1c0ec4a.6ba0e","type":"function","z":"444fced8.33ecb","name":"","func":"global.set(\"Alexa-ShoppingList-aux\", msg.payload);\nvar newMsg;\nnewMsg = {payload: true};\nreturn newMsg;","outputs":1,"noerr":0,"x":560,"y":4340,"wires":[["1e721130.88e9ff","b64bd9f1.625ab8"]]},{"id":"431cbd93.d5b3f4","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1390,"y":4340,"wires":[["4473ffa5.c6242","a84377ff.317638"]]},{"id":"cabd4650.f81098","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1030,"y":4340,"wires":[["a97fd117.493ab"]]},{"id":"1e721130.88e9ff","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":710,"y":4340,"wires":[["43cb6e36.b3727"]]},{"id":"d9f3301a.9e26d","type":"switch","z":"444fced8.33ecb","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"false"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":1730,"y":4460,"wires":[["9a05cb5e.a141b8"],["c2925e7d.d0847"]]},{"id":"4273f70c.a2f798","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2110,"y":4540,"wires":[]},{"id":"c5fd3cbd.356fb","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1550,"y":4460,"wires":[["d9f3301a.9e26d","92d2bc2b.25961"]]},{"id":"92d2bc2b.25961","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1690,"y":4400,"wires":[]},{"id":"a84377ff.317638","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1570,"y":4280,"wires":[]},{"id":"9548fd60.1d0ed","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1350,"y":4400,"wires":[]},{"id":"fad19841.0c97e8","type":"function","z":"444fced8.33ecb","name":"","func":"var shoppingListHA = global.get(\"HA-ShoppingList-aux\");\nvar shoppingListAlexa = msg.payload;\nvar newMsg;\nvar noNewItem = true;\nvar newItemPosition = [];\nvar i;\n    for(var j = 0; j <shoppingListAlexa.length; j++){\n        if(shoppingListAlexa[j].completed === true){\n                        newMsg = {payload:{\n                                  id: shoppingListAlexa[j].id,\n                                  item: shoppingListAlexa[j].value,\n                                  list: \"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0=\"\n                                },\n                                  id: shoppingListAlexa[j].id,\n                                  item: shoppingListAlexa[j].value,\n                                  list: \"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0=\",\n                                ajuda: true\n                        };\n                        node.send(newMsg);\n        }\n    }","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1730,"y":4540,"wires":[["c2925e7d.d0847"]]},{"id":"d9cb0ed8.27163","type":"inject","z":"444fced8.33ecb","name":"","repeat":"432000","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1350,"y":4540,"wires":[["4f1abce4.d33704"]]},{"id":"2a6e2a13.beec36","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1710,"y":4600,"wires":[]},{"id":"8ec1a11b.56e75","type":"function","z":"e7cd1901.ee2408","name":"TV da Sala Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2300,"y":620,"wires":[["c18acf0.2ec693"]]},{"id":"79c5edf6.bf7ca4","type":"function","z":"e7cd1901.ee2408","name":"Luz da Sala Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":2300,"y":780,"wires":[["1dc6a3d6.67629c"]]},{"id":"6683f650.ea72b8","type":"function","z":"444fced8.33ecb","name":"Boa noite Sala","func":"if(\n    msg.payload.name===\"Echo Dot da Sala\" &&(\n    msg.payload.description.summary.includes('boa noite')===true || \n    msg.payload.description.summary.includes('vou dormir')===true\n    )){\n    \n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"media_player.apple_tv\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.fita_do_escritorio\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_tv\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.tunel\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.abajur\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n        \"entity_id\": \"switch.sonoff_1000de2b76\"\n        }\n    }};\n    node.send(newMsg);\n    \n}\n","outputs":1,"noerr":0,"x":520,"y":1920,"wires":[["43589260.16b1ec","3b658808.43fb48","a5b917c3.6093d8"]]},{"id":"2df5031e.7be11c","type":"function","z":"444fced8.33ecb","name":"Boa noite Quarto","func":"if(\n    msg.payload.name===\"Echo Dot do Quarto Nédi\" &&(\n    msg.payload.description.summary.includes('boa noite')===true ||\n    msg.payload.description.summary.includes('vou dormir')===true\n    )){\n    \n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"media_player.fire_tv\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_nedi\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.rgb_strip\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.fita_do_quarto\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.flor\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.tomada_tv_quarto\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.lampada\"\n        }\n    }};\n    \n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"switch.umidificador\"\n        }\n    }};\n    node.send(newMsg);\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":1820,"wires":[["fc61f154.cd1ef","5ec01e46.02d1e"]]},{"id":"fc61f154.cd1ef","type":"function","z":"444fced8.33ecb","name":"Vou dormir","func":"var newMsg;\nnewMsg = {payload : {\"On\":true}};\nreturn newMsg;\n","outputs":1,"noerr":0,"x":730,"y":1860,"wires":[["1162d52e.d59a7b"]]},{"id":"1162d52e.d59a7b","type":"link out","z":"444fced8.33ecb","name":"Vou dormir alexa","links":["17b7df66.4128b1"],"x":855,"y":1860,"wires":[]},{"id":"379789b5.f21f06","type":"function","z":"444fced8.33ecb","name":"Faz o café","func":"if(\n    msg.payload.name===\"Echo Dot da Cozinha\" &&(\n    msg.payload.description.summary.includes('café')===true && (\n    msg.payload.description.summary.includes('faça')===true  || \n    msg.payload.description.summary.includes('faz')===true\n\n    ))){\n    global.set(\"alexaCafeAux\", true);\n    var newMsg;\n    newMsg= {payload : {\"On\":true }};\n    node.send(newMsg);\n    \n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":510,"y":2060,"wires":[["c09e3f0a.b5ec8","ba786e95.fb7b7","b962a68d.1befc8"]]},{"id":"4be760da.d877","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"0.5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":730,"y":2560,"wires":[["d893df70.4923f","afa0db4a.7e5e98"]]},{"id":"5ec01e46.02d1e","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"0.5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"0.05","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":750,"y":1800,"wires":[["7bf01927.d253a8"]]},{"id":"43589260.16b1ec","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"0.5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"0.05","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":870,"y":1900,"wires":[["c5a24ffa.21152"]]},{"id":"dcb36bca.8fd928","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= { \"payload\": \"Olá\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_da_sala\" };\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4570,"y":1640,"wires":[["d25a67f2.63dd58"]]},{"id":"a7e46552.72f7e8","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":4420,"y":1640,"wires":[["dcb36bca.8fd928"]]},{"id":"5f6ea653.0463e8","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= { \"payload\": \"Olá\", \"data\": { \"type\": \"tts\" }, \"target\": \"alexa_media_echo_dot_da_sala\" };\nreturn newMsg;","outputs":1,"noerr":0,"x":340,"y":960,"wires":[["d1bb1156.06898"]]},{"id":"191674f4.ceb1fb","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":960,"wires":[["5f6ea653.0463e8"]]},{"id":"f20ff60c.1bfd68","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= { \"payload\": \"Olá\", \"data\": { \"type\": \"tts\" }, \"target\": \"alexa_media_echo_dot_da_sala\" };\nreturn newMsg;","outputs":1,"noerr":0,"x":340,"y":1020,"wires":[["ed1efe74.9b07a"]]},{"id":"fb5b9fc8.99d46","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":1020,"wires":[["f20ff60c.1bfd68"]]},{"id":"192d5e1.c13aca2","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= {\n\"payload\":\"<amazon:effect name='whispered'>I am whispering this.</amazon:effect>\",\n\"data\":{\"type\":\"announce\", \"method\":\"speak\"},\n\"target\":[\"Guest Room\", \"media_player.kitchen\", \"serialNumber\"]\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":340,"y":1080,"wires":[["aa85408.edca4c"]]},{"id":"ea11dfc2.6ca59","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":1080,"wires":[["192d5e1.c13aca2"]]},{"id":"27bf476b.a8fea8","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"amzn_sfx_doorbell_01\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":4570,"y":840,"wires":[["78c68f27.131b6"]]},{"id":"ffd31f41.561e5","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":4420,"y":840,"wires":[["27bf476b.a8fea8"]]},{"id":"49a50dcf.e7d414","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"amzn_sfx_doorbell_chime_01\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":4570,"y":900,"wires":[["51eef913.b3ab68"]]},{"id":"1604921d.88d14e","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":4420,"y":900,"wires":[["49a50dcf.e7d414"]]},{"id":"5dd54bb1.7d0844","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_do_quarto_nedi\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_do_quarto_nedi\",\n      \"media_content_id\": \"amzn_sfx_doorbell_chime_02\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":4570,"y":960,"wires":[["93bcf598.a6ce38"]]},{"id":"36cf19f2.16b2d6","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":4420,"y":960,"wires":[["5dd54bb1.7d0844"]]},{"id":"a206a24.b328e6","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"christmas_05\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":4570,"y":1020,"wires":[["2d31da8d.2a48b6"]]},{"id":"5262beeb.93d8d","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":4420,"y":1020,"wires":[["a206a24.b328e6"]]},{"id":"f55ea695.3a7ee8","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"horror_10\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4570,"y":1080,"wires":[["edaba96b.e4f778"]]},{"id":"260f467e.ce7c3a","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":4420,"y":1080,"wires":[["f55ea695.3a7ee8"]]},{"id":"42b8df82.a9c75","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"amzn_sfx_large_crowd_cheer_01\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":4570,"y":1140,"wires":[["a44198ee.7be1a8"]]},{"id":"bde4feb6.7db06","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":4420,"y":1140,"wires":[["42b8df82.a9c75"]]},{"id":"184002dd.3781fd","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"zap_01\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":4570,"y":1200,"wires":[["cb832669.f36e88"]]},{"id":"f1250045.db752","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":4420,"y":1200,"wires":[["184002dd.3781fd"]]},{"id":"f130a404.4c9358","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"clock_01\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4570,"y":1260,"wires":[["20b3fd7.da88402"]]},{"id":"1ce01e6.e9f91e2","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":4420,"y":1260,"wires":[["f130a404.4c9358"]]},{"id":"ec5a85bc.5df348","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"amzn_sfx_rooster_crow_01\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":4570,"y":1320,"wires":[["33b1bb87.6b1a74"]]},{"id":"896a7cad.78f03","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":4420,"y":1320,"wires":[["ec5a85bc.5df348"]]},{"id":"1921dabd.839fa5","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"Alexa.Joke.Play\",\n      \"media_content_type\": \"sequence\"\n  }}\n};\nreturn newMsg;\n\n\n/*\noutras sequencias:\n\nAlexa.Weather.Play\nAlexa.Traffic.Play\nAlexa.FlashBriefing.Play\nAlexa.GoodMorning.Play\nAlexa.GoodNight.Play\nAlexa.SingASong.Play\nAlexa.TellStory.Play\nAlexa.FunFact.Play\nAlexa.Joke.Play\nAlexa.Music.PlaySearchPhrase\nAlexa.Calendar.PlayTomorrow\nAlexa.Calendar.PlayToday\nAlexa.Calendar.PlayNext\nAlexa.CleanUp.Play\nAlexa.ImHome.Play\n*/\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4570,"y":1420,"wires":[["ce05e556.9c5808"]]},{"id":"8e67beb2.f96dd","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":4420,"y":1420,"wires":[["1921dabd.839fa5"]]},{"id":"f7524c2e.df148","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"Alexa.Music.PlaySearchPhrase\",\n      \"media_content_type\": \"sequence\"\n  }}\n};\nreturn newMsg;\n\n\n/*\noutras sequencias:\n\nAlexa.Weather.Play\nAlexa.Traffic.Play\nAlexa.FlashBriefing.Play\nAlexa.GoodMorning.Play\nAlexa.GoodNight.Play\nAlexa.SingASong.Play\nAlexa.TellStory.Play\nAlexa.FunFact.Play\nAlexa.Joke.Play\nAlexa.Music.PlaySearchPhrase\nAlexa.Calendar.PlayTomorrow\nAlexa.Calendar.PlayToday\nAlexa.Calendar.PlayNext\nAlexa.CleanUp.Play\nAlexa.ImHome.Play\n*/\n","outputs":1,"noerr":0,"x":4570,"y":1480,"wires":[["6e5eb1f2.c2de4"]]},{"id":"8fcd4c2d.f42d4","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":4420,"y":1480,"wires":[["f7524c2e.df148"]]},{"id":"54d92940.abe508","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_do_quarto\",\n  \"data\":{\n          \"entity_id\": \"media_player.echo_dot_do_quarto\",\n          \"media_content_id\": \"Teste\",\n          \"media_content_type\": \"routine\"\n\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":4570,"y":1560,"wires":[["7b144007.9be49"]]},{"id":"ca0ad5cb.c54c18","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":4420,"y":1560,"wires":[["54d92940.abe508"]]},{"id":"b9e274e1.4b76c8","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":3620,"y":1720,"wires":[["36a693c.704b66c"]]},{"id":"46cb50e6.e789f","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= { \"payload\": \"Olá\", \"data\": { \"type\": \"tts\" }, \"target\": \"alexa_media_echo_dot_da_sala\" };\nreturn newMsg;","outputs":1,"noerr":0,"x":4570,"y":1720,"wires":[["8c3e146d.e06b98"]]},{"id":"5a74d9f.9f31a28","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":4420,"y":1720,"wires":[["46cb50e6.e789f"]]},{"id":"6e07605b.68b1c","type":"switch","z":"2bbba447.a4759c","name":"","property":"isDay","propertyType":"msg","rules":[{"t":"false"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":550,"y":360,"wires":[["2f8ed67d.22b95a","fe5dc8bd.a35d18"],["89da767e.34ade8"]]},{"id":"e3f28710.c14ba8","type":"switch","z":"2bbba447.a4759c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1550,"y":320,"wires":[["250ab27.747084e"],["b4038cea.b3677"]]},{"id":"f614d0f7.ccce2","type":"comment","z":"2bbba447.a4759c","name":"Se for de dia, só checa o aux","info":"","x":780,"y":500,"wires":[]},{"id":"87902325.656bf","type":"function","z":"444fced8.33ecb","name":"Almoço","func":"if(msg.payload.description.summary.includes('almoço')===true ||\n    msg.payload.description.summary.includes('hora do almoço')===true\n   ){\n    var newMsg;\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_on\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n        }\n    }\n    node.send(newMsg);\n\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_TV\"\n        }\n    }\n    node.send(newMsg);\n\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\",\n            \"media_content_id\": 12,\n            \"media_content_type\": \"channel\"\n        }\n    }};\n    node.send(newMsg);\n\n    newMsg= {payload : {\n    \"domain\": \"media_player\",\n    \"service\": \"play_media\",\n    \"data\":{\n      \"entity_id\": \"media_player.tv_da_sala\",\n      \"media_content_type\": \"send_key\",\n      \"media_content_id\": \"ST_VOL16\"\n    }   \n    }};\n    node.send(newMsg);\n    \n    \n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":2780,"wires":[["4be760da.d877","7732cc0d.f4dba4"]]},{"id":"7732cc0d.f4dba4","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"0.5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"20","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":700,"y":2760,"wires":[["2b383006.609fc"]]},{"id":"ba786e95.fb7b7","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_cozinha\",\n  \"data\":{\n          \"entity_id\": \"media_player.echo_dot_da_cozinha\",\n          \"media_content_id\": \"Faz o café\",\n          \"media_content_type\": \"routine\"\n\n  }}\n};\nreturn newMsg;\n","outputs":1,"noerr":0,"x":760,"y":2120,"wires":[["2f8673c6.69e92c"]]},{"id":"85ac76bc.c20008","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"switch.flor\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":2940,"y":1180,"wires":[["f409bec3.fbc9"]]},{"id":"48eda273.47b84c","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"switch.flor\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":840,"y":2560,"wires":[["dfd9d82.6a62528"]]},{"id":"64fce5b5.d5d89c","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"delay","timeout":"9","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":580,"y":1740,"wires":[["87ddd14.3c9613"]]},{"id":"b9fb4f5d.09759","type":"function","z":"d67ca66.293d758","name":"Turn off","func":"var newMsg;\n    newMsg = {payload:{\n            \n          \"domain\": \"switch\",\n          \"service\": \"turn_off\",\n          \"data\":{\n          \"entity_id\": \"switch.cafeteira\",\n        }\n    }\n}\n    return newMsg;","outputs":1,"noerr":0,"x":980,"y":1620,"wires":[["73661948.9a4f58"]]},{"id":"64e3e55d.98c86c","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":490,"y":40,"wires":[]},{"id":"32a79da4.741ed2","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"media_player\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"media_player.fire_tv\"\n    }\n}};\nnode.send(newMsg);\n\nnewMsg= {payload : {\n    \"domain\": \"media_player\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"media_player.fire_tv_2\"\n    }\n}};\nnode.send(newMsg);\n","outputs":1,"noerr":0,"x":840,"y":2500,"wires":[["67687946.7e8118"]]},{"id":"52b1861d.d051a8","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"switch.tomada_tv_quarto\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":840,"y":2440,"wires":[["3b4850dd.d3f53"]]},{"id":"bd0e87aa.31bc78","type":"function","z":"859b066a.dd8128","name":"Vou dormir?","func":"var newMsg;\nnewMsg = {payload: {}};\nif(msg.payload === true){\n    newMsg.payload = {\"On\": true};\n}\nif(msg.payload === false){\n    newMsg.payload = {\"On\": false};\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":480,"y":2720,"wires":[["a32a9915.70db78"]]},{"id":"87ddd14.3c9613","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"10","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":740,"y":1740,"wires":[["b9fb4f5d.09759","7837a8bf.76d0c8","1464f5f6.04b21a","cdde1573.915d88","3f801c92.47f5f4","a7423af1.5b9b38"]]},{"id":"aff57b37.026a28","type":"function","z":"d67ca66.293d758","name":"if true","func":"var alexaCafeAux = global.get(\"alexaCafeAux\");\nif(msg.payload === true){\n    if(alexaCafeAux === false){\n        return msg;\n    }\n    else{\n        global.set(\"alexaCafeAux\", false);\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":430,"y":1740,"wires":[["64fce5b5.d5d89c","b235294.859eed8"]]},{"id":"aa3e8e1b.c2b91","type":"function","z":"444fced8.33ecb","name":"Adicionar à lista do HA","func":"if(\n        msg.payload.description.summary.includes('adiciona')===true || \n        msg.payload.description.summary.includes('lista')===true || \n        msg.payload.description.summary.includes('coloca')===true|| \n        msg.payload.description.summary.includes('colocar')===true|| \n        msg.payload.description.summary.includes('adicionar')===true|| \n        msg.payload.description.summary.includes('poe')===true|| \n        msg.payload.description.summary.includes('põe')===true|| \n        msg.payload.description.summary.includes('põem')===true|| \n        msg.payload.description.summary.includes('poem')===true|| \n        msg.payload.description.summary.includes('bota')===true\n            \n        ){\n    if(typeof msg.payload.domainAttributes !== \"undefined\" && msg.payload.domainAttributes !== null){\n        if(typeof msg.payload.domainAttributes.value !== \"undefined\"){\n                var newMsg;\n                newMsg= {payload : {\n                    \"domain\": \"shopping_list\",\n                    \"service\": \"add_item\",\n                    \"data\":{\n                        \"name\": msg.payload.domainAttributes.value\n                        }\n                    }};\n            \n            return newMsg;\n        }\n    }\n}","outputs":1,"noerr":0,"x":540,"y":220,"wires":[["4376ca8e.370404"]]},{"id":"2f7e965e.742a2a","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"30","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1160,"y":220,"wires":[["985fb0da.440f1","58306fca.39078"]]},{"id":"dbcf6b8f.9c7328","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delayv","timeout":"20","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1640,"y":300,"wires":[["1d2874be.53f38b"]]},{"id":"985fb0da.440f1","type":"function","z":"2ea7fd8b.7e0bb2","name":"Delay + 20 min","func":"msg.delay = 1200000;\nreturn msg;","outputs":1,"noerr":0,"x":1460,"y":300,"wires":[["dbcf6b8f.9c7328"]]},{"id":"1d2874be.53f38b","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn Off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_off\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":1800,"y":300,"wires":[["9bd8b440.a18d68"]]},{"id":"58306fca.39078","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1360,"y":220,"wires":[["2c252d54.6a0d92"]]},{"id":"cbf70672.c70458","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":580,"y":420,"wires":[["40d8ecc9.126694"]]},{"id":"a9a23c75.2095f","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":580,"y":480,"wires":[["80760c35.5968d"]]},{"id":"940ee253.3159e","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":580,"y":360,"wires":[["bd53e302.56acc","7cb7d34c.c828fc"]]},{"id":"98cbcd2d.f7cd1","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_off\",\n    data:{\n        \"entity_id\": \"switch.lampada\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":2940,"y":1860,"wires":[["345fa672.00beea"]]},{"id":"afab0c06.ceb72","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"switch.lampada\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":2940,"y":1800,"wires":[["345fa672.00beea"]]},{"id":"e5fea666.eaa338","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    data:{\n        \"entity_id\": \"switch.lampada\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":1340,"y":1960,"wires":[["793d91c6.19af3"]]},{"id":"3ee9b545.16afba","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"45","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1390,"y":2180,"wires":[["74a5998b.6139c8","9a33931e.b2eee"]]},{"id":"2bfcbde2.ab89c2","type":"mqtt out","z":"859b066a.dd8128","name":"setOff RGB Strip","topic":"QuartoNedi/setOnRGB","qos":"","retain":"","broker":"64936db9.640564","x":1770,"y":2240,"wires":[]},{"id":"9a33931e.b2eee","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"msg = {payload:0};\nreturn msg;","outputs":1,"noerr":0,"x":1580,"y":2240,"wires":[["2bfcbde2.ab89c2"]]},{"id":"74a5998b.6139c8","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_off\",\n    data:{\n        \"entity_id\": \"switch.lampada\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":1574.4443359375,"y":2179.9998779296875,"wires":[["817700e0.41833"]]},{"id":"ef1ca901.caf2a8","type":"inject","z":"e7cd1901.ee2408","name":"Inicializar as variaveis flow","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/30 6 * * *","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1640,"y":480,"wires":[["465b8921.dabc98"]]},{"id":"465b8921.dabc98","type":"function","z":"e7cd1901.ee2408","name":"","func":"flow.set(\"countBrightness\", 1);\nflow.set(\"increasing\", true);\nflow.set(\"auxCT\", 6100);\nflow.set(\"triggered1\", false);\nflow.set(\"triggered2\", false);\nflow.set(\"triggered3\", false);\n\nvar date = new Date();\nvar hours = date.getHours(); //hourss in 0-23\nvar minutes = \"0\" + date.getMinutes();\nminutes = parseInt(minutes.substr(-2), 10);\nvar seconds = \"0\" + date.getSeconds();\nseconds = parseInt(seconds.substr(-2), 10);\n\nflow.set(\"lastChangeSec\", seconds);\nflow.set(\"lastChangeMinute\", minutes);\nflow.set(\"lastChangeHour\", hours);\n    ","outputs":1,"noerr":0,"x":1870,"y":500,"wires":[[]]},{"id":"4f03c7e4.62f298","type":"inject","z":"5767c936.cabd18","name":"Inicializar as variaveis flow","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/30 6 * * *","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1035,"y":1004,"wires":[["49f80ffd.acfac"]]},{"id":"49f80ffd.acfac","type":"function","z":"5767c936.cabd18","name":"","func":"flow.set(\"increasing\", true);\nflow.set(\"countBrightnessLuz\", 1);\nflow.set(\"increasing\", true);\nflow.set(\"auxCT\", 6100);\nflow.set(\"triggered1\", false);\nflow.set(\"triggered2\", false);\nflow.set(\"triggered3\", false);\nflow.set(\"triggered4\", false);\nflow.set(\"triggered5\", false);\n    \nvar date = new Date();\nvar hours = date.getHours(); //hourss in 0-23\nvar minutes = \"0\" + date.getMinutes();\nminutes = parseInt(minutes.substr(-2), 10);\nvar seconds = \"0\" + date.getSeconds();\nseconds = parseInt(seconds.substr(-2), 10);\n\nflow.set(\"lastChangeSec\", seconds);\nflow.set(\"lastChangeMinute\", minutes);\nflow.set(\"lastChangeHour\", hours);\n\nglobal.set(\"auxTurnOnEscritorio\", false);\n    ","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1265,"y":1024,"wires":[[]]},{"id":"270b57cf.3bbcb8","type":"function","z":"444fced8.33ecb","name":"Flor Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"switch.flow\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":1232,"y":800,"wires":[["b4fe4713.cf86c8"]]},{"id":"e9965ef4.dc795","type":"function","z":"2ea7fd8b.7e0bb2","name":"Detected?","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":530,"y":460,"wires":[["2f7e965e.742a2a"]]},{"id":"d7e2903f.799be","type":"function","z":"2ea7fd8b.7e0bb2","name":"Detected?","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":530,"y":520,"wires":[["2f7e965e.742a2a"]]},{"id":"62aeee38.66017","type":"function","z":"2ea7fd8b.7e0bb2","name":"Detected?","func":"if(msg.payload === \"on\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":580,"wires":[["664d1a0d.99fbd4","eb10d419.bb3698"]]},{"id":"8854e815.7cc7e8","type":"function","z":"2ea7fd8b.7e0bb2","name":"Detected?","func":"if(msg.payload === \"on\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":760,"wires":[["b0277a70.37f2a8","eb10d419.bb3698"]]},{"id":"aea952f0.7dca8","type":"function","z":"2ea7fd8b.7e0bb2","name":"Detected?","func":"if(msg.payload === \"on\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":820,"wires":[["2f7e965e.742a2a","72213a3.890f9c4"]]},{"id":"9df27abe.b95d08","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1280,"y":740,"wires":[["6ffdbd0.9a4a944","39e201a5.0dd0ae"]]},{"id":"f4c968df.943ee8","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1280,"y":620,"wires":[["23c48ba4.c0be94","ccf25148.857f"]]},{"id":"815320ad.3bfd9","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1280,"y":380,"wires":[["e19e2e86.320b9","aa736933.be4ac8"]]},{"id":"664d1a0d.99fbd4","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn On","func":"var newMsg;\nnewMsg= {payload: {\n      \"domain\": \"input_boolean\",\n      \"service\": \"turn_on\",\n      \"entity_id\": \"input_boolean.sala_ocupada_switch\",\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1120,"y":380,"wires":[["815320ad.3bfd9"]]},{"id":"b0277a70.37f2a8","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn On","func":"var newMsg;\nnewMsg= {payload: {\n      \"domain\": \"input_boolean\",\n      \"service\": \"turn_on\",\n      \"entity_id\": \"input_boolean.cozinha_ocupada_switch\",\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1120,"y":620,"wires":[["f4c968df.943ee8"]]},{"id":"72213a3.890f9c4","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn On","func":"var newMsg;\nnewMsg= {payload: {\n      \"domain\": \"input_boolean\",\n      \"service\": \"turn_on\",\n      \"entity_id\": \"input_boolean.quarto_nedi_ocupado_switch\",\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1120,"y":740,"wires":[["9df27abe.b95d08"]]},{"id":"a2c55b1b.216528","type":"function","z":"2bbba447.a4759c","name":"Turn Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"input_boolean.banheiro_ocupado_switch\",\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":2500,"y":220,"wires":[["f5da50f6.4f0a9"]]},{"id":"d0ddc950.fa7118","type":"function","z":"2bbba447.a4759c","name":"Turn On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        data:{\n            \"entity_id\": \"input_boolean.banheiro_ocupado_switch\",\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2500,"y":160,"wires":[["f5da50f6.4f0a9"]]},{"id":"7332e558.4e464c","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"input_boolean.quarto_ocupado\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":2940,"y":1440,"wires":[["63e6332f.2989ac"]]},{"id":"87921bf9.d6ed98","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"input_boolean.quarto_ocupado\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":2940,"y":1380,"wires":[["63e6332f.2989ac"]]},{"id":"83022ff1.d18fb","type":"function","z":"e7cd1901.ee2408","name":"Turn Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.sala_ocupada_switch\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":2280,"y":980,"wires":[["184e69f9.5c17a6"]]},{"id":"a363d670.bc5818","type":"function","z":"e7cd1901.ee2408","name":"Turn On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.sala_ocupada_switch\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":2280,"y":1020,"wires":[["184e69f9.5c17a6"]]},{"id":"d7677e76.e2922","type":"function","z":"5767c936.cabd18","name":"Turn Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.sala_ocupada_switch\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":2401,"y":811,"wires":[["c635d49e.ea96a8"]]},{"id":"21eee5c4.42f43a","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Tracks","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":570,"y":180,"wires":[["35f1389c.58dbe8","894f73d0.7faf5"]]},{"id":"67df1aa2.acfcf4","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":2690,"y":180,"wires":[["3c855ed7.ebda22"]]},{"id":"1fe978b4.916027","type":"spotify","z":"7b0de646.c85c78","name":"Getting Old Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1270,"y":180,"wires":[["38acba26.313156"]]},{"id":"35f1389c.58dbe8","type":"function","z":"7b0de646.c85c78","name":"Discover Weekly Archive","func":"flow.set(\"discoverWeeklyTracks\", msg.payload.items)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '5Rxn0QVVaFMpp6UmHj53QA',\n        {offset: 0}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":810,"y":180,"wires":[["88ba07cd.6d1548"]]},{"id":"38acba26.313156","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"discoverWeeklyOldAux\");\nvar oldArrayAux = flow.get(\"discoverWeeklyOldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"discoverWeeklyOldArrayAux\", newOldArrayAux);\nflow.set(\"discoverWeeklyOldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n    \n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1480,"y":180,"wires":[["fc2ff4a2.644d28"]]},{"id":"acb51d44.247d9","type":"inject","z":"7b0de646.c85c78","name":"","repeat":"","crontab":"00 12 * * 2,3","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":180,"wires":[["e41be8e0.1fef58"]]},{"id":"e41be8e0.1fef58","type":"function","z":"7b0de646.c85c78","name":"Discover Weekly","func":"var newMsg;\nflow.set(\"discoverWeeklyOldAux\", 0);\nflow.set(\"discoverWeeklyOldArrayAux\", []);\nflow.set(\"discoverWeeklyOffset\",100);\nnewMsg = {\n    \"params\":[\n        '37i9dQZEVXcLnLyPWrETXX'\n    ]\n}\nreturn newMsg;\n","outputs":1,"noerr":0,"x":370,"y":180,"wires":[["21eee5c4.42f43a"]]},{"id":"e94b8343.e1599","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1880,"y":180,"wires":[["368061d.6d6e49e"],["ae779a88.fa5de8","92ef2381.dbda5"]]},{"id":"368061d.6d6e49e","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"offsetAux = flow.get(\"discoverWeeklyOffset\");\nflow.set(\"discoverWeeklyOffset\",offsetAux+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '5Rxn0QVVaFMpp6UmHj53QA',\n        {offset: offsetAux}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1800,"y":100,"wires":[["1fe978b4.916027"]]},{"id":"ae779a88.fa5de8","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"discoverWeeklyTracks\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nfor(var i=0; i<newTracks.length; i++) {\n    alreadyIn = false;\n    for(var j=0; j<oldTracks.length; j++) {\n        if(newTracks[i].track.id === oldTracks[j].track.id){\n            alreadyIn = true\n        }\n    }\n    if(alreadyIn === false){\n        auxString = \"['\" + newTracks[i].track.uri + \"']\"\n        newMsg = {\n            \"params\":[\n                \"5Rxn0QVVaFMpp6UmHj53QA\",\n                [newTracks[i].track.uri]\n            ]}\n        node.send(newMsg);\n\n    }\n}","outputs":1,"noerr":0,"x":2210,"y":180,"wires":[["e9f13be7.5e3408","de5e297d.e24438"]]},{"id":"fc2ff4a2.644d28","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":180,"wires":[["e94b8343.e1599"]]},{"id":"92ef2381.dbda5","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2200,"y":260,"wires":[]},{"id":"88ba07cd.6d1548","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1040,"y":180,"wires":[["1fe978b4.916027"]]},{"id":"e9f13be7.5e3408","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2450,"y":180,"wires":[["67df1aa2.acfcf4"]]},{"id":"894f73d0.7faf5","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":760,"y":240,"wires":[]},{"id":"de5e297d.e24438","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2490,"y":260,"wires":[]},{"id":"3c855ed7.ebda22","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2890,"y":260,"wires":[]},{"id":"7837a8bf.76d0c8","type":"function","z":"d67ca66.293d758","name":"Pisca Banheiro","func":"var newMsg;\nnewMsg = {payload:{\n          \"domain\": \"light\",\n          \"service\": \"turn_on\",\n          \"data\":{\n          \"entity_id\": \"light.luz_do_banheiro\",\n            \"effect\": \"Twitter\"\n        }\n    }\n}\n    return newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1000,"y":1560,"wires":[["1bc561f3.21090e"]]},{"id":"4a374454.4142ac","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Tracks","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":570,"y":440,"wires":[["a64f6650.16bb58","434b94e8.b4713c"]]},{"id":"1800da54.e85e76","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":2690,"y":440,"wires":[["79936ffe.e8906"]]},{"id":"99917997.b40b98","type":"spotify","z":"7b0de646.c85c78","name":"Getting Old Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1270,"y":440,"wires":[["6fc060a0.cd011"]]},{"id":"a64f6650.16bb58","type":"function","z":"7b0de646.c85c78","name":"Top Brasil Archive","func":"flow.set(\"topBrasilTracks\", msg.payload.items)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '35uWFe4ozJHwjDfrM3yt9X',\n        {offset: 0}\n    ]\n}\nreturn newMsg;\n","outputs":1,"noerr":0,"x":790,"y":440,"wires":[["7c12d609.7085b8"]]},{"id":"6fc060a0.cd011","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"topBrasilOldAux\");\nvar oldArrayAux = flow.get(\"topBrasilOldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"topBrasilOldArrayAux\", newOldArrayAux);\nflow.set(\"topBrasilOldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n    \n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1480,"y":440,"wires":[["2e8040ad.403d1"]]},{"id":"4c68c70c.82e1a8","type":"inject","z":"7b0de646.c85c78","name":"","repeat":"","crontab":"00 14 * * 3,4","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":440,"wires":[["3034b028.07d7e"]]},{"id":"3034b028.07d7e","type":"function","z":"7b0de646.c85c78","name":"Top Brasil","func":"var newMsg;\nflow.set(\"topBrasilOldAux\", 0);\nflow.set(\"topBrasilOldArrayAux\", []);\nflow.set(\"topBrasilOffset\",100);\nnewMsg = {\n    \"params\":[\n        '37i9dQZF1DX0FOF1IUWK1W'\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":340,"y":440,"wires":[["4a374454.4142ac"]]},{"id":"9b5fbfce.6c8dc","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1880,"y":440,"wires":[["67a6039a.330dbc"],["1f1121c8.b2b6be","56e4e6cf.9459d8"]]},{"id":"67a6039a.330dbc","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"offsetAux = flow.get(\"topBrasilOffset\");\nflow.set(\"topBrasilOffset\",offsetAux+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '35uWFe4ozJHwjDfrM3yt9X',\n        {offset: offsetAux}\n    ]\n}\nreturn newMsg;\n","outputs":1,"noerr":0,"x":1800,"y":360,"wires":[["99917997.b40b98"]]},{"id":"1f1121c8.b2b6be","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"topBrasilTracks\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nfor(var i=0; i<newTracks.length; i++) {\n    alreadyIn = false;\n    for(var j=0; j<oldTracks.length; j++) {\n        if(newTracks[i].track.id === oldTracks[j].track.id){\n            alreadyIn = true\n        }\n    }\n    if(alreadyIn === false){\n        auxString = \"['\" + newTracks[i].track.uri + \"']\"\n        newMsg = {\n            \"params\":[\n                \"35uWFe4ozJHwjDfrM3yt9X\",\n                [newTracks[i].track.uri]\n            ]}\n        node.send(newMsg);\n\n    }\n}\n","outputs":1,"noerr":0,"x":2210,"y":440,"wires":[["4ca284cd.5ca04c","c5e9a994.3b9308"]]},{"id":"2e8040ad.403d1","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":440,"wires":[["9b5fbfce.6c8dc"]]},{"id":"56e4e6cf.9459d8","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2200,"y":520,"wires":[]},{"id":"7c12d609.7085b8","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1040,"y":440,"wires":[["99917997.b40b98"]]},{"id":"4ca284cd.5ca04c","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2450,"y":440,"wires":[["1800da54.e85e76"]]},{"id":"434b94e8.b4713c","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":760,"y":500,"wires":[]},{"id":"c5e9a994.3b9308","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2490,"y":520,"wires":[]},{"id":"79936ffe.e8906","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2890,"y":520,"wires":[]},{"id":"9526c853.237968","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Tracks","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":570,"y":680,"wires":[["ac54f018.d32e7","f2abd7ed.b85238"]]},{"id":"1449fdf2.e40e42","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":2690,"y":680,"wires":[["9dee9eed.4e4e5"]]},{"id":"f73d72ec.acd28","type":"spotify","z":"7b0de646.c85c78","name":"Getting Old Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1270,"y":680,"wires":[["9308b9d3.af0f18"]]},{"id":"ac54f018.d32e7","type":"function","z":"7b0de646.c85c78","name":"Top Germany Archive","func":"flow.set(\"topGermanyTracks\", msg.payload.items)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '76J4h1CN1vbZltoq7lYB4R',\n        {offset: 0}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":800,"y":680,"wires":[["b7f81fc2.a4d9f"]]},{"id":"9308b9d3.af0f18","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"topGermanyOldAux\");\nvar oldArrayAux = flow.get(\"topGermanyOldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"topGermanyOldArrayAux\", newOldArrayAux);\nflow.set(\"topGermanyOldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n    \n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1480,"y":680,"wires":[["cb029a42.b53af8"]]},{"id":"96ea9b53.d6af88","type":"inject","z":"7b0de646.c85c78","name":"","repeat":"","crontab":"00 15 * * 3,4","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":680,"wires":[["75c460e0.d6bd"]]},{"id":"75c460e0.d6bd","type":"function","z":"7b0de646.c85c78","name":"Top Germany","func":"var newMsg;\nflow.set(\"topGermanyOldAux\", 0);\nflow.set(\"topGermanyOldArrayAux\", []);\nflow.set(\"topGermanyOffset\",100);\nnewMsg = {\n    \"params\":[\n        '6HiZDoQlmYliE3RhFm4Fek'\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":360,"y":680,"wires":[["9526c853.237968"]]},{"id":"3b45c7.2b64aa3a","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1880,"y":680,"wires":[["5c514e54.0051c"],["b613bfd5.3d21","9dd4c7c1.ede508"]]},{"id":"5c514e54.0051c","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"offsetAux = flow.get(\"topGermanyOffset\");\nflow.set(\"topGermanyOffset\",offsetAux+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '76J4h1CN1vbZltoq7lYB4R',\n        {offset: offsetAux}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1800,"y":600,"wires":[["f73d72ec.acd28"]]},{"id":"b613bfd5.3d21","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"topGermanyTracks\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nfor(var i=0; i<newTracks.length; i++) {\n    alreadyIn = false;\n    for(var j=0; j<oldTracks.length; j++) {\n        if(newTracks[i].track.id === oldTracks[j].track.id){\n            alreadyIn = true\n        }\n    }\n    if(alreadyIn === false){\n        auxString = \"['\" + newTracks[i].track.uri + \"']\"\n        newMsg = {\n            \"params\":[\n                \"76J4h1CN1vbZltoq7lYB4R\",\n                [newTracks[i].track.uri]\n            ]}\n        node.send(newMsg);\n\n    }\n}","outputs":1,"noerr":0,"x":2210,"y":680,"wires":[["b386b533.a16958","193322b1.238e5d"]]},{"id":"cb029a42.b53af8","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":680,"wires":[["3b45c7.2b64aa3a"]]},{"id":"9dd4c7c1.ede508","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2200,"y":760,"wires":[]},{"id":"b7f81fc2.a4d9f","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1040,"y":680,"wires":[["f73d72ec.acd28"]]},{"id":"b386b533.a16958","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2450,"y":680,"wires":[["1449fdf2.e40e42"]]},{"id":"f2abd7ed.b85238","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":760,"y":740,"wires":[]},{"id":"193322b1.238e5d","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2490,"y":760,"wires":[]},{"id":"9dee9eed.4e4e5","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2890,"y":760,"wires":[]},{"id":"95ecd622.cc6388","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Tracks","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":570,"y":900,"wires":[["d7f8f9f0.61ba68","51770cfc.313aa4"]]},{"id":"63081ad6.b1a454","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":2690,"y":900,"wires":[["eb719cd7.29dee"]]},{"id":"4cec2d74.c449a4","type":"spotify","z":"7b0de646.c85c78","name":"Getting Old Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1270,"y":900,"wires":[["466a0bbb.b6baf4"]]},{"id":"d7f8f9f0.61ba68","type":"function","z":"7b0de646.c85c78","name":"Top Danmark Archive","func":"flow.set(\"topDanmarkTracks\", msg.payload.items)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '1YlehTYisXGTKxCW3Nm32q',\n        {offset: 0}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":800,"y":900,"wires":[["bed80d53.23eb5"]]},{"id":"466a0bbb.b6baf4","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"topDanmarkOldAux\");\nvar oldArrayAux = flow.get(\"topDanmarkOldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n            newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"topDanmarkOldArrayAux\", newOldArrayAux);\nflow.set(\"topDanmarkOldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n    \n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1480,"y":900,"wires":[["bdd45785.4dc018"]]},{"id":"ba6f5458.416e28","type":"inject","z":"7b0de646.c85c78","name":"","repeat":"","crontab":"00 15 * * 3,4","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":900,"wires":[["5a0a074c.c44308"]]},{"id":"5a0a074c.c44308","type":"function","z":"7b0de646.c85c78","name":"Top Danmark","func":"var newMsg;\nflow.set(\"topDanmarkOldAux\", 0);\nflow.set(\"topDanmarkOldArrayAux\", []);\nflow.set(\"topDanmarkOffset\",100);\nnewMsg = {\n    \"params\":[\n        '3YJe3cIXVuL3Eh3b5QoEu1'\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":350,"y":900,"wires":[["95ecd622.cc6388"]]},{"id":"d1fbe463.6b92c8","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1880,"y":900,"wires":[["2520435e.7eab2c"],["5a71e15d.fa062","aa7d309c.076e4"]]},{"id":"2520435e.7eab2c","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"offsetAux = flow.get(\"topDanmarkOffset\");\nflow.set(\"topDanmarkOffset\",offsetAux+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '1YlehTYisXGTKxCW3Nm32q',\n        {offset: offsetAux}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1800,"y":820,"wires":[["4cec2d74.c449a4"]]},{"id":"5a71e15d.fa062","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"topDanmarkTracks\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nfor(var i=0; i<newTracks.length; i++) {\n    alreadyIn = false;\n    for(var j=0; j<oldTracks.length; j++) {\n        if(newTracks[i].track.id === oldTracks[j].track.id){\n            alreadyIn = true\n        }\n    }\n    if(alreadyIn === false){\n        auxString = \"['\" + newTracks[i].track.uri + \"']\"\n        newMsg = {\n            \"params\":[\n                \"1YlehTYisXGTKxCW3Nm32q\",\n                [newTracks[i].track.uri]\n            ]}\n        node.send(newMsg);\n\n    }\n}","outputs":1,"noerr":0,"x":2210,"y":900,"wires":[["926e4f0e.04832","d18c7825.592818"]]},{"id":"bdd45785.4dc018","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":900,"wires":[["d1fbe463.6b92c8"]]},{"id":"aa7d309c.076e4","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2200,"y":980,"wires":[]},{"id":"bed80d53.23eb5","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1040,"y":900,"wires":[["4cec2d74.c449a4"]]},{"id":"926e4f0e.04832","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2450,"y":900,"wires":[["63081ad6.b1a454"]]},{"id":"51770cfc.313aa4","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":760,"y":960,"wires":[]},{"id":"d18c7825.592818","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2490,"y":980,"wires":[]},{"id":"eb719cd7.29dee","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2890,"y":980,"wires":[]},{"id":"eab315a0.b32508","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Tracks","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":570,"y":1100,"wires":[["9f180e48.be25f","576113b.438ecec"]]},{"id":"2a8b0457.6890ec","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":2690,"y":1100,"wires":[["7e3bfef.54acc"]]},{"id":"91bdc8a3.79b4b8","type":"spotify","z":"7b0de646.c85c78","name":"Getting Old Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1270,"y":1100,"wires":[["cbb6c18a.5a496"]]},{"id":"9f180e48.be25f","type":"function","z":"7b0de646.c85c78","name":"Global X Archive","func":"flow.set(\"globalXTracks\", msg.payload.items)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '50W5L0TYBG4YG8mWjGFRPl',\n        {offset: 0}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":790,"y":1100,"wires":[["e14cbf2.5776c4"]]},{"id":"cbb6c18a.5a496","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"globalXOldAux\");\nvar oldArrayAux = flow.get(\"globalXOldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"globalXOldArrayAux\", newOldArrayAux);\nflow.set(\"globalXOldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n    \n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1480,"y":1100,"wires":[["36559b7d.cbd544"]]},{"id":"e82f0b79.1baea8","type":"inject","z":"7b0de646.c85c78","name":"","repeat":"","crontab":"00 16 * * 4","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":1100,"wires":[["cbc315d0.e9da88"]]},{"id":"cbc315d0.e9da88","type":"function","z":"7b0de646.c85c78","name":"Global X","func":"var newMsg;\nflow.set(\"globalXOldAux\", 0);\nflow.set(\"globalXOldArrayAux\", []);\nflow.set(\"globalXOffset\",100);\nnewMsg = {\n    \"params\":[\n        '37i9dQZF1DWUxHPh2rEiHr'\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":340,"y":1100,"wires":[["eab315a0.b32508"]]},{"id":"65a9568d.250a68","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1880,"y":1100,"wires":[["6f3bb583.34082c"],["e7ef7fdb.13438","c0f3ee22.d1d0b"]]},{"id":"6f3bb583.34082c","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"offsetAux = flow.get(\"globalXOffset\");\nflow.set(\"globalXOffset\",offsetAux+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '50W5L0TYBG4YG8mWjGFRPl',\n        {offset: offsetAux}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1800,"y":1020,"wires":[["91bdc8a3.79b4b8"]]},{"id":"e7ef7fdb.13438","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"globalXTracks\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nfor(var i=0; i<newTracks.length; i++) {\n    alreadyIn = false;\n    for(var j=0; j<oldTracks.length; j++) {\n        if(newTracks[i].track.id === oldTracks[j].track.id){\n            alreadyIn = true\n        }\n    }\n    if(alreadyIn === false){\n        auxString = \"['\" + newTracks[i].track.uri + \"']\"\n        newMsg = {\n            \"params\":[\n                \"50W5L0TYBG4YG8mWjGFRPl\",\n                [newTracks[i].track.uri]\n            ]}\n        node.send(newMsg);\n\n    }\n}","outputs":1,"noerr":0,"x":2210,"y":1100,"wires":[["964614b1.ac6608","f5bb9ecd.21ea1"]]},{"id":"36559b7d.cbd544","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":1100,"wires":[["65a9568d.250a68"]]},{"id":"c0f3ee22.d1d0b","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2200,"y":1180,"wires":[]},{"id":"e14cbf2.5776c4","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1040,"y":1100,"wires":[["91bdc8a3.79b4b8"]]},{"id":"964614b1.ac6608","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2450,"y":1100,"wires":[["2a8b0457.6890ec"]]},{"id":"576113b.438ecec","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":760,"y":1160,"wires":[]},{"id":"f5bb9ecd.21ea1","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2490,"y":1180,"wires":[]},{"id":"7e3bfef.54acc","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2890,"y":1180,"wires":[]},{"id":"96f1b6c9.bcebc8","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Tracks","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":570,"y":1320,"wires":[["ace14571.337cc8","be04c8f3.ddc9b8"]]},{"id":"89fb334.1345bd","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":2690,"y":1320,"wires":[["ad1eb4b3.a3a608"]]},{"id":"1c0ed305.a524bd","type":"spotify","z":"7b0de646.c85c78","name":"Getting Old Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1270,"y":1320,"wires":[["8dd81a7a.e1d088","b9019e06.741ed"]]},{"id":"ace14571.337cc8","type":"function","z":"7b0de646.c85c78","name":"Top Finland Archive","func":"flow.set(\"topFinlandTracks\", msg.payload.items)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '2FbFhJ9br4ACkAzSWQTlte',\n        {offset: 0}\n    ]\n}\nreturn newMsg;\n","outputs":1,"noerr":0,"x":790,"y":1320,"wires":[["79c4403c.0a419"]]},{"id":"8dd81a7a.e1d088","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"topFinlandOldAux\");\nvar oldArrayAux = flow.get(\"topFinlandOldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"topFinlandOldArrayAux\", newOldArrayAux);\nflow.set(\"topFinlandOldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1480,"y":1320,"wires":[["80abdb8d.878ec8"]]},{"id":"5afb1af8.29af64","type":"inject","z":"7b0de646.c85c78","name":"","repeat":"","crontab":"00 17 * * 3,4","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":1320,"wires":[["29068bfd.22bb54"]]},{"id":"29068bfd.22bb54","type":"function","z":"7b0de646.c85c78","name":"Top Finland","func":"var newMsg;\nflow.set(\"topFinlandOldAux\", 0);\nflow.set(\"topFinlandOldArrayAux\", []);\nflow.set(\"topFinlandOffset\",100);\nnewMsg = {\n    \"params\":[\n        '37i9dQZEVXbMxcczTSoGwZ'\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":350,"y":1320,"wires":[["96f1b6c9.bcebc8"]]},{"id":"82fa33e2.8c3c","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1880,"y":1320,"wires":[["91f62074.83a54"],["d7d9c589.d3e5a8","e4adab67.da9048"]]},{"id":"91f62074.83a54","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"discoverWeeklyOffset = flow.get(\"topFinlandOffset\");\nflow.set(\"topFinlandOffset\",discoverWeeklyOffset+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '2FbFhJ9br4ACkAzSWQTlte',\n        {offset: discoverWeeklyOffset}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1800,"y":1240,"wires":[["1c0ed305.a524bd"]]},{"id":"d7d9c589.d3e5a8","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"topFinlandTracks\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nvar i;\n        for(i=0; i<newTracks.length; i++) {\n            alreadyIn = false;\n            for(var j=0; j<oldTracks.length; j++) {\n                if(newTracks[i].track.id === oldTracks[j].track.id){\n                    alreadyIn = true\n                }\n            }\n            if(alreadyIn === false){\n                auxString = \"['\" + newTracks[i].track.uri + \"']\"\n                newMsg = {\n                    \"params\":[\n                        \"2FbFhJ9br4ACkAzSWQTlte\",\n                        [newTracks[i].track.uri]\n                    ]}\n                node.send(newMsg);\n        \n            }\n        }","outputs":1,"noerr":0,"x":2210,"y":1320,"wires":[["be0d0c47.0b465","7cdd74fa.2c834c"]]},{"id":"80abdb8d.878ec8","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":1320,"wires":[["82fa33e2.8c3c"]]},{"id":"e4adab67.da9048","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2200,"y":1400,"wires":[]},{"id":"79c4403c.0a419","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1040,"y":1320,"wires":[["1c0ed305.a524bd"]]},{"id":"be0d0c47.0b465","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2450,"y":1320,"wires":[["89fb334.1345bd"]]},{"id":"be04c8f3.ddc9b8","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":760,"y":1380,"wires":[]},{"id":"7cdd74fa.2c834c","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2490,"y":1400,"wires":[]},{"id":"ad1eb4b3.a3a608","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2890,"y":1400,"wires":[]},{"id":"b9019e06.741ed","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1450,"y":1380,"wires":[]},{"id":"7840428.2ec55bc","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"20","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1330,"y":340,"wires":[["a2a4940d.a23088"]]},{"id":"4943a9f0.439568","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":990,"y":4280,"wires":[]},{"id":"b64bd9f1.625ab8","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":710,"y":4280,"wires":[]},{"id":"b962a68d.1befc8","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"9","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":780,"y":2200,"wires":[["d8a6a7af.471828","722918db.057468","7092e720.21bfb8","f4fb0b93.88f248"]]},{"id":"d8a6a7af.471828","type":"function","z":"444fced8.33ecb","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Café pronto\", \"message\": \"O café está pronto\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"x":1050,"y":2220,"wires":[["364eaeaf.def002"]]},{"id":"1464f5f6.04b21a","type":"function","z":"d67ca66.293d758","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Café pronto\", \"message\": \"O café está pronto\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"x":990,"y":1740,"wires":[["744d12ad.5a64ac"]]},{"id":"523b3264.d38f2c","type":"function","z":"444fced8.33ecb","name":"Notificação","func":"if(msg.payload === \"home\"){\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \n         message: `{{ [\n             \"O Café está pronto.\",\n             \"O Café está prontinho.\",\n             \"Tem café quentinho na cozinha.\",\n             \"Tem café na cozinha.\",\n             \"Corre pra cozinha, o café está pronto.\",\n             \"O Café está pronto na cozinha.\",\n             \"O Café está quentinho te esperando.\"\n         ]|random }}`\n  \n\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"x":1250,"y":2280,"wires":[["f578d1a6.284bb"]]},{"id":"fda88def.b69f6","type":"link in","z":"859b066a.dd8128","name":"Botao Quarto","links":["c1f2906e.f1bc6","7f6d2d52.017e94"],"x":215,"y":1400,"wires":[["e740020e.82078","5eb62a84.b20844"]]},{"id":"6adec2d1.8d8afc","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":870,"y":1420,"wires":[]},{"id":"a50fec65.4ec2","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1520,"y":1220,"wires":[["ce1bcdf1.593cb"]]},{"id":"315759a.85645a6","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1520,"y":1340,"wires":[["4cf5516a.7f55"]]},{"id":"97a94c63.cf63d","type":"function","z":"859b066a.dd8128","name":"In Case of Error","func":"var newMsg;\nnewMsg = {payload:{\"On\":true}}\nreturn newMsg;","outputs":1,"noerr":0,"x":1360,"y":1340,"wires":[["315759a.85645a6"]]},{"id":"8a64803e.2782f","type":"function","z":"859b066a.dd8128","name":"In Case of Error","func":"var newMsg;\nnewMsg = {payload:true}\nreturn newMsg;","outputs":1,"noerr":0,"x":1360,"y":1220,"wires":[["a50fec65.4ec2"]]},{"id":"91098119.f77d8","type":"inject","z":"5767c936.cabd18","name":"Liga a Luz","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"1","payloadType":"str","x":1060,"y":180,"wires":[["db6caf2c.e2ac4"]]},{"id":"5d29cf32.e961","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1280,"y":660,"wires":[["a4f518c2.079878"]]},{"id":"b6f15c21.550fa","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1280,"y":800,"wires":[["b7203386.43b91"]]},{"id":"e164b7af.c75a38","type":"comment","z":"5767c936.cabd18","name":"Ajuda do Sensor de Movimento","info":"","x":270,"y":1100,"wires":[]},{"id":"6e4d9674.425e78","type":"inject","z":"d67ca66.293d758","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"30 00 * * 1,2,3,4,0","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":310,"y":1520,"wires":[["67c9d186.cfabb"]]},{"id":"1ffbc922.856317","type":"inject","z":"d67ca66.293d758","name":"","repeat":"","crontab":"00 00 * * 1,2,3,4,0","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":310,"y":1460,"wires":[["e592bd76.6e2c3"]]},{"id":"41408462.ac874c","type":"inject","z":"d67ca66.293d758","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 01 * * 1,2,3,4,0","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":310,"y":1580,"wires":[["2522c34f.ceba4c"]]},{"id":"e592bd76.6e2c3","type":"function","z":"d67ca66.293d758","name":"Volume 12","func":"if(global.get(\"horaDoFilme\") === false){\n    var newMsg;\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_VOL12\"\n        }\n    }\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":470,"y":1460,"wires":[["7511e273.ed96cc"]]},{"id":"67c9d186.cfabb","type":"function","z":"d67ca66.293d758","name":"Volume 10","func":"if(global.get(\"horaDoFilme\") === false){\n    var newMsg;\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_VOL10\"\n        }\n    }\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":470,"y":1520,"wires":[["7511e273.ed96cc"]]},{"id":"2522c34f.ceba4c","type":"function","z":"d67ca66.293d758","name":"Volume 8","func":"if(global.get(\"horaDoFilme\") === false){\n    var newMsg;\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_VOL8\"\n        }\n    }\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":460,"y":1580,"wires":[["7511e273.ed96cc"]]},{"id":"532314fa.f2012c","type":"function","z":"e7cd1901.ee2408","name":"Luz da Sala On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\",\n            \"brightness_pct\": 100,\n            \"kelvin\": 6200\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2500,"y":820,"wires":[["1dc6a3d6.67629c"]]},{"id":"d67e4ab.c1b5bb8","type":"catch","z":"d3db5d74.fb8fa","name":"","scope":null,"uncaught":false,"x":240,"y":3120,"wires":[["71498996.90f268","6f7f9381.9d1d6c"]]},{"id":"4e5d0f81.f3bd5","type":"function","z":"d3db5d74.fb8fa","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no Aqara Sensores.\"});\n\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            msg.payload = msg.payload + \"Erro numero \"+ i +\n            \"id: \" + msg.error[i].source.id+\". \"+\n            msg.error[i].source.name+ \". Tipo de erro:\" + \n            msg.error[i].source.type + \". Mensagem: \" +\n            msg.error[i].message + \"\\n\\n\";\n            \n        }\n    }\n    else{\n        msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n        msg.error.source.name+ \". Tipo de erro:\" + \n        msg.error.source.type + \". Mensagem: \" +\n        msg.error.message;\n    }\n   \n        return msg;\n}\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"x":1060,"y":3100,"wires":[["7ae9832b.29fcac","f415c6d8.4cbf48","2c9b56bf.9f838a"]]},{"id":"71498996.90f268","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":310,"y":3240,"wires":[["2934582d.184ef8"]]},{"id":"2934582d.184ef8","type":"function","z":"d3db5d74.fb8fa","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);\nglobal.set(\"ContCatchErrors\", 0);\n","outputs":1,"noerr":0,"x":490,"y":3240,"wires":[[]]},{"id":"e92d8962.b7bc48","type":"join","z":"d3db5d74.fb8fa","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":890,"y":3160,"wires":[["4e5d0f81.f3bd5"]]},{"id":"44fbab0a.7f3934","type":"switch","z":"d3db5d74.fb8fa","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":750,"y":3120,"wires":[["4e5d0f81.f3bd5"],["e92d8962.b7bc48"]]},{"id":"3706cb36.6a7874","type":"function","z":"d3db5d74.fb8fa","name":"Cont++","func":"if(global.get(\"ContCatchErrors\") === 0){\n\n    global.set(\"ContCatchErrors\", 1);\n    msg.ajuda = 1;    \n    return msg;\n}\nif(global.get(\"ContCatchErrors\") > 0){\n    global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n    msg.ajuda = 2;\n    return msg;\n    \n}\n","outputs":1,"noerr":0,"x":530,"y":3120,"wires":[["44fbab0a.7f3934"]]},{"id":"2c9b56bf.9f838a","type":"function","z":"d3db5d74.fb8fa","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"x":1250,"y":3060,"wires":[["e2dc6379.4e9bb","4239d307.833fac"]]},{"id":"edc059ec.cdd2e8","type":"comment","z":"d3db5d74.fb8fa","name":"Catching Errors and notifying","info":"","x":280,"y":3060,"wires":[]},{"id":"4239d307.833fac","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delay","timeout":"8","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1440,"y":3060,"wires":[["cfd819c5.6cc7d8"]]},{"id":"6f7f9381.9d1d6c","type":"switch","z":"d3db5d74.fb8fa","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":390,"y":3120,"wires":[[],["3706cb36.6a7874"]]},{"id":"150ad16c.450bbf","type":"catch","z":"d67ca66.293d758","name":"","scope":null,"uncaught":false,"x":240,"y":4000,"wires":[["2840121.e88ebee","e452b105.67aff"]]},{"id":"b2c539ee.0865c8","type":"function","z":"d67ca66.293d758","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no Home Assistant Automation.\"});\n\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            msg.payload = msg.payload + \"Erro numero \"+ i +\n            \"id: \" + msg.error[i].source.id+\". \"+\n            msg.error[i].source.name+ \". Tipo de erro:\" + \n            msg.error[i].source.type + \". Mensagem: \" +\n            msg.error[i].message + \"\\n\\n\";\n            \n        }\n    }\n    else{\n        msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n        msg.error.source.name+ \". Tipo de erro:\" + \n        msg.error.source.type + \". Mensagem: \" +\n        msg.error.message;\n    }\n   \n        return msg;\n}\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"x":1060,"y":3980,"wires":[["642c7690.ce47d8","2034f8fb.2e2178","867dbbf8.3fce58"]]},{"id":"2840121.e88ebee","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":310,"y":4120,"wires":[["cbd077a.ec12188"]]},{"id":"cbd077a.ec12188","type":"function","z":"d67ca66.293d758","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);\nglobal.set(\"ContCatchErrors\", 0);\n","outputs":1,"noerr":0,"x":490,"y":4120,"wires":[[]]},{"id":"76961ef1.e7a94","type":"join","z":"d67ca66.293d758","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":890,"y":4040,"wires":[["b2c539ee.0865c8"]]},{"id":"d6fd7f59.d5ba3","type":"switch","z":"d67ca66.293d758","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":750,"y":4000,"wires":[["b2c539ee.0865c8"],["76961ef1.e7a94"]]},{"id":"3e4b1469.06937c","type":"function","z":"d67ca66.293d758","name":"Cont++","func":"if(!msg.error[i].message.includes('Conflict'))\n{\n    if(global.get(\"ContCatchErrors\") === 0){\n\n        global.set(\"ContCatchErrors\", 1);\n        msg.ajuda = 1;    \n        return msg;\n    }\n    if(global.get(\"ContCatchErrors\") > 0){\n        global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n        msg.ajuda = 2;\n        return msg;\n        \n    }\n}","outputs":1,"noerr":0,"x":530,"y":4000,"wires":[["d6fd7f59.d5ba3"]]},{"id":"867dbbf8.3fce58","type":"function","z":"d67ca66.293d758","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"x":1250,"y":3940,"wires":[["393f8bc8.a11c74","bf9aa7c1.5293e8"]]},{"id":"d96e24c2.d84098","type":"comment","z":"d67ca66.293d758","name":"Catching Errors and notifying","info":"","x":280,"y":3940,"wires":[]},{"id":"bf9aa7c1.5293e8","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"delay","timeout":"8","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1440,"y":3940,"wires":[["e18d7d74.a8ff5"]]},{"id":"e452b105.67aff","type":"switch","z":"d67ca66.293d758","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":390,"y":4000,"wires":[[],["3e4b1469.06937c"]]},{"id":"d6a00fa7.28e1f","type":"catch","z":"7b0de646.c85c78","name":"","scope":null,"uncaught":false,"x":360,"y":3160,"wires":[["a7222489.76dc98","2e3122ba.5aa62e"]]},{"id":"ec204fa6.59f2d","type":"function","z":"7b0de646.c85c78","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no Spotify Helpers.\"});\n\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            msg.payload = msg.payload + \"Erro numero \"+ i +\n            \"id: \" + msg.error[i].source.id+\". \"+\n            msg.error[i].source.name+ \". Tipo de erro:\" + \n            msg.error[i].source.type + \". Mensagem: \" +\n            msg.error[i].message + \"\\n\\n\";\n            \n        }\n    }\n    else{\n        msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n        msg.error.source.name+ \". Tipo de erro:\" + \n        msg.error.source.type + \". Mensagem: \" +\n        msg.error.message;\n    }\n   \n        return msg;\n}\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"x":1180,"y":3140,"wires":[["308fbc11.8da8e4","f8ce5a3.d77dfa8","70a1d2a.048b02c"]]},{"id":"a7222489.76dc98","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":430,"y":3280,"wires":[["cd8e5d0d.4a98b"]]},{"id":"cd8e5d0d.4a98b","type":"function","z":"7b0de646.c85c78","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);\nglobal.set(\"ContCatchErrors\", 0);\n","outputs":1,"noerr":0,"x":610,"y":3280,"wires":[[]]},{"id":"97e093fb.01dda","type":"join","z":"7b0de646.c85c78","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1010,"y":3200,"wires":[["ec204fa6.59f2d"]]},{"id":"7ef04449.be5f0c","type":"switch","z":"7b0de646.c85c78","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":870,"y":3160,"wires":[["ec204fa6.59f2d"],["97e093fb.01dda"]]},{"id":"ed7fda08.f17278","type":"function","z":"7b0de646.c85c78","name":"Cont++","func":"if(global.get(\"ContCatchErrors\") === 0){\n\n    global.set(\"ContCatchErrors\", 1);\n    msg.ajuda = 1;    \n    return msg;\n}\nif(global.get(\"ContCatchErrors\") > 0){\n    global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n    msg.ajuda = 2;\n    return msg;\n    \n}\n","outputs":1,"noerr":0,"x":650,"y":3160,"wires":[["7ef04449.be5f0c"]]},{"id":"70a1d2a.048b02c","type":"function","z":"7b0de646.c85c78","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"x":1370,"y":3100,"wires":[["ee70b3b2.cd44d","c2cf74ec.3b9e08"]]},{"id":"b03a04b4.ef3348","type":"comment","z":"7b0de646.c85c78","name":"Catching Errors and notifying","info":"","x":400,"y":3100,"wires":[]},{"id":"c2cf74ec.3b9e08","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"delay","timeout":"8","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1560,"y":3100,"wires":[["be1210a6.1a4ef"]]},{"id":"2e3122ba.5aa62e","type":"switch","z":"7b0de646.c85c78","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":510,"y":3160,"wires":[[],["ed7fda08.f17278"]]},{"id":"51882b84.051b14","type":"catch","z":"444fced8.33ecb","name":"","scope":null,"uncaught":false,"x":240,"y":4860,"wires":[["818c9508.d03408","8922b86d.8e2bd8"]]},{"id":"96052d96.01437","type":"function","z":"444fced8.33ecb","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no Alexa Automation.\"});\n\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            msg.payload = msg.payload + \"Erro numero \"+ i +\n            \"id: \" + msg.error[i].source.id+\". \"+\n            msg.error[i].source.name+ \". Tipo de erro:\" + \n            msg.error[i].source.type + \". Mensagem: \" +\n            msg.error[i].message + \"\\n\\n\";\n            \n        }\n    }\n    else{\n        msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n        msg.error.source.name+ \". Tipo de erro:\" + \n        msg.error.source.type + \". Mensagem: \" +\n        msg.error.message;\n    }\n   \n        return msg;\n}\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"x":1060,"y":4840,"wires":[["cf6ffdbe.2c237","93a15a3a.164d48","3b2b1ba5.92e3d4"]]},{"id":"818c9508.d03408","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":310,"y":4980,"wires":[["d4ee3b86.fa23b8"]]},{"id":"d4ee3b86.fa23b8","type":"function","z":"444fced8.33ecb","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);\nglobal.set(\"ContCatchErrors\", 0);\n","outputs":1,"noerr":0,"x":490,"y":4980,"wires":[[]]},{"id":"e2a5696f.ad3558","type":"join","z":"444fced8.33ecb","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":890,"y":4900,"wires":[["96052d96.01437"]]},{"id":"1e55bc51.1f9584","type":"switch","z":"444fced8.33ecb","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":750,"y":4860,"wires":[["96052d96.01437"],["e2a5696f.ad3558"]]},{"id":"f719d417.dbe4c8","type":"function","z":"444fced8.33ecb","name":"Cont++","func":"if(global.get(\"ContCatchErrors\") === 0){\n\n    global.set(\"ContCatchErrors\", 1);\n    msg.ajuda = 1;    \n    return msg;\n}\nif(global.get(\"ContCatchErrors\") > 0){\n    global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n    msg.ajuda = 2;\n    return msg;\n    \n}\n","outputs":1,"noerr":0,"x":530,"y":4860,"wires":[["1e55bc51.1f9584"]]},{"id":"3b2b1ba5.92e3d4","type":"function","z":"444fced8.33ecb","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"x":1250,"y":4800,"wires":[["401a175f.c09d28","9c6e5b09.683fb8"]]},{"id":"23c71be0.c79dd4","type":"comment","z":"444fced8.33ecb","name":"Catching Errors and notifying","info":"","x":280,"y":4800,"wires":[]},{"id":"9c6e5b09.683fb8","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"8","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1440,"y":4800,"wires":[["4420f6a3.941d88"]]},{"id":"8922b86d.8e2bd8","type":"switch","z":"444fced8.33ecb","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":390,"y":4860,"wires":[[],["f719d417.dbe4c8"]]},{"id":"77e7d976.53fa78","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delayv","timeout":"20","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1640,"y":440,"wires":[["cf903424.3a44c8"]]},{"id":"aa736933.be4ac8","type":"function","z":"2ea7fd8b.7e0bb2","name":"Delay + 20 min","func":"msg.delay = 1200000;\nreturn msg;","outputs":1,"noerr":0,"x":1460,"y":440,"wires":[["77e7d976.53fa78"]]},{"id":"cf903424.3a44c8","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn Off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_off\",\n          \"entity_id\": \"input_boolean.sala_ocupada_switch\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":1800,"y":440,"wires":[["9b4e3a94.a2fa78"]]},{"id":"a74b6985.a8c138","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delayv","timeout":"20","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1640,"y":680,"wires":[["c7e8b158.db904"]]},{"id":"ccf25148.857f","type":"function","z":"2ea7fd8b.7e0bb2","name":"Delay + 20 min","func":"msg.delay = 1200000;\nreturn msg;","outputs":1,"noerr":0,"x":1460,"y":680,"wires":[["a74b6985.a8c138"]]},{"id":"c7e8b158.db904","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn Off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_off\",\n          \"entity_id\": \"input_boolean.cozinha_ocupada_switch\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":1800,"y":680,"wires":[["4821aef.fa5a95"]]},{"id":"2c291c4f.3bcaa4","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delayv","timeout":"20","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1640,"y":800,"wires":[["e8b377fb.080e78"]]},{"id":"39e201a5.0dd0ae","type":"function","z":"2ea7fd8b.7e0bb2","name":"Delay + 20 min","func":"msg.delay = 1200000;\nreturn msg;","outputs":1,"noerr":0,"x":1460,"y":800,"wires":[["2c291c4f.3bcaa4"]]},{"id":"e8b377fb.080e78","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn Off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_off\",\n          \"entity_id\": \"input_boolean.quarto_nedi_ocupado_switch\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":1800,"y":800,"wires":[["450a41b6.47521"]]},{"id":"eec3239f.5b027","type":"inject","z":"2ea7fd8b.7e0bb2","name":"","repeat":"1200","crontab":"","once":true,"onceDelay":"50","topic":"","payload":"true","payloadType":"bool","x":190,"y":220,"wires":[["646d904c.6769f","44f37172.e6c4c","5f47554c.dcf13c","ccea9dd.3ac356"]]},{"id":"9ab5d2cd.a93c5","type":"function","z":"d67ca66.293d758","name":"Notificação","func":"if(msg.payload === \"on\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Update\", \"message\": \"Há uma nova atualização do Home Assistant\"}'\n  \n\n    }\n    }};\n    node.send(newMsg);\n    \n    \n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \"title\": \"Update\",\n        \"message\": \"Há uma nova atualização do Home Assistant\"\n\n    }\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":637,"y":2020,"wires":[["9d43e026.111f9"]]},{"id":"d79abb8.dc3fc48","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nvar i = parseInt(flow.get(\"iterFitaDoQuartoInc\"));\nif(Hour > 10 && Hour < 21){\n    aux = 255;\n    auxInc = 30;\n}\nif(Hour <= 10 || Hour >= 21){\n    aux = 150;\n    auxInc = 20;\n}\n\nif (i > aux) { \n    return {reset: true} ;\n}\nvar newMsg;\n//var timerId = setInterval(function check() {\n//    newMsg= {payload : {\"On\":true,\n//            \"Brightness\": i,     \n//            \"Hue\": 174,\n//            \"Saturation\": 100 }};\n//    node.send(newMsg);\n//    i = i + auxInc; \n//    if (i > aux) { \n//        clearInterval(check);\n//        return;\n//    }\n//} , 250);\n\nnewMsg= {payload : {\"On\":true,\n            \"Brightness\": i,     \n            \"Hue\": 174,\n            \"Saturation\": 100 }};\n    i = i + auxInc; \n    \nflow.set(\"iterFitaDoQuartoInc\", i);\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3010,"y":420,"wires":[["c105b94f.0b66f8"]]},{"id":"fc2d90d4.5482","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3840,"y":1300,"wires":[["f51a50d2.41f56"]]},{"id":"e3bf4b20.84c2c8","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"msg.payload = {\"On\": false}\nreturn msg;","outputs":1,"noerr":0,"x":840,"y":2260,"wires":[[]]},{"id":"1709e7aa.4b4af8","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1830,"y":2640,"wires":[["75578844.506568"]]},{"id":"4fcf26d8.a83f78","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1810,"y":2800,"wires":[["8e887755.d13cb8"]]},{"id":"8fed1c7f.b1c9f","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3360,"y":420,"wires":[["4c38ce98.51c67"]]},{"id":"941d47c9.5197e8","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3980,"y":240,"wires":[["4c41c991.2adfc8","690062a7.0ec32c"]]},{"id":"8a236524.1c4328","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2170,"y":820,"wires":[["49f438d1.bca1e8"]]},{"id":"97d95d14.37082","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2170,"y":720,"wires":[["c7c5f30d.41a72"]]},{"id":"49e2ae6e.3770a","type":"function","z":"2ea7fd8b.7e0bb2","name":"Is it on?","func":"if(msg.payload === \"on\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":529,"y":700,"wires":[["2f7e965e.742a2a","664d1a0d.99fbd4"]]},{"id":"fe55583b.925df8","type":"function","z":"d3db5d74.fb8fa","name":"Botão Quarto Maria Click","func":"if(msg.payload.entity_id === \"binary_sensor.botao_quarto_maria\" && msg.payload.event.click_type === \"single\"){\n\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":180,"wires":[["a5bada24.753448"]]},{"id":"a5bada24.753448","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Clique Quarto Maria","links":["bf1670e7.f4493"],"x":715,"y":180,"wires":[]},{"id":"200a2af8.ab0036","type":"function","z":"d3db5d74.fb8fa","name":"Botão Quarto Maria Double","func":"if(msg.payload.entity_id === \"binary_sensor.botao_quarto_maria\" && msg.payload.event.click_type === \"double\"){\n\n    \n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":540,"y":220,"wires":[["a1c8520.4e51ab"]]},{"id":"a1c8520.4e51ab","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Duplo Clique Quarto Maria","links":["b76cbf74.d82fb","6642b0f3.696f5"],"x":715,"y":220,"wires":[]},{"id":"3774203b.8dc19","type":"function","z":"2ea7fd8b.7e0bb2","name":"At home?","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":520,"y":940,"wires":[["2f7e965e.742a2a"]]},{"id":"2bede119.72612e","type":"function","z":"2ea7fd8b.7e0bb2","name":"At home?","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":520,"y":1000,"wires":[["2f7e965e.742a2a"]]},{"id":"1d22767b.f129aa","type":"function","z":"2ea7fd8b.7e0bb2","name":"At home?","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":520,"y":1060,"wires":[["2f7e965e.742a2a"]]},{"id":"52b72dee.4176d4","type":"function","z":"2bbba447.a4759c","name":"Triggered?","func":"if(flow.get(\"triggered1\")===true){\n    flow.set(\"triggered1\", false);\n    return msg;\n}","outputs":1,"noerr":0,"x":1010,"y":420,"wires":[["d851d997.3c2738"]]},{"id":"2d40431.6363ebc","type":"function","z":"4c9c764d.9c4468","d":true,"name":"Turn On Dim","func":"msg.payload = { On: true, Hue: 240, Saturation: 100, Brightness: 50 };\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":950,"y":1380,"wires":[["48503f48.28a35"]]},{"id":"b09a970.3afbe68","type":"function","z":"444fced8.33ecb","d":true,"name":"Menos Brilho & Turquesa","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.fita_do_quarto\",\n        \"brightness\": 10,\n        \"rgb_color\": [0,216,255]\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":1280,"y":620,"wires":[["be7ef1ea.3760c"]]},{"id":"4a4d95ff.2ae1ec","type":"function","z":"444fced8.33ecb","name":"Atividade na Sala","func":"if(msg.payload.name===\"Echo Dot da Sala\"){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.sala_ocupada_switch\"\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":340,"wires":[["181bced0.749d31"]]},{"id":"bd72b3f8.afed","type":"function","z":"444fced8.33ecb","name":"Atividade no Quarto Nédi","func":"if(msg.payload.name===\"Echo Dot do Quarto Nédi\"){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.quarto_nedi_ocupado_swtich\"\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"x":549,"y":400,"wires":[["7b04e543.e5ac8c"]]},{"id":"c2af1e6b.5dd89","type":"function","z":"444fced8.33ecb","name":"Atividade na Cozinha","func":"if(msg.payload.name===\"Echo Dot da Cozinha\"){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.cozinha_ocupada_switch\"\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"x":540,"y":520,"wires":[["916545e5.635aa8"]]},{"id":"1c697dc3.2f69f2","type":"delay","z":"554bb518.994efc","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1220,"y":340,"wires":[["af96622f.78ac9"]]},{"id":"6a8fe430.294a0c","type":"inject","z":"d3db5d74.fb8fa","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":280,"y":800,"wires":[["31339c0.ecc2764"]]},{"id":"50b47a4d.54fd14","type":"inject","z":"859b066a.dd8128","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2290,"y":80,"wires":[["5276a510.bf584c"]]},{"id":"690062a7.0ec32c","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":4100,"y":300,"wires":[]},{"id":"d685bbde.8cfa28","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2620,"y":160,"wires":[]},{"id":"dd96d778.8e89b8","type":"function","z":"859b066a.dd8128","name":"Check if it's already On","func":"if(msg.payload === \"off\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":2240,"y":220,"wires":[["5276a510.bf584c"]]},{"id":"8f2f5dac.05e15","type":"function","z":"d67ca66.293d758","name":"Boa Noite Casa?","func":"if(\n    msg.payload.event.actionName === \"Sala Off\"\n    ){\n    return {\"payload\": {\"On\": false, \"on\": false}};\n}","outputs":1,"noerr":0,"x":530,"y":2300,"wires":[["4177e2e9.cbc80c","49bcc954.2a4e38","43d5b756.ecd308"]]},{"id":"93200b37.65da88","type":"function","z":"d67ca66.293d758","name":"Cozy Time?","func":"if(\n    msg.payload.event.actionName === \"Cozy Time\"\n    ){\n    return {\"payload\": {\"On\": true}};\n}","outputs":1,"noerr":0,"x":510,"y":2120,"wires":[["b97bc34b.2fbc2"]]},{"id":"b97bc34b.2fbc2","type":"link out","z":"d67ca66.293d758","name":"Cozy Time Action","links":["56beed64.231ab4"],"x":689,"y":2120,"wires":[]},{"id":"aeb9c42.5596d38","type":"function","z":"d67ca66.293d758","name":"Vou dormir?","func":"if(\n    msg.payload.event.actionName === \"Vou Dormir\"\n    ){\n    return {\"payload\": {\"On\": true}};\n}","outputs":1,"noerr":0,"x":510,"y":2180,"wires":[["54089fcf.dd297"]]},{"id":"54089fcf.dd297","type":"link out","z":"d67ca66.293d758","name":"Vou dormir Action","links":["17b7df66.4128b1"],"x":689,"y":2180,"wires":[]},{"id":"97ae9d93.03b45","type":"function","z":"d67ca66.293d758","name":"Movie Night?","func":"if(\n    msg.payload.event.actionName === \"Movie Night\"\n    ){\n    return {\"payload\": {\"horaDoFilme\": true}};\n}","outputs":1,"noerr":0,"x":510,"y":2240,"wires":[["9a1c72b3.da05c"]]},{"id":"9a1c72b3.da05c","type":"link out","z":"d67ca66.293d758","name":"Movie Night Action","links":["a3cf5b54.d11ca8"],"x":689,"y":2240,"wires":[]},{"id":"4177e2e9.cbc80c","type":"function","z":"d67ca66.293d758","name":"Turn Off Sala","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\"\n        }\n    }};\n    node.send(newMsg);\n\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\"\n        }\n    }};\n    node.send(newMsg);   \n\n\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.abajur_direita\"\n        }\n    }};\n    node.send(newMsg);         \n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.abajur_esquerda\"\n        }\n    }};\n    node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.luzes_do_escritorio\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.luzes_do_escritorio\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.sala\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.sala\"\n            }\n        }};\n    node.send(newMsg);  \n    \n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.sala_ocupada_switch\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":810,"y":2540,"wires":[["c9648a3c.d6a348"]]},{"id":"a1715e17.4597b","type":"link in","z":"d67ca66.293d758","name":"Boa Noite Casa","links":["4b42a86c.e9e038","1b8c3fb3.a193c"],"x":615,"y":2400,"wires":[["49bcc954.2a4e38","4177e2e9.cbc80c","43d5b756.ecd308"]]},{"id":"49bcc954.2a4e38","type":"function","z":"d67ca66.293d758","name":"Turn Off","func":"global.set(\"SalaOn\", false);\nreturn {payload : {\"on\": false}};\n","outputs":1,"noerr":0,"x":800,"y":2300,"wires":[["3a30f06f.ca027","2b1b546.381d4ac","b33859c3.c7681","c9fee3d9.d47888"]]},{"id":"5fe91ddd.b4ae94","type":"function","z":"859b066a.dd8128","name":"Check if it's already On","func":"if(msg.payload === \"off\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1150,"y":820,"wires":[["4a3016b4.a521c8","5d191951.232418"]]},{"id":"225cdd12.c72e02","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"str","x":270,"y":1140,"wires":[["19554fb4.898e3"]]},{"id":"2680ecb7.43a464","type":"inject","z":"4c9c764d.9c4468","name":"Passou das 19:30","repeat":"","crontab":"30 19 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":550,"y":80,"wires":[["bb4ce455.0074a8"]]},{"id":"c41e4981.c0d638","type":"inject","z":"4c9c764d.9c4468","name":"Passou das 19:30","repeat":"","crontab":"30 19 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1170,"y":180,"wires":[["1a8b27f1.115c48"]]},{"id":"72f2a359.5c521c","type":"function","z":"e7cd1901.ee2408","name":"Luz da Sala On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\",\n            \"brightness\": msg.payload.bri,\n            \"kelvin\": msg.payload.ct\n        }\n    }};\n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3300,"y":80,"wires":[["e7c9d71f.790548"]]},{"id":"f047d207.54c4","type":"function","z":"5767c936.cabd18","name":"Luz do Escritório On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_1\",\n            \"brightness\": msg.payload.bri,\n            \"kelvin\": msg.payload.ct\n        }\n    }};\n    node.send(newMsg);\n    \n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2\",\n            \"brightness\": msg.payload.bri,\n            \"kelvin\": msg.payload.ct\n        }\n    }};\n    \n    return newMsg;\n\n// \"brightness\": parseInt((msg.payload.bri/2.55)+1)","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3440,"y":300,"wires":[["142cf903.1b62c7"]]},{"id":"95c52976.c05758","type":"function","z":"e7cd1901.ee2408","name":"In case of Error","func":"var newMsg;\nvar ctAux\nctAux = msg.data.attributes.color_temp\n\nctAux = Math.round(1000000 / ctAux);\n//ctAux = parseInt(ctAux * -12.5+8059)\nif(msg.payload === \"on\"){\n        newMsg = {payload:{state:{bri:msg.data.attributes.brightness,\n            ct: ctAux\n                                  }\n                            },\n                            came: \"HomeAssistant\"\n        };\n        return newMsg;\n}\nif(msg.payload === \"off\"){\n        newMsg = {payload:{resetar: true}};\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1747,"y":200,"wires":[["30e986e4.20ec7a"]]},{"id":"10709ab7.2877a5","type":"function","z":"5767c936.cabd18","name":"In case of Error","func":"var newMsg;\nvar ctAux\nctAux = msg.data.attributes.color_temp\n\nctAux = Math.round(1000000 / ctAux);\n//ctAux = parseInt(ctAux * -12.5+8059)\nif(msg.payload === \"on\"){\n        newMsg = {payload:{state:{bri:msg.data.attributes.brightness,\n            ct: ctAux\n                                  }\n                            },\n                            came: \"HomeAssistant\"\n        };\n        return newMsg;\n}\nif(msg.payload === \"off\"){\n        newMsg = {payload:{resetar: true}};\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1780,"y":280,"wires":[["c38ea8d9.112cc8"]]},{"id":"4b0ffe36.4217f","type":"debug","z":"e7cd1901.ee2408","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1740,"y":140,"wires":[]},{"id":"afa0db4a.7e5e98","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"0.5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"30","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":940,"y":2500,"wires":[["2d23d4ab.10c21c"]]},{"id":"d9f0e7f6.c5a938","type":"function","z":"d3db5d74.fb8fa","name":"Aux Escritório Escuro","func":"if(msg.payload < 100){\n    global.set(\"escritorioEscuro\", true);\n}\nif(msg.payload < 60){\n    global.set(\"escritorioEscuro\", true);\n    return {\"payload\": {\"On\": true}};\n}","outputs":1,"noerr":0,"x":1260,"y":720,"wires":[["cc911481.98c798"]]},{"id":"7ac2d25c.e13b9c","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"rate","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"10","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2100,"y":300,"wires":[["5349675d.bda988"]]},{"id":"2d2b471d.051b18","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"rate","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"10","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2100,"y":240,"wires":[["2a05ae59.9f7e02"]]},{"id":"c38ea8d9.112cc8","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1940,"y":280,"wires":[["7ac2d25c.e13b9c"]]},{"id":"30e986e4.20ec7a","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1920,"y":200,"wires":[["2d2b471d.051b18"]]},{"id":"833e30e1.2f909","type":"switch","z":"5767c936.cabd18","name":"","property":"auxEmissor","propertyType":"flow","rules":[{"t":"eq","v":"Yeelight","vt":"str"},{"t":"eq","v":"HomeAssistant","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":3200,"y":220,"wires":[["9ffef5c0.172838","89fc9ed.7aa91e"],["f047d207.54c4"]]},{"id":"70421787.bbae78","type":"function","z":"5767c936.cabd18","name":"Came From","func":"flow.set(\"auxEmissor\", msg.came);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2430,"y":300,"wires":[["187514be.470c7b"]]},{"id":"c8adf277.daab7","type":"change","z":"e7cd1901.ee2408","name":"","rules":[{"t":"delete","p":"reset","pt":"msg"},{"t":"delete","p":"came","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2560,"y":220,"wires":[["bceedc42.6aad4"]]},{"id":"94317e5a.295e5","type":"function","z":"e7cd1901.ee2408","name":"Came From","func":"flow.set(\"auxEmissor\", msg.came);\nreturn msg;","outputs":1,"noerr":0,"x":2390,"y":220,"wires":[["c8adf277.daab7"]]},{"id":"9cb07780.bcfb08","type":"switch","z":"e7cd1901.ee2408","name":"","property":"auxEmissor","propertyType":"flow","rules":[{"t":"eq","v":"HomeAssistant","vt":"str"},{"t":"eq","v":"Yeelight","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":3130,"y":140,"wires":[["72f2a359.5c521c","f56b8e30.19171"],["ef8cbd88.f0403","cecb4513.4195f8","1df6f143.b3402f"]]},{"id":"72937ef4.b2531","type":"inject","z":"e7cd1901.ee2408","name":"Set bright","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1680,"y":560,"wires":[["56bfa971.e2ee68"]]},{"id":"56bfa971.e2ee68","type":"function","z":"e7cd1901.ee2408","name":"Bright","func":"flow.set(\"countBrightness\", 255);\nflow.set(\"auxCT\", 6100);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1830,"y":580,"wires":[[]]},{"id":"c9648a3c.d6a348","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"milliseconds","rate":"3","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":970,"y":2540,"wires":[["eb756d67.5b8c7"]]},{"id":"5a48819f.5863b","type":"function","z":"e7cd1901.ee2408","name":"Reset","func":"msg.reset = 1;\nreturn msg;","outputs":1,"noerr":0,"x":2370,"y":300,"wires":[["701ddd3a.218e34"]]},{"id":"34650f4f.5e35c","type":"function","z":"5767c936.cabd18","name":"Reset","func":"msg.reset = 1;\nreturn msg;","outputs":1,"noerr":0,"x":2410,"y":364,"wires":[["124b61c8.1527fe"]]},{"id":"cc911481.98c798","type":"link out","z":"d3db5d74.fb8fa","name":"","links":["6db289b5.2e7be8"],"x":1425,"y":720,"wires":[]},{"id":"bb4ce455.0074a8","type":"function","z":"4c9c764d.9c4468","name":"Escuro?","func":"global.set(\"salaEscura\", true);\nglobal.set(\"escritorioEscuro\", true);\nreturn msg;\n","outputs":1,"noerr":0,"x":740,"y":80,"wires":[["55f5a77a.253908"]]},{"id":"3d291f1c.4439","type":"function","z":"444fced8.33ecb","name":"Atividade no Quarto Maria","func":"if(msg.payload.name===\"Echo Dot do Quarto Maria\"){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.quarto_maria_ocupado_swtich\"\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"x":550,"y":460,"wires":[["ba5122b.ccbdfe"]]},{"id":"b649ab01.d53148","type":"function","z":"4c9c764d.9c4468","name":"Escuro?","func":"if(msg.payload < 60 && msg.payload > 0){\n                global.set(\"salaEscura\", true);\n                node.status({fill:\"green\",shape:\"dot\",text:\"SalaEscura true\"});\n                flow.set(\"triggered\", true);\n                node.send(msg);\n}\nelse if(msg.payload > 250){\n                global.set(\"salaEscura\", false);\n                node.status({fill:\"yellow\",shape:\"dot\",text:\"SalaEscura false\"});\n}\nif(msg.payload < 135 && msg.payload > 0){\n                global.set(\"escritorioEscuro\", true);\n                node.status({fill:\"green\",shape:\"dot\",text:\"EscritorioEscuro true\"});\n                flow.set(\"triggered\", true);\n                node.send(msg);\n}\nelse if(msg.payload > 250){\n                global.set(\"escritorioEscuro\", false);\n                node.status({fill:\"yellow\",shape:\"dot\",text:\"EscritorioEscuro false\"});\n}\n\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":740,"y":160,"wires":[["55f5a77a.253908"]]},{"id":"31b9e976.8077f6","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":580,"y":160,"wires":[["b649ab01.d53148","d27fe00c.72864"]]},{"id":"1f9e3931.bcd327","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":400,"y":160,"wires":[["31b9e976.8077f6"]]},{"id":"d999e68c.efcaf8","type":"function","z":"444fced8.33ecb","name":"Turn On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.rainbow_slow\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":1230,"y":500,"wires":[["56811ca4.681924"]]},{"id":"d1df1e50.00d2","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.rainbow_slow\"\n    }\n}};\nnode.send(newMsg);\n\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.3_cores\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.chase\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.chase_2\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.dark_cloud\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.hollywood\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.holofote\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.loading_bar\"\n    }\n}};\nnode.send(newMsg); \nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.oliver\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.palette\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.purple_green_palette\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.rainbow\"\n    }\n}};\nnode.send(newMsg); \nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.rainbow_stripes\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.random\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.sparkles\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.sparkles_colorido\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.unicornio\"\n    }\n}};\nnode.send(newMsg); \nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.rainbow_slow\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":840,"y":2380,"wires":[["6a5fa728.f3daa8"]]},{"id":"6a5fa728.f3daa8","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"3","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":990,"y":2380,"wires":[["2fafdb42.3f1dc4"]]},{"id":"a2eabe9.35fc44","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.rgb_strip\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":2940,"y":1120,"wires":[["18a27b29.899f75"]]},{"id":"d2cb09e7.582ad8","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3090,"y":1000,"wires":[["2e1d9879.f46658"]]},{"id":"d3e1203d.5d95a","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.rainbow_slow\"\n    }\n}};\nnode.send(newMsg);\n\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.3_cores\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.chase\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.chase_2\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.dark_cloud\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.hollywood\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.holofote\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.loading_bar\"\n    }\n}};\nnode.send(newMsg); \nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.oliver\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.palette\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.purple_green_palette\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.rainbow\"\n    }\n}};\nnode.send(newMsg); \nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.rainbow_stripes\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.random\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.sparkles\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.sparkles_colorido\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.unicornio\"\n    }\n}};\nnode.send(newMsg); \nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.rainbow_slow\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":2940,"y":1000,"wires":[["d2cb09e7.582ad8"]]},{"id":"8fc684ac.1af088","type":"function","z":"859b066a.dd8128","name":"Check if it's already On","func":"if(msg.payload.On === false){\n    flow.set(\"iterFitaDoQuartoInc\", 1);\n    return msg;\n}","outputs":1,"noerr":0,"x":1210,"y":720,"wires":[["ffafb4e0.f0f8f8"]]},{"id":"6054501.5c1bbb","type":"exec","z":"554bb518.994efc","command":"journalctl -u nodered -all","addpay":false,"append":"","useSpawn":"true","timer":"","oldrc":false,"name":"last","x":410,"y":1300,"wires":[["8ae1f406.ba0098"],[],[]]},{"id":"8ae1f406.ba0098","type":"function","z":"554bb518.994efc","name":"prepare filename","func":"\nvar d = new Date();\nvar t = d.getTime();\nvar year = d.getFullYear();\nvar month = d.getMonth()+1; \nvar day = d.getDate();\nvar hour  = d.getHours();\nvar minute  = d.getMinutes();\n\nif(month.toString().length == 1) \n{\n    month = '0'+month;\n}\n\nmsg.filename = \"/home/pi/nodeRedLogFiles/nodeRedLog_\"+day+\"-\"+month+\"-\"+year+\"-\"+hour+\":\"+minute+\".csv\";\n\nreturn msg;","outputs":1,"noerr":0,"x":610,"y":1300,"wires":[["d974a220.0c8d3"]]},{"id":"5c663da1.a92fa4","type":"inject","z":"554bb518.994efc","name":"save last nodered-journal","repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":210,"y":1300,"wires":[["6054501.5c1bbb"]]},{"id":"d974a220.0c8d3","type":"file","z":"554bb518.994efc","name":"","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":810,"y":1300,"wires":[[]]},{"id":"13c4832e.98f7cd","type":"comment","z":"554bb518.994efc","name":"Save last journal nodered","info":"","x":170,"y":1240,"wires":[]},{"id":"d27fe00c.72864","type":"function","z":"4c9c764d.9c4468","name":"Escuro?","func":"if(msg.payload < 200 && msg.payload > 0){\n                node.send(msg);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":740,"y":120,"wires":[[]]},{"id":"7cb7d34c.c828fc","type":"function","z":"4c9c764d.9c4468","name":"Escuro?","func":"if(msg.payload < 250 && msg.payload > 0){\n                node.send(msg);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":740,"y":320,"wires":[[]]},{"id":"333d133.c2f93ec","type":"function","z":"444fced8.33ecb","name":"Notificação","func":"if(msg.payload === \"home\"){\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_macbook_pro_de_nedison\",\n    data:{\n        \n        message: `{{ [\n             \"O Café está pronto.\",\n             \"O Café está prontinho.\",\n             \"Tem café quentinho na cozinha.\",\n             \"Tem café na cozinha.\",\n             \"Corre pra cozinha, o café está pronto.\",\n             \"O Café está pronto na cozinha.\",\n             \"O Café está quentinho te esperando.\"\n         ]|random }}`\n  \n\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"x":1230,"y":2340,"wires":[["e8799273.d7905"]]},{"id":"2426b618.2e080a","type":"function","z":"d67ca66.293d758","name":"Notificação","func":"if(msg.payload === \"home\"){\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_macbook_pro_de_nedison\",\n    data:{\n        \n        message: `{{ [\n             \"O Café está pronto.\",\n             \"O Café está prontinho.\",\n             \"Tem café quentinho na cozinha.\",\n             \"Tem café na cozinha.\",\n             \"Corre pra cozinha, o café está pronto.\",\n             \"O Café está pronto na cozinha.\",\n             \"O Café está quentinho te esperando.\"\n         ]|random }}`\n  \n\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"x":1190,"y":1880,"wires":[["2cbc6790.bfe668"]]},{"id":"6e9440a1.3fa3a","type":"function","z":"d67ca66.293d758","name":"Notificação","func":"if(msg.payload === \"home\"){\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \n        message: `{{ [\n             \"O Café está pronto.\",\n             \"O Café está prontinho.\",\n             \"Tem café quentinho na cozinha.\",\n             \"Tem café na cozinha.\",\n             \"Corre pra cozinha, o café está pronto.\",\n             \"O Café está pronto na cozinha.\",\n             \"O Café está quentinho te esperando.\"\n         ]|random }}`\n  \n\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"x":1190,"y":1820,"wires":[["1ae5f225.e369fe"]]},{"id":"d3b8b6e.d569048","type":"inject","z":"d67ca66.293d758","name":"","repeat":"","crontab":"10 14 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":297,"y":1960,"wires":[["c580857d.99c3c8"]]},{"id":"1d5f55ac.ab204a","type":"function","z":"444fced8.33ecb","name":"Notificação","func":"if(msg.payload === \"home\"){\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_softcelular\",\n    data:{\n        \n        message: `{{ [\n             \"O Café está pronto.\",\n             \"O Café está prontinho.\",\n             \"Tem café quentinho na cozinha.\",\n             \"Tem café na cozinha.\",\n             \"Corre pra cozinha, o café está pronto.\",\n             \"O Café está pronto na cozinha.\",\n             \"O Café está quentinho te esperando.\"\n         ]|random }}`\n  \n\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"x":1230,"y":2400,"wires":[["e204e475.d4aca8"]]},{"id":"96c42809.0e0038","type":"function","z":"d67ca66.293d758","name":"Notificação","func":"if(msg.payload === \"home\"){\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_softcelular\",\n    data:{\n        \n         message: `{{ [\n             \"O Café está pronto.\",\n             \"O Café está prontinho.\",\n             \"Tem café quentinho na cozinha.\",\n             \"Tem café na cozinha.\",\n             \"Corre pra cozinha, o café está pronto.\",\n             \"O Café está pronto na cozinha.\",\n             \"O Café está quentinho te esperando.\"\n         ]|random }}`\n  \n\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"x":1190,"y":1940,"wires":[["e187b40f.c08868"]]},{"id":"167dd391.ddaa2c","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":750,"y":2820,"wires":[["2b383006.609fc"]]},{"id":"59ef2215.5285dc","type":"function","z":"2ea7fd8b.7e0bb2","name":"Detected?","func":"if(msg.payload === \"on\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":530,"y":880,"wires":[["2f7e965e.742a2a","4d9c14f8.a18bcc"]]},{"id":"748845f7.408c5c","type":"function","z":"2ea7fd8b.7e0bb2","name":"Detected?","func":"if(msg.payload === \"on\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":530,"y":640,"wires":[["2f7e965e.742a2a","664d1a0d.99fbd4"]]},{"id":"fdc3de8.8813d2","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1280,"y":880,"wires":[["4aad5e64.a78a5","940dd198.99b4e"]]},{"id":"12b642b0.7b50bd","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delayv","timeout":"20","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1640,"y":940,"wires":[["3fcd9b73.acc8d4"]]},{"id":"940dd198.99b4e","type":"function","z":"2ea7fd8b.7e0bb2","name":"Delay + 20 min","func":"msg.delay = 1200000;\nreturn msg;","outputs":1,"noerr":0,"x":1460,"y":940,"wires":[["12b642b0.7b50bd"]]},{"id":"3fcd9b73.acc8d4","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn Off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_off\",\n          \"entity_id\": \"input_boolean.quarto_maria_ocupado_switch\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":1800,"y":940,"wires":[["9a60745.c28a788"]]},{"id":"4d9c14f8.a18bcc","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn On","func":"var newMsg;\nnewMsg= {payload: {\n      \"domain\": \"input_boolean\",\n      \"service\": \"turn_on\",\n      \"entity_id\": \"input_boolean.quarto_maria_ocupado_switch\",\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1120,"y":880,"wires":[["fdc3de8.8813d2"]]},{"id":"3001e3b1.19278c","type":"debug","z":"e7cd1901.ee2408","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2940,"y":260,"wires":[]},{"id":"fdaa18d0.27a2c8","type":"debug","z":"e7cd1901.ee2408","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3090,"y":80,"wires":[]},{"id":"cecb4513.4195f8","type":"debug","z":"e7cd1901.ee2408","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3270,"y":260,"wires":[]},{"id":"5619a37.a00cb5c","type":"inject","z":"d67ca66.293d758","name":"7 AM","repeat":"","crontab":"00 07 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"false","payloadType":"bool","x":330,"y":2620,"wires":[["e751ce31.77dd5","feae1bf7.c67b28","d6210037.0c3e5"]]},{"id":"e751ce31.77dd5","type":"function","z":"d67ca66.293d758","name":"Turn Off","func":"    var newMsg;\n    \n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.boa_noite\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":470,"y":2620,"wires":[["fa9fbc55.e8df4"]]},{"id":"feae1bf7.c67b28","type":"function","z":"d67ca66.293d758","name":"Turn Off","func":"    var newMsg;\n    \n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.vou_dormir\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":470,"y":2680,"wires":[["e21d43ff.c4614"]]},{"id":"a984656a.c4e198","type":"function","z":"d3db5d74.fb8fa","name":"Janela Fechada","func":"if(msg.topic === \"binary_sensor.janela_quarto_maria\"){\n    if(msg.payload === false){\n        global.set(\"janelaQuartoMaria\",false);\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"x":520,"y":1720,"wires":[[]]},{"id":"1d1cb695.50aaa9","type":"function","z":"d3db5d74.fb8fa","name":"Janela Aberta","func":"if(msg.topic === \"binary_sensor.janela_quarto_maria\"){\n    if(msg.payload === true){\n        global.set(\"janelaQuartoMaria\",true);\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"x":520,"y":1660,"wires":[[]]},{"id":"3c9fc7.6938503a","type":"function","z":"d3db5d74.fb8fa","name":"Janela Fechada","func":"if(msg.topic === \"binary_sensor.janela_quarto_nedi\"){\n    if(msg.payload === false){\n        global.set(\"janelaQuartoNedi\",false);\n        msg.reset = true;\n        msg.payload = \"reset\"; \n        return msg;\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":1840,"wires":[["b9dc8e30.7f553"]]},{"id":"604c113d.67dae","type":"function","z":"d3db5d74.fb8fa","name":"Janela Aberta","func":"if(msg.topic === \"binary_sensor.janela_quarto_nedi\"){\n    if(msg.payload === true){\n        global.set(\"janelaQuartoNedi\",true);\n        return msg;\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":1780,"wires":[["b9dc8e30.7f553"]]},{"id":"a9fdd412.daee28","type":"function","z":"d3db5d74.fb8fa","name":"Janela Fechada","func":"if(msg.topic === \"binary_sensor.janela_quarto_pai\"){\n    if(msg.payload === false){\n        global.set(\"janelaQuartoPai\",false);\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"x":520,"y":1960,"wires":[[]]},{"id":"c565ad59.11f79","type":"function","z":"d3db5d74.fb8fa","name":"Janela Aberta","func":"if(msg.topic === \"binary_sensor.janela_quarto_pai\"){\n    if(msg.payload === true){\n        global.set(\"janelaQuartoPai\",true);\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"x":520,"y":1900,"wires":[[]]},{"id":"9c27139a.c24c1","type":"function","z":"d3db5d74.fb8fa","name":"Janela Fechada","func":"if(msg.topic === \"binary_sensor.janela_sala\"){\n    if(msg.payload === false){\n        global.set(\"janelaSala\",false);\n        msg.reset = true;\n        msg.payload = \"reset\"; \n        return msg;\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":2080,"wires":[["86c97a42.dedca8"]]},{"id":"93421936.7e0098","type":"function","z":"d3db5d74.fb8fa","name":"Janela Aberta","func":"if(msg.topic === \"binary_sensor.janela_sala\"){\n    if(msg.payload === true){\n        global.set(\"janelaSala\",true);\n        return msg;\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":2020,"wires":[["86c97a42.dedca8"]]},{"id":"66f9a3a3.4af88c","type":"inject","z":"d3db5d74.fb8fa","name":"Check Windows","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/30 8-22 * * *","once":true,"onceDelay":"30","topic":"","payload":"true","payloadType":"bool","x":1450,"y":1780,"wires":[["96da81b6.00201","3e92f633.39663a","1ad8fab2.69e7a5","49601c4b.d52b24","fdd737c0.8ed7b8","9478d381.e15f1"]]},{"id":"56c92056.79c58","type":"function","z":"d3db5d74.fb8fa","name":"janela aux","func":"global.set(\"janelaQuartoMaria\",msg.payload);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1910,"y":1620,"wires":[[]]},{"id":"b17398e3.0f3eb8","type":"function","z":"d3db5d74.fb8fa","name":"janela aux","func":"global.set(\"janelaQuartoNedi\",msg.payload);\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1910,"y":1680,"wires":[[]]},{"id":"527d99bb.e6e388","type":"function","z":"d3db5d74.fb8fa","name":"janela aux","func":"global.set(\"janelaQuartoPai\",msg.payload);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1910,"y":1740,"wires":[[]]},{"id":"e46425ff.0ef6f8","type":"function","z":"d3db5d74.fb8fa","name":"janela aux","func":"global.set(\"janelaSala\",msg.payload);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1910,"y":1860,"wires":[[]]},{"id":"d9852513.51ccc8","type":"function","z":"d3db5d74.fb8fa","name":"Chuva?","func":"var date = new Date();\nvar Day = date.getDay(); \nvar Hour = date.getHours();\nif( ((msg.data.currently.summary.includes(\"rain\")=== true ||\n    msg.data.currently.summary.includes(\"Rain\")=== true)  &&\n    msg.payload.precipitation > 5 ||\n    msg.data.currently.precipIntensity > 5 ||\n    msg.data.currently.precipProbability > 0.5)\n    && (Hour > 9 && Hour < 23)\n    ){\n    \n    global.set(\"chuvaAux\",true);\n    return {payload:1};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1920,"y":2060,"wires":[["3e2dd5e4.ef0e6a"]]},{"id":"c4144b54.079d28","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1760,"y":2060,"wires":[["d9852513.51ccc8","eaa67a7f.f32758"]]},{"id":"31ec1a11.2d0896","type":"function","z":"d3db5d74.fb8fa","name":"Chuva aux","func":"if(msg.payload.includes(\"rain\")===true &&\n    msg.data.attributes.precipitation > 5){\n    global.set(\"chuvaAux\", true);\n    return {payload:1};\n}\nelse{\n    global.set(\"chuvaAux\", false);\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1910,"y":1920,"wires":[["3e2dd5e4.ef0e6a"]]},{"id":"3e2dd5e4.ef0e6a","type":"function","z":"d3db5d74.fb8fa","name":"","func":"var date = new Date();\nvar Day = date.getDay(); \nvar Hour = date.getHours();\nvar janelaQuartoMaria = global.get(\"janelaQuartoMaria\");\nvar janelaQuartoNedi = global.get(\"janelaQuartoNedi\");\nvar janelaQuartoPai = global.get(\"janelaQuartoPai\");\nvar janelaSala = global.get(\"janelaSala\");\nvar chuvaNotifAux = global.get(\"chuvaNotifAux\");\nif(janelaQuartoMaria === true ||\n    janelaQuartoNedi === true || \n    janelaQuartoPai === true ||\n    janelaSala === true\n){\n    if (Hour > 9 && Hour < 22){\n        if(chuvaNotifAux === false){\n            global.set(\"chuvaNotifAux\", true);\n            return msg;\n        }\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2100,"y":1940,"wires":[["f6b82d7f.4e4bb","3e59019.44ca6fe","3d875b2c.2db814","a18727e7.097b68","dd6f98e5.66aaf8"]]},{"id":"3e59019.44ca6fe","type":"function","z":"d3db5d74.fb8fa","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Chuva\", \"message\": \"Há chance de chover agora e há janelas abertas.\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2370,"y":1920,"wires":[["b5022911.dfe1e8"]]},{"id":"e4ce18a4.6f27c8","type":"function","z":"d3db5d74.fb8fa","name":"Notificação","func":"if(msg.payload === \"home\"){\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \n         message: `Há chance de chover agora e a(s) janela(s) {% if is_state(\"binary_sensor.janela_quarto_maria\", \"on\") -%} do Quarto Maria, {%- endif %} {% if is_state(\"binary_sensor.janela_quarto_nedi\", \"on\") -%} do Quarto Nédi,{%- endif %} {% if is_state(\"binary_sensor.janela_quarto_pai\", \"on\") -%} do Quarto Pai,{%- endif %} {% if is_state(\"binary_sensor.janela_sala\", \"on\") -%} da Sala {%- endif %} está/estão aberta(s)`\n  \n\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2570,"y":1980,"wires":[["4cfc883b.142618"]]},{"id":"b6eccf3b.11e16","type":"function","z":"d3db5d74.fb8fa","name":"Notificação","func":"if(msg.payload === \"home\"){\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_macbook_pro_de_nedison\",\n    data:{\n        \n           \n         message: `Há chance de chover agora e a(s) janela(s) {% if is_state(\"binary_sensor.janela_quarto_maria\", \"on\") -%} do Quarto Maria, {%- endif %} {% if is_state(\"binary_sensor.janela_quarto_nedi\", \"on\") -%} do Quarto Nédi,{%- endif %} {% if is_state(\"binary_sensor.janela_quarto_pai\", \"on\") -%} do Quarto Pai,{%- endif %} {% if is_state(\"binary_sensor.janela_sala\", \"on\") -%} da Sala {%- endif %} está/estão aberta(s)`\n  \n  \n\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"x":2570,"y":2040,"wires":[["160fe6cf.d20ae9"]]},{"id":"ba4f2035.9e641","type":"function","z":"d3db5d74.fb8fa","name":"Notificação","func":"if(msg.payload === \"home\"){\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_softcelular\",\n    data:{\n        \n           \n         message: `Há chance de chover agora e a(s) janela(s) {% if is_state(\"binary_sensor.janela_quarto_maria\", \"on\") -%} do Quarto Maria, {%- endif %} {% if is_state(\"binary_sensor.janela_quarto_nedi\", \"on\") -%} do Quarto Nédi,{%- endif %} {% if is_state(\"binary_sensor.janela_quarto_pai\", \"on\") -%} do Quarto Pai,{%- endif %} {% if is_state(\"binary_sensor.janela_sala\", \"on\") -%} da Sala {%- endif %} está/estão aberta(s)`\n  \n  \n\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"x":2570,"y":2100,"wires":[["e89dafc8.93efc"]]},{"id":"391eeadd.0a78d6","type":"function","z":"d3db5d74.fb8fa","name":"Notificação","func":"if(msg.payload === \"home\"){\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_maria_s_iphone\",\n    data:{\n        \n      \n         message: `Há chance de chover agora e a(s) janela(s) {% if is_state(\"binary_sensor.janela_quarto_maria\", \"on\") -%} do Quarto Maria, {%- endif %} {% if is_state(\"binary_sensor.janela_quarto_nedi\", \"on\") -%} do Quarto Nédi,{%- endif %} {% if is_state(\"binary_sensor.janela_quarto_pai\", \"on\") -%} do Quarto Pai,{%- endif %} {% if is_state(\"binary_sensor.janela_sala\", \"on\") -%} da Sala {%- endif %} está/estão aberta(s)`\n  \n\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"x":2570,"y":2160,"wires":[["96d328b3.543e68"]]},{"id":"11700620.30430a","type":"inject","z":"859b066a.dd8128","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1130,"y":1580,"wires":[["df7f6951.f1f2f8"]]},{"id":"51fa6e7f.a5e2f","type":"link in","z":"859b066a.dd8128","name":"Botao Quarto","links":["c1f2906e.f1bc6","7f6d2d52.017e94"],"x":1115,"y":900,"wires":[["3d5c7efc.6f1112"]]},{"id":"3d5c7efc.6f1112","type":"function","z":"859b066a.dd8128","name":"Reset","func":"\nreturn {reset: 1};","outputs":1,"noerr":0,"x":1200,"y":920,"wires":[["4a3016b4.a521c8"]]},{"id":"f2c4c73c.d2fef8","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2210,"y":300,"wires":[]},{"id":"c6329c13.8e51a","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":660,"y":1320,"wires":[["95d42658.d910a8"]]},{"id":"a81304dc.ed1408","type":"inject","z":"7b0de646.c85c78","d":true,"name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"04 10 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":270,"y":2440,"wires":[["63d3e63.7cb6f18"]]},{"id":"8180ca54.706518","type":"function","z":"7b0de646.c85c78","name":"Play in Echo Dot","func":"for(var i = 0; i < msg.payload.devices.length; i++){\n    if(msg.payload.devices[i].name === \"Echo Dot do Quarto Nédi\" ||\n    msg.payload.devices[i].name === \"Amazon FireTV Stick Gen 2 ♘\" ||\n    msg.payload.devices[i].name === \"Fire TV Mano\" ||\n    msg.payload.devices[i].name === \"8105abdc-7d9f-419e-b855-a3075760c47c\"\n    ){\n        msg.params = [ {deviceIds: [msg.payload.devices[i].id], play: 'true'} ]; \n        return msg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1270,"y":2500,"wires":[["dfd63bec.abecd8","39b352c7.4b2f3e","532d45.1ad952bc"]]},{"id":"dfd63bec.abecd8","type":"spotify","z":"7b0de646.c85c78","name":"","auth":"3b9d50b6.bca4e","api":"transferMyPlayback","x":1510,"y":2540,"wires":[[]]},{"id":"7063225c.fb96cc","type":"spotify","z":"7b0de646.c85c78","name":"","auth":"3b9d50b6.bca4e","api":"play","x":1220,"y":2620,"wires":[[]]},{"id":"c051aae0.0977a8","type":"function","z":"7b0de646.c85c78","name":"Play 2021/1","func":"msg.params = [ {context_uri: \"spotify:playlist:3szB690Xq6L24GyDRfkk7W\"} ]; \nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1040,"y":2580,"wires":[["7063225c.fb96cc","a9858188.21d7c"]]},{"id":"386e1711.812158","type":"spotify","z":"7b0de646.c85c78","name":"Shuffle","auth":"3b9d50b6.bca4e","api":"setShuffle","x":1020,"y":2660,"wires":[[]]},{"id":"3eec978e.67c008","type":"function","z":"7b0de646.c85c78","name":"Set Shuffle","func":"msg.params = [ {state: \"true\"}, \"true\" ]; \nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":840,"y":2620,"wires":[["386e1711.812158","a00845b0.2978f8"]]},{"id":"1fb2f433.413ccc","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"delay","timeout":"4","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":850,"y":2540,"wires":[["c051aae0.0977a8"]]},{"id":"5d874223.5446fc","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":850,"y":2460,"wires":[["bcacc1f7.56127"]]},{"id":"7d6c8c4e.304f14","type":"function","z":"7b0de646.c85c78","name":"Notificação","func":"if(msg.payload === \"home\"){\n    return {payload: true};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":630,"y":2460,"wires":[["3eec978e.67c008","1fb2f433.413ccc","5d874223.5446fc"]]},{"id":"808a5ff8.37167","type":"function","z":"2ea7fd8b.7e0bb2","name":"True?","func":"if(msg.data.attributes.media_title === \"Netflix\" || \nmsg.data.attributes.media_title === \"PrimeVideo\"|| \nmsg.data.attributes.media_title === \"YouTube\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":280,"wires":[["664d1a0d.99fbd4","2f7e965e.742a2a"]]},{"id":"bdaa44f3.e86668","type":"function","z":"2ea7fd8b.7e0bb2","name":"True?","func":"if(msg.payload === \"playing\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":400,"wires":[["2f7e965e.742a2a","72213a3.890f9c4"]]},{"id":"37a840c9.0b82f","type":"function","z":"2ea7fd8b.7e0bb2","name":"True?","func":"if(msg.payload === \"playing\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":340,"wires":[["2f7e965e.742a2a","664d1a0d.99fbd4"]]},{"id":"c5250d18.6422a","type":"function","z":"d67ca66.293d758","name":"Alguém chegou","func":"if(msg.payload === \"on\" || msg.payload === true){\n    var date = new Date();\n    var Hour = date.getHours();\n    if(Hour > 17){\n        return msg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":600,"y":2920,"wires":[["30f8b917.574e16"]]},{"id":"30f8b917.574e16","type":"function","z":"d67ca66.293d758","name":"Turn On","func":"msg.payload =\n    {\n    \"on\": true,\n    \"bri\": 190,\n    \"ct\": 6100\n};    \nglobal.set(\"SalaOnFirstTime\", false);\nglobal.set(\"SalaOn\", true);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":820,"y":2960,"wires":[["7a6c3e.100243c4","c6dd6266.3a7bb","90ff44a7.0e0458","ee1dc484.379c48"]]},{"id":"77334325.c1f0bc","type":"function","z":"d67ca66.293d758","name":"Alguém chegou","func":"if(msg.payload === \"on\" || msg.payload === true){\n    var date = new Date();\n    var Hour = date.getHours();\n    if(Hour < 9){\n        return msg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":620,"y":3180,"wires":[["1657b8c3.270107"]]},{"id":"1657b8c3.270107","type":"function","z":"d67ca66.293d758","name":"Turn On","func":"msg.payload =\n    {\n    \"on\": true,\n    \"bri\": 50,\n    \"ct\": 6100\n};    \nglobal.set(\"SalaOnFirstTime\", false);\nglobal.set(\"SalaOn\", true);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":830,"y":3220,"wires":[["96807431.12f6d8","6b0f1615.6cab68","590cfd2d.5bd984","e325813b.ab572"]]},{"id":"bcacc1f7.56127","type":"spotify","z":"7b0de646.c85c78","name":"","auth":"3b9d50b6.bca4e","api":"getMyDevices","x":1040,"y":2480,"wires":[["8180ca54.706518","e8f0f070.a02ca"]]},{"id":"8a61a341.0fa5d","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1040,"y":460,"wires":[["723cac3c.588f44"]]},{"id":"9cbf6d55.4769d","type":"function","z":"4c9c764d.9c4468","name":"Escuro?","func":"if(msg.payload < 20 && msg.payload > 0){\n                global.set(\"salaEscura\", true);\n                node.status({fill:\"green\",shape:\"dot\",text:\"SalaEscura true\"});\n                flow.set(\"triggered\", true);\n                node.send(msg);\n}\nelse if(msg.payload > 200){\n                global.set(\"salaEscura\", false);\n                node.status({fill:\"yellow\",shape:\"dot\",text:\"SalaEscura false\"});\n}\nif(msg.payload < 100 && msg.payload > 0){\n                global.set(\"escritorioEscuro\", true);\n                node.status({fill:\"green\",shape:\"dot\",text:\"EscritorioEscuro true\"});\n                flow.set(\"triggered\", true);\n                node.send(msg);\n}\nelse if(msg.payload > 200){\n                global.set(\"escritorioEscuro\", false);\n                node.status({fill:\"yellow\",shape:\"dot\",text:\"EscritorioEscuro false\"});\n}\n\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":740,"y":260,"wires":[["55f5a77a.253908"]]},{"id":"676b28e4.047048","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":580,"y":260,"wires":[["9cbf6d55.4769d","b3299f65.933ab"]]},{"id":"52ed3553.1f2cec","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":400,"y":260,"wires":[["676b28e4.047048"]]},{"id":"b3299f65.933ab","type":"function","z":"4c9c764d.9c4468","name":"Escuro?","func":"if(msg.payload < 50 && msg.payload > 0){\n                node.send(msg);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":740,"y":220,"wires":[[]]},{"id":"6930c113.943ca","type":"inject","z":"c3fa9bdb.b5c4c8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"15 13 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":210,"y":280,"wires":[["6bddf58.ebf350c"]]},{"id":"ac33d5bc.aa8068","type":"function","z":"c3fa9bdb.b5c4c8","name":"Maria?","func":"if(msg.payload === \"Maria\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":280,"wires":[["d8e4a705.032dd8","c49430f1.7a9de"]]},{"id":"5a987bdb.ac6c04","type":"function","z":"c3fa9bdb.b5c4c8","name":"Nédi?","func":"if(msg.payload === \"Nédi\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":500,"wires":[["5de58fdc.3fc5","c260a8a7.ca5ef8","6f4f7ebb.dd5ee","e790e9be.717668"]]},{"id":"68714b3e.4ccae4","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pai?","func":"if(msg.payload === \"Cristofer\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":340,"wires":[["2215441c.54d72c","ff5115c0.b26c68"]]},{"id":"6f4f7ebb.dd5ee","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Louça\", \"message\": \"Hoje é seu dia de lavar a louça\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"x":1150,"y":460,"wires":[["3ed4d074.96f81"]]},{"id":"c260a8a7.ca5ef8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_macbook_pro_de_nedison\",\n    data:{\n        \n\n         message: 'Hoje é seu dia de lavar a louça'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":580,"wires":[["af726ffe.24617"]]},{"id":"5de58fdc.3fc5","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \n  \n         message: 'Hoje é seu dia de lavar a louça'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":520,"wires":[["724baa3f.406c04"]]},{"id":"2215441c.54d72c","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_softcelular\",\n    data:{\n        \n         message: 'Hoje é seu dia de lavar a louça'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":340,"wires":[["9e1eb3c4.3e713"]]},{"id":"d8e4a705.032dd8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\nnewMsg= {payload : {\n\"domain\": \"notify\",\n\"service\": \"mobile_app_maria_s_iphone\",\ndata:{\n        \n         message: 'Hoje é seu dia de lavar a louça'\n  }\n}};\nreturn newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":280,"wires":[["c7ed63b7.74073"]]},{"id":"d9713983.882208","type":"inject","z":"c3fa9bdb.b5c4c8","d":true,"name":"","repeat":"","crontab":"00 18 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":550,"y":2960,"wires":[["6d293ca8.24be74"]]},{"id":"b91e061a.d39408","type":"function","z":"c3fa9bdb.b5c4c8","name":"Quantos dias?","func":"if(msg.payload != \"0.0\" && msg.payload != \"1.0\" && msg.payload != \"2.0\"){\n    global.set(\"diasSemLavarARoupa\", msg.payload);\n    return msg;\n}","outputs":1,"noerr":0,"x":1000,"y":2960,"wires":[["853118a2.875f38"]]},{"id":"a95e112b.38c53","type":"function","z":"c3fa9bdb.b5c4c8","name":"Maria?","func":"if(msg.payload === \"Maria\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1470,"y":2960,"wires":[["78918ff8.9914","b2a83312.9c275"]]},{"id":"95ade173.f04fe","type":"function","z":"c3fa9bdb.b5c4c8","name":"Nédi?","func":"if(msg.payload === \"Nédi\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1470,"y":3180,"wires":[["d50ff1d0.f48fd","f657f353.86dad","2c93691d.b8b696","26812f11.fb543"]]},{"id":"374c7c18.47d7a4","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pai?","func":"if(msg.payload === \"Cristofer\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1470,"y":3020,"wires":[["dbe6559.6453da8","f83db5ad.07d688"]]},{"id":"2c93691d.b8b696","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Louça\", \"message\": \"Hoje é seu dia de lavar a roupa. Já fazem mais de três dias que não são lavadas.\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"x":1710,"y":3140,"wires":[["90077918.20bc78"]]},{"id":"f657f353.86dad","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_macbook_pro_de_nedison\",\n    data:{\n        \n\n         message: 'Hoje é seu dia de lavar a roupa. Já fazem mais de '+ String(parseInt(global.get(\"diasSemLavarARoupa\")))+ ' dias que não são lavadas.'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1710,"y":3260,"wires":[["cfee3ce7.24f6c"]]},{"id":"d50ff1d0.f48fd","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \n  \n         message: 'Hoje é seu dia de lavar a roupa. Já fazem mais de '+ String(parseInt(global.get(\"diasSemLavarARoupa\")))+ ' dias que não são lavadas.'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1710,"y":3200,"wires":[["cb3cd3e5.3ec49"]]},{"id":"dbe6559.6453da8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_softcelular\",\n    data:{\n        \n         message: 'Hoje é seu dia de lavar a roupa. Já fazem mais de'+ String(parseInt(global.get(\"diasSemLavarARoupa\")))+ ' dias que não são lavadas.'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1710,"y":3020,"wires":[["36312c40.f34eb4"]]},{"id":"78918ff8.9914","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\nnewMsg= {payload : {\n\"domain\": \"notify\",\n\"service\": \"mobile_app_maria_s_iphone\",\ndata:{\n        \n         message: 'Hoje é seu dia de lavar a roupa. Já fazem mais de '+ String(parseInt(global.get(\"diasSemLavarARoupa\")))+ ' dias que não são lavadas.'\n  }\n}};\nreturn newMsg;\n","outputs":1,"noerr":0,"x":1710,"y":2960,"wires":[["562c2738.d5d178"]]},{"id":"ef780a63.9a8708","type":"inject","z":"c3fa9bdb.b5c4c8","d":true,"name":"","repeat":"","crontab":"00 19 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":550,"y":3500,"wires":[["92be78b6.fbb388"]]},{"id":"ebbfc12d.075ab","type":"function","z":"c3fa9bdb.b5c4c8","name":"Quantos dias?","func":"if(msg.payload != \"0.0\" && msg.payload != \"1.0\" && msg.payload != \"2.0\"){\n    global.set(\"diasSemLevarOLixo\", msg.payload);\n    return msg;\n}","outputs":1,"noerr":0,"x":1000,"y":3500,"wires":[["ef75412c.fa12d"]]},{"id":"70f8b4e8.f374ac","type":"function","z":"c3fa9bdb.b5c4c8","name":"Maria?","func":"if(msg.payload === \"Maria\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1470,"y":3500,"wires":[["19761596.e1f28a","a1313278.12632"]]},{"id":"4ec9d9a3.39fd98","type":"function","z":"c3fa9bdb.b5c4c8","name":"Nédi?","func":"if(msg.payload === \"Nédi\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1470,"y":3720,"wires":[["b40172ef.83dc5","2b9a4596.79daea","fe9ad91a.8b4fd8","ed51ac4c.90dbc"]]},{"id":"3d17cc07.1064b4","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pai?","func":"if(msg.payload === \"Cristofer\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1470,"y":3560,"wires":[["e8524f68.bf053","b829a5.308f3658"]]},{"id":"fe9ad91a.8b4fd8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Louça\", \"message\": \"Hoje é seu dia de levar o lixo. Já fazem mais de três dias que não são lavadas.\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"x":1710,"y":3680,"wires":[["17191daa.11b972"]]},{"id":"2b9a4596.79daea","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_macbook_pro_de_nedison\",\n    data:{\n        \n\n          message: 'Hoje é seu dia de levar o lixo. Já fazem mais de '+ String(parseInt(global.get(\"diasSemLevarOLixo\")))+ ' dias que o lixo não é levado.'\n \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1710,"y":3800,"wires":[["f651923f.adf3"]]},{"id":"b40172ef.83dc5","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \n  \n         message: 'Hoje é seu dia de levar o lixo. Já fazem mais de '+ String(parseInt(global.get(\"diasSemLevarOLixo\")))+ ' dias que o lixo não é levado.'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1710,"y":3740,"wires":[["e800b86b.ae0198"]]},{"id":"e8524f68.bf053","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_softcelular\",\n    data:{\n        \n         message: 'Hoje é seu dia de levar o lixo. Já fazem mais de '+ String(parseInt(global.get(\"diasSemLevarOLixo\")))+ ' dias que o lixo não é levado.'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1710,"y":3560,"wires":[["72bafa5e.611894"]]},{"id":"19761596.e1f28a","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\nnewMsg= {payload : {\n\"domain\": \"notify\",\n\"service\": \"mobile_app_maria_s_iphone\",\ndata:{\n        \n         message: 'Hoje é seu dia de levar o lixo. Já fazem mais de '+ String(parseInt(global.get(\"diasSemLevarOLixo\")))+ ' dias que o lixo não é levado.'\n  }\n}};\nreturn newMsg;\n","outputs":1,"noerr":0,"x":1710,"y":3500,"wires":[["cbd6f6e7.574348"]]},{"id":"3d5a35ba.7fd82a","type":"function","z":"c3fa9bdb.b5c4c8","name":"Maria?","func":"if(msg.payload === \"Maria\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1290,"y":4020,"wires":[["882310cc.40d48","669f4194.5e245"]]},{"id":"95918114.2ca78","type":"function","z":"c3fa9bdb.b5c4c8","name":"Nédi?","func":"if(msg.payload === \"Nédi\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1290,"y":4240,"wires":[["9bc85a26.713fd8","e01adce8.f3fcb","ad4e84e6.86bb88","bd2043b.25187c"]]},{"id":"4bc56fc6.d158e","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pai?","func":"if(msg.payload === \"Cristofer\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1290,"y":4080,"wires":[["24252baf.4e77e4","65ca6d3e.6c6414"]]},{"id":"ad4e84e6.86bb88","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Louça\", \"message\": \"A roupa já deve estar seca.\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"x":1530,"y":4200,"wires":[["4ab79159.2d5a9"]]},{"id":"e01adce8.f3fcb","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_macbook_pro_de_nedison\",\n    data:{\n        \n\n        \n         message: 'A roupa já deve estar seca'\n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1530,"y":4320,"wires":[["dec70c72.9e0d3"]]},{"id":"9bc85a26.713fd8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \n  \n         \n         message: 'A roupa já deve estar seca'\n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1530,"y":4260,"wires":[["68d446ac.aa3e78"]]},{"id":"24252baf.4e77e4","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_softcelular\",\n    data:{\n        \n         \n         message: 'A roupa já deve estar seca'\n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1530,"y":4080,"wires":[["8b585c69.df8bd"]]},{"id":"882310cc.40d48","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\nnewMsg= {payload : {\n\"domain\": \"notify\",\n\"service\": \"mobile_app_maria_s_iphone\",\ndata:{\n        \n         message: 'A roupa já deve estar seca'\n  }\n}};\nreturn newMsg;\n","outputs":1,"noerr":0,"x":1530,"y":4020,"wires":[["7300173c.056218"]]},{"id":"e687ec1.d1d911","type":"function","z":"c3fa9bdb.b5c4c8","name":"Seca?","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"x":790,"y":4020,"wires":[["212aa61a.89a2da"]]},{"id":"ff8f90a2.6bc01","type":"function","z":"c3fa9bdb.b5c4c8","name":"Maria?","func":"if(msg.payload === \"Maria\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1310,"y":4600,"wires":[["d086227f.8949b","a563d3b7.22322"]]},{"id":"7692d52d.7a6a2c","type":"function","z":"c3fa9bdb.b5c4c8","name":"Nédi?","func":"if(msg.payload === \"Nédi\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1310,"y":4820,"wires":[["b37dd6ab.62c888","821cfa2f.85c998","9ac12349.76188","5e405b73.b1cb44"]]},{"id":"48db8584.442dac","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pai?","func":"if(msg.payload === \"Cristofer\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1310,"y":4660,"wires":[["344947c8.88c368","26249e87.c4bb52"]]},{"id":"9ac12349.76188","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Louça\", \"message\": \"A roupa já deve estar seca.\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"x":1550,"y":4780,"wires":[["1804bb95.24e424"]]},{"id":"821cfa2f.85c998","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_macbook_pro_de_nedison\",\n    data:{\n        \n\n        \n         message: 'As roupas estão prontas na máquina.'\n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1550,"y":4900,"wires":[["8d9bf81f.2ea748"]]},{"id":"b37dd6ab.62c888","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \n  \n         \n         message: 'As roupas estão prontas na máquina.'\n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1550,"y":4840,"wires":[["64ea7cd7.760784"]]},{"id":"344947c8.88c368","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_softcelular\",\n    data:{\n        \n         \n         message: 'As roupas estão prontas na máquina.'\n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1550,"y":4660,"wires":[["4a49619b.b11d6"]]},{"id":"d086227f.8949b","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\nnewMsg= {payload : {\n\"domain\": \"notify\",\n\"service\": \"mobile_app_maria_s_iphone\",\ndata:{\n        \n         message: 'As roupas estão prontas na máquina.'\n  }\n}};\nreturn newMsg;\n","outputs":1,"noerr":0,"x":1550,"y":4600,"wires":[["b5d7e180.ae7d3"]]},{"id":"ea5f6616.e4e2c8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pronto?","func":"if(msg.payload === \"Pronto\"){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":4600,"wires":[["21ff783.0175288"]]},{"id":"5b272ae3.79d454","type":"inject","z":"859b066a.dd8128","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 23 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":330,"y":3040,"wires":[["d8661a64.1e9758"]]},{"id":"868ffa70.694c68","type":"function","z":"859b066a.dd8128","name":"Hot?","func":"if(msg.payload > 25){\n    var newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"switch.flor\"\n        }\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1010,"y":3040,"wires":[["750e76aa.199378"]]},{"id":"9c93669e.1ad888","type":"function","z":"859b066a.dd8128","name":"Home?","func":"if(msg.payload === \"home\"){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":670,"y":3040,"wires":[["a746ccf6.359e4"]]},{"id":"4613fa06.873564","type":"comment","z":"859b066a.dd8128","name":"Liga o ventilador antes de ir dormir se tiver em casa e quente","info":"","x":450,"y":2960,"wires":[]},{"id":"3131595f.58bac6","type":"function","z":"d3db5d74.fb8fa","name":"Botão Cozinha Click","func":"if(msg.topic === \"sensor.botao_cozinha_action_2\" && msg.payload === \"single\"){\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":540,"y":2840,"wires":[[]]},{"id":"1b17d0d9.4f785f","type":"function","z":"d3db5d74.fb8fa","name":"Botão Cozinha Double","func":"if(msg.topic === \"sensor.botao_cozinha_action_2\" && msg.payload === \"double\"){\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"x":540,"y":2880,"wires":[[]]},{"id":"ebeebd66.a6613","type":"debug","z":"d3db5d74.fb8fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":500,"y":2800,"wires":[]},{"id":"2c8c1735.30eb58","type":"function","z":"d3db5d74.fb8fa","name":"Botão Cozinha","func":"if(msg.topic === \"sensor.botao_cozinha_battery_2\"){\n    return msg;\n}\n//sensor_switch.aq2\n//nao funciona direito, manda o estado da bateria em vez do click","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":2920,"wires":[[]]},{"id":"73006d69.524894","type":"inject","z":"859b066a.dd8128","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1200,"y":760,"wires":[[]]},{"id":"1b42668a.8123a9","type":"trigger","z":"859b066a.dd8128","name":"","op1":"1","op2":"0","op1type":"num","op2type":"str","duration":"-250","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":3030,"y":240,"wires":[["e294467e.db1708"]]},{"id":"f68bd53d.9d4a18","type":"function","z":"859b066a.dd8128","name":"Aux Function","func":"flow.set(\"iterLuzDoQuartoInc\", 20);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2820,"y":240,"wires":[["1b42668a.8123a9"]]},{"id":"5b3cbd6e.8fb344","type":"function","z":"859b066a.dd8128","name":"Aux Function","func":"flow.set(\"iterLuzDoQuartoInc\", 200);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2820,"y":320,"wires":[["ed05dc81.78be5"]]},{"id":"ed05dc81.78be5","type":"trigger","z":"859b066a.dd8128","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-250","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":3030,"y":320,"wires":[["b6213a32.33a3d8"]]},{"id":"7f96e993.e00fc8","type":"trigger","z":"859b066a.dd8128","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-250","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":2630,"y":420,"wires":[["789012b.2d71cec"]]},{"id":"789012b.2d71cec","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"4","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2840,"y":420,"wires":[["d79abb8.dc3fc48"]]},{"id":"c649377c.e77e58","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3380,"y":180,"wires":[]},{"id":"43510f05.df61f","type":"function","z":"859b066a.dd8128","name":"Turn On 100%","func":"var i = parseInt(flow.get(\"iterLuzDoQuartoInc\"));\nvar newMsg;\nif (i > 255) {    \n    newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.luz_do_quarto_nedi\",\n                \"brightness\": 255,\n                \"rgb_color\": [255, 255, 255]\n            }\n    }};    \n    node.send(newMsg);\n        return {reset: 1};\n}\nnewMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.luz_do_quarto_nedi\",\n                \"brightness\": i,\n                \"rgb_color\": [i, i, i]\n            }\n}};    \ni += 50\nflow.set(\"iterLuzDoQuartoInc\", i);\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2088,"y":1780,"wires":[["2072682.049cf98"]]},{"id":"8fd7d816.0f6e08","type":"trigger","z":"859b066a.dd8128","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-250","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":1888,"y":1780,"wires":[["43510f05.df61f"]]},{"id":"4ebded05.27faf4","type":"function","z":"859b066a.dd8128","name":"Aux Function","func":"flow.set(\"iterLuzDoQuartoInc\", 20);\nreturn msg;","outputs":1,"noerr":0,"x":1678,"y":1780,"wires":[["8fd7d816.0f6e08"]]},{"id":"8d8e3f4d.4c6b9","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"4","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2420,"y":1780,"wires":[["655f3b49.057eb4"]]},{"id":"dd43b66b.484888","type":"function","z":"859b066a.dd8128","name":"Turn On 100%","func":"var i = parseInt(flow.get(\"iterLuzDoQuartoInc\"));\nvar newMsg;\nif (i > 255) {\n    newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.luz_do_quarto_nedi\",\n                \"brightness\": 255,\n                \"rgb_color\": [255, 255, 255]\n            }\n    }};    \n    node.send(newMsg);\n    return {reset: true};\n}\nnewMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.luz_do_quarto_nedi\",\n                \"brightness\": i,\n                \"rgb_color\": [i, i, i]\n            }\n}};    \ni += 30\nflow.set(\"iterLuzDoQuartoInc\", i);\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3360,"y":1700,"wires":[["9f8b8f6a.6b8bd"]]},{"id":"249af0e9.8a084","type":"trigger","z":"859b066a.dd8128","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-250","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":3160,"y":1700,"wires":[["dd43b66b.484888"]]},{"id":"df106a4d.b38fe8","type":"function","z":"859b066a.dd8128","name":"Aux Function","func":"flow.set(\"iterLuzDoQuartoInc\", 20);\nreturn msg;","outputs":1,"noerr":0,"x":2950,"y":1700,"wires":[["249af0e9.8a084"]]},{"id":"8c935f1a.2982b","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"4","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3900,"y":1700,"wires":[["df583e49.c659f"]]},{"id":"335714c2.05618c","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var i = parseInt(flow.get(\"iterLuzDoQuartoDec\"));\nif (i <= 0) {      \n        newMsg= {payload : {        \n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            data:{\n                \"entity_id\": \"light.luz_do_quarto_nedi\"\n            }},reset: true };\n        return newMsg;\n}\nelse{\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n                    \n            \"entity_id\": \"light.luz_do_quarto_nedi\",\n            \"brightness\": i,\n            \"rgb_color\": [i, i, i]\n        }\n        }};\n    if(i < 60){ \n            \n            newMsg= {payload : {\n                \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \"entity_id\": \"light.luz_do_quarto_nedi\",\n                \"brightness\": 0,\n                \"rgb_color\": [0, 0, 0]\n            }\n        }};\n        node.send(newMsg);          \n        newMsg= {payload : {        \n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            data:{\n                \"entity_id\": \"light.luz_do_quarto_nedi\"\n            }}};\n    }\n}\ni-= 50\n        \nflow.set(\"iterLuzDoQuartoDec\", i);\nreturn newMsg;","outputs":1,"noerr":0,"x":3560,"y":1620,"wires":[["dd0fda98.cc8b48"]]},{"id":"8e3a6c64.6eb63","type":"trigger","z":"859b066a.dd8128","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-250","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":3380,"y":1620,"wires":[["335714c2.05618c"]]},{"id":"9a840250.37c4f","type":"function","z":"859b066a.dd8128","name":"Aux Function","func":"if(msg.payload === \"on\"){\n    flow.set(\"iterLuzDoQuartoDec\", parseInt(msg.data.attributes.brightness));\n    return msg;\n}","outputs":1,"noerr":0,"x":3170,"y":1620,"wires":[["8e3a6c64.6eb63"]]},{"id":"bbfced5e.c9152","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var i = parseInt(flow.get(\"iterLuzDoQuartoDec\"));\nif (i <= 0) {    \n        newMsg= {payload : {        \n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            data:{\n                \"entity_id\": \"light.luz_do_quarto_nedi\"\n            }},reset: true };\n        return newMsg;\n}\nelse{\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n                    \n            \"entity_id\": \"light.luz_do_quarto_nedi\",\n            \"brightness\": i,\n            \"rgb_color\": [i, i, i]\n        }\n        }};\n    if(i < 40){ \n            \n            newMsg= {payload : {\n                \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \"entity_id\": \"light.luz_do_quarto_nedi\",\n                \"brightness\": 0,\n                \"rgb_color\": [0, 0, 0]\n            }\n        }};\n        node.send(newMsg);          \n        newMsg= {payload : {        \n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            data:{\n                \"entity_id\": \"light.luz_do_quarto_nedi\"\n            }}};\n    }\n}\ni-= 30\n        \nflow.set(\"iterLuzDoQuartoDec\", i);\nreturn newMsg;","outputs":1,"noerr":0,"x":1460,"y":2620,"wires":[["2f597e48.8a45c2"]]},{"id":"f616efae.e6096","type":"trigger","z":"859b066a.dd8128","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-500","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":1280,"y":2620,"wires":[["bbfced5e.c9152"]]},{"id":"21abaed9.616a12","type":"function","z":"859b066a.dd8128","name":"Aux Function","func":"if(msg.payload === \"on\"){\n    flow.set(\"iterLuzDoQuartoDec\", parseInt(msg.data.attributes.brightness));\n    return msg;\n}","outputs":1,"noerr":0,"x":1070,"y":2620,"wires":[["f616efae.e6096"]]},{"id":"18d7ad9f.bc36c2","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var i = parseInt(flow.get(\"iterFitaDoQuartoDec\"));\nif (i <= 0) {    \n        newMsg= {payload : {\"On\":false},reset: true };\n        return newMsg;\n}\nelse{\n            newMsg= {payload : {\"On\":true,\n                    \"Brightness\": i,     \n                    \"Hue\": 174,\n                    \"Saturation\": 100 }};\n            if(i < 30){ \n                newMsg= {payload : {\"On\":true,\n                    \"Brightness\": 0,     \n                    \"Hue\": 174,\n                    \"Saturation\": 100 }};\n                node.send(newMsg);   \n                \n                newMsg= {payload : {\"On\":false}};\n            }\n}\ni-= 20\n        \nflow.set(\"iterFitaDoQuartoDec\", i);\nreturn newMsg;","outputs":1,"noerr":0,"x":1460,"y":2800,"wires":[["22e78807.560778"]]},{"id":"3d3a9809.4fd548","type":"trigger","z":"859b066a.dd8128","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-500","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":1280,"y":2800,"wires":[["18d7ad9f.bc36c2"]]},{"id":"864f2f47.bdc12","type":"function","z":"859b066a.dd8128","name":"Aux Function","func":"if(msg.payload.On === true){\n    flow.set(\"iterFitaDoQuartoDec\", parseInt(msg.payload.Brightness));\n    return msg;\n}","outputs":1,"noerr":0,"x":1070,"y":2800,"wires":[["3d3a9809.4fd548"]]},{"id":"5fb1b5ca.290c7c","type":"function","z":"859b066a.dd8128","d":true,"name":"Aux Function","func":"if(msg.payload.On === true){\n    flow.set(\"iterFitaDoQuartoDec\", parseInt(msg.payload.Brightness));\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3130,"y":1240,"wires":[["e7c68e7c.8929a"]]},{"id":"e7c68e7c.8929a","type":"trigger","z":"859b066a.dd8128","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-500","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":3340,"y":1240,"wires":[["f0adbc91.c5088"]]},{"id":"f0adbc91.c5088","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var i = parseInt(flow.get(\"iterFitaDoQuartoDec\"));\nif (i <= 0) {    \n        newMsg= {payload : {\"On\":false},reset: true };\n        return newMsg;\n}\nelse{\n            newMsg= {payload : {\"On\":true,\n                    \"Brightness\": i,     \n                    \"Hue\": i,\n                    \"Saturation\": 0 }};\n            if(i < 30){ \n                newMsg= {payload : {\"On\":true,\n                    \"Brightness\": 0,     \n                    \"Hue\": 0,\n                    \"Saturation\": 0 }};\n                node.send(newMsg);   \n                \n                newMsg= {payload : {\"On\":false}};\n            }\n}\ni-= 50\n        \nflow.set(\"iterFitaDoQuartoDec\", i);\nreturn newMsg;","outputs":1,"noerr":0,"x":3520,"y":1240,"wires":[["f781cb30.af94f8"]]},{"id":"7c0834d7.4a132c","type":"function","z":"859b066a.dd8128","name":"Aux Function","func":"if(msg.payload.On === true){\n    flow.set(\"iterFitaDoQuartoDec\", 20);\n    return msg;\n}","outputs":1,"noerr":0,"x":1650,"y":1000,"wires":[["dc0bdca1.80197"]]},{"id":"dc0bdca1.80197","type":"trigger","z":"859b066a.dd8128","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-250","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":1860,"y":1000,"wires":[["ee960c9d.3cd3a"]]},{"id":"ee960c9d.3cd3a","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var i = parseInt(flow.get(\"iterFitaDoQuartoDec\"));\nif (i <= 0) {    \n        newMsg= {payload : {\"On\":false},reset: true};\n        return newMsg;\n}\nelse{\n            newMsg= {payload : {\"On\":true,\n                    \"Brightness\": i,     \n                    \"Hue\": 174,\n                    \"Saturation\": 100 }};\n            if(i < 30){ \n                newMsg= {payload : {\"On\":true,\n                    \"Brightness\": 0,     \n                    \"Hue\": 174,\n                    \"Saturation\": 100 }};\n                node.send(newMsg);   \n                \n                flow.set(\"iterFitaDoQuartoDec\", 0);    \n                newMsg= {payload : {\"On\":false},reset: 1 };\n            }\n}\ni--\n        \nflow.set(\"iterFitaDoQuartoDec\", i);\nreturn newMsg;","outputs":1,"noerr":0,"x":2040,"y":1000,"wires":[["908e30b.b7589d"]]},{"id":"8187005c.34453","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2390,"y":1000,"wires":[["42cbbce1.6a1f94"]]},{"id":"224721c2.f5b2ce","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var i = parseInt(flow.get(\"iterLuzDoQuartoDec\"));\nif (i <= 0) {    \n        newMsg= {payload : {        \n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            data:{\n                \"entity_id\": \"light.luz_do_quarto_nedi\"\n            }},reset: true };\n        return newMsg;\n}\nelse{\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_nedi\",\n            \"brightness\": parseInt(i/13),\n            \"rgb_color\": [i, parseInt(i/2), 0]\n        }\n    }};\n    if(i < 25){ \n        \n        newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.luz_do_quarto_nedi\",\n                \"brightness\": 0,\n                \"rgb_color\": [0, 0, 0]\n            }\n        }};\n        node.send(newMsg);          \n        flow.set(\"iterLuzDoQuartoDec\", 0);    \n        newMsg= {payload : {        \n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            data:{\n                \"entity_id\": \"light.luz_do_quarto_nedi\"\n            }},reset: 1 };\n    }\n}\n\ni-= 30\n        \nflow.set(\"iterLuzDoQuartoDec\", i);\nreturn newMsg;","outputs":1,"noerr":0,"x":2040,"y":920,"wires":[["3818936e.ad3ecc"]]},{"id":"d5a552ec.f49fe","type":"trigger","z":"859b066a.dd8128","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-500","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":1860,"y":920,"wires":[["224721c2.f5b2ce"]]},{"id":"cb05467a.0397d8","type":"function","z":"859b066a.dd8128","name":"Aux Function","func":"if(msg.payload === \"on\"){\n    flow.set(\"iterLuzDoQuartoDec\",255);\n    return msg;\n}","outputs":1,"noerr":0,"x":1650,"y":920,"wires":[["d5a552ec.f49fe"]]},{"id":"69cb7dbd.243a34","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2390,"y":920,"wires":[["7c8962c4.d668fc"]]},{"id":"ffafb4e0.f0f8f8","type":"trigger","z":"859b066a.dd8128","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-250","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":1620,"y":720,"wires":[["92b1356a.9d8308"]]},{"id":"92b1356a.9d8308","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nvar i = parseInt(flow.get(\"iterFitaDoQuartoInc\"));\nif(Hour > 10 && Hour < 21){\n    aux = 255;\n    auxInc = 30;\n}\nif(Hour <= 10 || Hour >= 21){\n    aux = 150;\n    auxInc = 20;\n}\n\nif (i > 20) { \n    return {reset: true} ;\n}\nvar newMsg;\n//var timerId = setInterval(function check() {\n//    newMsg= {payload : {\"On\":true,\n//            \"Brightness\": i,     \n//            \"Hue\": 174,\n//            \"Saturation\": 100 }};\n//    node.send(newMsg);\n//    i = i + auxInc; \n//    if (i > aux) { \n//        clearInterval(check);\n//        return;\n//    }\n//} , 250);\n\nnewMsg= {payload : {\"On\":true,\n        \"Brightness\": i,     \n        \"Hue\": 174,\n        \"Saturation\": 100 }};\ni += 5\n    \nflow.set(\"iterFitaDoQuartoInc\", i);\nreturn newMsg;","outputs":1,"noerr":0,"x":1820,"y":720,"wires":[["3a9a7920.b4b246"]]},{"id":"b381d7bd.8b3f58","type":"function","z":"859b066a.dd8128","name":"Turn On Bright","func":"var i = parseInt(flow.get(\"iterLuzDoQuartoInc\"));\nif (i > 255) {\n        return {reset: true};\n}\nvar newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_nedi\",\n            \"brightness\": parseInt(i/15),\n            \"rgb_color\": [255, 150, 0]\n        }\n    }};\ni += 30\nflow.set(\"iterLuzDoQuartoInc\", i);\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1840,"y":820,"wires":[["b47006a0.2b0608"]]},{"id":"46d8aad0.89d8a4","type":"trigger","z":"859b066a.dd8128","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-250","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":1640,"y":820,"wires":[["b381d7bd.8b3f58"]]},{"id":"5d191951.232418","type":"function","z":"859b066a.dd8128","name":"Aux Function","func":"flow.set(\"iterLuzDoQuartoInc\", 35);\nreturn msg;","outputs":1,"noerr":0,"x":1430,"y":820,"wires":[["46d8aad0.89d8a4"]]},{"id":"9adbba25.db7a78","type":"function","z":"859b066a.dd8128","name":"Movimento dentro?","func":"if(msg.payload === \"off\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":730,"y":220,"wires":[["830ed247.f6566","6ad71445.4314fc"]]},{"id":"6dae747b.76605c","type":"function","z":"859b066a.dd8128","name":"Movimento dentro?","func":"if(msg.payload === \"off\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":520,"y":760,"wires":[["8f68046c.7fa428"]]},{"id":"81c06c4d.5194b","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nvar i = parseInt(flow.get(\"iterFitaDoQuartoDec\"));\n\n\nif (i > 255) { \n    return {reset: true} ;\n}\nvar newMsg;\n//var timerId = setInterval(function check() {\n//    newMsg= {payload : {\"On\":true,\n//            \"Brightness\": i,     \n//            \"Hue\": 174,\n//            \"Saturation\": 100 }};\n//    node.send(newMsg);\n//    i = i + auxInc; \n//    if (i > aux) { \n//        clearInterval(check);\n//        return;\n//    }\n//} , 250);\n\nnewMsg= {payload : {\"On\":true,\n            \"Brightness\": i,     \n            \"Hue\": i,\n            \"Saturation\": 0 }};\ni = i + 30; \n    \nflow.set(\"iterFitaDoQuartoDec\", i);\nreturn newMsg;","outputs":1,"noerr":0,"x":3520,"y":1300,"wires":[["66da94b0.2f1dec"]]},{"id":"eb5b860e.8074c8","type":"trigger","z":"859b066a.dd8128","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-250","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":3340,"y":1300,"wires":[["81c06c4d.5194b"]]},{"id":"7e122029.95ec1","type":"function","z":"859b066a.dd8128","name":"Aux Function","func":"flow.set(\"iterFitaDoQuartoInc\", 2);\nreturn msg;\n","outputs":1,"noerr":0,"x":2950,"y":1300,"wires":[["eb5b860e.8074c8"]]},{"id":"c14458a8.5a2408","type":"switch","z":"859b066a.dd8128","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":3390,"y":360,"wires":[["941d47c9.5197e8"],["ed05dc81.78be5","66519808.a94bd"]]},{"id":"65f2e1b5.e39a7","type":"switch","z":"859b066a.dd8128","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":3390,"y":280,"wires":[["941d47c9.5197e8"],["1b42668a.8123a9"]]},{"id":"b6b8d224.65ba2","type":"function","z":"d3db5d74.fb8fa","name":"Movimento Quarto Maria","func":"if(msg.payload.entity_id === \"binary_sensor.movimento_quarto_maria\"){\n        var newMsg;\n        newMsg = {payload:{On : true}};\n        return newMsg;\n}\n//sensor_motion.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":1220,"wires":[["d7496dca.caa2f"]]},{"id":"2d1a39fd.73ad86","type":"function","z":"d3db5d74.fb8fa","name":"Movimento Sala","func":"if(msg.payload.entity_id === \"binary_sensor.movimento_sala\"){\n    var newMsg = {payload: {MotionDetected: true}}\n    return newMsg;\n}\n//sensor_motion.aq2","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":980,"wires":[["1f03bb0a.233655"]]},{"id":"1f03bb0a.233655","type":"link out","z":"d3db5d74.fb8fa","name":"Movimento Sala","links":["291b7897.febc08","b3061b2a.42a488"],"x":715,"y":980,"wires":[]},{"id":"d7496dca.caa2f","type":"link out","z":"d3db5d74.fb8fa","name":"Movimento Quarto Maria","links":["a775b02e.913eb"],"x":715,"y":1220,"wires":[]},{"id":"8f9ac090.1149f","type":"link in","z":"2bbba447.a4759c","name":"Movimento Banheiro","links":[],"x":155,"y":800,"wires":[["d6b5f0bc.8c9fa"]]},{"id":"d6b5f0bc.8c9fa","type":"function","z":"2bbba447.a4759c","d":true,"name":"Turn On","func":"//diferentes brightness dependendo da hora\nvar date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nvar newMsg;\nnewMsg = {payload:{}};\nif(Hour === 23){\n        newMsg.payload =\n        {\n        \"on\": true,\n        \"bri\": 50,\n        \"ct\": 5000\n        };\n        global.set(\"isOnBanheiro\", true);\n        \n        node.status({fill:\"green\",shape:\"dot\",text:\"Liga\"});\n        node.send(newMsg);\n        \n}\nif(Hour >= 0 && Hour < 8){\n        newMsg.payload =\n        {\n        \"on\": true,\n        \"bri\": 30,\n        \"ct\": 2500\n        };\n        global.set(\"isOnBanheiro\", true);\n        \n        node.status({fill:\"green\",shape:\"dot\",text:\"Liga\"});\n        node.send(newMsg);\n        \n}\nif((Hour > 17 && Hour < 22) || \n        global.get(\"botaoBanheiro\") === true){\n        global.set(\"botaoBanheiro\", false);\n        global.set(\"isOnBanheiro\", true);\n        newMsg.payload = \n            {\n            \"on\": true,\n            \"bri\": 255,\n            \"ct\": 6200\n            \n};\nnode.status({fill:\"green\",shape:\"dot\",text:\"Liga\"});\nnode.send(newMsg);\n\nsetTimeout(function(){\n            node.status({text:\"\"});\n            }, 15000);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":280,"y":800,"wires":[["71edec0.93a0814","6aed7577.2179ac","e4ec042f.948798"]]},{"id":"6aed7577.2179ac","type":"function","z":"2bbba447.a4759c","name":"Delay + 20 min","func":"msg.delay = 1200000;\nreturn msg;","outputs":1,"noerr":0,"x":460,"y":880,"wires":[["3f7ad307.04971c"]]},{"id":"3f7ad307.04971c","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"delayv","timeout":"20","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":640,"y":880,"wires":[["16d5dc37.bf8364"]]},{"id":"120b8090.260cef","type":"function","z":"2bbba447.a4759c","name":"Turn Off","func":"if(msg.payload === \"off\"){\n    var newMsg;\n    newMsg = { payload : {\"on\":false}, ajuda : false};\n    return newMsg;   \n}\nelse{\n    return {ajuda: true};\n}","outputs":1,"noerr":0,"x":1060,"y":880,"wires":[["f64ae584.fb0c68"]]},{"id":"c105b94f.0b66f8","type":"switch","z":"859b066a.dd8128","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":3180,"y":480,"wires":[["8fed1c7f.b1c9f"],["7f96e993.e00fc8"]]},{"id":"3a9a7920.b4b246","type":"switch","z":"859b066a.dd8128","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":1980,"y":760,"wires":[["97d95d14.37082"],["ffafb4e0.f0f8f8"]]},{"id":"b47006a0.2b0608","type":"switch","z":"859b066a.dd8128","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":2000,"y":860,"wires":[["8a236524.1c4328"],["46d8aad0.89d8a4"]]},{"id":"3818936e.ad3ecc","type":"switch","z":"859b066a.dd8128","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":2200,"y":960,"wires":[["69cb7dbd.243a34"],["d5a552ec.f49fe"]]},{"id":"908e30b.b7589d","type":"switch","z":"859b066a.dd8128","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":2200,"y":1040,"wires":[["8187005c.34453"],["dc0bdca1.80197"]]},{"id":"66da94b0.2f1dec","type":"switch","z":"859b066a.dd8128","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":3660,"y":1360,"wires":[["fc2d90d4.5482"],["eb5b860e.8074c8"]]},{"id":"f781cb30.af94f8","type":"switch","z":"859b066a.dd8128","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":3660,"y":1280,"wires":[["fc2d90d4.5482"],["e7c68e7c.8929a"]]},{"id":"dd0fda98.cc8b48","type":"switch","z":"859b066a.dd8128","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":3700,"y":1660,"wires":[["8c935f1a.2982b"],["8e3a6c64.6eb63"]]},{"id":"9f8b8f6a.6b8bd","type":"switch","z":"859b066a.dd8128","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":3520,"y":1760,"wires":[["8c935f1a.2982b"],["249af0e9.8a084"]]},{"id":"2072682.049cf98","type":"switch","z":"859b066a.dd8128","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":2260,"y":1820,"wires":[["8d8e3f4d.4c6b9"],["8fd7d816.0f6e08"]]},{"id":"2f597e48.8a45c2","type":"switch","z":"859b066a.dd8128","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":1620,"y":2660,"wires":[["1709e7aa.4b4af8"],["f616efae.e6096"]]},{"id":"22e78807.560778","type":"switch","z":"859b066a.dd8128","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":1620,"y":2860,"wires":[["4fcf26d8.a83f78"],["3d3a9809.4fd548"]]},{"id":"f64ae584.fb0c68","type":"switch","z":"2bbba447.a4759c","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"false"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":1190,"y":820,"wires":[["74683cb2.be8ac4","e9a4dd30.d6d73"],["6aed7577.2179ac"]]},{"id":"6b30c287.9ff15c","type":"function","z":"4c9c764d.9c4468","name":"Netflix or Prime Video?","func":"var ocupado = global.get(\"tvAuxFilme\");\nif(ocupado === false){\n    if(msg.data.new_state.attributes.media_title === \"Netflix\" || \n    msg.data.new_state.attributes.media_title ===\"Prime Video\"|| \n    msg.data.new_state.attributes.media_title ===\"Apple TV\"|| \n    msg.data.new_state.attributes.media_title ===\"Disney+\"|| \n    msg.data.new_state.attributes.media_title ===\"mycontent-video-player\"){\n        global.set(\"tvAuxFilme\", true);\n        return {payload: \"playing\"};\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":380,"y":1260,"wires":[["19554fb4.898e3","9c98b28c.4c8bd","cebfe46c.10f188"]]},{"id":"e9a4dd30.d6d73","type":"function","z":"2bbba447.a4759c","name":"Turn Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"input_boolean.banheiro_ocupado_switch\",\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1380,"y":820,"wires":[["1af4195f.5b5297"]]},{"id":"e4ec042f.948798","type":"function","z":"2bbba447.a4759c","name":"Turn On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        data:{\n            \"entity_id\": \"input_boolean.banheiro_ocupado_switch\",\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1380,"y":760,"wires":[["1af4195f.5b5297"]]},{"id":"3c34f863.bc1ac8","type":"function","z":"5767c936.cabd18","name":"Abajures Escritorio Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.abajur_esquerda\"\n        }\n    }};\n    node.send(newMsg);\n    \n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.abajur_direita\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2441,"y":580,"wires":[["88e11aa0.ea33f8"]]},{"id":"a15f542b.7479e8","type":"function","z":"4c9c764d.9c4468","name":"Turn Off","func":"msg.payload = {\"on\": false};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"x":940,"y":1220,"wires":[["337c17d5.a9f378","2f9c7b9a.a87b14"]]},{"id":"c16309d1.f94448","type":"function","z":"444fced8.33ecb","name":"Turn On","func":"var newMsg;\n        newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_on\",\n            \"data\":{\n                \"entity_id\": \"switch.tomada_tv_quarto_nedi\"\n            }\n        }};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":720,"y":2900,"wires":[["90386d3.76d279","b81fc5d.1f8e938"]]},{"id":"56322f3d.4f55e","type":"function","z":"c3fa9bdb.b5c4c8","name":"Mariana?","func":"if(msg.payload === \"Mariana\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":920,"y":660,"wires":[["6a78346b.28ebdc"]]},{"id":"f9552f8a.45009","type":"function","z":"c3fa9bdb.b5c4c8","name":"Cleusa?","func":"if(msg.payload === \"Cleusa\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":920,"y":740,"wires":[["30c4bd48.a31952"]]},{"id":"cb806604.579fa8","type":"function","z":"444fced8.33ecb","name":"Quem lava a roupa","func":"if(\n        (msg.payload.description.summary.includes('lavar')=== true ||\n        msg.payload.description.summary.includes('lava')=== true\n        )\n        &&\n        (msg.payload.description.summary.includes('roupa')===true ||\n        msg.payload.description.summary.includes('roupas')===true)\n    ){\n        if(msg.payload.name === \"Echo Dot da Cozinha\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_cozinha\") \n        }\n        if(msg.payload.name === \"Echo Dot da Sala\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_sala\")       \n        }\n        if(msg.payload.name === \"Echo Dot do Quarto Nédi\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_nedi\")\n        }\n        \n        if(msg.payload.name === \"Echo Dot do Quarto Maria\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_maria\")\n        }\n        return {payload:true};\n        \n    }","outputs":1,"noerr":0,"x":510,"y":3600,"wires":[["1b95a1c2.86787e"]]},{"id":"9150be82.f8d1d","type":"function","z":"444fced8.33ecb","name":"Construct Message","func":"const entity = flow.get(\"alexaDeviceHelper\");\nvar message;\nif(msg.payload === \"Nédi\"){\n    message =  \"Hoje é o Nédi que lava a roupa\";\n}\nif(msg.payload === \"Maria\"){\n    message =  \"Hoje é a Maria que lava a roupa\";\n}\nif(msg.payload === \"Mariana\"){\n    message =  \"Hoje é a Mariana que lava a roupa\";\n}\nif(msg.payload === \"Cristofer\"){\n    message =  \"Hoje é o Cristófer que lava a roupa\";\n}\nreturn {\n    payload:{\n        data: {\n            message: message,\n            data: { type: \"tts\" },\n            target: [entity]\n        }\n    }\n};","outputs":1,"noerr":0,"x":1010,"y":3600,"wires":[["f6c95af8.213898"]]},{"id":"aff3cf91.243c6","type":"function","z":"444fced8.33ecb","name":"Quem lava a louça","func":"if(\n        (msg.payload.description.summary.includes('lavar')=== true ||\n        msg.payload.description.summary.includes('lava')=== true\n        )\n        &&\n        (msg.payload.description.summary.includes('louça')===true)\n    ){\n        if(msg.payload.name === \"Echo Dot da Cozinha\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_cozinha\") \n        }\n        if(msg.payload.name === \"Echo Dot da Sala\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_sala\")       \n        }\n        if(msg.payload.name === \"Echo Dot do Quarto Nédi\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_nedi\")\n        }\n        \n        if(msg.payload.name === \"Echo Dot do Quarto Maria\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_maria\")\n        }\n        return {payload:true};\n        \n    }","outputs":1,"noerr":0,"x":510,"y":3660,"wires":[["f1ef2f51.b93de"]]},{"id":"74be5855.d070e8","type":"function","z":"444fced8.33ecb","name":"Construct Message","func":"const entity = flow.get(\"alexaDeviceHelper\");\nvar message;\nif(msg.payload === \"Nédi\"){\n    message =  \"Hoje é o Nédi que lava a louça\";\n}\nif(msg.payload === \"Maria\"){\n    message =  \"Hoje é a Maria que lava a louça\";\n}\nif(msg.payload === \"Mariana\"){\n    message =  \"Hoje é a Mariana que lava a louça\";\n}\nif(msg.payload === \"Cristofer\"){\n    message =  \"Hoje é o Cristófer que lava a louça\";\n}\nif(msg.payload === \"Cleusa\"){\n    message =  \"Hoje é a Cleusa que lava a louça\";\n}\nreturn {\n    payload:{\n        data: {\n            message: message,\n            data: { type: \"tts\" },\n            target: [entity]\n        }\n    }\n};","outputs":1,"noerr":0,"x":1010,"y":3660,"wires":[["6731d3c5.5a9b0c"]]},{"id":"10ef1a07.b04176","type":"function","z":"444fced8.33ecb","name":"Quem faz o almoço","func":"if(\n        (msg.payload.description.summary.includes('faz')=== true)\n        &&\n        (msg.payload.description.summary.includes('almoço')===true)\n    ){\n        if(msg.payload.name === \"Echo Dot da Cozinha\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_cozinha\") \n        }\n        if(msg.payload.name === \"Echo Dot da Sala\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_sala\")       \n        }\n        if(msg.payload.name === \"Echo Dot do Quarto Nédi\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_nedi\")\n        }\n        \n        if(msg.payload.name === \"Echo Dot do Quarto Maria\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_maria\")\n        }\n        return {payload:true};\n        \n    }","outputs":1,"noerr":0,"x":510,"y":3720,"wires":[["f53f2505.ce6f28"]]},{"id":"212a938a.d4921c","type":"function","z":"444fced8.33ecb","name":"Construct Message","func":"const entity = flow.get(\"alexaDeviceHelper\");\nvar message;\nif(msg.payload === \"Nédi\"){\n    message =  \"Hoje é o Nédi que faz o almoço\";\n}\nif(msg.payload === \"Maria\"){\n    message =  \"Hoje é a Maria que faz o almoço\";\n}\nif(msg.payload === \"Mariana\"){\n    message =  \"Hoje é a Mariana que faz o almoço\";\n}\nif(msg.payload === \"Cristofer\"){\n    message =  \"Hoje é o Cristófer que faz o almoço\";\n}\nreturn {\n    payload:{\n        data: {\n            message: message,\n            data: { type: \"tts\" },\n            target: [entity]\n        }\n    }\n};","outputs":1,"noerr":0,"x":1010,"y":3720,"wires":[["c0122428.4fdf18"]]},{"id":"2c6e3954.48f5a6","type":"function","z":"444fced8.33ecb","name":"Quem lava a cozinha","func":"if(\n        (msg.payload.description.summary.includes('lava')=== true)\n        &&\n        (msg.payload.description.summary.includes('cozinha')===true)\n    ){\n        if(msg.payload.name === \"Echo Dot da Cozinha\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_cozinha\") \n        }\n        if(msg.payload.name === \"Echo Dot da Sala\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_sala\")       \n        }\n        if(msg.payload.name === \"Echo Dot do Quarto Nédi\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_nedi\")\n        }\n        \n        if(msg.payload.name === \"Echo Dot do Quarto Maria\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_maria\")\n        }\n        return {payload:true};\n        \n    }","outputs":1,"noerr":0,"x":520,"y":3780,"wires":[["72aa4e3b.7d9b4"]]},{"id":"cbd9c72a.6f64a8","type":"function","z":"444fced8.33ecb","name":"Construct Message","func":"const entity = flow.get(\"alexaDeviceHelper\");\nvar message;\nif(msg.payload === \"Nédi\"){\n    message =  \"Hoje é o Nédi que lava a cozinha\";\n}\nif(msg.payload === \"Maria\"){\n    message =  \"Hoje é a Maria que lava a cozinha\";\n}\nif(msg.payload === \"Mariana\"){\n    message =  \"Hoje é a Mariana que lava a cozinha\";\n}\nif(msg.payload === \"Cristofer\"){\n    message =  \"Hoje é o Cristófer que lava a cozinha\";\n}\nreturn {\n    payload:{\n        data: {\n            message: message,\n            data: { type: \"tts\" },\n            target: [entity]\n        }\n    }\n};","outputs":1,"noerr":0,"x":1010,"y":3780,"wires":[["84c6767b.e68148"]]},{"id":"cced1b08.182ed8","type":"function","z":"444fced8.33ecb","name":"Quem leva o lixo","func":"if(\n        (msg.payload.description.summary.includes('leva')=== true)\n        &&\n        (msg.payload.description.summary.includes('lixo')===true)\n    ){\n        if(msg.payload.name === \"Echo Dot da Cozinha\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_cozinha\") \n        }\n        if(msg.payload.name === \"Echo Dot da Sala\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_sala\")       \n        }\n        if(msg.payload.name === \"Echo Dot do Quarto Nédi\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_nedi\")\n        }\n        \n        if(msg.payload.name === \"Echo Dot do Quarto Maria\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_maria\")\n        }\n        return {payload:true};\n        \n    }","outputs":1,"noerr":0,"x":510,"y":3840,"wires":[["1b1292a7.58a55d"]]},{"id":"c7bb3020.c1e9c","type":"function","z":"444fced8.33ecb","name":"Construct Message","func":"const entity = flow.get(\"alexaDeviceHelper\");\nvar message;\nif(msg.payload === \"Nédi\"){\n    message =  \"Hoje é o Nédi que leva o lixo\";\n}\nif(msg.payload === \"Maria\"){\n    message =  \"Hoje é a Maria que leva o lixo\";\n}\nif(msg.payload === \"Mariana\"){\n    message =  \"Hoje é a Mariana que leva o lixo\";\n}\nif(msg.payload === \"Cristofer\"){\n    message =  \"Hoje é o Cristófer que leva o lixo\";\n}\nreturn {\n    payload:{\n        data: {\n            message: message,\n            data: { type: \"tts\" },\n            target: [entity]\n        }\n    }\n};","outputs":1,"noerr":0,"x":1010,"y":3840,"wires":[["13299b9f.ed8554"]]},{"id":"526dcb0e.aba824","type":"function","z":"444fced8.33ecb","name":"Quem arruma a mesa","func":"if(\n        (msg.payload.description.summary.includes('arruma')=== true)\n        &&\n        (msg.payload.description.summary.includes('mesa')===true)\n    ){\n        if(msg.payload.name === \"Echo Dot da Cozinha\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_cozinha\") \n        }\n        if(msg.payload.name === \"Echo Dot da Sala\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_sala\")       \n        }\n        if(msg.payload.name === \"Echo Dot do Quarto Nédi\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_nedi\")\n        }\n        \n        if(msg.payload.name === \"Echo Dot do Quarto Maria\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_maria\")\n        }\n        return {payload:true};\n        \n    }","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":3900,"wires":[["a999ddd2.11c2"]]},{"id":"a72ef4ba.0e1068","type":"function","z":"444fced8.33ecb","name":"Construct Message","func":"const entity = flow.get(\"alexaDeviceHelper\");\nvar message;\nif(msg.payload === \"Nédi\"){\n    message =  \"Hoje é o Nédi que arruma a mesa\";\n}\nif(msg.payload === \"Maria\"){\n    message =  \"Hoje é a Maria que arruma a mesa\";\n}\nif(msg.payload === \"Mariana\"){\n    message =  \"Hoje é a Mariana que arruma a mesa\";\n}\nif(msg.payload === \"Cristofer\"){\n    message =  \"Hoje é o Cristófer que arruma a mesa\";\n}\nreturn {\n    payload:{\n        data: {\n            message: message,\n            data: { type: \"tts\" },\n            target: [entity]\n        }\n    }\n};","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1010,"y":3900,"wires":[["227d045a.71d77c"]]},{"id":"37aab766.ba5f88","type":"inject","z":"c3fa9bdb.b5c4c8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"15 12 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":150,"y":900,"wires":[["904067dc.365ae8"]]},{"id":"74c0c669.4d0e38","type":"function","z":"c3fa9bdb.b5c4c8","name":"Maria?","func":"if(msg.payload === \"Maria\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":900,"wires":[["1c38d9ef.7e2016","446f4589.68cb0c"]]},{"id":"2cce545e.db7bbc","type":"function","z":"c3fa9bdb.b5c4c8","name":"Nédi?","func":"if(msg.payload === \"Nédi\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":1120,"wires":[["5a575e22.e17d1","afc4dc64.48ef2","5944f4cd.b64acc","ab991015.11616"]]},{"id":"130d7896.f47fd7","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pai?","func":"if(msg.payload === \"Cristofer\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":960,"wires":[["2f235d24.c4ffd2","b6f5757c.48cd98"]]},{"id":"5944f4cd.b64acc","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Louça\", \"message\": \"Hoje é seu dia de arrumar a mesa\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"x":1150,"y":1080,"wires":[["2592ece0.90f874"]]},{"id":"afc4dc64.48ef2","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_macbook_pro_de_nedison\",\n    data:{\n        \n\n         message: 'Hoje é seu dia de arrumar a mesa'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":1200,"wires":[["bbaa258f.3c5dc8"]]},{"id":"5a575e22.e17d1","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \n  \n         message: 'Hoje é seu dia de arrumar a mesa'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":1140,"wires":[["e48e4de1.dcedd"]]},{"id":"2f235d24.c4ffd2","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_softcelular\",\n    data:{\n        \n         message: 'Hoje é seu dia de arrumar a mesa'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":960,"wires":[["af1ac5b5.2edd38"]]},{"id":"1c38d9ef.7e2016","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\nnewMsg= {payload : {\n\"domain\": \"notify\",\n\"service\": \"mobile_app_maria_s_iphone\",\ndata:{\n        \n         message: 'Hoje é seu dia de arrumar a mesa'\n  }\n}};\nreturn newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":900,"wires":[["1732489f.b4bf57"]]},{"id":"cdaaa9a1.bfd9f8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Mariana?","func":"if(msg.payload === \"Mariana\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":920,"y":1280,"wires":[["f6f84721.a0a328"]]},{"id":"ae9ff12b.eb648","type":"function","z":"c3fa9bdb.b5c4c8","name":"Cleusa?","func":"if(msg.payload === \"Cleusa\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":920,"y":1360,"wires":[["cfa7af2f.b0c2c"]]},{"id":"9103eac3.07f308","type":"inject","z":"c3fa9bdb.b5c4c8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"35 13 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":210,"y":1560,"wires":[["b777a9d8.2e33b8"]]},{"id":"33e7b0a2.2202d","type":"function","z":"c3fa9bdb.b5c4c8","name":"Maria?","func":"if(msg.payload === \"Maria\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":1560,"wires":[["c19f14c6.0a1838","b843169a.9eaa98"]]},{"id":"c8159813.b19808","type":"function","z":"c3fa9bdb.b5c4c8","name":"Nédi?","func":"if(msg.payload === \"Nédi\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":1780,"wires":[["c6dfdabf.898058","f829bfb6.aeafc","3e62a3b3.d0c53c","ec9b4920.be1ac8"]]},{"id":"2ff0dba8.d52cc4","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pai?","func":"if(msg.payload === \"Cristofer\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":1620,"wires":[["ee519293.b1b34","8ef6fd7b.134b8"]]},{"id":"3e62a3b3.d0c53c","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Louça\", \"message\": \"Hoje é seu dia de arrumar e limpar a cozinha\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"x":1150,"y":1740,"wires":[["6120cee2.045ba"]]},{"id":"f829bfb6.aeafc","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_macbook_pro_de_nedison\",\n    data:{\n        \n\n         message: 'Hoje é seu dia de arrumar e limpar a cozinha'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":1860,"wires":[["425a0c3a.ee4394"]]},{"id":"c6dfdabf.898058","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \n  \n         message: 'Hoje é seu dia de arrumar e limpar a cozinha'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":1800,"wires":[["615e19b6.fa9058"]]},{"id":"ee519293.b1b34","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_softcelular\",\n    data:{\n        \n         message: 'Hoje é seu dia de arrumar e limpar a cozinha'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1150,"y":1620,"wires":[["1b398868.546ed8"]]},{"id":"c19f14c6.0a1838","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\nnewMsg= {payload : {\n\"domain\": \"notify\",\n\"service\": \"mobile_app_maria_s_iphone\",\ndata:{\n        \n         message: 'Hoje é seu dia de arrumar e limpar a cozinha'\n  }\n}};\nreturn newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":1560,"wires":[["f238d117.d7a65"]]},{"id":"815a03c6.edb32","type":"function","z":"c3fa9bdb.b5c4c8","name":"Mariana?","func":"if(msg.payload === \"Mariana\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":920,"y":1940,"wires":[["4b6f284e.1139a8"]]},{"id":"1bdbd9a4.c15266","type":"function","z":"c3fa9bdb.b5c4c8","name":"Cleusa?","func":"if(msg.payload === \"Cleusa\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":920,"y":2020,"wires":[["f5000d4b.74a9e"]]},{"id":"e248fc2.f0346","type":"inject","z":"c3fa9bdb.b5c4c8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"30 11 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":170,"y":2200,"wires":[["e21ef9a0.1759d8"]]},{"id":"aec19c0c.746cc","type":"function","z":"c3fa9bdb.b5c4c8","name":"Maria?","func":"if(msg.payload === \"Maria\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":2200,"wires":[["559ef4a7.f7e09c","43e52cf5.3e7ee4"]]},{"id":"12d42236.b0013e","type":"function","z":"c3fa9bdb.b5c4c8","name":"Nédi?","func":"if(msg.payload === \"Nédi\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":2420,"wires":[["7106f681.c5d678","69a996e5.cd57e8","9bafb876.cf0cb8","573b9ed7.9701f"]]},{"id":"b24e941d.0499b8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pai?","func":"if(msg.payload === \"Cristofer\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":2260,"wires":[["7c7966ab.1aabe8","54ff00d4.4fe9"]]},{"id":"9bafb876.cf0cb8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Louça\", \"message\": \"Hoje é seu dia de fazer o almoço\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"x":1150,"y":2380,"wires":[["6f58ca8e.048b94"]]},{"id":"69a996e5.cd57e8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_macbook_pro_de_nedison\",\n    data:{\n        \n\n         message: 'Hoje é seu dia de fazer o almoço'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":2500,"wires":[["31948f25.2f2cd"]]},{"id":"7106f681.c5d678","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \n  \n         message: 'Hoje é seu dia de fazer o almoço'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":2440,"wires":[["58341600.ba1368"]]},{"id":"7c7966ab.1aabe8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_softcelular\",\n    data:{\n        \n         message: 'Hoje é seu dia de fazer o almoço'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":2260,"wires":[["45dd6492.0006cc"]]},{"id":"559ef4a7.f7e09c","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\nnewMsg= {payload : {\n\"domain\": \"notify\",\n\"service\": \"mobile_app_maria_s_iphone\",\ndata:{\n        \n         message: 'Hoje é seu dia de fazer o almoço'\n  }\n}};\nreturn newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":2200,"wires":[["68b39efe.27e76"]]},{"id":"2993fa55.853746","type":"function","z":"c3fa9bdb.b5c4c8","name":"Mariana?","func":"if(msg.payload === \"Mariana\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":920,"y":2580,"wires":[["23ae8fa.232b57"]]},{"id":"425bffbc.5170a","type":"alexa-remote-event","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","event":"ws-device-activity","x":190,"y":520,"wires":[["fb61a0f6.7dc42","5dbf333.b939dcc","247b7d18.10da82","6cc082a4.cebc2c","24d07955.b49ff6","225c0d0d.39b7a2","ae466c3b.c0827","1e067aee.66c0b5","18d78045.d4bfc","6640a3fe.73843c","57ed58fd.5a6c18","817f8363.e868e","7d63ea8e.4a9ef4","e6a01969.9876f8","6683f650.ea72b8","2df5031e.7be11c","379789b5.f21f06","470c17ea.7843e8","64e3e55d.98c86c","aa3e8e1b.c2b91","c2af1e6b.5dd89","bd72b3f8.afed","4a4d95ff.2ae1ec","3d291f1c.4439","87902325.656bf","cb806604.579fa8","aff3cf91.243c6","10ef1a07.b04176","2c6e3954.48f5a6","cced1b08.182ed8","526dcb0e.aba824","581daa37.ad1a54","9704ea70.dfcb88","b90f92de.0e9e6","548f56c3.b00918","6d30b421.7fdb9c","8f236e2.339c69","95692a86.5657b8","c7efcbaf.f44cd8","cfadd93a.8674e8","f8cda435.4b8738","93da222c.6ffaf"]]},{"id":"10c8544d.2497dc","type":"alexa-remote-smarthome","z":"859b066a.dd8128","name":"","account":"421d4b0d.32a884","config":{"option":"action","value":[]},"outputs":1,"x":3020,"y":100,"wires":[[]]},{"id":"f31d5496.2b7e18","type":"alexa-remote-smarthome","z":"859b066a.dd8128","name":"","account":"421d4b0d.32a884","config":{"option":"action","value":[]},"outputs":1,"x":3020,"y":160,"wires":[[]]},{"id":"47f62cef.700a54","type":"alexa-remote-smarthome","z":"859b066a.dd8128","d":true,"name":"","account":"421d4b0d.32a884","config":{"option":"action","value":[{"entity":"f78e20f8-0e84-4e19-8441-c2dfea07d935","action":"setBrightness","value":{"type":"num","value":"10"}},{"entity":"f78e20f8-0e84-4e19-8441-c2dfea07d935","action":"setColorTemperature","value":{"type":"str","value":"incandescent"}},{"entity":"063c5681-d6a4-4bf2-af40-b7fa798204fc","action":"turnOn"}]},"outputs":1,"x":1120,"y":960,"wires":[[]]},{"id":"a370477f.87b298","type":"alexa-remote-smarthome","z":"859b066a.dd8128","d":true,"name":"","account":"421d4b0d.32a884","config":{"option":"action","value":[{"entity":"debedcda-d66e-46f6-9047-21579a1582fa","action":"turnOff"}]},"outputs":1,"x":1620,"y":880,"wires":[[]]},{"id":"9eb428b1.d1d508","type":"alexa-remote-smarthome","z":"2bbba447.a4759c","name":"Luz do Banheiro","account":"421d4b0d.32a884","config":{"option":"query","value":[{"entity":"c2851099-5dda-4848-8575-398d3b867fa0","property":"powerState"}]},"outputs":1,"x":840,"y":360,"wires":[["f39ad338.f1792"]]},{"id":"a3b3a99d.ff7468","type":"alexa-remote-smarthome","z":"2bbba447.a4759c","name":"","account":"421d4b0d.32a884","config":{"option":"action","value":[{"entity":"c2851099-5dda-4848-8575-398d3b867fa0","action":"turnOn"}]},"outputs":1,"x":3440,"y":180,"wires":[[]]},{"id":"d588617e.d700b","type":"alexa-remote-smarthome","z":"2bbba447.a4759c","name":"","account":"421d4b0d.32a884","config":{"option":"action","value":[{"entity":"c2851099-5dda-4848-8575-398d3b867fa0","action":"turnOff"}]},"outputs":1,"x":3440,"y":280,"wires":[[]]},{"id":"27cc348a.a12c9c","type":"alexa-remote-smarthome","z":"859b066a.dd8128","name":"","account":"421d4b0d.32a884","config":{"option":"action","value":[{"entity":"bb3addbc-ee3f-4720-8237-9797ba33b6e6","action":"turnOff"}]},"outputs":1,"x":1020,"y":2680,"wires":[[]]},{"id":"c3c08b63.f7a388","type":"alexa-remote-smarthome","z":"859b066a.dd8128","d":true,"name":"","account":"421d4b0d.32a884","config":{"option":"query","value":[]},"outputs":1,"x":530,"y":1360,"wires":[["1bf5970a.d99939","da6218d6.54b928"]]},{"id":"96e8b4ab.c18ff8","type":"alexa-remote-smarthome","z":"859b066a.dd8128","name":"","account":"421d4b0d.32a884","config":{"option":"action","value":[]},"outputs":1,"x":3130,"y":1560,"wires":[[]]},{"id":"d4386d44.5a3ad","type":"alexa-remote-smarthome","z":"859b066a.dd8128","name":"","account":"421d4b0d.32a884","config":{"option":"action","value":[]},"outputs":1,"x":3130,"y":1500,"wires":[[]]},{"id":"52bf523a.a2e16c","type":"alexa-remote-smarthome","z":"859b066a.dd8128","name":"","account":"421d4b0d.32a884","config":{"option":"action","value":[]},"outputs":1,"x":1870,"y":1660,"wires":[[]]},{"id":"a5b917c3.6093d8","type":"alexa-remote-smarthome","z":"444fced8.33ecb","name":"Luz da Mesa Off","account":"421d4b0d.32a884","config":{"option":"action","value":[{"entity":"4f6607ff-a4dc-4bd7-baa2-81c1dd310d8d","action":"turnOff"}]},"outputs":1,"x":740,"y":1940,"wires":[[]]},{"id":"e6cd5785.820048","type":"alexa-remote-routine","z":"554bb518.994efc","d":true,"name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"Oi"},"volume":{"type":"num","value":"100"},"mode":"set","devices":["a9d590ebfbcd400dab7f40b75426db6d"]}},"x":410,"y":340,"wires":[["d7147383.eec86"]]},{"id":"d7147383.eec86","type":"alexa-remote-routine","z":"554bb518.994efc","d":true,"name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":""},"volume":{"type":"num","value":"50"},"mode":"set","devices":["a9d590ebfbcd400dab7f40b75426db6d"]}},"x":690,"y":340,"wires":[[]]},{"id":"45637419.03f15c","type":"alexa-remote-routine","z":"4c9c764d.9c4468","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"Bom filme."},"volume":{"type":"num","value":"50"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1270,"y":1140,"wires":[[]]},{"id":"964f049b.68d9e8","type":"alexa-remote-routine","z":"4c9c764d.9c4468","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":""},"volume":{"type":"num","value":"40"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1550,"y":1200,"wires":[[]]},{"id":"b22531d9.33f41","type":"alexa-remote-routine","z":"859b066a.dd8128","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do Quarto Automações"},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG0894430B3V"]}},"x":1450,"y":3560,"wires":[[]]},{"id":"de9d3923.5e5748","type":"alexa-remote-routine","z":"859b066a.dd8128","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":""},"volume":{"type":"num","value":"40"},"mode":"set","devices":["G090XG0894430B3V"]}},"x":1610,"y":3640,"wires":[[]]},{"id":"b2bff029.0ca5","type":"alexa-remote-routine","z":"5767c936.cabd18","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do Escritório Automações"},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1515,"y":1936,"wires":[[]]},{"id":"dd8da4a9.c4e8c8","type":"alexa-remote-routine","z":"5767c936.cabd18","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":""},"volume":{"type":"num","value":"40"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1715,"y":2016,"wires":[[]]},{"id":"f389a2c9.12d75","type":"alexa-remote-routine","z":"e7cd1901.ee2408","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do Sala Automações"},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1550,"y":1180,"wires":[[]]},{"id":"8a518d3e.49bc2","type":"alexa-remote-routine","z":"e7cd1901.ee2408","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":""},"volume":{"type":"num","value":"40"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1710,"y":1240,"wires":[[]]},{"id":"cc01888e.654468","type":"alexa-remote-routine","z":"4c9c764d.9c4468","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do HomeKit Automações"},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1410,"y":4680,"wires":[[]]},{"id":"84d22155.c9a92","type":"alexa-remote-routine","z":"4c9c764d.9c4468","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":""},"volume":{"type":"num","value":"40"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1550,"y":4740,"wires":[[]]},{"id":"3a01f365.64a05c","type":"alexa-remote-routine","z":"2bbba447.a4759c","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do Banheiro Automações"},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1430,"y":1020,"wires":[[]]},{"id":"fe6c172a.add0a8","type":"alexa-remote-routine","z":"2bbba447.a4759c","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":""},"volume":{"type":"num","value":"40"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1630,"y":1080,"wires":[[]]},{"id":"feda9f09.b20c3","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"Fala rouca","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"ssml","text":{"type":"ssml","value":"<speak><prosody pitch=\"-50%\" \trate=\"80%\" volume=\"+0dB\">\tIsto é um teste! <break time='100ms'/> Como posso te ajudar? \t</prosody></speak>"},"devices":["7c757a5cc13e48da91a35e14b6ac58f3"]}},"x":3790,"y":1260,"wires":[[]]},{"id":"9e6274be.3bb758","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"Fala \"soft\"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"ssml","text":{"type":"ssml","value":"<speak><amazon:effect phonation=\"soft\">\tIsto é um teste! <break time='100ms'/> Como posso te ajudar? \t</amazon:effect></speak>"},"devices":["G090XG0793643C6P"]}},"x":3790,"y":1320,"wires":[[]]},{"id":"7bf2c203.2a37ec","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"Fala que nem monstro","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"ssml","text":{"type":"ssml","value":"<speak><amazon:effect vocal-tract-length=\"+80%\">\tIsto é um teste! <break time='100ms'/> Como posso te ajudar? \t</amazon:effect></speak>"},"devices":["G090XG0793643C6P"]}},"x":3820,"y":1380,"wires":[[]]},{"id":"8644d282.30e27","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"Rapido cochicho ","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"ssml","text":{"type":"ssml","value":"<speak>   <prosody rate=\"150%\" pitch=      \"+50%\"                         volume      =      \"x-soft\">    Rapido cuchicho   </prosody> </speak>"},"devices":["G090XG0793643C6P"]}},"x":3810,"y":1440,"wires":[[]]},{"id":"4f475e29.5a0a5","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"ssml","text":{"type":"ssml","value":"<speak>     <prosody volume=\"x-loud\"><amazon:effect name=\"whispered\">Eu não sou um humano real </amazon:effect></prosody> </speak>"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":4240,"y":1460,"wires":[[]]},{"id":"d03e26a5.493c88","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"Wow","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"ssml","text":{"type":"ssml","value":"<speak>     <say-as interpret-as=\"interjection\">Wow</say-as>, Não vi isso vindo </speak>\t"},"devices":["G090XG0793643C6P"]}},"x":3770,"y":1600,"wires":[[]]},{"id":"52335afb.7478b4","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":""},"volume":{"type":"num","value":"100"},"mode":"set","devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":3950,"y":1500,"wires":[[]]},{"id":"487163d2.483a7c","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":""},"volume":{"type":"num","value":"40"},"mode":"set","devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":4170,"y":1560,"wires":[[]]},{"id":"85e24233.c7501","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"ssml","text":{"type":"ssml","value":"<speak> <voice name=\"Kendra\"><lang xml:lang=\"en-US\">Normal speech.   <amazon:emotion name=\"excited\" intensity=\"medium\"> I am excited - medium.  </amazon:emotion>  <amazon:emotion name=\"excited\" intensity=\"medium\"> I am excited - medium.  </amazon:emotion>  <amazon:emotion name=\"excited\" intensity=\"low\"> I am excited - low.  </amazon:emotion>  <amazon:emotion name=\"excited\" intensity=\"high\"> I am excited - high.  </amazon:emotion>  Now back to normal speech. </lang></voice></speak>"},"devices":["G090XG0793643C6P"]}},"x":3800,"y":1660,"wires":[[]]},{"id":"650e012d.d0af3","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                         "},"volume":{"type":"num","value":"50"},"mode":"set","devices":["G090XG0894430B3V"]}},"x":770,"y":2960,"wires":[[]]},{"id":"8f85d735.b5c078","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":770,"y":1680,"wires":[[]]},{"id":"6f4a0d7c.b00f04","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":750,"y":2320,"wires":[[]]},{"id":"5790296f.677688","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG0894430B3V"]}},"x":750,"y":780,"wires":[[]]},{"id":"3b658808.43fb48","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":770,"y":2000,"wires":[[]]},{"id":"2d23d4ab.10c21c","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1170,"y":2500,"wires":[[]]},{"id":"68868c0e.937504","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG0894430B3V"]}},"x":850,"y":3220,"wires":[[]]},{"id":"c09e3f0a.b5ec8","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"O café está sendo preparado"},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG1103420J46"]}},"x":810,"y":2060,"wires":[[]]},{"id":"ebdf5687.a38418","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG0894430B3V"]}},"x":870,"y":1560,"wires":[[]]},{"id":"36a693c.704b66c","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"Varias vozes","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"ssml","text":{"type":"str","value":"<speak> Posso ficar mudando <voice name=\"Ricardo\">pra voz do Ricardo</voice> <voice name=\"Camila\">pra voz da Camila, ou </voice>, <lang xml:lang=\"en-US\"> <voice name=\"Joanna\">And change languages mid-sentence, and even change to other voices in these languages like, </voice>   <voice name=\"Ivy\">to Ivy</voice>  <voice name=\"Joanna\">to Joanna</voice>  <voice name=\"Joey\">to Joey</voice>  <voice name=\"Justin\">to Justin</voice>  <voice name=\"Kendra\">to Kendra</voice>  <voice name=\"Kimberly\">to Kimberly</voice>  <voice name=\"Matthew\">to Matthew</voice>  <voice name=\"Salli\">to Salli</voice>  </lang>  </speak>"},"volume":{"type":"num","value":"50"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":3790,"y":1720,"wires":[[]]},{"id":"b235294.859eed8","type":"alexa-remote-routine","z":"d67ca66.293d758","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"O café está sendo preparado"},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG1103420J46"]}},"x":630,"y":1840,"wires":[[]]},{"id":"e2dc6379.4e9bb","type":"alexa-remote-routine","z":"d3db5d74.fb8fa","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do Aqara Sensores"},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1450,"y":2980,"wires":[[]]},{"id":"cfd819c5.6cc7d8","type":"alexa-remote-routine","z":"d3db5d74.fb8fa","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":""},"volume":{"type":"num","value":"40"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1650,"y":3040,"wires":[[]]},{"id":"393f8bc8.a11c74","type":"alexa-remote-routine","z":"d67ca66.293d758","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do Home Assistant Automações"},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1450,"y":3860,"wires":[[]]},{"id":"e18d7d74.a8ff5","type":"alexa-remote-routine","z":"d67ca66.293d758","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":""},"volume":{"type":"num","value":"40"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1650,"y":3920,"wires":[[]]},{"id":"ee70b3b2.cd44d","type":"alexa-remote-routine","z":"7b0de646.c85c78","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do Spotify Helpers"},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1570,"y":3020,"wires":[[]]},{"id":"be1210a6.1a4ef","type":"alexa-remote-routine","z":"7b0de646.c85c78","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":""},"volume":{"type":"num","value":"40"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1770,"y":3080,"wires":[[]]},{"id":"401a175f.c09d28","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do Alexa Automações"},"volume":{"type":"num","value":"20"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1450,"y":4720,"wires":[[]]},{"id":"4420f6a3.941d88","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":""},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1650,"y":4780,"wires":[[]]},{"id":"9a05cb5e.a141b8","type":"alexa-remote-other","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","config":{"option":"addListItem","value":{"list":{"type":"str","value":"SHOPPING_ITEM"},"text":{"type":"msg","value":"item"}}},"x":1950,"y":4440,"wires":[["bf90c51a.246768"]]},{"id":"b0feba76.29ab18","type":"alexa-remote-list","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","config":{"option":"getListItems","value":{"list":{"type":"str","value":"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0="}}},"x":380,"y":4340,"wires":[["4c92db9c.4ac3b4","a1c0ec4a.6ba0e"]]},{"id":"c2925e7d.d0847","type":"alexa-remote-list","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","config":{"option":"removeItem","value":{"list":{"type":"str","value":"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0="},"item":{"type":"msg","value":"id"}}},"x":1930,"y":4500,"wires":[["4273f70c.a2f798"]]},{"id":"f490c4f5.2b7b38","type":"alexa-remote-list","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","config":{"option":"getListItems","value":{"list":{"type":"str","value":"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0="}}},"x":1200,"y":4460,"wires":[["a3321db6.f2b2e","9548fd60.1d0ed"]]},{"id":"4f1abce4.d33704","type":"alexa-remote-list","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","config":{"option":"getListItems","value":{"list":{"type":"str","value":"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0="}}},"x":1540,"y":4540,"wires":[["2a6e2a13.beec36","fad19841.0c97e8"]]},{"id":"2a9c795b.26ed16","type":"server-events","z":"d3db5d74.fb8fa","name":"Click","server":"d14d7300.ae20c","event_type":"xiaomi_aqara.click","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"x":230,"y":480,"wires":[["e2812321.99f76","b3cdb622.ddf5c8","910ee8ec.c1bba8","1849eadb.cfb485","38389231.38335e","b7edb068.d2035","153e6887.fab7b7","f762ec29.df263","bbc954fe.34ca28","debd4025.dcc25","935d70a4.0388a","200a2af8.ab0036","fe55583b.925df8","2873d8ed.ca9528","34c8078e.a5c46"]]},{"id":"42d36de4.b8bfd4","type":"server-events","z":"d3db5d74.fb8fa","name":"Movimento","server":"d14d7300.ae20c","event_type":"xiaomi_aqara.motion","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"x":240,"y":880,"wires":[["31339c0.ecc2764","97ed078d.d825b8","87bc8837.99e6a8","9542dcaf.e3052","b09d4ce2.2903e","b6b8d224.65ba2","2d1a39fd.73ad86"]]},{"id":"973b23ff.50cbc","type":"server-events","z":"d3db5d74.fb8fa","name":"Vibração","server":"d14d7300.ae20c","event_type":"xiaomi_aqara.movement","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"x":290,"y":1500,"wires":[["36bb604a.83da8","7eac7957.0a0eb8"]]},{"id":"bb34c681.a75a08","type":"server-events","z":"444fced8.33ecb","name":"Novo item","server":"d14d7300.ae20c","event_type":"shopping_list_updated","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"x":280,"y":4540,"wires":[["3929b2fd.756b8e","87de823c.02e22"]]},{"id":"87732fdb.f9908","type":"server-events","z":"d67ca66.293d758","name":"iOS Action","server":"d14d7300.ae20c","event_type":"ios.action_fired","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"x":300,"y":2120,"wires":[["8f2f5dac.05e15","93200b37.65da88","aeb9c42.5596d38","97ae9d93.03b45"]]},{"id":"3b08b13.d3dd94e","type":"server-state-changed","z":"d67ca66.293d758","name":"State Lampada","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"switch.lampada","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":270,"y":160,"wires":[["c26cc436.d71418"],["c26cc436.d71418"]]},{"id":"8766a7e8.a955c8","type":"server-state-changed","z":"d67ca66.293d758","name":"State Abajur","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"switch.abajur","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":280,"y":260,"wires":[["70ce4b62.b3fb04"],["70ce4b62.b3fb04"]]},{"id":"c14c661d.8877d8","type":"server-state-changed","z":"d67ca66.293d758","d":true,"name":"State Cafeteira","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"switch.cafeteira","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":270,"y":480,"wires":[["6f521a81.1652e4"],["6f521a81.1652e4"]]},{"id":"bc52e0ab.cf4ac","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Porta Banheiro","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.porta_banheiro","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":300,"y":1400,"wires":[["8cd6b99e.6b2b18","dd5a2759.0b99d8"],["968300f.8aadb","dd5a2759.0b99d8"]]},{"id":"e7fb71d2.0c53a","type":"server-state-changed","z":"d67ca66.293d758","name":"Sun below horizon","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sun.sun","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"above_horizon","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":260,"y":880,"wires":[["ef9cc054.943","72ca570b.9ae3d8"],["ef9cc054.943","47d2250d.065b8c"]]},{"id":"b39c4ded.6504d","type":"server-state-changed","z":"d67ca66.293d758","name":"Cafeteira","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"switch.cafeteira","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":280,"y":1740,"wires":[["aff57b37.026a28"],["aff57b37.026a28"]]},{"id":"3cd193a7.a0fa2c","type":"server-state-changed","z":"859b066a.dd8128","name":"Vou dormir","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.vou_dormir","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":280,"y":2720,"wires":[["bd0e87aa.31bc78"],["bd0e87aa.31bc78"]]},{"id":"97e377ef.cd5248","type":"server-state-changed","z":"4c9c764d.9c4468","name":"Apple TV On?","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"media_player.apple_tv","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":110,"y":1220,"wires":[["19554fb4.898e3","d4012601.43bbf8"]]},{"id":"21dc15df.611b0a","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Banheiro Ocupado","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.banheiro_ocupado","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":330,"y":460,"wires":[["e9965ef4.dc795"]]},{"id":"aea81ab1.7f20d8","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Sala Ocupada","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.sala_ocupada","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":350,"y":520,"wires":[["d7e2903f.799be"]]},{"id":"e7961457.397778","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Movimento Escritório","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.movimento_escritorio","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":320,"y":580,"wires":[["62aeee38.66017"]]},{"id":"5eebe845.032db8","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Movimento Cozinha","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.movimento_cozinha","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":330,"y":760,"wires":[["8854e815.7cc7e8"]]},{"id":"ce4cf27c.4e149","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Movimento Quarto Nédi","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.movimento_quarto_nedi","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":320,"y":820,"wires":[["aea952f0.7dca8"]]},{"id":"da7d094d.1fa6e8","type":"server-state-changed","z":"2bbba447.a4759c","name":"Banheiro Ocupado","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.banheiro_ocupado","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":1970,"y":420,"wires":[["962c7f2a.f157e"]]},{"id":"6157b5d8.912f1c","type":"server-state-changed","z":"d67ca66.293d758","name":"Updater","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.updater","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"true","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":450,"y":2020,"wires":[["9ab5d2cd.a93c5"],["9ab5d2cd.a93c5"]]},{"id":"d55de659.8068a8","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"TV da Sala","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"media_player.tv_da_sala","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":360,"y":700,"wires":[["49e2ae6e.3770a"]]},{"id":"90d6b55b.eb46c8","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Nedi's iPhone","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"device_tracker.life360_nedison_neto_faria_velloso","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":350,"y":940,"wires":[["3774203b.8dc19"]]},{"id":"76cc299c.777468","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Maria's iPhone","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"device_tracker.life360_maria_luisa_faria_velloso","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":340,"y":1000,"wires":[["2bede119.72612e"]]},{"id":"b95f1e80.57f14","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Cristofer","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"device_tracker.life360_cristofer_velloso","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":360,"y":1060,"wires":[["1d22767b.f129aa"]]},{"id":"8d1fe0d3.d44fc","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Sensor de Luz Escritório Aqara","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.sensor_de_luz_escritorio_aqara","entityidfiltertype":"exact","outputinitially":false,"state_type":"num","haltifstate":"","halt_if_type":"num","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":990,"y":720,"wires":[["d9f0e7f6.c5a938"]]},{"id":"19bf7470.17a6fc","type":"server-state-changed","z":"4c9c764d.9c4468","name":"Sensor de Luz Escritório Aqara","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.sensor_de_luz_escritorio_aqara","entityidfiltertype":"exact","outputinitially":false,"state_type":"num","haltifstate":"","halt_if_type":"num","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":170,"y":160,"wires":[["1f9e3931.bcd327"]]},{"id":"bdf57e86.f23cc","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Movimento Quarto Maria","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.movimento_quarto_maria","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":310,"y":880,"wires":[["59ef2215.5285dc"]]},{"id":"889ffe0b.6fe08","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Movimento Sala","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.movimento_sala","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":340,"y":640,"wires":[["748845f7.408c5c"]]},{"id":"fe14e295.1ac16","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Janela Quarto Maria","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.janela_quarto_maria","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":310,"y":1700,"wires":[["1d1cb695.50aaa9"],["a984656a.c4e198"]]},{"id":"c0f3e341.45c75","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Janela Quarto Nédi","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.janela_quarto_nedi","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":310,"y":1820,"wires":[["604c113d.67dae"],["3c9fc7.6938503a"]]},{"id":"946daff2.5753d","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Janela Quarto Pai","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.janela_quarto_pai","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":310,"y":1940,"wires":[["c565ad59.11f79"],["a9fdd412.daee28"]]},{"id":"24e31857.e747b8","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Janela Sala Direita","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.janela_sala_direita","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":310,"y":2060,"wires":[["93421936.7e0098"],["9c27139a.c24c1"]]},{"id":"7e99ca8c.7fe274","type":"server-state-changed","z":"d67ca66.293d758","name":"Alguém em Casa","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.alguem_em_casa","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"true","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":320,"y":2920,"wires":[["c5250d18.6422a","77334325.c1f0bc","ab6e20fa.2fccc"],["c5250d18.6422a","77334325.c1f0bc","ab6e20fa.2fccc"]]},{"id":"536798ce.6fd7b8","type":"server-state-changed","z":"4c9c764d.9c4468","name":"Sensor de Luz Sala","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.sensor_de_luz_sala","entityidfiltertype":"exact","outputinitially":false,"state_type":"num","haltifstate":"","halt_if_type":"num","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":210,"y":260,"wires":[["52ed3553.1f2cec"]]},{"id":"c0ae7a5a.ce6478","type":"server-state-changed","z":"c3fa9bdb.b5c4c8","d":true,"name":"Roupa está Seca","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.esta_seca","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":580,"y":4020,"wires":[["e687ec1.d1d911"]]},{"id":"b1df2b69.18c768","type":"server-state-changed","z":"c3fa9bdb.b5c4c8","name":"Máquina de Lavar Roupas","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_select.maquina_de_lavar_roupas","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":310,"y":4600,"wires":[["ea5f6616.e4e2c8"]]},{"id":"5ebfc60.94d593c","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Botão Cozinha","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.botao_cozinha_action_2","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":300,"y":2860,"wires":[["3131595f.58bac6","1b17d0d9.4f785f","ebeebd66.a6613"]]},{"id":"5d4c4a88.0386a4","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Botão Cozinha","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.botao_cozinha_battery_2","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":300,"y":2920,"wires":[["2c8c1735.30eb58"]]},{"id":"deffa27c.e2d7d","type":"server-state-changed","z":"4c9c764d.9c4468","name":"Netflix?","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"media_player.tv_da_sala","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":130,"y":1280,"wires":[["6b30c287.9ff15c"]]},{"id":"1ec5d52d.21f41b","type":"api-call-service","z":"d67ca66.293d758","name":"Lampada OnOff","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.lampada","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":990,"y":180,"wires":[[]]},{"id":"aa54b7b4.3a3f08","type":"api-call-service","z":"d67ca66.293d758","name":"Abajur OnOff","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.abajur_esquerda","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1150,"y":280,"wires":[[]]},{"id":"4c41c991.2adfc8","type":"api-call-service","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4220,"y":240,"wires":[[]]},{"id":"75578844.506568","type":"api-call-service","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2030,"y":2640,"wires":[[]]},{"id":"5420eb2f.585104","type":"api-call-service","z":"2bbba447.a4759c","name":"Luz Noturna","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.aqara_hub","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3250,"y":600,"wires":[[]]},{"id":"49f438d1.bca1e8","type":"api-call-service","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2370,"y":820,"wires":[[]]},{"id":"d81c8d41.b658f","type":"api-call-service","z":"444fced8.33ecb","name":"Luz do Quarto","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1500,"y":680,"wires":[[]]},{"id":"d49ef7c3.77a7c8","type":"api-call-service","z":"444fced8.33ecb","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":850,"y":1620,"wires":[[]]},{"id":"d893df70.4923f","type":"api-call-service","z":"444fced8.33ecb","name":"TV da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"media_player.tv_da_sala","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":930,"y":2560,"wires":[["cf6e490b.bd57d8"]]},{"id":"5e4ab241.037a1c","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Luz Noturna On","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.aqara_hub","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1100,"y":1100,"wires":[[]]},{"id":"720b2e2a.c4b74","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Luz Noturna Off","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.aqara_hub","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1360,"y":1160,"wires":[[]]},{"id":"f241c1a3.11968","type":"api-call-service","z":"4c9c764d.9c4468","name":"TV da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"media_player.tv_da_sala","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1090,"y":1020,"wires":[[]]},{"id":"7511e273.ed96cc","type":"api-call-service","z":"d67ca66.293d758","name":"TV Set Volume","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"media_play","entityId":"media_player.tv_da_sala","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":720,"y":1380,"wires":[[]]},{"id":"293815f6.1c67ea","type":"api-call-service","z":"554bb518.994efc","name":"","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"xiaomi_aqara","service":"play_ringtone","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":680,"y":700,"wires":[[]]},{"id":"f21d5385.706d6","type":"api-call-service","z":"554bb518.994efc","name":"","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"xiaomi_aqara","service":"play_ringtone","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":680,"y":820,"wires":[[]]},{"id":"42be937b.e17c5c","type":"api-call-service","z":"444fced8.33ecb","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":750,"y":3020,"wires":[[]]},{"id":"7275fc50.c70e94","type":"api-call-service","z":"444fced8.33ecb","name":"Fire TV","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"media_player.fire_tv","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1100,"y":3120,"wires":[[]]},{"id":"c882366e.e8ab78","type":"api-call-service","z":"444fced8.33ecb","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":750,"y":3440,"wires":[[]]},{"id":"13cd65e3.056f3a","type":"api-call-service","z":"444fced8.33ecb","name":"Fire TV","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"media_player.fire_tv","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":900,"y":3320,"wires":[[]]},{"id":"cf707e94.e0dd8","type":"api-call-service","z":"444fced8.33ecb","name":"Lampada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.lampada","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1480,"y":740,"wires":[[]]},{"id":"eb95127f.26f2d","type":"api-call-service","z":"444fced8.33ecb","name":"Apple TV","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"media_player.apple_tv","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":720,"y":1740,"wires":[[]]},{"id":"4473ffa5.c6242","type":"api-call-service","z":"444fced8.33ecb","name":"Shopping List","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"","service":"","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1600,"y":4340,"wires":[[]]},{"id":"c18acf0.2ec693","type":"api-call-service","z":"e7cd1901.ee2408","name":"TV da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_off","entityId":"media_player.tv_da_sala","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2490,"y":620,"wires":[[]]},{"id":"1dc6a3d6.67629c","type":"api-call-service","z":"e7cd1901.ee2408","name":"Luz da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"","entityId":"light.luz_da_sala","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2690,"y":800,"wires":[[]]},{"id":"c5a24ffa.21152","type":"api-call-service","z":"444fced8.33ecb","name":"Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_off","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1010,"y":1900,"wires":[[]]},{"id":"7bf01927.d253a8","type":"api-call-service","z":"444fced8.33ecb","name":"Quarto","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_off","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":910,"y":1800,"wires":[[]]},{"id":"d25a67f2.63dd58","type":"api-call-service","z":"444fced8.33ecb","name":"Alexa fala Olá pelo HA","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4780,"y":1640,"wires":[[]]},{"id":"d1bb1156.06898","type":"api-call-service","z":"554bb518.994efc","name":"Alexa fala Olá pelo HA","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media_echo_dot_da_sala","entityId":"","data":"{ \"message\": \"{{payload}}\", \"data\": { \"type\": \"tts\" }, \"target\": \"{{service}}\" }","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":540,"y":960,"wires":[[]]},{"id":"ed1efe74.9b07a","type":"api-call-service","z":"554bb518.994efc","name":"Alexa anuncia Olá pelo HA","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media_echo_dot_da_sala","entityId":"","data":"{ \"message\": \"{{payload}}\", \"data\": { \"type\": \"announce\" }, \"target\": \"{{service}}\" }","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":560,"y":1020,"wires":[[]]},{"id":"aa85408.edca4c","type":"api-call-service","z":"554bb518.994efc","name":"Alexa anuncia Olá pelo HA","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media_echo_dot_da_sala","entityId":"","data":"{ \"message\": \"{{payload}}\", \"data\": { \"type\": \"announce\", \"method\":\"speak\" }, \"target\": \"{{service}}\" }","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":560,"y":1080,"wires":[[]]},{"id":"78c68f27.131b6","type":"api-call-service","z":"444fced8.33ecb","name":"Alexa toca campainha 1","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4790,"y":840,"wires":[[]]},{"id":"51eef913.b3ab68","type":"api-call-service","z":"444fced8.33ecb","name":"Alexa toca campainha 2","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4790,"y":900,"wires":[[]]},{"id":"93bcf598.a6ce38","type":"api-call-service","z":"444fced8.33ecb","name":"Alexa toca campainha 3","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4790,"y":960,"wires":[[]]},{"id":"2d31da8d.2a48b6","type":"api-call-service","z":"444fced8.33ecb","name":"Alexa som de natal","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4770,"y":1020,"wires":[[]]},{"id":"edaba96b.e4f778","type":"api-call-service","z":"444fced8.33ecb","name":"Alexa barulho de terror","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4780,"y":1080,"wires":[[]]},{"id":"a44198ee.7be1a8","type":"api-call-service","z":"444fced8.33ecb","name":"Alexa cheer","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4750,"y":1140,"wires":[[]]},{"id":"cb832669.f36e88","type":"api-call-service","z":"444fced8.33ecb","name":"Alexa barulho de zap","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4780,"y":1200,"wires":[[]]},{"id":"20b3fd7.da88402","type":"api-call-service","z":"444fced8.33ecb","name":"Alexa barulho de relogio","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4790,"y":1260,"wires":[[]]},{"id":"33b1bb87.6b1a74","type":"api-call-service","z":"444fced8.33ecb","name":"Alexa barulho de galo","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4780,"y":1320,"wires":[[]]},{"id":"ce05e556.9c5808","type":"api-call-service","z":"444fced8.33ecb","name":"Alexa conta piada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4770,"y":1420,"wires":[[]]},{"id":"6e5eb1f2.c2de4","type":"api-call-service","z":"444fced8.33ecb","name":"Alexa conta piada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4770,"y":1480,"wires":[[]]},{"id":"7b144007.9be49","type":"api-call-service","z":"444fced8.33ecb","name":"Liga rotina da Alexa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4770,"y":1560,"wires":[[]]},{"id":"8c3e146d.e06b98","type":"api-call-service","z":"444fced8.33ecb","name":"Alexa anuncia Olá pelo HA","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media_echo_dot_do_quarto","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{service}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":4800,"y":1720,"wires":[[]]},{"id":"2f8673c6.69e92c","type":"api-call-service","z":"444fced8.33ecb","name":"Liga rotina da Alexa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":950,"y":2120,"wires":[[]]},{"id":"f409bec3.fbc9","type":"api-call-service","z":"859b066a.dd8128","name":"Flor","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.flor","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3110,"y":1180,"wires":[[]]},{"id":"dfd9d82.6a62528","type":"api-call-service","z":"859b066a.dd8128","name":"Flor","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.flor","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":980,"y":2560,"wires":[[]]},{"id":"73661948.9a4f58","type":"api-call-service","z":"d67ca66.293d758","name":"Desliga a Cafeteira","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.cafeteira","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1190,"y":1620,"wires":[[]]},{"id":"67687946.7e8118","type":"api-call-service","z":"859b066a.dd8128","name":"Fire TV","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_off","entityId":"media_player.fire_tv, media_player.fire_tv_2","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":980,"y":2500,"wires":[[]]},{"id":"3b4850dd.d3f53","type":"api-call-service","z":"859b066a.dd8128","name":"Tomada TV","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.tomada_tv_quarto","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":990,"y":2440,"wires":[[]]},{"id":"4376ca8e.370404","type":"api-call-service","z":"444fced8.33ecb","name":"Add Item Shopping List","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"shopping_list","service":"add_item","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":810,"y":220,"wires":[[]]},{"id":"330dd2a9.829e9e","type":"api-call-service","z":"444fced8.33ecb","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":750,"y":280,"wires":[[]]},{"id":"345fa672.00beea","type":"api-call-service","z":"859b066a.dd8128","name":"Lâmpada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.lampada","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3115,"y":1820,"wires":[[]]},{"id":"793d91c6.19af3","type":"api-call-service","z":"859b066a.dd8128","name":"Lâmpada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.lampada","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1500,"y":1960,"wires":[[]]},{"id":"817700e0.41833","type":"api-call-service","z":"859b066a.dd8128","name":"Lâmpada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.lampada","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1734.4443359375,"y":2179.9998779296875,"wires":[[]]},{"id":"2c252d54.6a0d92","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Alguém em Casa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.alguem_em_casa","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1550,"y":220,"wires":[[]]},{"id":"9bd8b440.a18d68","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Alguém em Casa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.alguem_em_casa","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1990,"y":300,"wires":[[]]},{"id":"b4fe4713.cf86c8","type":"api-call-service","z":"444fced8.33ecb","name":"Flor","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.flor","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1470,"y":800,"wires":[[]]},{"id":"6ffdbd0.9a4a944","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Quarto Nédi Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.quarto_nedi_ocupado_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1480,"y":740,"wires":[[]]},{"id":"23c48ba4.c0be94","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Cozinha Ocupada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.cozinha_ocupada_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1470,"y":620,"wires":[[]]},{"id":"e19e2e86.320b9","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Sala Ocupada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.sala_ocupada_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1460,"y":380,"wires":[[]]},{"id":"f5da50f6.4f0a9","type":"api-call-service","z":"2bbba447.a4759c","name":"Banheiro Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.banheiro_ocupado_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2693,"y":189,"wires":[[]]},{"id":"63e6332f.2989ac","type":"api-call-service","z":"859b066a.dd8128","name":"Quarto Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"binary_sensor.quarto_ocupado","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3130,"y":1400,"wires":[[]]},{"id":"184e69f9.5c17a6","type":"api-call-service","z":"e7cd1901.ee2408","name":"Sala Ocupada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_off","entityId":"input_boolean.sala_ocupada_switch","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2480,"y":1000,"wires":[[]]},{"id":"2a0e2015.b584f","type":"api-call-service","z":"444fced8.33ecb","name":"Apple TV","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"media_play_pause","entityId":"media_player.apple_tv","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":840,"y":2640,"wires":[[]]},{"id":"c635d49e.ea96a8","type":"api-call-service","z":"5767c936.cabd18","name":"Sala Ocupada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_off","entityId":"input_boolean.sala_ocupada_switch","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2561,"y":831,"wires":[[]]},{"id":"1bc561f3.21090e","type":"api-call-service","z":"d67ca66.293d758","name":"Luz do Banheiro","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.cafeteira","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1180,"y":1560,"wires":[[]]},{"id":"364eaeaf.def002","type":"api-call-service","z":"444fced8.33ecb","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1210,"y":2220,"wires":[[]]},{"id":"744d12ad.5a64ac","type":"api-call-service","z":"d67ca66.293d758","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1170,"y":1740,"wires":[[]]},{"id":"f578d1a6.284bb","type":"api-call-service","z":"444fced8.33ecb","name":"Notify Nédi's iPhone","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1460,"y":2220,"wires":[[]]},{"id":"9b4e3a94.a2fa78","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Sala Ocupada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"binary_sensor","service":"turn_on","entityId":"binary_sensor.sala_ocupada","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1980,"y":440,"wires":[[]]},{"id":"4821aef.fa5a95","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Cozinha Ocupada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"binary_sensor","service":"turn_on","entityId":"binary_sensor.cozinha_ocupada","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1990,"y":680,"wires":[[]]},{"id":"450a41b6.47521","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Quarto Nédi Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.quarto_nedi_ocupado_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2000,"y":800,"wires":[[]]},{"id":"9d43e026.111f9","type":"api-call-service","z":"d67ca66.293d758","name":"Notifica","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"","service":"","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":807,"y":2020,"wires":[[]]},{"id":"be7ef1ea.3760c","type":"api-call-service","z":"444fced8.33ecb","name":"Fita do Quarto ","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.fita_do_quarto_ha","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1500,"y":620,"wires":[[]]},{"id":"181bced0.749d31","type":"api-call-service","z":"444fced8.33ecb","name":"Sala Ocupada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"input_boolean.sala_ocupada_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":780,"y":340,"wires":[[]]},{"id":"7b04e543.e5ac8c","type":"api-call-service","z":"444fced8.33ecb","name":"Quarto Nédi Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"input_boolean.quarto_nedi_ocupado_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":800,"y":400,"wires":[[]]},{"id":"916545e5.635aa8","type":"api-call-service","z":"444fced8.33ecb","name":"Cozinha Ocupada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"input_boolean.cozinha_ocupada_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":790,"y":520,"wires":[[]]},{"id":"eb756d67.5b8c7","type":"api-call-service","z":"d67ca66.293d758","name":"Home Assistant","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1140,"y":2540,"wires":[[]]},{"id":"e7c9d71f.790548","type":"api-call-service","z":"e7cd1901.ee2408","name":"Luz da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_da_sala","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3510,"y":80,"wires":[[]]},{"id":"142cf903.1b62c7","type":"api-call-service","z":"5767c936.cabd18","name":"Luz do Escritório 1","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_escritorio_1","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3650,"y":300,"wires":[[]]},{"id":"ba5122b.ccbdfe","type":"api-call-service","z":"444fced8.33ecb","name":"Quarto Maria Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"input_boolean.quarto_maria_ocupado_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":800,"y":460,"wires":[[]]},{"id":"56811ca4.681924","type":"api-call-service","z":"444fced8.33ecb","name":"Rainbow Slow","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.rainbow_slow","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1500,"y":500,"wires":[[]]},{"id":"2fafdb42.3f1dc4","type":"api-call-service","z":"859b066a.dd8128","name":"All effects","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.3_cores, light.chase, light.chase_2, light.dark_cloud, light.hollywood, light.holofote, light.loading_bar, light.oliver, light.palette, light.purple_green_palette, light.rainbow, light.rainbow_slow, light.rainbow_stripes, light.random, light.sparkles, light.sparkles_colorido, light.unicornio","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1140,"y":2380,"wires":[[]]},{"id":"18a27b29.899f75","type":"api-call-service","z":"859b066a.dd8128","name":"RGB Strip","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.rgb_strip","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3130,"y":1120,"wires":[[]]},{"id":"2e1d9879.f46658","type":"api-call-service","z":"859b066a.dd8128","name":"All effects","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.3_cores, light.chase, light.chase_2, light.dark_cloud, light.hollywood, light.holofote, light.loading_bar, light.oliver, light.palette, light.purple_green_palette, light.rainbow, light.rainbow_slow, light.rainbow_stripes, light.random, light.sparkles, light.sparkles_colorido, light.unicornio","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3240,"y":1000,"wires":[[]]},{"id":"e8799273.d7905","type":"api-call-service","z":"444fced8.33ecb","name":"Notify MacBook","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_macbook_pro_de_nedison","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1420,"y":2280,"wires":[[]]},{"id":"2cbc6790.bfe668","type":"api-call-service","z":"d67ca66.293d758","name":"Notify MacBook","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1380,"y":1880,"wires":[[]]},{"id":"1ae5f225.e369fe","type":"api-call-service","z":"d67ca66.293d758","name":"Notify Nédi's iPhone","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1400,"y":1820,"wires":[[]]},{"id":"e204e475.d4aca8","type":"api-call-service","z":"444fced8.33ecb","name":"Notify Pai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_softcelular","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1400,"y":2340,"wires":[[]]},{"id":"e187b40f.c08868","type":"api-call-service","z":"d67ca66.293d758","name":"Notify Pai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_softcelular","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1360,"y":1940,"wires":[[]]},{"id":"2b383006.609fc","type":"api-call-service","z":"444fced8.33ecb","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\"},\"message\":\"{{ [\\\"O almoço está pronto.\\\", \\\"O almoço está prontinho.\\\",\\\"Tem almoço quentinho na mesa.\\\",\\\"O almoço está na mesa.\\\",\\\"Corre pra mesa, o almoço está pronto.\\\",\\\"O almoço está pronto na mesa.\\\",\\\"O almoço está quentinho te esperando.\\\"]|random }}\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_do_quarto_nedi\",\"media_player.echo_dot_do_quarto_maria\",\"media_player.echo_dot_do_quarto_pai\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":930,"y":2760,"wires":[[]]},{"id":"f4fb0b93.88f248","type":"api-call-service","z":"444fced8.33ecb","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"{{ [\\\"O Café está pronto.\\\",\\\"O Café está prontinho.\\\",\\\"Tem café quentinho na cozinha.\\\",\\\"Tem café na cozinha.\\\",\\\"Corre pra cozinha, o café está pronto.\\\",\\\"O Café está pronto na cozinha.\\\",\\\"O Café está quentinho te esperando.\\\"]|random }}\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_do_quarto_nedi\",\"media_player.echo_dot_do_quarto_pai\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1050,"y":2160,"wires":[[]]},{"id":"a7423af1.5b9b38","type":"api-call-service","z":"d67ca66.293d758","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"{{ [\\\"O Café está pronto.\\\",\\\"O Café está prontinho.\\\",\\\"Tem café quentinho na cozinha.\\\",\\\"Tem café na cozinha.\\\",\\\"Corre pra cozinha, o café está pronto.\\\",\\\"O Café está pronto na cozinha.\\\",\\\"O Café está quentinho te esperando.\\\"]|random }}\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\",\"media_player.echo_dot_do_quarto_pai\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":990,"y":1680,"wires":[[]]},{"id":"4aad5e64.a78a5","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Quarto Maria Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.quarto_maria_ocupado_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1480,"y":880,"wires":[[]]},{"id":"9a60745.c28a788","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Quarto Nédi Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.quarto_maria_ocupado_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2000,"y":940,"wires":[[]]},{"id":"fa9fbc55.e8df4","type":"api-call-service","z":"d67ca66.293d758","name":"Boa noite","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":610,"y":2620,"wires":[[]]},{"id":"e21d43ff.c4614","type":"api-call-service","z":"d67ca66.293d758","name":"Vou Dormir","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":620,"y":2680,"wires":[[]]},{"id":"b5022911.dfe1e8","type":"api-call-service","z":"d3db5d74.fb8fa","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2530,"y":1920,"wires":[[]]},{"id":"4cfc883b.142618","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Notify Nédi's iPhone","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2780,"y":1980,"wires":[[]]},{"id":"160fe6cf.d20ae9","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Notify MacBook","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_macbook_pro_de_nedison","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2760,"y":2040,"wires":[[]]},{"id":"e89dafc8.93efc","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Notify Pai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_softcelular","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2740,"y":2100,"wires":[[]]},{"id":"f6b82d7f.4e4bb","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Há chance de chover agora e as janelas: {% if is_state(\\\"binary_sensor.janela_quarto_maria\\\", \\\"on\\\") -%} do Quarto Maria, {%- endif %} {% if is_state(\\\"binary_sensor.janela_quarto_nedi\\\", \\\"on\\\") -%} do Quarto Nédi,{%- endif %} {% if is_state(\\\"binary_sensor.janela_quarto_pai\\\", \\\"on\\\") -%} do Quarto Pai,{%- endif %} {% if is_state(\\\"binary_sensor.janela_sala_esquerda\\\", \\\"on\\\") -%} da Sala {%- endif %}  {% if is_state(\\\"binary_sensor.janela_sala_direita\\\", \\\"on\\\") -%} da Sala {%- endif %} estão aberta\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_do_quarto_nedi\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":2370,"y":1860,"wires":[[]]},{"id":"96d328b3.543e68","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_maria_s_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2750,"y":2160,"wires":[[]]},{"id":"3ed4d074.96f81","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1310,"y":460,"wires":[[]]},{"id":"af726ffe.24617","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify MacBook","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1340,"y":580,"wires":[[]]},{"id":"724baa3f.406c04","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi's iPhone","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1360,"y":520,"wires":[[]]},{"id":"9e1eb3c4.3e713","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Pai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_softcelular","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1320,"y":340,"wires":[[]]},{"id":"c49430f1.7a9de","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Maria. Hoje é seu dia de lavar a louça\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":220,"wires":[[]]},{"id":"c7ed63b7.74073","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_maria_s_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1330,"y":280,"wires":[[]]},{"id":"ff5115c0.b26c68","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cristófer. Hoje é seu dia de lavar a louça\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":400,"wires":[[]]},{"id":"e790e9be.717668","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Nédi. Hoje é seu dia de lavar a louça\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":640,"wires":[[]]},{"id":"90077918.20bc78","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1870,"y":3140,"wires":[[]]},{"id":"cfee3ce7.24f6c","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify MacBook","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1900,"y":3260,"wires":[[]]},{"id":"cb3cd3e5.3ec49","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi's iPhone","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1920,"y":3200,"wires":[[]]},{"id":"36312c40.f34eb4","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Pai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_softcelular","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1880,"y":3020,"wires":[[]]},{"id":"b2a83312.9c275","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Maria. Hoje é seu dia de lavar a roupa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1710,"y":2900,"wires":[[]]},{"id":"562c2738.d5d178","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_maria_s_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1890,"y":2960,"wires":[[]]},{"id":"f83db5ad.07d688","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cristófer. Hoje é seu dia de lavar a roupa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1710,"y":3080,"wires":[[]]},{"id":"26812f11.fb543","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Nédi. Hoje é seu dia de lavar a roupa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1710,"y":3320,"wires":[[]]},{"id":"17191daa.11b972","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1870,"y":3680,"wires":[[]]},{"id":"f651923f.adf3","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify MacBook","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1900,"y":3800,"wires":[[]]},{"id":"e800b86b.ae0198","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi's iPhone","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1920,"y":3740,"wires":[[]]},{"id":"72bafa5e.611894","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Pai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_softcelular","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1880,"y":3560,"wires":[[]]},{"id":"a1313278.12632","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Maria. Hoje é seu dia de levar o lixo\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1710,"y":3440,"wires":[[]]},{"id":"cbd6f6e7.574348","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_maria_s_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1890,"y":3500,"wires":[[]]},{"id":"b829a5.308f3658","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cristófer. Hoje é seu dia de levar o lixo\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1710,"y":3620,"wires":[[]]},{"id":"ed51ac4c.90dbc","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Nédi. Hoje é seu dia de levar o lixo\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1710,"y":3860,"wires":[[]]},{"id":"4ab79159.2d5a9","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1690,"y":4200,"wires":[[]]},{"id":"dec70c72.9e0d3","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify MacBook","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1720,"y":4320,"wires":[[]]},{"id":"68d446ac.aa3e78","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi's iPhone","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1740,"y":4260,"wires":[[]]},{"id":"8b585c69.df8bd","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Pai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_softcelular","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1700,"y":4080,"wires":[[]]},{"id":"669f4194.5e245","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Maria. A roupa já deve estar seca\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1530,"y":3960,"wires":[[]]},{"id":"7300173c.056218","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_maria_s_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1710,"y":4020,"wires":[[]]},{"id":"65ca6d3e.6c6414","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cristófer. A roupa já deve estar seca\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1530,"y":4140,"wires":[[]]},{"id":"bd2043b.25187c","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Nédi. A roupa já deve estar seca\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1530,"y":4380,"wires":[[]]},{"id":"1804bb95.24e424","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1710,"y":4780,"wires":[[]]},{"id":"8d9bf81f.2ea748","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify MacBook","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1740,"y":4900,"wires":[[]]},{"id":"64ea7cd7.760784","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi's iPhone","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1760,"y":4840,"wires":[[]]},{"id":"4a49619b.b11d6","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Pai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_softcelular","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1720,"y":4660,"wires":[[]]},{"id":"a563d3b7.22322","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Maria, é sua vez de estender a roupa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1550,"y":4520,"wires":[[]]},{"id":"b5d7e180.ae7d3","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_maria_s_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1730,"y":4600,"wires":[[]]},{"id":"26249e87.c4bb52","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cristófer, é sua vez de estender a roupa.\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_pai\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1550,"y":4720,"wires":[[]]},{"id":"750e76aa.199378","type":"api-call-service","z":"859b066a.dd8128","name":"Ventilador","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.ventilador","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1160,"y":3040,"wires":[[]]},{"id":"655f3b49.057eb4","type":"api-call-service","z":"859b066a.dd8128","name":"Luz do Quarto","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2600,"y":1780,"wires":[[]]},{"id":"df583e49.c659f","type":"api-call-service","z":"859b066a.dd8128","name":"Luz do Quarto","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4080,"y":1700,"wires":[[]]},{"id":"7c8962c4.d668fc","type":"api-call-service","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2590,"y":920,"wires":[[]]},{"id":"1af4195f.5b5297","type":"api-call-service","z":"2bbba447.a4759c","name":"Banheiro Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.banheiro_ocupado_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1550,"y":780,"wires":[[]]},{"id":"88e11aa0.ea33f8","type":"api-call-service","z":"5767c936.cabd18","name":"Abajures","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.abajur_direita","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2661,"y":580,"wires":[[]]},{"id":"90386d3.76d279","type":"api-call-service","z":"444fced8.33ecb","name":"Tomada TV Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"swich","service":"turn_on","entityId":"switch.tomada_tv_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":930,"y":2860,"wires":[[]]},{"id":"6a78346b.28ebdc","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Mariana. Hoje é seu dia de lavar a louça\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":700,"wires":[[]]},{"id":"30c4bd48.a31952","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cleusa. Hoje é seu dia de lavar a louça\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":780,"wires":[[]]},{"id":"f6c95af8.213898","type":"api-call-service","z":"444fced8.33ecb","name":"Notify Alexa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":1230,"y":3600,"wires":[[]]},{"id":"6731d3c5.5a9b0c","type":"api-call-service","z":"444fced8.33ecb","name":"Notify Alexa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":1230,"y":3660,"wires":[[]]},{"id":"c0122428.4fdf18","type":"api-call-service","z":"444fced8.33ecb","name":"Notify Alexa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":1230,"y":3720,"wires":[[]]},{"id":"84c6767b.e68148","type":"api-call-service","z":"444fced8.33ecb","name":"Notify Alexa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":1230,"y":3780,"wires":[[]]},{"id":"13299b9f.ed8554","type":"api-call-service","z":"444fced8.33ecb","name":"Notify Alexa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":1230,"y":3840,"wires":[[]]},{"id":"227d045a.71d77c","type":"api-call-service","z":"444fced8.33ecb","name":"Notify Alexa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":1230,"y":3900,"wires":[[]]},{"id":"2592ece0.90f874","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1310,"y":1080,"wires":[[]]},{"id":"bbaa258f.3c5dc8","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify MacBook","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1340,"y":1200,"wires":[[]]},{"id":"e48e4de1.dcedd","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi's iPhone","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1360,"y":1140,"wires":[[]]},{"id":"af1ac5b5.2edd38","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Pai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_softcelular","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1320,"y":960,"wires":[[]]},{"id":"446f4589.68cb0c","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Maria. Hoje é seu dia de arrumar a mesa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":840,"wires":[[]]},{"id":"1732489f.b4bf57","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_maria_s_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1330,"y":900,"wires":[[]]},{"id":"b6f5757c.48cd98","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cristófer. Hoje é seu dia de arrumar a mesa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":1020,"wires":[[]]},{"id":"ab991015.11616","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Nédi. Hoje é seu dia de arrumar a mesa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":1260,"wires":[[]]},{"id":"f6f84721.a0a328","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Mariana. Hoje é seu dia de arrumar a mesa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":1320,"wires":[[]]},{"id":"cfa7af2f.b0c2c","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cleusa. Hoje é seu dia de arrumar a mesa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":1400,"wires":[[]]},{"id":"6120cee2.045ba","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1310,"y":1740,"wires":[[]]},{"id":"425a0c3a.ee4394","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify MacBook","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1340,"y":1860,"wires":[[]]},{"id":"615e19b6.fa9058","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi's iPhone","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1360,"y":1800,"wires":[[]]},{"id":"1b398868.546ed8","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Pai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_softcelular","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1320,"y":1620,"wires":[[]]},{"id":"b843169a.9eaa98","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Maria. Hoje é seu dia de arrumar e limpar a cozinha\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":1500,"wires":[[]]},{"id":"f238d117.d7a65","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_maria_s_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1330,"y":1560,"wires":[[]]},{"id":"8ef6fd7b.134b8","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cristófer. Hoje é seu dia de arrumar e limpar a cozinha\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":1680,"wires":[[]]},{"id":"ec9b4920.be1ac8","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Nédi. Hoje é seu dia de arrumar e limpar a cozinha\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":1920,"wires":[[]]},{"id":"4b6f284e.1139a8","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Mariana. Hoje é seu dia de arrumar e limpar a cozinha\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":1980,"wires":[[]]},{"id":"f5000d4b.74a9e","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cleusa. Hoje é seu dia de arrumar e limpar a cozinha\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":2060,"wires":[[]]},{"id":"6f58ca8e.048b94","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1310,"y":2380,"wires":[[]]},{"id":"31948f25.2f2cd","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify MacBook","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1340,"y":2500,"wires":[[]]},{"id":"58341600.ba1368","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi's iPhone","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1360,"y":2440,"wires":[[]]},{"id":"45dd6492.0006cc","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Pai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_softcelular","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1320,"y":2260,"wires":[[]]},{"id":"43e52cf5.3e7ee4","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Maria. Hoje é seu dia de fazer o almoço\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":2140,"wires":[[]]},{"id":"68b39efe.27e76","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_maria_s_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1330,"y":2200,"wires":[[]]},{"id":"54ff00d4.4fe9","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cristófer. Hoje é seu dia de fazer o almoço\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":2320,"wires":[[]]},{"id":"573b9ed7.9701f","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Mariana. Hoje é seu dia de fazer o almoço\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":2560,"wires":[[]]},{"id":"23ae8fa.232b57","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Mariana. Hoje é seu dia de arrumar a mesa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":2620,"wires":[[]]},{"id":"680d3cd7.7b3284","type":"api-current-state","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":530,"y":1300,"wires":[["1bf5970a.d99939","81a6fdf6.25452"]]},{"id":"b19f1845.20a6e8","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Corredor escuro?","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"5","halt_if_type":"num","halt_if_compare":"lt","override_topic":false,"entity_id":"sensor.sensor_de_luz_corredor","state_type":"num","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":750,"y":1100,"wires":[["eb38b384.65fda"],["eb38b384.65fda"]]},{"id":"55f5a77a.253908","type":"api-current-state","z":"4c9c764d.9c4468","name":"Sala Ocupada","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.sala_ocupada","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1000,"y":340,"wires":[["e53fd18b.10dd3","7840428.2ec55bc"],["e53fd18b.10dd3","7840428.2ec55bc"]]},{"id":"74c414e5.0afb0c","type":"api-current-state","z":"859b066a.dd8128","name":"RGB Strip","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"light.rgb_strip","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1350,"y":1280,"wires":[["ce1bcdf1.593cb"],["ce1bcdf1.593cb"]]},{"id":"89da767e.34ade8","type":"api-current-state","z":"2bbba447.a4759c","name":"Banheiro Ocupado","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.banheiro_ocupado","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":730,"y":420,"wires":[["52b72dee.4176d4"]]},{"id":"646d904c.6769f","type":"api-current-state","z":"2ea7fd8b.7e0bb2","name":"Vó Em Casa","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.vo_em_casa","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":350,"y":220,"wires":[["e588ecf4.3d63d"],["e588ecf4.3d63d"]]},{"id":"538cd4f9.edfb1c","type":"api-current-state","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2975,"y":1620,"wires":[["9a840250.37c4f"]]},{"id":"2007e720.2de1f8","type":"api-current-state","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":870,"y":2620,"wires":[["21abaed9.616a12"]]},{"id":"b7254c11.8a6fe","type":"api-current-state","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2000,"y":220,"wires":[["dd96d778.8e89b8","f2c4c73c.d2fef8"]]},{"id":"f54150fe.25a9","type":"api-current-state","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":930,"y":820,"wires":[["5fe91ddd.b4ae94"]]},{"id":"1a8b27f1.115c48","type":"api-current-state","z":"4c9c764d.9c4468","name":"Sala Ocupada","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.sala_ocupada","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1360,"y":180,"wires":[["a2a4940d.a23088"],["a2a4940d.a23088"]]},{"id":"dea9e275.a6cd1","type":"api-current-state","z":"e7cd1901.ee2408","name":"Luz da Sala","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_da_sala","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1570,"y":200,"wires":[["95c52976.c05758","4b0ffe36.4217f"]]},{"id":"41b9df88.d6a34","type":"api-current-state","z":"5767c936.cabd18","name":"Luz do Escritório","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_escritorio_1","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1590,"y":280,"wires":[["10709ab7.2877a5"]]},{"id":"722918db.057468","type":"api-current-state","z":"444fced8.33ecb","name":"Nédi home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1050,"y":2280,"wires":[["523b3264.d38f2c","333d133.c2f93ec"]]},{"id":"cdde1573.915d88","type":"api-current-state","z":"d67ca66.293d758","name":"Nédi home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.nedi_2","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":990,"y":1820,"wires":[["6e9440a1.3fa3a","2426b618.2e080a"]]},{"id":"761491ab.47174","type":"api-current-state","z":"859b066a.dd8128","name":"Nédi home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":930,"y":2040,"wires":[["bee5557c.627e48"]]},{"id":"c580857d.99c3c8","type":"api-current-state","z":"d67ca66.293d758","name":"Updater?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.updater","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":437,"y":1960,"wires":[["9ab5d2cd.a93c5"]]},{"id":"7092e720.21bfb8","type":"api-current-state","z":"444fced8.33ecb","name":"Papai home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.cristofer","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1030,"y":2400,"wires":[["1d5f55ac.ab204a"]]},{"id":"3f801c92.47f5f4","type":"api-current-state","z":"d67ca66.293d758","name":"Papai home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.cristofer","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":990,"y":1940,"wires":[["96c42809.0e0038"]]},{"id":"1ad8fab2.69e7a5","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Janela Quarto Maria","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.janela_quarto_maria","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1710,"y":1620,"wires":[["56c92056.79c58"]]},{"id":"96da81b6.00201","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Janela Quarto Nédi","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.janela_quarto_nedi","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1700,"y":1680,"wires":[["b17398e3.0f3eb8"]]},{"id":"3e92f633.39663a","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Janela Quarto Pai","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.janela_quarto_pai","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1700,"y":1740,"wires":[["527d99bb.e6e388"]]},{"id":"49601c4b.d52b24","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Janela Sala Esquerda","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.janela_sala_esquerda","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1710,"y":1860,"wires":[["e46425ff.0ef6f8"]]},{"id":"fdd737c0.8ed7b8","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Chuva?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"weather.home","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1671,"y":1920,"wires":[["31ec1a11.2d0896","ff4db3ea.6494a","10dc082e.ac79a"]]},{"id":"3d875b2c.2db814","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Nédi home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2370,"y":1980,"wires":[["e4ce18a4.6f27c8","b6eccf3b.11e16"]]},{"id":"a18727e7.097b68","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Papai home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.cristofer","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2370,"y":2100,"wires":[["ba4f2035.9e641"]]},{"id":"dd6f98e5.66aaf8","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Maria home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.maria","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2370,"y":2160,"wires":[["391eeadd.0a78d6"]]},{"id":"63d3e63.7cb6f18","type":"api-current-state","z":"7b0de646.c85c78","name":"Nédi home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":430,"y":2440,"wires":[["7d6c8c4e.304f14"]]},{"id":"44f37172.e6c4c","type":"api-current-state","z":"2ea7fd8b.7e0bb2","name":"TV da Sala","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"media_player.tv_da_sala","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":350,"y":280,"wires":[["808a5ff8.37167"]]},{"id":"5f47554c.dcf13c","type":"api-current-state","z":"2ea7fd8b.7e0bb2","name":"Fire TV","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"media_player.fire_tv","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":360,"y":400,"wires":[["bdaa44f3.e86668"]]},{"id":"ccea9dd.3ac356","type":"api-current-state","z":"2ea7fd8b.7e0bb2","name":"Apple TV","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"media_player.apple_tv","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":360,"y":340,"wires":[["37a840c9.0b82f"]]},{"id":"1b287783.476148","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Quem Lava a Louça","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_lava_a_louca","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":680,"y":280,"wires":[["ac33d5bc.aa8068","5a987bdb.ac6c04","68714b3e.4ccae4","56322f3d.4f55e","f9552f8a.45009"]]},{"id":"6d293ca8.24be74","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Dias Sem Lavar a Roupa","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_number.dias_sem_lavar_a_roupa","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":770,"y":2960,"wires":[["b91e061a.d39408"]]},{"id":"853118a2.875f38","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Quem Lava a Roupa","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_lava_a_roupa","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1240,"y":2960,"wires":[["a95e112b.38c53","95ade173.f04fe","374c7c18.47d7a4"]]},{"id":"92be78b6.fbb388","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Dias Sem Levar o Lixo","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_number.dias_sem_levar_o_lixo","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":760,"y":3500,"wires":[["ebbfc12d.075ab"]]},{"id":"ef75412c.fa12d","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Quem Leva o Lixo","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_leva_o_lixo","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1230,"y":3500,"wires":[["70f8b4e8.f374ac","4ec9d9a3.39fd98","3d17cc07.1064b4"]]},{"id":"212aa61a.89a2da","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Quem Lava a Roupa","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_lava_a_roupa","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1060,"y":4020,"wires":[["3d5a35ba.7fd82a","95918114.2ca78","4bc56fc6.d158e"]]},{"id":"1f654b42.851ce5","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Quem Lava a Roupa","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_lava_a_roupa","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1080,"y":4600,"wires":[["ff8f90a2.6bc01","7692d52d.7a6a2c","48db8584.442dac"]]},{"id":"a746ccf6.359e4","type":"api-current-state","z":"859b066a.dd8128","name":"Temperatura","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"sensor.temperatura_quarto_nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":840,"y":3040,"wires":[["868ffa70.694c68"]]},{"id":"d8661a64.1e9758","type":"api-current-state","z":"859b066a.dd8128","name":"Nédi home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":500,"y":3040,"wires":[["9c93669e.1ad888"]]},{"id":"e51e3045.5da4d","type":"api-current-state","z":"859b066a.dd8128","name":"Movimento Aux","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_quarto_nedi_aux","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":530,"y":220,"wires":[["9adbba25.db7a78"]]},{"id":"ca07e16b.baa1b","type":"api-current-state","z":"859b066a.dd8128","name":"Movimento Aux","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_quarto_nedi_aux","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":320,"y":760,"wires":[["6dae747b.76605c"]]},{"id":"16d5dc37.bf8364","type":"api-current-state","z":"2bbba447.a4759c","d":true,"name":"Movimento Quarto Maria","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_quarto_maria","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":850,"y":880,"wires":[["120b8090.260cef"]]},{"id":"1b95a1c2.86787e","type":"api-current-state","z":"444fced8.33ecb","name":"Quem Lava a Roupa","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_lava_a_roupa","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":760,"y":3600,"wires":[["9150be82.f8d1d"]]},{"id":"f1ef2f51.b93de","type":"api-current-state","z":"444fced8.33ecb","name":"Quem Lava a Louça","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_lava_a_louca","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":760,"y":3660,"wires":[["74be5855.d070e8"]]},{"id":"f53f2505.ce6f28","type":"api-current-state","z":"444fced8.33ecb","name":"Quem Faz o Almoço","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_faz_o_almoco","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":760,"y":3720,"wires":[["212a938a.d4921c"]]},{"id":"72aa4e3b.7d9b4","type":"api-current-state","z":"444fced8.33ecb","name":"Quem Lava a Cozinha","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_lava_a_cozinha","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":760,"y":3780,"wires":[["cbd9c72a.6f64a8"]]},{"id":"1b1292a7.58a55d","type":"api-current-state","z":"444fced8.33ecb","name":"Quem Leva o Lixo","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_leva_o_lixo","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":750,"y":3840,"wires":[["c7bb3020.c1e9c"]]},{"id":"a999ddd2.11c2","type":"api-current-state","z":"444fced8.33ecb","name":"Quem Arruma a Mesa","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_arruma_a_mesa","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":760,"y":3900,"wires":[["a72ef4ba.0e1068"]]},{"id":"770ab6c6.431378","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Quem Arruma a Mesa","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_arruma_a_mesa","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":680,"y":900,"wires":[["74c0c669.4d0e38","2cce545e.db7bbc","130d7896.f47fd7","cdaaa9a1.bfd9f8","ae9ff12b.eb648"]]},{"id":"f24e9eb9.587c8","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Quem Lava a Cozinha","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_lava_a_cozinha","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":680,"y":1560,"wires":[["33e7b0a2.2202d","c8159813.b19808","2ff0dba8.d52cc4","815a03c6.edb32","1bdbd9a4.c15266"]]},{"id":"a6f4d0bb.f96a7","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Quem Faz o Almoço","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_faz_o_almoco","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":680,"y":2200,"wires":[["aec19c0c.746cc","12d42236.b0013e","b24e941d.0499b8","2993fa55.853746"]]},{"id":"4f152b26.364244","type":"ha-api","z":"444fced8.33ecb","name":"","server":"d14d7300.ae20c","debugenabled":false,"protocol":"websocket","method":"get","path":"","data":"{\"type\": \"shopping_list/items\"}","dataType":"json","location":"payload","locationType":"msg","responseType":"json","x":730,"y":4460,"wires":[["62fba09.68b566","415161f9.53369"]]},{"id":"43cb6e36.b3727","type":"ha-api","z":"444fced8.33ecb","name":"","server":"d14d7300.ae20c","debugenabled":false,"protocol":"websocket","method":"get","path":"","data":"{\"type\": \"shopping_list/items\"}","dataType":"json","location":"payload","locationType":"msg","responseType":"json","x":870,"y":4340,"wires":[["cabd4650.f81098","4943a9f0.439568"]]},{"id":"af96622f.78ac9","type":"ha-api","z":"554bb518.994efc","name":"","server":"d14d7300.ae20c","debugenabled":false,"protocol":"websocket","method":"get","path":"","data":"{\"type\": \"shopping_list/items\"}","dataType":"json","location":"payload","locationType":"msg","responseType":"json","x":1390,"y":340,"wires":[["2b507ce1.829ea4"]]},{"id":"dd17d6d1.214528","type":"sun events","z":"4c9c764d.9c4468","testmode":false,"verbose":false,"topic":"","name":"Sunset","x":430,"y":420,"wires":[["cbf70672.c70458"]]},{"id":"a70ff2a4.8b495","type":"hb-event","z":"2ea7fd8b.7e0bb2","name":"WiFi","Homebridge":"Homebridge","Manufacturer":"Wifi presence 1.0","Service":"Occupancy Sensor","device":"Homebridge0E:79:18:75:24:85Wifi presence 1.0WiFi00000086","conf":"1e751e4e.9c7702","x":370,"y":160,"wires":[["250cb2cf.f20f0e"]]},{"id":"4f0c4b24.f771a4","type":"hb-status","z":"859b066a.dd8128","d":true,"name":"","Homebridge":"Homebridge","Manufacturer":"MagicHome","Service":"Lightbulb","device":"Homebridge0E:79:18:75:24:85MagicHomeFita do Quarto00000043","conf":"1e751e4e.9c7702","x":2130,"y":360,"wires":[["7cd3a616.9bfae8","81c6103f.955f9"]]},{"id":"aa029cc1.d33f8","type":"hb-status","z":"859b066a.dd8128","d":true,"name":"","Homebridge":"Homebridge","Manufacturer":"MagicHome","Service":"Lightbulb","device":"Homebridge0E:79:18:75:24:85MagicHomeFita do Quarto00000043","conf":"1e751e4e.9c7702","x":2930,"y":1240,"wires":[["5fb1b5ca.290c7c"]]},{"id":"45041c52.418684","type":"hb-status","z":"859b066a.dd8128","d":true,"name":"","Homebridge":"Homebridge","Manufacturer":"MagicHome","Service":"Lightbulb","device":"Homebridge0E:79:18:75:24:85MagicHomeFita do Quarto00000043","conf":"1e751e4e.9c7702","x":870,"y":2800,"wires":[["864f2f47.bdc12"]]},{"id":"9f29212.a7843e","type":"hb-status","z":"859b066a.dd8128","d":true,"name":"","Homebridge":"Homebridge","Manufacturer":"MagicHome","Service":"Lightbulb","device":"Homebridge0E:79:18:75:24:85MagicHomeFita do Quarto00000043","conf":"1e751e4e.9c7702","x":950,"y":720,"wires":[["8fc684ac.1af088"]]},{"id":"f4905f09.cfce1","type":"hb-control","z":"4c9c764d.9c4468","d":true,"name":"","Homebridge":"Homebridge","Manufacturer":"MagicHome","Service":"Lightbulb","device":"Homebridge0E:79:18:75:24:85MagicHomeLuz da TV00000043","conf":"1e751e4e.9c7702","x":1190,"y":1440,"wires":[]},{"id":"8e887755.d13cb8","type":"hb-control","z":"859b066a.dd8128","name":"Fita do Quarto","Homebridge":"Homebridge","Manufacturer":"MagicHome","Service":"Lightbulb","device":"Homebridge0E:79:18:75:24:85MagicHomeFita do Quarto00000043","conf":"1e751e4e.9c7702","x":2000,"y":2800,"wires":[]},{"id":"f51a50d2.41f56","type":"hb-control","z":"859b066a.dd8128","name":"Fita do Quarto","Homebridge":"Homebridge","Manufacturer":"MagicHome","Service":"Lightbulb","device":"Homebridge0E:79:18:75:24:85MagicHomeFita do Quarto00000043","conf":"1e751e4e.9c7702","x":4020,"y":1300,"wires":[]},{"id":"b5177da.2e63d8","type":"hb-control","z":"444fced8.33ecb","name":"Fita do Quarto","Homebridge":"Homebridge","Manufacturer":"MagicHome","Service":"Lightbulb","device":"Homebridge0E:79:18:75:24:85MagicHomeFita do Quarto00000043","conf":"1e751e4e.9c7702","x":1502,"y":560,"wires":[]},{"id":"4c38ce98.51c67","type":"hb-control","z":"859b066a.dd8128","name":"Fita do Quarto","Homebridge":"Homebridge","Manufacturer":"MagicHome","Service":"Lightbulb","device":"Homebridge0E:79:18:75:24:85MagicHomeFita do Quarto00000043","conf":"1e751e4e.9c7702","x":3530,"y":420,"wires":[]},{"id":"c7c5f30d.41a72","type":"hb-control","z":"859b066a.dd8128","name":"Fita do Quarto","Homebridge":"Homebridge","Manufacturer":"MagicHome","Service":"Lightbulb","device":"Homebridge0E:79:18:75:24:85MagicHomeFita do Quarto00000043","conf":"1e751e4e.9c7702","x":2360,"y":720,"wires":[]},{"id":"48503f48.28a35","type":"hb-control","z":"4c9c764d.9c4468","d":true,"name":"","Homebridge":"Homebridge","Manufacturer":"MagicHome","Service":"Lightbulb","device":"Homebridge0E:79:18:75:24:85MagicHomeFita do Escritorio00000043","conf":"1e751e4e.9c7702","x":1170,"y":1380,"wires":[]},{"id":"42cbbce1.6a1f94","type":"hb-control","z":"859b066a.dd8128","name":"Fita do Quarto","Homebridge":"Homebridge","Manufacturer":"MagicHome","Service":"Lightbulb","device":"Homebridge0E:79:18:75:24:85MagicHomeFita do Quarto00000043","conf":"1e751e4e.9c7702","x":2580,"y":1000,"wires":[]},{"id":"21a9e8e3.9bbc08","type":"darksky in","z":"4c9c764d.9c4468","d":true,"darksky":"8f012b2f.669ef8","name":"","key":"","lon":"-51.18650436","lat":"-30.01009828","date":"","time":"","lang":"en","units":"ca","x":430,"y":480,"wires":[["a9a23c75.2095f"]]},{"id":"b4748033.2d69f","type":"darksky in","z":"d3db5d74.fb8fa","darksky":"8f012b2f.669ef8","name":"","key":"","lon":"-51.18650436","lat":"-30.01009828","date":"","time":"","lang":"en","units":"ca","x":1610,"y":2060,"wires":[["c4144b54.079d28","1a87657.8904d1b"]]},{"id":"c853cb4a.0f97e8","type":"pushbullet","z":"859b066a.dd8128","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no Quarto Automation.","chan":"","name":"","x":1340,"y":3700,"wires":[]},{"id":"f83d952e.27ae68","type":"pushbullet","z":"5767c936.cabd18","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no Escritório Automation.","chan":"","name":"","x":1495,"y":2076,"wires":[]},{"id":"2fecdaad.39a646","type":"pushbullet","z":"e7cd1901.ee2408","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no SalaAutomation.","chan":"","name":"","x":1410,"y":1320,"wires":[]},{"id":"4814f202.46ea2c","type":"pushbullet","z":"4c9c764d.9c4468","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no HomeKit Automation.","chan":"","name":"","x":1290,"y":4800,"wires":[]},{"id":"dd589a32.8ce048","type":"pushbullet","z":"2bbba447.a4759c","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no Banheiro Automation.","chan":"","name":"","x":1390,"y":1140,"wires":[]},{"id":"7ae9832b.29fcac","type":"pushbullet","z":"d3db5d74.fb8fa","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no Aqara Sensores Automation","chan":"","name":"","x":1430,"y":3100,"wires":[]},{"id":"642c7690.ce47d8","type":"pushbullet","z":"d67ca66.293d758","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no Home Assistant Automation","chan":"","name":"","x":1430,"y":3980,"wires":[]},{"id":"308fbc11.8da8e4","type":"pushbullet","z":"7b0de646.c85c78","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no Spotify Helpers","chan":"","name":"","x":1510,"y":3140,"wires":[]},{"id":"cf6ffdbe.2c237","type":"pushbullet","z":"444fced8.33ecb","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no Alexa Automation.","chan":"","name":"","x":1400,"y":4840,"wires":[]},{"id":"181802f.9d709fd","type":"e-mail","z":"859b066a.dd8128","server":"smtp.gmail.com","port":"465","secure":true,"tls":true,"name":"nedisonn@me.com","dname":"","x":1250,"y":3760,"wires":[]},{"id":"6ff94495.22d69c","type":"e-mail","z":"5767c936.cabd18","server":"smtp.gmail.com","port":"465","secure":true,"tls":true,"name":"nedisonn@me.com","dname":"","x":1415,"y":2136,"wires":[]},{"id":"90ac006a.915e5","type":"e-mail","z":"e7cd1901.ee2408","server":"smtp.gmail.com","port":"465","secure":true,"tls":true,"name":"nedisonn@me.com","dname":"","x":1330,"y":1380,"wires":[]},{"id":"d6b32035.1477","type":"e-mail","z":"4c9c764d.9c4468","server":"smtp.gmail.com","port":"465","secure":true,"tls":true,"name":"nedisonn@me.com","dname":"","x":1190,"y":4860,"wires":[]},{"id":"6b52e091.61a56","type":"e-mail","z":"2bbba447.a4759c","server":"smtp.gmail.com","port":"465","secure":true,"tls":true,"name":"nedisonn@me.com","dname":"","x":1290,"y":1200,"wires":[]},{"id":"f415c6d8.4cbf48","type":"e-mail","z":"d3db5d74.fb8fa","server":"smtp.gmail.com","port":"465","secure":true,"tls":true,"name":"nedisonn@me.com","dname":"","x":1310,"y":3160,"wires":[]},{"id":"2034f8fb.2e2178","type":"e-mail","z":"d67ca66.293d758","server":"smtp.gmail.com","port":"465","secure":true,"tls":true,"name":"nedisonn@me.com","dname":"","x":1310,"y":4040,"wires":[]},{"id":"f8ce5a3.d77dfa8","type":"e-mail","z":"7b0de646.c85c78","server":"smtp.gmail.com","port":"465","secure":true,"tls":true,"name":"nedisonn@me.com","dname":"","x":1430,"y":3200,"wires":[]},{"id":"93a15a3a.164d48","type":"e-mail","z":"444fced8.33ecb","server":"smtp.gmail.com","port":"465","secure":true,"tls":false,"name":"nedisonn@me.com","dname":"","x":1310,"y":4900,"wires":[]},{"id":"980435a0.32ea78","type":"BooleanLogicUltimate","z":"859b066a.dd8128","name":"","filtertrue":"both","persist":false,"sInitializeWith":"false","triggertopic":"trigger","outputtriggeredby":"all","inputCount":"3","topic":"result","x":2020,"y":1340,"wires":[[],["5bbc4c76.3271a4","d29ab4df.b0de28","a50d5f5c.46e0d"],[]]},{"id":"a4f518c2.079878","type":"BooleanLogicUltimate","z":"5767c936.cabd18","name":"","filtertrue":"both","persist":false,"sInitializeWith":"false","triggertopic":"trigger","outputtriggeredby":"onlyonetopic","inputCount":"3","topic":"result","x":1530,"y":760,"wires":[[],["5e3a273.1f3f4d8","d64c8331.8f764","703ec7a2.e01c68"],[]]},{"id":"b7203386.43b91","type":"BooleanLogicUltimate","z":"e7cd1901.ee2408","name":"","filtertrue":"both","persist":false,"sInitializeWith":"false","triggertopic":"trigger","outputtriggeredby":"onlyonetopic","inputCount":"3","topic":"result","x":1490,"y":860,"wires":[[],["681f184.384a0e8","78eed8d.a5d0028"],[]]},{"id":"5e3a273.1f3f4d8","type":"InvertUltimate","z":"5767c936.cabd18","name":"Invert","x":1810,"y":760,"wires":[["9802b432.06b398"]]},{"id":"681f184.384a0e8","type":"InvertUltimate","z":"e7cd1901.ee2408","name":"Invert","x":1750,"y":860,"wires":[["465bdde4.286d34"]]},{"id":"22c1a09f.a9a0d","type":"yeelight-compat-hue-state","z":"5767c936.cabd18","name":"","server":"2db68ab1.bee496","x":1590,"y":340,"wires":[["9d786bf9.924af8","37b09774.ccc7b8"]]},{"id":"d36d2c87.c9cc8","type":"yeelight-compat-hue-state","z":"e7cd1901.ee2408","name":"","server":"5a8bf4db.2d6bcc","x":1580,"y":260,"wires":[["2c10f23c.fcb11e"]]},{"id":"25b6724e.fcf97e","type":"yeelight-compat-hue-state","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":1119,"y":1500,"wires":[["b52cd23d.eabd2"]]},{"id":"2f8ed67d.22b95a","type":"yeelight-compat-hue-state","z":"2bbba447.a4759c","name":"Luz do Banheiro","server":"56814891.18c868","x":740,"y":300,"wires":[["30922957.6bfc26"]]},{"id":"4933329e.0da91c","type":"yeelight-compat-hue-state","z":"e7cd1901.ee2408","name":"","server":"5a8bf4db.2d6bcc","x":900,"y":800,"wires":[["b0fd8aa9.65c008"]]},{"id":"64ff672c.ba8d78","type":"yeelight-compat-hue-state","z":"5767c936.cabd18","name":"","server":"2db68ab1.bee496","x":900,"y":660,"wires":[["5d67fe55.6d3b9"]]},{"id":"33280499.5ea6bc","type":"yeelight-compat-hue-state","z":"5767c936.cabd18","name":"","server":"2db68ab1.bee496","x":1060,"y":60,"wires":[["bbdbe498.e75468"]]},{"id":"adfe724a.6dadc","type":"yeelight-compat-hue-state","z":"e7cd1901.ee2408","name":"","server":"5a8bf4db.2d6bcc","x":1170,"y":320,"wires":[["be6ae750.e08a88"]]},{"id":"89308aa8.40e6a8","type":"yeelight-compat-hue-state","z":"2bbba447.a4759c","name":"Luz do Banheiro","server":"56814891.18c868","x":3520,"y":420,"wires":[["57b1a1b4.9a528"]]},{"id":"3290497e.d5f816","type":"yeelight-compat-hue-state","z":"5767c936.cabd18","name":"","server":"2db68ab1.bee496","x":390,"y":1380,"wires":[["4892980c.666928"]]},{"id":"9ffef5c0.172838","type":"yeelight-compat-hue-out","z":"5767c936.cabd18","name":"Luz do Escritorio","server":"14b837c9.ab10c","x":3430,"y":240,"wires":[]},{"id":"ef8cbd88.f0403","type":"yeelight-compat-hue-out","z":"e7cd1901.ee2408","name":"Luz da Sala","server":"5a8bf4db.2d6bcc","x":3290,"y":200,"wires":[]},{"id":"337c17d5.a9f378","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"Luz da Sala","server":"5a8bf4db.2d6bcc","x":1115,"y":1220,"wires":[]},{"id":"2aeb6d7.b81e592","type":"yeelight-compat-hue-out","z":"2bbba447.a4759c","name":"Luz do Banheiro","server":"56814891.18c868","x":3300,"y":360,"wires":[]},{"id":"f127ac0f.face3","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":1909,"y":1480,"wires":[]},{"id":"b0620f12.25b7d","type":"yeelight-compat-hue-out","z":"e7cd1901.ee2408","name":"","server":"5a8bf4db.2d6bcc","x":2290,"y":860,"wires":[]},{"id":"e432c868.e95268","type":"yeelight-compat-hue-out","z":"5767c936.cabd18","name":"","server":"14b837c9.ab10c","x":2431,"y":751,"wires":[]},{"id":"bdf393b7.4aafb","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":1909,"y":1540,"wires":[]},{"id":"e1ea9a2.31bd168","type":"yeelight-compat-hue-out","z":"2bbba447.a4759c","name":"Luz do Banheiro","server":"56814891.18c868","x":3830,"y":420,"wires":[]},{"id":"3a30f06f.ca027","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"","server":"5a8bf4db.2d6bcc","x":990,"y":2180,"wires":[]},{"id":"2b1b546.381d4ac","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"","server":"2db68ab1.bee496","x":1010,"y":2300,"wires":[]},{"id":"c6dd6266.3a7bb","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"Luz da Sala","server":"2db68ab1.bee496","x":1050,"y":2980,"wires":[]},{"id":"7a6c3e.100243c4","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"Luz da Sala","server":"5a8bf4db.2d6bcc","x":1030,"y":2920,"wires":[]},{"id":"6b0f1615.6cab68","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"Luz da Sala","server":"2db68ab1.bee496","x":1050,"y":3240,"wires":[]},{"id":"96807431.12f6d8","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"Luz da Sala","server":"5a8bf4db.2d6bcc","x":1030,"y":3180,"wires":[]},{"id":"71edec0.93a0814","type":"yeelight-compat-hue-out","z":"2bbba447.a4759c","name":"Luz do Banheiro","server":"56814891.18c868","x":450,"y":740,"wires":[]},{"id":"74683cb2.be8ac4","type":"yeelight-compat-hue-out","z":"2bbba447.a4759c","name":"Luz do Banheiro","server":"56814891.18c868","x":1370,"y":860,"wires":[]},{"id":"dd9bfc01.ea174","type":"inject","z":"2bbba447.a4759c","name":"","props":[{"p":"payload.on","v":"true","vt":"bool"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":2900,"y":380,"wires":[["eb4434ec.ed1628"]]},{"id":"89fc9ed.7aa91e","type":"yeelight-compat-hue-out","z":"5767c936.cabd18","name":"Luz do Escritorio","server":"2db68ab1.bee496","x":3430,"y":180,"wires":[]},{"id":"2c5d9c1c.9be264","type":"function","z":"5767c936.cabd18","name":"Luz do Escritorio Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_1\"\n        }\n    }};\n    node.send(newMsg)\n    \n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2\"\n        }\n    }};\n    node.send(newMsg)\n    \n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2_hk\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2441,"y":643,"wires":[["9fd07b37.426da8"]]},{"id":"9fd07b37.426da8","type":"api-call-service","z":"5767c936.cabd18","name":"Luz do Escritório 2 Off","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.luz_do_escritorio_2","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2701,"y":643,"wires":[[]]},{"id":"1af7a9e4.d79636","type":"yeelight-compat-hue-out","z":"5767c936.cabd18","name":"","server":"2db68ab1.bee496","x":2431,"y":691,"wires":[]},{"id":"ef0dad43.78086","type":"function","z":"5767c936.cabd18","name":"Luz do Escritorio On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_1\",\n            \"brightness_pct\": 100,\n            \"color_temp\": 153\n        }\n    }};\n    //node.send(newMsg)\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2\",\n            \"brightness_pct\": 100,\n            \"color_temp\": 153\n        }\n    }};\n    //node.send(newMsg)\n    \n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2_hk\",\n            \"brightness_pct\": 100,\n            \"rgb_color\": [255, 249, 242]\n        }\n    }};\n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2600,"y":920,"wires":[["44063c91.9bb50c"]]},{"id":"44063c91.9bb50c","type":"api-call-service","z":"5767c936.cabd18","name":"Luz do Escritório On","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_escritorio","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2860,"y":920,"wires":[[]]},{"id":"81757540.d34d7","type":"function","z":"5767c936.cabd18","name":"Add Topic","func":"var newMsg;\nif(typeof msg.ajuda !== \"undefined\"){\n    if(msg.ajuda === 1){\n        newMsg = {\"topic\":\"Luz2\", \"payload\": true};\n        flow.set(\"triggered3\", false);\n        return newMsg;\n    }\n}\nif(flow.get(\"triggered4\")===true){\n    flow.set(\"triggered4\", false);\n    if(msg.payload === \"on\")\n    {\n        newMsg = {\"topic\":\"Luz2\", \"payload\": true};\n        return newMsg;\n    }\n    if(msg.payload === \"off\")\n    {\n        newMsg = {\"topic\":\"Luz2\",\"payload\": false};\n        return newMsg;\n    }\n\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1100,"y":780,"wires":[["89b7895b.fb9a88"]]},{"id":"b4ad0947.84e188","type":"change","z":"5767c936.cabd18","name":"","rules":[{"t":"set","p":"triggered4","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":650,"y":780,"wires":[["93026f01.f8a9a","a44d5b4c.4c0be"]]},{"id":"93026f01.f8a9a","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":820,"y":720,"wires":[["718e4f93.893918"]]},{"id":"718e4f93.893918","type":"function","z":"5767c936.cabd18","name":"In Case of Error","func":"msg.ajuda = 1;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":980,"y":720,"wires":[["81757540.d34d7"]]},{"id":"89b7895b.fb9a88","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1280,"y":780,"wires":[["a4f518c2.079878"]]},{"id":"a4b1a47.d185b58","type":"change","z":"e7cd1901.ee2408","name":"","rules":[{"t":"set","p":"triggered4","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":900,"wires":[["ceb656d4.09644","32b530a4.c1a65"]]},{"id":"1035b59d.5c9a22","type":"function","z":"e7cd1901.ee2408","name":"Add Topic","func":"var newMsg;\nif(typeof msg.ajuda !== \"undefined\"){\n    if(msg.ajuda === 1){\n        newMsg = {\"topic\":\"LuzEntrada\", \"payload\": true};\n        flow.set(\"triggered3\", false);\n        return newMsg;\n    }\n}\nif(flow.get(\"triggered4\")===true){\n    flow.set(\"triggered4\", false);\n        if(msg.payload.state.on === true)\n        {\n            newMsg = {\"topic\":\"LuzEntrada\", \"payload\": true};\n            return newMsg;\n        }\n        if(msg.payload.state.on === false)\n        {\n            newMsg = {\"topic\":\"LuzEntrada\",\"payload\": false};\n            return newMsg;\n        }\n    \n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1120,"y":900,"wires":[["d18d78b0.dd0e88"]]},{"id":"274c6d62.cc482a","type":"function","z":"e7cd1901.ee2408","name":"In Case of Error","func":"msg.ajuda = 1;\nreturn msg;","outputs":1,"noerr":0,"x":960,"y":860,"wires":[["1035b59d.5c9a22"]]},{"id":"32b530a4.c1a65","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":800,"y":860,"wires":[["274c6d62.cc482a"]]},{"id":"d18d78b0.dd0e88","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1280,"y":900,"wires":[["b7203386.43b91"]]},{"id":"ceb656d4.09644","type":"yeelight-compat-hue-state","z":"e7cd1901.ee2408","name":"","server":"56814891.18c868","x":910,"y":900,"wires":[["1035b59d.5c9a22"]]},{"id":"44c5f3b7.f04ac4","type":"yeelight-compat-hue-out","z":"e7cd1901.ee2408","name":"","server":"56814891.18c868","x":2300,"y":920,"wires":[]},{"id":"33d7f2cf.e657ee","type":"function","z":"e7cd1901.ee2408","name":"Luz da Entrada Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2310,"y":680,"wires":[["be445e21.8c5018"]]},{"id":"586425e0.aad894","type":"function","z":"e7cd1901.ee2408","name":"Luz da Entrada On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\",\n            \"brightness_pct\": 100,\n            \"kelvin\": 6200\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2490,"y":720,"wires":[["be445e21.8c5018"]]},{"id":"be445e21.8c5018","type":"api-call-service","z":"e7cd1901.ee2408","name":"Luz da Entrada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"","entityId":"light.luz_da_entrada","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2700,"y":700,"wires":[[]]},{"id":"f56b8e30.19171","type":"function","z":"e7cd1901.ee2408","name":"Luz da Entrada On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\",\n            \"brightness\": msg.payload.bri,\n            \"kelvin\": msg.payload.ct\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3310,"y":40,"wires":[["57bdd3e1.87d094"]]},{"id":"57bdd3e1.87d094","type":"api-call-service","z":"e7cd1901.ee2408","name":"Luz da Entrada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_da_entrada","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3520,"y":40,"wires":[[]]},{"id":"a775b02e.913eb","type":"link in","z":"ec27da7d.cad118","name":"Quarto On","links":["d7496dca.caa2f"],"x":75,"y":300,"wires":[["7f4886f0.0875e8"]]},{"id":"56e65b9f.fc8204","type":"function","z":"ec27da7d.cad118","name":"Time Check","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\n\n\nif((Hour >= 16 && Hour < 22)){\n    msg = {\"payload\": 1};\n    return msg;\n}\nelse if((Hour <= 8 && Hour >= 22)){\n    msg = {\"payload\": 2};\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2770,"y":300,"wires":[["5cd012a9.f939c4","aa781891.2ebf6"]]},{"id":"5cd012a9.f939c4","type":"switch","z":"ec27da7d.cad118","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":2940,"y":320,"wires":[["c8243cef.4cc668"],["52fdff1c.c454e"]]},{"id":"30a44bf.d0c3634","type":"comment","z":"ec27da7d.cad118","name":"Alguém entrou no quarto","info":"Alguém entrou no quarto e estava com as luzes desligada.","x":1620,"y":220,"wires":[]},{"id":"91258170.3b41f8","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"30","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1730,"y":280,"wires":[["95f26990.dad3e8","2e839e1c.af03c2"]]},{"id":"bc8ed2f6.3c7c28","type":"function","z":"ec27da7d.cad118","name":"Turn On Bright","func":"var i = parseInt(flow.get(\"iterLuzDoQuartoMariaInc\"));\nvar cameFrom = flow.get(\"cameFrom\");\nvar newMsg;\nif (i > 255) {\n        newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.luz_do_quarto_maria\",\n                \"brightness\": 255,\n                \"color_temp\": 204\n            }\n        }};\n        \n        node.send(newMsg);\n        newMsg={reset: true};    \n        return newMsg;\n}\n//if(cameFrom === \"HK\"){\n//    newMsg= {payload : {\n//                \"domain\": \"light\",\n//                \"service\": \"turn_on\",\n//                data:{\n//                    \n//                    \"entity_id\": \"light.luz_do_quarto_maria_hk\",\n//                    \"brightness\": i,\n//                   \"rgb_color\": [i, i, i]\n//                }\n//    }};  \n//    node.send(newMsg);\n//}\nif(cameFrom === \"HA\"){\n    newMsg= {payload : {\n                \"domain\": \"light\",\n                \"service\": \"turn_on\",\n                data:{\n                    \n                    \"entity_id\": \"light.luz_do_quarto_maria\",\n                    \"brightness\": i,\n                    \"color_temp\": 204\n                }\n    }};    \n    node.send(newMsg);\n} \ni += 35\nflow.set(\"iterLuzDoQuartoMariaInc\", i);\nreturn;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3530,"y":300,"wires":[["64c94178.0fbe08","31b720.a63880e"]]},{"id":"f3702718.1abd48","type":"function","z":"ec27da7d.cad118","name":"Turn On Dim","func":"var i = parseInt(flow.get(\"iterLuzDoQuartoMariaInc\"));\nvar cameFrom = flow.get(\"cameFrom\");\nvar newMsg;\nif (i > 150) {\n        return {reset: true};\n}\nif(cameFrom === \"HK\"){\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria_hk\",\n            \"brightness\": parseInt(i/15),\n            \"rgb_color\": [255, 181, 107]\n        }\n    }};\n    node.send(newMsg);\n}\n\nif(cameFrom === \"HA\"){\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria\",\n            \"brightness\": parseInt(i/15),\n            \"rgb_color\": [255, 181, 107]\n        }\n    }};\n    node.send(newMsg);\n}\ni += 50\nflow.set(\"iterLuzDoQuartoMariaInc\", i);\nreturn;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3520,"y":380,"wires":[["839ba67b.88c7e8"]]},{"id":"212c8564.09f82a","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":4220,"y":320,"wires":[["36faa332.af6d94","84344a42.5a6a7"]]},{"id":"e29f4d90.e8fec8","type":"inject","z":"ec27da7d.cad118","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2560,"y":340,"wires":[["56e65b9f.fc8204"]]},{"id":"36faa332.af6d94","type":"debug","z":"ec27da7d.cad118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":4380,"y":380,"wires":[]},{"id":"aa781891.2ebf6","type":"debug","z":"ec27da7d.cad118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2920,"y":220,"wires":[]},{"id":"f1e1977a.6f1fc8","type":"function","z":"ec27da7d.cad118","name":"Check if it's already On","func":"if(msg.payload === \"off\"){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2550,"y":260,"wires":[["56e65b9f.fc8204"]]},{"id":"903722bf.f5bfd","type":"inject","z":"ec27da7d.cad118","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1180,"y":360,"wires":[["20d4a2d7.21cc9e"]]},{"id":"5e3b95d1.e42b0c","type":"debug","z":"ec27da7d.cad118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2230,"y":340,"wires":[]},{"id":"2e26f98f.485b5e","type":"trigger","z":"ec27da7d.cad118","name":"","op1":"1","op2":"0","op1type":"num","op2type":"str","duration":"-250","extend":false,"overrideDelay":false,"units":"ms","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":3330,"y":300,"wires":[["bc8ed2f6.3c7c28"]]},{"id":"c8243cef.4cc668","type":"function","z":"ec27da7d.cad118","name":"Aux Function","func":"flow.set(\"iterLuzDoQuartoMariaInc\", 20);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3120,"y":300,"wires":[["2e26f98f.485b5e"]]},{"id":"52fdff1c.c454e","type":"function","z":"ec27da7d.cad118","name":"Aux Function","func":"flow.set(\"iterLuzDoQuartoMariaInc\", 200);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3120,"y":380,"wires":[["7dcf899f.a47f5"]]},{"id":"7dcf899f.a47f5","type":"trigger","z":"ec27da7d.cad118","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-250","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":3330,"y":380,"wires":[["f3702718.1abd48"]]},{"id":"64c94178.0fbe08","type":"debug","z":"ec27da7d.cad118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3680,"y":240,"wires":[]},{"id":"7555de2d.334b38","type":"function","z":"ec27da7d.cad118","name":"Movimento dentro?","func":"if(msg.payload === \"off\"){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1530,"y":300,"wires":[["91258170.3b41f8"]]},{"id":"839ba67b.88c7e8","type":"switch","z":"ec27da7d.cad118","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":3690,"y":420,"wires":[["212c8564.09f82a"],["7dcf899f.a47f5","3baa292f.b8ea5e"]]},{"id":"31b720.a63880e","type":"switch","z":"ec27da7d.cad118","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":3690,"y":340,"wires":[["212c8564.09f82a"],["2e26f98f.485b5e"]]},{"id":"95f26990.dad3e8","type":"api-current-state","z":"ec27da7d.cad118","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_maria","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1950,"y":300,"wires":[["5e3b95d1.e42b0c","4e054618.f5ace8"]]},{"id":"20d4a2d7.21cc9e","type":"api-current-state","z":"ec27da7d.cad118","name":"Movimento Aux","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_quarto_maria_aux","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1330,"y":300,"wires":[["7555de2d.334b38"]]},{"id":"bd1f6328.84ca2","type":"api-current-state","z":"859b066a.dd8128","name":"Projetor Ceu","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"light.projetor_ceu","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1350,"y":1400,"wires":[["4cf5516a.7f55"],["4cf5516a.7f55"]]},{"id":"1df6f143.b3402f","type":"yeelight-compat-hue-out","z":"e7cd1901.ee2408","name":"Luz da Sala","server":"56814891.18c868","x":3300,"y":140,"wires":[]},{"id":"a44d5b4c.4c0be","type":"api-current-state","z":"5767c936.cabd18","name":"Luz do Escriório 2 HK","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_escritorio_2_hk","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":880,"y":780,"wires":[["81757540.d34d7"]]},{"id":"84344a42.5a6a7","type":"api-call-service","z":"ec27da7d.cad118","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4430,"y":320,"wires":[[]]},{"id":"2e839e1c.af03c2","type":"api-current-state","z":"ec27da7d.cad118","name":"Luz do Quarto Maria HK","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_maria_hk","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1960,"y":240,"wires":[["4e054618.f5ace8","42fe6d4f.76c4e4"]]},{"id":"581daa37.ad1a54","type":"function","z":"444fced8.33ecb","name":"Netflix","func":"if(         (msg.payload.name===\"Echo Dot da Sala\" && (\n        (\n        msg.payload.description.summary.includes('Netflix')===true\n    )))){\n    var newMsg;\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"app\",\n          \"media_content_id\": \"11101200001\"\n        }\n    }\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":490,"y":2440,"wires":[["4be760da.d877"]]},{"id":"9704ea70.dfcb88","type":"function","z":"444fced8.33ecb","name":"Disney Plus","func":"if(         (msg.payload.name===\"Echo Dot da Sala\" && (\n        \n        msg.payload.description.summary.includes('disney plus')===true\n    ))){\n    var newMsg;\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"app\",\n          \"media_content_id\": \"MCmYXNxgcu.DisneyPlus\"\n        }\n    }\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":510,"y":2480,"wires":[["4be760da.d877"]]},{"id":"cf6e490b.bd57d8","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1110,"y":2620,"wires":[]},{"id":"6c79311b.68ced","type":"server-state-changed","z":"859b066a.dd8128","name":"Movimento","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.movimento_quarto_nedi","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":200,"y":500,"wires":[["8d1f178e.806578"],["8d1f178e.806578"]]},{"id":"cc553f2f.68ab8","type":"server-state-changed","z":"859b066a.dd8128","name":"Movimento Aux","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.movimento_quarto_nedi_aux","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":220,"y":560,"wires":[["8d1f178e.806578"],["8d1f178e.806578"]]},{"id":"8d1f178e.806578","type":"function","z":"859b066a.dd8128","name":"Movimento?","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":410,"y":520,"wires":[["ad7eee9a.1e84a8"]]},{"id":"813518c3.c153b8","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"if(msg.payload == false){\n    var date = new Date();\n    var Hour = date.getHours(); //hours in 0-23\n    if(Hour > 21 || Hour < 7){\n        newMsg= {payload : {\n            \"domain\": \"remote\",\n            \"service\": \"send_command\",\n            data:{\n                \"entity_id\": \"remote.rm_mini_3_quarto_remote\",\n                \"device\": \"fita\",\n                \"command\": \"ligar\"\n            }\n        }};\n        node.send(newMsg);\n        newMsg= {payload : {\n            \"domain\": \"remote\",\n            \"service\": \"send_command\",\n            data:{\n                \"entity_id\": \"remote.rm_mini_3_quarto_remote\",\n                \"device\": \"fita\",\n                \"command\": \"aquamarine\"\n            }\n        }};\n        return newMsg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":780,"y":520,"wires":[["f04f2f6b.fb44b","cdfb9483.1eb448"]]},{"id":"1f8cffab.901a3","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"remote\",\n    \"service\": \"send_command\",\n    data:{\n        \"entity_id\": \"remote.rm_mini_3_quarto_remote\",\n        \"device\": \"fita\",\n        \"command\": \"desligar\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.fita_cama\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1440,"y":560,"wires":[["f04f2f6b.fb44b"]]},{"id":"ad7eee9a.1e84a8","type":"api-current-state","z":"859b066a.dd8128","name":"Quarto Nédi on?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"group.luzes_do_quarto_nedi","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":600,"y":560,"wires":[["813518c3.c153b8"]]},{"id":"bf344586.9863a8","type":"server-state-changed","z":"c3fa9bdb.b5c4c8","name":"Máquina de Lavar Roupas","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.sensor_da_maquina_de_lavar_action","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":2350,"y":4540,"wires":[["3d92c90.d75af38","6052aaa5.23f7e4","c4c5e231.078db"]]},{"id":"3d92c90.d75af38","type":"function","z":"c3fa9bdb.b5c4c8","name":"Vibrando?","func":"if( msg.payload === \"vibration\" ||\n    msg.payload === \"tilt\" ||\n    msg.payload === \"drop\" \n    ){\n    vibrationCount = flow.get(\"vibrationCount\");\n    washingMachineStage = flow.get(\"washingMachineStage\")\n    if(vibrationCount > 3 || washingMachineStage == \"Lavando\"){\n        flow.set(\"vibrationCount\", vibrationCount+1);\n        flow.set(\"washingMachineStage\", \"Lavando\")\n        var newMsg;\n        newMsg = {payload:{\n                      \"domain\": \"input_select\",\n                      \"service\": \"select_option\",\n                      \"data\":{\n                      \"entity_id\": \"input_select.maquina_de_lavar_roupas\",\n                        \"option\": \"Lavando\"\n                    }\n                }\n            }\n            return newMsg;\n    \n    }\n    flow.set(\"vibrationCount\", vibrationCount+1);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2570,"y":4540,"wires":[["a991685f.ed5a28","72cc7c65.6be7a4","30ebe780.fd8ac8"]]},{"id":"9c867cd6.62ccf","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Maq Lavar Input Select","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_select","service":"select_option","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3970,"y":4520,"wires":[[]]},{"id":"e7df2829.b0fe88","type":"function","z":"c3fa9bdb.b5c4c8","name":"Acabou","func":"    var newMsg;\n    if(flow.get(\"washingMachineStage\") == \"Lavando\"){ \n        flow.set(\"vibrationCount\", 0);\n        newMsg = {payload:{\n                  \"domain\": \"input_select\",\n                  \"service\": \"select_option\",\n                  \"data\":{\n                  \"entity_id\": \"input_select.maquina_de_lavar_roupas\",\n                    \"option\": \"Pronto\"\n                }\n            }\n        }\n        flow.set(\"washingMachineStage\", \"Pronto\")\n        return newMsg;\n    }","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3220,"y":4500,"wires":[["9c867cd6.62ccf","665518b0.bbb868","dc104c0e.649cc"]]},{"id":"273820d4.f2e2f","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delayv","timeout":"25","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2920,"y":4500,"wires":[["e26a2c5c.ca85"]]},{"id":"3b2f97c2.59f538","type":"function","z":"444fced8.33ecb","name":"Projetor On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.projetor_ceu\",\n        \"brightness\": 60\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1250,"y":860,"wires":[["f4da60c2.4feed8"]]},{"id":"f4da60c2.4feed8","type":"api-call-service","z":"444fced8.33ecb","name":"Projetor Ceu","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.projetor_ceu","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1498,"y":860,"wires":[[]]},{"id":"b90f92de.0e9e6","type":"function","z":"444fced8.33ecb","name":"WoL PC","func":"if(\n    (msg.payload.description.summary.includes('liga')===true || \n    msg.payload.description.summary.includes('ligue')===true ||\n    msg.payload.description.summary.includes('desliga')===false ||\n    msg.payload.description.summary.includes('desligue')===false )&& \n    ((msg.payload.description.summary.includes('p.')===true && \n        msg.payload.description.summary.includes('c.')===true)  ||\n        msg.payload.description.summary.includes('p.c.')===true||\n        msg.payload.description.summary.includes('PC')===true\n    )\n    ){\n    var newMsg;\n    newMsg= {payload : \n                {\n                    \"domain\": \"wake_on_lan\",\n                    \"service\": \"send_magic_packet\",\n                    \"data\":{\n                        \"mac\": \"10:1f:74:38:e3:8e\"\n                    }\n                }\n            };\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":482,"y":4000,"wires":[["7c52f827.a60848","b48925a9.c662d8"]]},{"id":"7c52f827.a60848","type":"api-call-service","z":"444fced8.33ecb","name":"Liga PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"wake_on_lan","service":"send_magic_packet","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":640,"y":4020,"wires":[[]]},{"id":"a3d7f2c3.98fec","type":"function","z":"d3db5d74.fb8fa","name":"janela aux","func":"global.set(\"janelaSala\",msg.payload);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1910,"y":1800,"wires":[[]]},{"id":"9478d381.e15f1","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Janela Sala Direita","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.janela_sala_direita","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1700,"y":1800,"wires":[["a3d7f2c3.98fec"]]},{"id":"f04f2f6b.fb44b","type":"api-call-service","z":"859b066a.dd8128","name":"Fita Cama","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"remote","service":"send_command","entityId":"remote.rm_mini_3_quarto_remote","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1610,"y":520,"wires":[[]]},{"id":"ddbd9add.1002e8","type":"function","z":"e7cd1901.ee2408","name":"Turn Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ventilador_da_sala\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2280,"y":1064,"wires":[["5f49e5ae.ed0ccc"]]},{"id":"5f49e5ae.ed0ccc","type":"api-call-service","z":"e7cd1901.ee2408","name":"Ventilador da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.ventilador_da_sala","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2490,"y":1064,"wires":[[]]},{"id":"7098bf85.8fa28","type":"server-state-changed","z":"e7cd1901.ee2408","name":"Desabilita Automação","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.desabilita_automacao_sala_escritorio","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":440,"y":380,"wires":[["624eb6b9.64f488"]]},{"id":"624eb6b9.64f488","type":"function","z":"e7cd1901.ee2408","name":"Aux Function","func":"if(msg.payload === \"on\"){\n    global.set(\"desabilitaAutomacao\", true)\n    var newMsg = {payload:\"reset\", reset: true}\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":630,"y":380,"wires":[["b2a76711.ae4398","9f86e19e.674de","ff1586d2.1093f8"]]},{"id":"15a0cc4b.9e0534","type":"server-state-changed","z":"5767c936.cabd18","name":"Desabilita Automação","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.desabilita_automacao_sala_escritorio","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":480,"y":380,"wires":[["4efd30af.8f616"]]},{"id":"4efd30af.8f616","type":"function","z":"5767c936.cabd18","name":"Aux Function","func":"if(msg.payload === \"on\"){\n    global.set(\"desabilitaAutomacao\", true)\n    var newMsg = {payload:\"reset\", reset: true}\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":670,"y":380,"wires":[["ba6a4e16.62ac7","8a61a341.0fa5d","dcd2984c.8ee318"]]},{"id":"e7f7c710.d118d8","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.projetor_ceu\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":840,"y":2320,"wires":[["b689c234.959f5"]]},{"id":"b689c234.959f5","type":"api-call-service","z":"859b066a.dd8128","name":"Projetor Céu","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.projetor_ceu","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":990,"y":2320,"wires":[[]]},{"id":"b249fc1e.9ed07","type":"api-call-service","z":"859b066a.dd8128","name":"Projetor Céu","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.projetor_ceu","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3130,"y":940,"wires":[[]]},{"id":"a640dc34.316c7","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.projetor_ceu\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2940,"y":940,"wires":[["b249fc1e.9ed07"]]},{"id":"3b8f46f7.b07fba","type":"comment","z":"859b066a.dd8128","name":"Ligar a luz debaixo da cama quando tiver movimento a noite","info":"","x":1010,"y":420,"wires":[]},{"id":"a696a96c.c0ecd8","type":"api-call-service","z":"e7cd1901.ee2408","name":"Ar Condicionado da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_off","entityId":"switch.ar_condicionado_sala","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2510,"y":1113,"wires":[[]]},{"id":"4c93361b.8a2798","type":"function","z":"e7cd1901.ee2408","name":"Turn Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ar_condicionado_sala\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2280,"y":1113,"wires":[["a696a96c.c0ecd8"]]},{"id":"1d4e741f.f8d3ac","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ventilador\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2940,"y":820,"wires":[["dcc8904.04f3f7"]]},{"id":"dcc8904.04f3f7","type":"api-call-service","z":"859b066a.dd8128","name":"Ventilador","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.ventilador","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3120,"y":820,"wires":[[]]},{"id":"468982ac.d0665c","type":"api-call-service","z":"859b066a.dd8128","name":"Ar Condicionado do Quarto","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_off","entityId":"switch.ar_condicionado_sala","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3180,"y":880,"wires":[[]]},{"id":"30734ef7.3c4e82","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ar_condicionado_quarto\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2940,"y":880,"wires":[["468982ac.d0665c"]]},{"id":"d9d62bca.20a008","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.fita_cama\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2940,"y":760,"wires":[["e0e65d32.17889"]]},{"id":"e0e65d32.17889","type":"api-call-service","z":"859b066a.dd8128","name":"Fita Cama","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.fita_cama","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3130,"y":760,"wires":[[]]},{"id":"271f0a9b.e32556","type":"api-call-service","z":"859b066a.dd8128","name":"Fita Cama","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.fita_cama","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":990,"y":2200,"wires":[[]]},{"id":"5be8420e.25cb1c","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.fita_cama\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":840,"y":2200,"wires":[["271f0a9b.e32556"]]},{"id":"ac7096f9.685db8","type":"api-call-service","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":730,"y":1040,"wires":[[]]},{"id":"df9654aa.9720d8","type":"function","z":"859b066a.dd8128","name":"Luz do Quarto Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"light.luz_do_quarto_nedi\"\n        }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":490,"y":1100,"wires":[["ac7096f9.685db8"]]},{"id":"56bd684b.606a48","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"4","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":280,"y":1100,"wires":[["df9654aa.9720d8"]]},{"id":"403451b.4c77ab","type":"function","z":"859b066a.dd8128","name":"Luz do Quarto On","func":"if(\n    msg.payload === \"vibration\" ||\n    msg.payload === \"tilt\" ||\n    msg.payload === \"drop\" \n    ){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_nedi\",\n            \"rgb_color\": [255, 255, 255],\n            \"brightness\": 255,\n            \"transition\": 30\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":490,"y":1000,"wires":[["56bd684b.606a48","ac7096f9.685db8"]]},{"id":"8b3f41b3.774c3","type":"server-state-changed","z":"859b066a.dd8128","name":"Porta Armário","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.porta_do_armario_action","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":270,"y":1000,"wires":[["403451b.4c77ab","736e54ee.c8b8ec"]]},{"id":"59b7617c.6557b","type":"comment","z":"859b066a.dd8128","name":"Porta do armário abre e liga a luz","info":"","x":310,"y":880,"wires":[]},{"id":"3baa292f.b8ea5e","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"delay","timeout":"10","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3890,"y":460,"wires":[["440df940.59eac8"]]},{"id":"440df940.59eac8","type":"function","z":"ec27da7d.cad118","name":"Turn Off","func":"var newMsg;\nnode.send(newMsg);\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria\"\n        }\n    }};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4050,"y":400,"wires":[["212c8564.09f82a"]]},{"id":"66519808.a94bd","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"10","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3620,"y":360,"wires":[["fe6987d8.1bb278"]]},{"id":"fe6987d8.1bb278","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnode.send(newMsg);\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_nedi\"\n        }\n    }};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3780,"y":300,"wires":[["941d47c9.5197e8"]]},{"id":"1177050d.93763b","type":"api-current-state","z":"ec27da7d.cad118","name":"Quantos Lux?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"sensor.sensor_de_luz_quarto_maria","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":900,"y":300,"wires":[["92ca138.d2915f"]]},{"id":"92ca138.d2915f","type":"function","z":"ec27da7d.cad118","name":"Escuro?","func":"if(msg.payload < 15){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1080,"y":300,"wires":[["20d4a2d7.21cc9e"]]},{"id":"c1e06d21.5bb3b","type":"function","z":"ec27da7d.cad118","name":"Veio de onde","func":"if(msg.data.attributes.flowing === null){\n    flow.set(\"cameFrom\", \"HK\");\n}\nelse{\n    flow.set(\"cameFrom\", \"HA\")\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2350,"y":260,"wires":[["f1e1977a.6f1fc8"]]},{"id":"4e054618.f5ace8","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2190,"y":240,"wires":[["c1e06d21.5bb3b"]]},{"id":"42fe6d4f.76c4e4","type":"debug","z":"ec27da7d.cad118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":2240,"y":160,"wires":[]},{"id":"c3cdc6e2.6da458","type":"api-current-state","z":"ec27da7d.cad118","name":"Hora do Sono","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.hora_do_sono_maria","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":560,"y":300,"wires":[["2c146ffe.19e48"],["2c146ffe.19e48"]]},{"id":"2c146ffe.19e48","type":"function","z":"ec27da7d.cad118","name":"Dormindo?","func":"if(msg.payload === false){\n    global.set(\"horaDoSonoMaria\", false);\n    return msg;\n}\nelse{\n    global.set(\"horaDoSonoMaria\", true);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":730,"y":300,"wires":[["1177050d.93763b"]]},{"id":"548f56c3.b00918","type":"function","z":"444fced8.33ecb","name":"Cozy Time Maria","func":"if(\n    msg.payload.name===\"Echo Dot do Quarto Maria\" &&(\n    msg.payload.description.summary.includes('vou')===true &&\n    (\n    msg.payload.description.summary.includes('descansar')===true ||\n    msg.payload.description.summary.includes('descansa')===true || \n    msg.payload.description.summary.includes('deitar')===true||\n    msg.payload.description.summary.includes('deita')===true|| \n    msg.payload.description.summary.includes('cama')===true\n    ))){\n\n    global.set(\"turnOffDelay\", true);\n    var newMsg;\n    newMsg = {\"payload\": {\"On\": true}};\n    return newMsg;\n    \n    \n    \n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":860,"wires":[["bb9b69d9.962478","210863f.1fbad9c"]]},{"id":"6d30b421.7fdb9c","type":"function","z":"444fced8.33ecb","name":"Boa Noite Maria","func":"if(\n    msg.payload.name===\"Echo Dot do Quarto Maria\" &&(\n    msg.payload.description.summary.includes('boa noite')===true ||\n    msg.payload.description.summary.includes('dormir')===true || \n    msg.payload.description.summary.includes('dormi')===true ||\n    (msg.payload.description.summary.includes('hora')===true &&\n    msg.payload.description.summary.includes('sono')===true)\n    )){\n    global.set(\"horaDoSonoMaria\", true);\n    var newMsg;\n    newMsg = {\"payload\": {\"On\": true}};\n    return newMsg;\n    \n    \n    \n    \n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":1000,"wires":[["e0daef57.33681","d8940157.5bc73","90c2bfda.c26d3"]]},{"id":"2df97c93.0c1ec4","type":"api-current-state","z":"ec27da7d.cad118","name":"Quantos Lux?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"sensor.sensor_de_luz_quarto_maria","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":680,"y":500,"wires":[["679b0dd4.459454"]]},{"id":"b45b9c2c.2eaf3","type":"inject","z":"ec27da7d.cad118","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"0 0-22 * * *","once":false,"onceDelay":"15","topic":"","payload":"","payloadType":"date","x":510,"y":500,"wires":[["2df97c93.0c1ec4"]]},{"id":"679b0dd4.459454","type":"function","z":"ec27da7d.cad118","name":"Funcionando?","func":"if(msg.payload > 60000){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":860,"y":500,"wires":[["e37cdd37.b7298"]]},{"id":"e37cdd37.b7298","type":"function","z":"ec27da7d.cad118","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Update\", \"message\": \"Erro no Lux Quarto Maria\"}'\n  \n\n    }\n    }};\n    node.send(newMsg);\n    \n    \n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \"title\": \"Erro\",\n        \"message\": \"Erro no Lux Quarto Maria\"\n\n    }\n    }};\n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1030,"y":500,"wires":[["33bd7a0a.b594e6"]]},{"id":"33bd7a0a.b594e6","type":"api-call-service","z":"ec27da7d.cad118","name":"Notifica","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"","service":"","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1200,"y":500,"wires":[[]]},{"id":"bb9b69d9.962478","type":"function","z":"444fced8.33ecb","name":"Pouco brilho e colorido","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.luz_do_quarto_nedi\",\n        \"brightness\": 20,\n        \"rgb_color\": [50,255,193]\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":780,"y":840,"wires":[["a39eb2da.734a"]]},{"id":"a39eb2da.734a","type":"api-call-service","z":"444fced8.33ecb","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.luz_do_quarto_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1000,"y":840,"wires":[[]]},{"id":"210863f.1fbad9c","type":"function","z":"444fced8.33ecb","name":"Galáxia On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.galaxia_maria\",\n        \"brightness\": 60\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":750,"y":900,"wires":[["d70f5eda.7069b"]]},{"id":"d70f5eda.7069b","type":"api-call-service","z":"444fced8.33ecb","name":"Galáxia Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.galaxia_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":980,"y":900,"wires":[[]]},{"id":"e0daef57.33681","type":"function","z":"444fced8.33ecb","name":"Luz Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.luz_do_quarto_maria\"\n    }\n}};\nnode.send(newMsg);\n\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.luz_do_quarto_maria_hk\"\n    }\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":740,"y":960,"wires":[["93d4fa3f.b0ee68"]]},{"id":"93d4fa3f.b0ee68","type":"api-call-service","z":"444fced8.33ecb","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.luz_do_quarto_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1002,"y":960,"wires":[[]]},{"id":"d8940157.5bc73","type":"function","z":"444fced8.33ecb","name":"Galáxia Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.galaxia_maria\",\n        \"brightness\": 5\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":750,"y":1020,"wires":[["f210ed72.ae562"]]},{"id":"f210ed72.ae562","type":"api-call-service","z":"444fced8.33ecb","name":"Galáxia Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.galaxia_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":980,"y":1020,"wires":[[]]},{"id":"90c2bfda.c26d3","type":"function","z":"444fced8.33ecb","name":"Hora do Sono On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"input_boolean.hora_do_sono_maria\"\n    }\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":770,"y":1080,"wires":[["7c734dd5.385e94"]]},{"id":"7c734dd5.385e94","type":"api-call-service","z":"444fced8.33ecb","name":"Hora do Sono Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"input_boolean.hora_do_sono_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1000,"y":1080,"wires":[[]]},{"id":"d6210037.0c3e5","type":"function","z":"d67ca66.293d758","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"input_boolean.hora_do_sono_maria\"\n    }\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":470,"y":2736,"wires":[["43780a31.7cd754"]]},{"id":"43780a31.7cd754","type":"api-call-service","z":"d67ca66.293d758","name":"Hora do Sono Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"input_boolean.hora_do_sono_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":654,"y":2736,"wires":[[]]},{"id":"7f4886f0.0875e8","type":"api-current-state","z":"ec27da7d.cad118","name":"Corredor","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_corredor","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":200,"y":300,"wires":[["2bd910fe.b30b3"],["2bd910fe.b30b3"]]},{"id":"2bd910fe.b30b3","type":"function","z":"ec27da7d.cad118","name":"Movimento?","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":370,"y":300,"wires":[["c3cdc6e2.6da458"]]},{"id":"4486ff2d.764ba","type":"api-current-state","z":"859b066a.dd8128","name":"Corredor","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_corredor","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":200,"y":220,"wires":[["f1d686af.40d548"],["f1d686af.40d548"]]},{"id":"f1d686af.40d548","type":"function","z":"859b066a.dd8128","name":"Movimento?","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":350,"y":220,"wires":[["e51e3045.5da4d"]]},{"id":"8f236e2.339c69","type":"function","z":"444fced8.33ecb","name":"Cancela Automações","func":"if(\n        (\n            msg.payload.description.summary.includes('cancela')===true || \n            msg.payload.description.summary.includes('cancelar')===true || \n            msg.payload.description.summary.includes('cancele')===true\n        ) && \n        (\n            msg.payload.description.summary.includes('automação')===true|| \n            msg.payload.description.summary.includes('automações')===true\n        )\n    ){\n        var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.desabilita_automacao_sala_escritorio\"\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":540,"y":160,"wires":[["e8b6e905.89cc98"]]},{"id":"e8b6e905.89cc98","type":"api-call-service","z":"444fced8.33ecb","name":"Add Item Shopping List","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"shopping_list","service":"add_item","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":810,"y":160,"wires":[[]]},{"id":"eb10d419.bb3698","type":"api-current-state","z":"2ea7fd8b.7e0bb2","name":"Alguém em Casa?","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.alguem_em_casa","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":790,"y":140,"wires":[["5e04f236.08948c"],["5e04f236.08948c"]]},{"id":"5e04f236.08948c","type":"function","z":"2ea7fd8b.7e0bb2","name":"True?","func":"if(msg.payload === false){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":970,"y":140,"wires":[["2f7e965e.742a2a","96c98e71.db341"]]},{"id":"7e4aedf.3862314","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Seja bem-vindo\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_do_quarto_nedi\",\"media_player.echo_dot_do_quarto\",\"media_player.echo_dot_do_quarto_maria\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1430,"y":140,"wires":[[]]},{"id":"fa95f894.fa4f98","type":"function","z":"2ea7fd8b.7e0bb2","name":"Aux","func":"return {payload: true};","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1290,"y":140,"wires":[["7e4aedf.3862314"]]},{"id":"e4df9aa7.6a4368","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.umidificador\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2940,"y":640,"wires":[["f3feb12e.023e7"]]},{"id":"f3feb12e.023e7","type":"api-call-service","z":"859b066a.dd8128","name":"Umidificador","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.umidificador","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3130,"y":640,"wires":[[]]},{"id":"a42e66d.212d498","type":"api-call-service","z":"859b066a.dd8128","name":"Tomada TV","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.tomada_tv_quarto","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3090,"y":700,"wires":[[]]},{"id":"8d7bb5c9.c6fab8","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"switch.tomada_tv_quarto\"\n    }\n}};\nnode.send(newMsg);newMsg= {payload : {\n    \"domain\": \"media_player\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"media_player.fire_tv_2\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"media_player\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"media_player.fire_tv\"\n    }\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2940,"y":700,"wires":[["a42e66d.212d498"]]},{"id":"95692a86.5657b8","type":"function","z":"444fced8.33ecb","name":"Temperatura na Sala","func":"if( \n    (\n        msg.payload.name===\"Echo Dot da Sala\" &&\n        msg.payload.description.summary.includes('aqui')===true &&\n        msg.payload.description.summary.includes('temperatura')===true\n        ) \n    ||\n    (\n        msg.payload.description.summary.includes('sala')===true &&\n        msg.payload.description.summary.includes('temperatura')===true\n        )\n    ){\n        var newMsg;\n        newMsg= { \"payload\": \"A temperatura atual da Sala está em {{ states.sensor.temperatura_sala.state | int }} °C\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_da_sala\" };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":540,"y":1140,"wires":[["ef098864.2195b8","fabbb91c.440868"]]},{"id":"c7efcbaf.f44cd8","type":"function","z":"444fced8.33ecb","name":"Temperatura Quarto Nédi","func":"if( \n    (\n        msg.payload.name===\"Echo Dot do Quarto Nédi\" &&\n        msg.payload.description.summary.includes('aqui')===true &&\n        msg.payload.description.summary.includes('temperatura')===true\n        ) \n    ||\n    (\n        msg.payload.description.summary.includes('quarto')===true &&\n        (\n        msg.payload.description.summary.includes('nedi')===true ||\n        msg.payload.description.summary.includes('nédi')===true ||\n        msg.payload.description.summary.includes('mano')===true\n            ) &&\n        msg.payload.description.summary.includes('temperatura')===true\n        )\n    ){\n        \n        var newMsg;\n        newMsg= { \"payload\": \"A temperatura atual do quarto está em {{ states.sensor.temperatura_quarto_nedi.state | int }} °C\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_do_quarto_nedi\" };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":550,"y":1260,"wires":[["2d72602c.f8d56","414e38d.2ba2fc8"]]},{"id":"cfadd93a.8674e8","type":"function","z":"444fced8.33ecb","name":"Temperatura Quarto Maria","func":"if( \n    (\n        msg.payload.name===\"Echo Dot do Quarto Maria\" &&\n        msg.payload.description.summary.includes('aqui')===true &&\n        msg.payload.description.summary.includes('temperatura')===true\n        ) \n    ||\n    (\n        msg.payload.description.summary.includes('quarto')===true &&\n        (\n        msg.payload.description.summary.includes('maria')===true ||\n        msg.payload.description.summary.includes('mana')===true\n            ) &&\n        msg.payload.description.summary.includes('temperatura')===true\n        )\n    ){\n        \n        var newMsg;\n        newMsg= { \"payload\": \"A temperatura atual do quarto está em {{ states.sensor.temperatura_quarto_maria.state | int }} °C\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_do_quarto_maria\" };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":560,"y":1360,"wires":[["7c24c10a.fff25","62bac1e5.3749d"]]},{"id":"f8cda435.4b8738","type":"function","z":"444fced8.33ecb","name":"Temperatura Quarto Pai","func":"if( \n    (\n        msg.payload.name===\"Echo Dot do Quarto Pai\" &&\n        msg.payload.description.summary.includes('aqui')===true &&\n        msg.payload.description.summary.includes('temperatura')===true\n        ) \n    ||\n    (\n        msg.payload.description.summary.includes('quarto')===true &&\n        (\n        msg.payload.description.summary.includes('pai')===true\n            ) &&\n        msg.payload.description.summary.includes('temperatura')===true\n        )\n    ){\n        \n        var newMsg;\n        newMsg= { \"payload\": \"A temperatura atual do quarto está em {{ states.sensor.temperatura_quarto_pai.state | int }} °C\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_do_quarto_pai\" };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":550,"y":1460,"wires":[["64530c5a.fc1a74","d4ead964.b4a5a8"]]},{"id":"cce7736e.0172","type":"api-call-service","z":"444fced8.33ecb","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":940,"y":1140,"wires":[[]]},{"id":"957251a2.ec442","type":"api-call-service","z":"444fced8.33ecb","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":940,"y":1240,"wires":[[]]},{"id":"9253ceb.9a85e3","type":"api-call-service","z":"444fced8.33ecb","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":940,"y":1340,"wires":[[]]},{"id":"8a6d922c.eaf5","type":"api-call-service","z":"444fced8.33ecb","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":960,"y":1440,"wires":[[]]},{"id":"ef098864.2195b8","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"50"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":930,"y":1200,"wires":[[]]},{"id":"2d72602c.f8d56","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"50"},"mode":"set","devices":["G090XG0894430B3V"]}},"x":930,"y":1300,"wires":[[]]},{"id":"7c24c10a.fff25","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"50"},"mode":"set","devices":["G090XG09951227MJ"]}},"x":930,"y":1400,"wires":[[]]},{"id":"64530c5a.fc1a74","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"50"},"mode":"set","devices":["G090XG1103120T5N"]}},"x":950,"y":1500,"wires":[[]]},{"id":"fabbb91c.440868","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":780,"y":1140,"wires":[["cce7736e.0172"]]},{"id":"414e38d.2ba2fc8","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":780,"y":1260,"wires":[["957251a2.ec442"]]},{"id":"62bac1e5.3749d","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":780,"y":1360,"wires":[["9253ceb.9a85e3"]]},{"id":"d4ead964.b4a5a8","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":780,"y":1460,"wires":[["8a6d922c.eaf5"]]},{"id":"a1220ab4.8e3e38","type":"alexa-remote-event","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","event":"ws-device-activity","x":1930,"y":400,"wires":[["7b38a6c4.a923c8","6dc676e7.09c2f8","50376e8e.43342","c2a3bbfe.e2d738","39b5fb6b.9686b4","4d6c4cb4.56d644","acd2c3c5.c6df","b712724a.1a07f","f7fff18d.7ee86","e998b33d.9019e","fbf8feee.e0037","95061fca.046ce","9f5c17e3.69c048","f040f242.d8f4e","8cee0e9f.ac9c1","b344c41b.9672e8"]]},{"id":"7b38a6c4.a923c8","type":"function","z":"444fced8.33ecb","name":"Umidade na Sala","func":"if( \n    (\n        msg.payload.name===\"Echo Dot da Sala\" &&\n        msg.payload.description.summary.includes('aqui')===true &&\n        msg.payload.description.summary.includes('umidade')===true\n        ) \n    ||\n    (\n        msg.payload.description.summary.includes('sala')===true &&\n        msg.payload.description.summary.includes('umidade')===true\n        )\n    ){\n        var newMsg;\n        newMsg= { \"payload\": \"A umidade atual da Sala está em {{ states.sensor.temperatura_sala.state | int }} °C\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_da_sala\" };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2310,"y":80,"wires":[["d505323e.70997","d8630d84.5574a"]]},{"id":"6dc676e7.09c2f8","type":"function","z":"444fced8.33ecb","name":"Umidade Quarto Nédi","func":"if( \n    (\n        msg.payload.name===\"Echo Dot do Quarto Nédi\" &&\n        msg.payload.description.summary.includes('aqui')===true &&\n        msg.payload.description.summary.includes('umidade')===true\n        ) \n    ||\n    (\n        msg.payload.description.summary.includes('quarto')===true &&\n        (\n        msg.payload.description.summary.includes('nedi')===true ||\n        msg.payload.description.summary.includes('nédi')===true ||\n        msg.payload.description.summary.includes('mano')===true\n            ) &&\n        msg.payload.description.summary.includes('umidade')===true\n        )\n    ){\n        \n        var newMsg;\n        newMsg= { \"payload\": \"A umidade atual do quarto está em {{ states.sensor.umidade_quarto_nedi.state | int }} °C\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_do_quarto_nedi\" };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2320,"y":160,"wires":[["eb00cc8f.252e4","cb873ef4.abfdb"]]},{"id":"50376e8e.43342","type":"function","z":"444fced8.33ecb","name":"Umidade Quarto Maria","func":"if( \n    (\n        msg.payload.name===\"Echo Dot do Quarto Maria\" &&\n        msg.payload.description.summary.includes('aqui')===true &&\n        msg.payload.description.summary.includes('umidade')===true\n        ) \n    ||\n    (\n        msg.payload.description.summary.includes('quarto')===true &&\n        (\n        msg.payload.description.summary.includes('maria')===true ||\n        msg.payload.description.summary.includes('mana')===true\n            ) &&\n        msg.payload.description.summary.includes('umidade')===true\n        )\n    ){\n        \n        var newMsg;\n        newMsg= { \"payload\": \"A umidade atual do quarto está em {{ states.sensor.umidade_quarto_maria.state | int }} °C\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_do_quarto_maria\" };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2320,"y":260,"wires":[["73aa429b.eb9bdc","63cdd8e0.eff6c8"]]},{"id":"c2a3bbfe.e2d738","type":"function","z":"444fced8.33ecb","name":"Umidade Quarto Pai","func":"if( \n    (\n        msg.payload.name===\"Echo Dot do Quarto Pai\" &&\n        msg.payload.description.summary.includes('aqui')===true &&\n        msg.payload.description.summary.includes('umidade')===true\n        ) \n    ||\n    (\n        msg.payload.description.summary.includes('quarto')===true &&\n        (\n        msg.payload.description.summary.includes('pai')===true\n            ) &&\n        msg.payload.description.summary.includes('umidade')===true\n        )\n    ){\n        \n        var newMsg;\n        newMsg= { \"payload\": \"A umidade atual do quarto está em {{ states.sensor.umidade_quarto_pai.state | int }} °C\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_do_quarto_pai\" };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2320,"y":360,"wires":[["69dfa9e3.80f7c8","165d637d.19453d"]]},{"id":"4a8021b0.defb5","type":"api-call-service","z":"444fced8.33ecb","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2720,"y":60,"wires":[[]]},{"id":"6dbe49cb.cd70b8","type":"api-call-service","z":"444fced8.33ecb","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2720,"y":160,"wires":[[]]},{"id":"b3aa2729.750f78","type":"api-call-service","z":"444fced8.33ecb","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2720,"y":260,"wires":[[]]},{"id":"798dbf4f.b9ef5","type":"api-call-service","z":"444fced8.33ecb","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2720,"y":360,"wires":[[]]},{"id":"d505323e.70997","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"50"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":2770,"y":100,"wires":[[]]},{"id":"eb00cc8f.252e4","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"50"},"mode":"set","devices":["G090XG0894430B3V"]}},"x":2770,"y":200,"wires":[[]]},{"id":"73aa429b.eb9bdc","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"50"},"mode":"set","devices":["G090XG09951227MJ"]}},"x":2770,"y":300,"wires":[[]]},{"id":"69dfa9e3.80f7c8","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"50"},"mode":"set","devices":["G090XG1103120T5N"]}},"x":2770,"y":400,"wires":[[]]},{"id":"d8630d84.5574a","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2560,"y":60,"wires":[["4a8021b0.defb5"]]},{"id":"cb873ef4.abfdb","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2560,"y":160,"wires":[["6dbe49cb.cd70b8"]]},{"id":"63cdd8e0.eff6c8","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2560,"y":260,"wires":[["b3aa2729.750f78"]]},{"id":"165d637d.19453d","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2560,"y":360,"wires":[["798dbf4f.b9ef5"]]},{"id":"2688edc8.b1f4e2","type":"inject","z":"444fced8.33ecb","name":"9AM","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 09 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1430,"y":3300,"wires":[["1193e2c9.d4d07d","ddb8a152.f2e47"]]},{"id":"257569d0.2d3636","type":"inject","z":"444fced8.33ecb","name":"11AM","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 11 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1430,"y":3360,"wires":[["b3efa8a7.37d388","6267320d.f2782c"]]},{"id":"3548c7b.3a43638","type":"inject","z":"444fced8.33ecb","name":"23PM","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 23 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1440,"y":3420,"wires":[["48fde1ee.fb5ca","dc1962fc.eed9a"]]},{"id":"ddb8a152.f2e47","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                         "},"volume":{"type":"num","value":"40"},"mode":"set","devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":1630,"y":3260,"wires":[[]]},{"id":"6267320d.f2782c","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                         "},"volume":{"type":"num","value":"60"},"mode":"set","devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":1630,"y":3340,"wires":[[]]},{"id":"48fde1ee.fb5ca","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                         "},"volume":{"type":"num","value":"30"},"mode":"set","devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":1630,"y":3420,"wires":[[]]},{"id":"1193e2c9.d4d07d","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                         "},"volume":{"type":"num","value":"60"},"mode":"set","devices":["d8ed9c7b043348ac9c818217500cec95"]}},"x":1630,"y":3300,"wires":[[]]},{"id":"b3efa8a7.37d388","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                         "},"volume":{"type":"num","value":"60"},"mode":"set","devices":["d8ed9c7b043348ac9c818217500cec95"]}},"x":1630,"y":3380,"wires":[[]]},{"id":"dc1962fc.eed9a","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                         "},"volume":{"type":"num","value":"30"},"mode":"set","devices":["d8ed9c7b043348ac9c818217500cec95"]}},"x":1630,"y":3460,"wires":[[]]},{"id":"5ff82e19.d35f4","type":"link in","z":"4c9c764d.9c4468","name":"Desliga a Casa","links":["d57439e1.373828"],"x":235,"y":1800,"wires":[["4c1575ef.12eddc","655165f6.6538bc"]]},{"id":"4c1575ef.12eddc","type":"function","z":"4c9c764d.9c4468","name":"Desliga Casa","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"media_player.fire_tv\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_nedi\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.rgb_strip\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.projetor_ceu\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.flor\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.tomada_tv_quarto\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.umidificador\"\n        }\n    }};\n    \n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\"\n        }\n    }};\n    node.send(newMsg);\n\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_1\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2_hk\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_maria\"\n        }\n    }};\n    node.send(newMsg);\n\n\n\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_maria_hk\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.galaxia_maria\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ventilador_da_sala\"\n        }\n    }};\n    node.send(newMsg);\n\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ventilador\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.abajur_direita\"\n        }\n    }};\n    node.send(newMsg);\n\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.abajur_esquerda\"\n        }\n    }};\n    node.send(newMsg);\n\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ar_condicionado_sala\"\n        }\n    }};\n    node.send(newMsg);    \n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ar_condicionado_quarto\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.fita_cama\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.alguem_em_casa\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.sala_ocupada_switch\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.quarto_nedi_ocupado_switch\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.quarto_maria_ocupado_switch\"\n        }\n    }};\n    node.send(newMsg);\n\nglobal.set(\"contEscritorio\", 2800)\nglobal.set(\"desabilitaAutomacao\", true)\nglobal.set(\"overrideEscritorio\", false)\nglobal.set(\"tvAuxFilme\", false)\nglobal.set(\"tvAuxPlay\", false)\nglobal.set(\"vouDormir\", false)\nglobal.set(\"horaDoFilme\", false)\nglobal.set(\"horaDoSonoMaria\", false)\nglobal.set(\"SalaOn\", false)\nglobal.set(\"EscritorioOn\", false)\nglobal.set(\"SalaOnFirstTime\", false)\nglobal.set(\"EscritorioOnFirstTime\", false)\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":370,"y":1780,"wires":[["9cc2db38.10d54"]]},{"id":"5a336e31.6a232","type":"api-call-service","z":"4c9c764d.9c4468","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":550,"y":1840,"wires":[[]]},{"id":"655165f6.6538bc","type":"function","z":"4c9c764d.9c4468","name":"Fala tchau","func":"        var newMsg;\n        newMsg= { \"payload\": \"Tchau, até logo!\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_da_sala\" };\n        return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":370,"y":1840,"wires":[["5a336e31.6a232"]]},{"id":"9cc2db38.10d54","type":"api-call-service","z":"4c9c764d.9c4468","name":"Casa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"","service":"","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":550,"y":1780,"wires":[[]]},{"id":"8652cb7e.20d158","type":"hb-control","z":"d67ca66.293d758","name":"Fita do Escritorio","Homebridge":"Homebridge","Manufacturer":"MagicHome","Service":"Lightbulb","device":"Homebridge0E:79:18:75:24:85MagicHomeFita do Escritorio00000043","conf":"1e751e4e.9c7702","x":1010,"y":2420,"wires":[]},{"id":"de840ab4.efe9a8","type":"hb-control","z":"d67ca66.293d758","name":"Luz da TV","Homebridge":"Homebridge","Manufacturer":"MagicHome","Service":"Lightbulb","device":"Homebridge0E:79:18:75:24:85MagicHomeLuz da TV00000043","conf":"1e751e4e.9c7702","x":990,"y":2480,"wires":[]},{"id":"43d5b756.ecd308","type":"function","z":"d67ca66.293d758","d":true,"name":"Turn Off","func":"global.set(\"SalaOn\", false);\nreturn {payload : {\"On\": false}};\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":800,"y":2440,"wires":[["8652cb7e.20d158","de840ab4.efe9a8"]]},{"id":"590cfd2d.5bd984","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"Luz da Sala","server":"56814891.18c868","x":1040,"y":3120,"wires":[]},{"id":"90ff44a7.0e0458","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"Luz da Sala","server":"56814891.18c868","x":1040,"y":2860,"wires":[]},{"id":"ee1dc484.379c48","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"Luz da Sala","server":"14b837c9.ab10c","x":1050,"y":3040,"wires":[]},{"id":"e325813b.ab572","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"Luz da Sala","server":"14b837c9.ab10c","x":1050,"y":3300,"wires":[]},{"id":"fbe96195.54045","type":"function","z":"d3db5d74.fb8fa","name":"Turn Off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"light.aqara_hub\",\n        }\n    }};\n    return newMsg;\n} ","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1220,"y":1240,"wires":[["9087ade6.99d3"]]},{"id":"c3558e1c.f8358","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Luz Noturna Off","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.aqara_hub","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1840,"y":1240,"wires":[[]]},{"id":"130a6775.a0e089","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delayv","timeout":"5","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1480,"y":1240,"wires":[["af71570d.6eabe8"]]},{"id":"2f9c7b9a.a87b14","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"Luz da Entrada","server":"56814891.18c868","x":1125,"y":1280,"wires":[]},{"id":"50e35619.23d9c8","type":"switch","z":"4c9c764d.9c4468","name":"","property":"payload.state.on","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1479,"y":1620,"wires":[["a720803c.fc91b"],["5c70c158.0a68b","117d06e2.d815f9"]]},{"id":"a720803c.fc91b","type":"function","z":"4c9c764d.9c4468","name":"Turn On Dim","func":"msg.payload = {\"on\": true,\"bri\":25, \"ct\": 3500};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"x":1659,"y":1600,"wires":[["5d5f419f.5982a"]]},{"id":"5c70c158.0a68b","type":"function","z":"4c9c764d.9c4468","name":"Turn On Dimmer","func":"msg.payload = {\"on\": true, \"bri\":5, \"ct\": 3500};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"x":1679,"y":1660,"wires":[["d32569d4.54bf88"]]},{"id":"cebfe46c.10f188","type":"function","z":"4c9c764d.9c4468","name":"Trigger","func":"flow.set(\"triggered2\", true);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":939,"y":1620,"wires":[["6469c6ba.1296c8"]]},{"id":"f66dbec9.4f378","type":"function","z":"4c9c764d.9c4468","name":"Was Triggered?","func":"if(flow.set(\"triggered2\")===true){\n    flow.set(\"triggered2\", false);\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1329,"y":1620,"wires":[["50e35619.23d9c8"]]},{"id":"6469c6ba.1296c8","type":"yeelight-compat-hue-state","z":"4c9c764d.9c4468","name":"","server":"14b837c9.ab10c","x":1119,"y":1620,"wires":[["f66dbec9.4f378"]]},{"id":"5d5f419f.5982a","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"14b837c9.ab10c","x":1909,"y":1600,"wires":[]},{"id":"d32569d4.54bf88","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"14b837c9.ab10c","x":1909,"y":1660,"wires":[]},{"id":"39b5fb6b.9686b4","type":"function","z":"444fced8.33ecb","name":"Playstation","func":"if(\n     (\n        msg.payload.name===\"Echo Dot da Sala\" &&\n    (msg.payload.description.summary.includes('liga')===true || \n    msg.payload.description.summary.includes('ligue')===true ||\n    msg.payload.description.summary.includes('desliga')===false ||\n    msg.payload.description.summary.includes('desligue')===false )&& \n    (msg.payload.description.summary.includes('playstation')===true) || \n    \n    (msg.payload.description.summary.includes('vou')===true && \n    (msg.payload.description.summary.includes('jogar')===true||\n    msg.payload.description.summary.includes('joga')===true))\n    )\n    ){\n    global.set(\"tvAuxPlay\", true);\n    var newMsg;\n        newMsg = {payload:true}\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2290,"y":500,"wires":[["4bd8799d.86fd48","2e2efc09.f9d244","37a2f609.673cfa","21584626.818daa","f3b4eb80.267c38","1789d9d5.93db16","6bb839fe.173d58"]]},{"id":"decd862e.05afd8","type":"api-call-service","z":"444fced8.33ecb","name":"Playstation","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":2730,"y":500,"wires":[[]]},{"id":"87fa9ee.12b146","type":"switch","z":"444fced8.33ecb","name":"","property":"payload.state.on","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"false","repair":false,"outputs":2,"x":3090,"y":560,"wires":[["64a41882.7102a8"],["e115491b.bc86b8","c1ec01a3.31fce"]]},{"id":"64a41882.7102a8","type":"function","z":"444fced8.33ecb","name":"Turn On Dim","func":"msg.payload = {\"on\": true,\"bri\":50, \"ct\": 3500};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3330,"y":520,"wires":[["2851a9fa.e70f66"]]},{"id":"e115491b.bc86b8","type":"function","z":"444fced8.33ecb","name":"Turn On Color","func":"msg.payload = {\"on\": true, \"bri\":15, \"hex\": \"32FFC1\"};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3340,"y":580,"wires":[["cc715a0b.ae6768"]]},{"id":"4bd8799d.86fd48","type":"function","z":"444fced8.33ecb","name":"Trigger","func":"flow.set(\"triggered\", true);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2580,"y":560,"wires":[["c51c13e.10346f"]]},{"id":"d907b2e7.bca67","type":"function","z":"444fced8.33ecb","name":"Was Triggered?","func":"if(flow.set(\"triggered\")===true){\n    flow.set(\"triggered\", false);\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2940,"y":560,"wires":[["87fa9ee.12b146"]]},{"id":"c51c13e.10346f","type":"yeelight-compat-hue-state","z":"444fced8.33ecb","name":"","server":"2db68ab1.bee496","x":2750,"y":560,"wires":[["d907b2e7.bca67"]]},{"id":"2851a9fa.e70f66","type":"yeelight-compat-hue-out","z":"444fced8.33ecb","name":"","server":"2db68ab1.bee496","x":3550,"y":520,"wires":[]},{"id":"cc715a0b.ae6768","type":"yeelight-compat-hue-out","z":"444fced8.33ecb","name":"","server":"2db68ab1.bee496","x":3550,"y":580,"wires":[]},{"id":"bb63f341.69eaa","type":"switch","z":"444fced8.33ecb","name":"","property":"payload.state.on","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"false","repair":false,"outputs":2,"x":3090,"y":680,"wires":[["1adf9cdc.7f3cc3"],["30657524.822f4a","c1ec01a3.31fce"]]},{"id":"1adf9cdc.7f3cc3","type":"function","z":"444fced8.33ecb","name":"Turn On Dim","func":"msg.payload = {\"on\": true,\"bri\":50, \"ct\": 3500};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3330,"y":640,"wires":[["c759107c.8c594"]]},{"id":"30657524.822f4a","type":"function","z":"444fced8.33ecb","name":"Turn On Color","func":"msg.payload = {\"on\": true, \"bri\":15, \"hex\": \"32FFC1\"};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3340,"y":700,"wires":[["2a83b266.518f7e"]]},{"id":"2e2efc09.f9d244","type":"function","z":"444fced8.33ecb","name":"Trigger","func":"flow.set(\"triggered2\", true);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2570,"y":680,"wires":[["df64a7ae.dd36d8"]]},{"id":"26141271.9914ce","type":"function","z":"444fced8.33ecb","name":"Was Triggered?","func":"if(flow.set(\"triggered2\")===true){\n    flow.set(\"triggered2\", false);\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2940,"y":680,"wires":[["bb63f341.69eaa"]]},{"id":"df64a7ae.dd36d8","type":"yeelight-compat-hue-state","z":"444fced8.33ecb","name":"","server":"14b837c9.ab10c","x":2750,"y":680,"wires":[["26141271.9914ce"]]},{"id":"c759107c.8c594","type":"yeelight-compat-hue-out","z":"444fced8.33ecb","name":"","server":"14b837c9.ab10c","x":3550,"y":640,"wires":[]},{"id":"2a83b266.518f7e","type":"yeelight-compat-hue-out","z":"444fced8.33ecb","name":"","server":"14b837c9.ab10c","x":3550,"y":700,"wires":[]},{"id":"46aaac0c.924f84","type":"api-call-service","z":"444fced8.33ecb","name":"Abajur","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":3510,"y":780,"wires":[[]]},{"id":"c1ec01a3.31fce","type":"function","z":"444fced8.33ecb","name":"Turn Off","func":"    var newMsg;\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.abajur_esquerda\",\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.abajur_direita\",\n        }\n    }\n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3362,"y":780,"wires":[["46aaac0c.924f84"]]},{"id":"4d6c4cb4.56d644","type":"function","z":"444fced8.33ecb","name":"Trabalhar","func":"if(\n     (\n        msg.payload.name===\"Echo Dot da Sala\" &&\n    \n    (msg.payload.description.summary.includes('vou')===true && \n    (msg.payload.description.summary.includes('trabalha')===true||\n    msg.payload.description.summary.includes('trabalhar')===true) ||\n    (msg.payload.description.summary.includes('estuda')===true||\n    msg.payload.description.summary.includes('estudar')===true))\n    )\n    ){    var newMsg;\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_on\",\n        \"data\":{\n          \"entity_id\": \"switch.abajur_esquerda\",\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_on\",\n        \"data\":{\n          \"entity_id\": \"switch.abajur_direita\",\n        }\n    }\n    return newMsg;\n\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2280,"y":1320,"wires":[["aa766bac.334b08","503759f7.d0e928","f719b272.fa924"]]},{"id":"aa766bac.334b08","type":"api-call-service","z":"444fced8.33ecb","name":"Escritório","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":2460,"y":1320,"wires":[[]]},{"id":"503759f7.d0e928","type":"function","z":"444fced8.33ecb","name":"Turn On","func":"msg.payload = {\"on\": true,\"bri\":255, \"ct\": 6100};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2460,"y":1380,"wires":[["872229ae.023cb8","9b55449b.9da608"]]},{"id":"872229ae.023cb8","type":"yeelight-compat-hue-out","z":"444fced8.33ecb","name":"","server":"2db68ab1.bee496","x":2690,"y":1380,"wires":[]},{"id":"9b55449b.9da608","type":"yeelight-compat-hue-out","z":"444fced8.33ecb","name":"","server":"14b837c9.ab10c","x":2690,"y":1440,"wires":[]},{"id":"acd2c3c5.c6df","type":"function","z":"444fced8.33ecb","name":"Playstation","func":"if(\n     (\n        msg.payload.name===\"Echo Dot da Sala\" &&\n    (msg.payload.description.summary.includes('hora')===true && \n    (msg.payload.description.summary.includes('jogo')===true))\n    )\n    ){\n    var newMsg;\n        newMsg = {payload:true}\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2290,"y":1120,"wires":[["dba8ef10.1d2b6","826924f.2e978d8","21584626.818daa","1789d9d5.93db16","6bb839fe.173d58"]]},{"id":"d65a1b47.6bdbc8","type":"api-call-service","z":"444fced8.33ecb","name":"Playstation","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":2770,"y":1200,"wires":[[]]},{"id":"dba8ef10.1d2b6","type":"function","z":"444fced8.33ecb","name":"Turn On Color","func":"msg.payload = {\"on\": true, \"bri\":15, \"hex\": \"32FFC1\"};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2600,"y":1260,"wires":[["aa478ff8.19a95","9bec3047.b7b67"]]},{"id":"aa478ff8.19a95","type":"yeelight-compat-hue-out","z":"444fced8.33ecb","name":"","server":"2db68ab1.bee496","x":2810,"y":1260,"wires":[]},{"id":"9bec3047.b7b67","type":"yeelight-compat-hue-out","z":"444fced8.33ecb","name":"","server":"14b837c9.ab10c","x":2810,"y":1320,"wires":[]},{"id":"37a2f609.673cfa","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"40"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":2670,"y":450,"wires":[[]]},{"id":"f719b272.fa924","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"40"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":2510,"y":1500,"wires":[[]]},{"id":"12dc5583.14ceda","type":"inject","z":"e7cd1901.ee2408","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":670,"y":560,"wires":[["aa48fad2.d67908","190248cb.085527"]]},{"id":"b712724a.1a07f","type":"function","z":"444fced8.33ecb","name":"TV Quarto Maria On/Off","func":"var newMsg;\nif(\n     (\n        msg.payload.name===\"Echo Dot do Quarto Maria\" &&\n    \n    ((\n    msg.payload.description.summary.includes('ligar')===true||\n    msg.payload.description.summary.includes('ligue')===true||\n    msg.payload.description.summary.includes('liga')===true) &&\n    msg.payload.description.summary.includes('desliga')===false &&\n    msg.payload.description.summary.includes('desligar')===false && \n    (msg.payload.description.summary.includes('TV')===true||\n    msg.payload.description.summary.includes('t.v.')===true||\n    msg.payload.description.summary.includes('t v')===true||\n    (msg.payload.description.summary.includes('t.')===true&&\n    msg.payload.description.summary.includes('v.')===true)\n    ))\n    )\n    ){    \n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_on\",\n        \"data\":{\n          \"entity_id\": \"switch.tv_do_quarto_maria\",\n        }\n    }\n    node.send(newMsg);\n    newMsg= {payload : \n                {\n                    \"domain\": \"media_player\",\n                    \"service\": \"turn_on\",\n                    \"data\":{\n                        \"entity_id\": \"media_player.fire_tv_maria\"\n                    }\n                }\n            };\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.tv_do_quarto_maria\",\n        }\n    }\n    return newMsg;\n\n}\nif(\n     (\n        msg.payload.name===\"Echo Dot do Quarto Maria\" &&\n    \n    ((\n    msg.payload.description.summary.includes('desligar')===true||\n    msg.payload.description.summary.includes('desligue')===true||\n    msg.payload.description.summary.includes('desliga')===true) && \n    (msg.payload.description.summary.includes('TV')===true||\n    msg.payload.description.summary.includes('t.v.')===true||\n    msg.payload.description.summary.includes('t v')===true||\n    (msg.payload.description.summary.includes('t.')===true&&\n    msg.payload.description.summary.includes('v.')===true)\n    ))\n    )\n    ){   \n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_on\",\n        \"data\":{\n          \"entity_id\": \"switch.tv_do_quarto_maria\",\n        }\n    }\n    node.send(newMsg);\n    newMsg= {payload : \n                {\n                    \"domain\": \"media_player\",\n                    \"service\": \"turn_off\",\n                    \"data\":{\n                        \"entity_id\": \"media_player.fire_tv_maria\"\n                    }\n                }\n            };\n            \n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.tv_do_quarto_maria\",\n        }\n    }\n    node.send(newMsg);\n    return newMsg;\n\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2330,"y":1580,"wires":[["f099b08a.13bcc"]]},{"id":"b81fc5d.1f8e938","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"25","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":880,"y":2920,"wires":[["ff3463af.6018c"]]},{"id":"47a824b0.aad36c","type":"api-call-service","z":"444fced8.33ecb","name":"TV do Quarto IR","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"swich","service":"turn_on","entityId":"switch.tomada_tv_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1520,"y":2920,"wires":[[]]},{"id":"ff3463af.6018c","type":"function","z":"444fced8.33ecb","name":"Turn On","func":"var newMsg;\n        newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_on\",\n            \"data\":{\n                \"entity_id\": \"switch.tv_do_quarto_ir\"\n            }\n        }};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1040,"y":2920,"wires":[["47a824b0.aad36c","a82d5004.fa947"]]},{"id":"f099b08a.13bcc","type":"api-call-service","z":"444fced8.33ecb","name":"TV do Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":2670,"y":1600,"wires":[[]]},{"id":"34c8078e.a5c46","type":"function","z":"d3db5d74.fb8fa","name":"Botão Sala e Escritório Double","func":"if(msg.payload.entity_id === \"binary_sensor.botao_sala_e_escritorio\"){\n    if(msg.payload.event.click_type === \"double\"){\n\n        var newMsg\n            newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.luzes_do_escritorio\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.luzes_do_escritorio\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.sala\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.sala\"\n            }\n        }};\n        return newMsg;  \n    }\n}\n//remote.b286acn01\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":550,"y":520,"wires":[["8ef548f1.890268","5f97b48b.c94a3c"]]},{"id":"2873d8ed.ca9528","type":"function","z":"d3db5d74.fb8fa","name":"Botão Sala e Escritório Click","func":"if(msg.payload.entity_id === \"binary_sensor.botao_sala_e_escritorio\"){\n    if(msg.payload.event.click_type === \"single\"){\n        var newMsg\n            newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.luzes_do_escritorio\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.luzes_do_escritorio\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.sala\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.sala\"\n            }\n        }};\n        return newMsg;  \n    }\n}\n//remote.b286acn01\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":540,"y":480,"wires":[["c41e683b.b85588","5f97b48b.c94a3c"]]},{"id":"8ef548f1.890268","type":"link out","z":"d3db5d74.fb8fa","name":"Sala e Escritorio Double Clique","links":[],"x":715,"y":520,"wires":[]},{"id":"c41e683b.b85588","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Sala e Escritorio Clique","links":[],"x":715,"y":480,"wires":[]},{"id":"c9fee3d9.d47888","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"","server":"14b837c9.ab10c","x":1010,"y":2360,"wires":[]},{"id":"b33859c3.c7681","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"","server":"56814891.18c868","x":1000,"y":2240,"wires":[]},{"id":"764d7fed.8f08c8","type":"inject","z":"859b066a.dd8128","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":190,"y":100,"wires":[["e0e99c04.912df"]]},{"id":"e0e99c04.912df","type":"api-current-state","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_corredor","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":410,"y":100,"wires":[["a89ed8bb.d32e4"],["a89ed8bb.d32e4"]]},{"id":"a89ed8bb.d32e4","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":590,"y":100,"wires":[]},{"id":"269caedd.e718c2","type":"server-state-changed","z":"444fced8.33ecb","name":"Playstation?","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"media_player.tv_da_sala","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":1950,"y":620,"wires":[["8664d7e2.640da8"]]},{"id":"8664d7e2.640da8","type":"function","z":"444fced8.33ecb","name":"Jogando?","func":"var ocupado = global.get(\"tvAuxPlay\");\nif(ocupado === false){\n    if(msg.data.new_state.attributes.media_title === \"Playstation\"){\n        global.set(\"tvAuxPlay\", true);\n        return {payload: \"playing\"};\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2280,"y":600,"wires":[["4bd8799d.86fd48","2e2efc09.f9d244","21584626.818daa","f3b4eb80.267c38","1789d9d5.93db16","6bb839fe.173d58"]]},{"id":"ea037758.f44ef8","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"Bom jogo."},"volume":{"type":"num","value":"50"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":2870,"y":740,"wires":[[]]},{"id":"b2839b13.870d78","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"25","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2820,"y":800,"wires":[["c7a55b3e.8390d8"]]},{"id":"c7a55b3e.8390d8","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":""},"volume":{"type":"num","value":"40"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":3050,"y":800,"wires":[[]]},{"id":"826924f.2e978d8","type":"function","z":"444fced8.33ecb","name":"Playstation","func":"\n    var newMsg;\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_on\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_HDMI3\"\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"select_source\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"source\": \"Playstation\"\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\"\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\"\n        }\n    }        \n    \n    node.send(newMsg);\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.abajur_esquerda\",\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.abajur_direita\",\n        }\n    }\n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2590,"y":1200,"wires":[["d65a1b47.6bdbc8"]]},{"id":"80a3e029.e2661","type":"function","z":"c3fa9bdb.b5c4c8","name":"Veio?","func":"if(msg.payload === false){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":870,"y":4600,"wires":[["1f654b42.851ce5"]]},{"id":"21ff783.0175288","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Clarice Veio?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.clarice_veio","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":730,"y":4600,"wires":[["80a3e029.e2661"]]},{"id":"9554ed69.10253","type":"function","z":"c3fa9bdb.b5c4c8","name":"Veio?","func":"if(msg.payload === false){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":470,"y":2200,"wires":[["a6f4d0bb.f96a7"]]},{"id":"e21ef9a0.1759d8","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Clarice Veio?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.clarice_veio","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":330,"y":2200,"wires":[["9554ed69.10253"]]},{"id":"be9bab93.e46e48","type":"function","z":"c3fa9bdb.b5c4c8","name":"Veio?","func":"if(msg.payload === false){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":510,"y":1560,"wires":[["f24e9eb9.587c8"]]},{"id":"b777a9d8.2e33b8","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Clarice Veio?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.clarice_veio","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":370,"y":1560,"wires":[["be9bab93.e46e48"]]},{"id":"f2199195.b7288","type":"function","z":"c3fa9bdb.b5c4c8","name":"Veio?","func":"if(msg.payload === false){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":470,"y":900,"wires":[["770ab6c6.431378"]]},{"id":"904067dc.365ae8","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Clarice Veio?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.clarice_veio","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":330,"y":900,"wires":[["f2199195.b7288"]]},{"id":"3d04b6bf.7ddf3a","type":"function","z":"c3fa9bdb.b5c4c8","name":"Veio?","func":"if(msg.payload === false){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":510,"y":280,"wires":[["1b287783.476148"]]},{"id":"6bddf58.ebf350c","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Clarice Veio?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.clarice_veio","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":370,"y":280,"wires":[["3d04b6bf.7ddf3a"]]},{"id":"f7fff18d.7ee86","type":"function","z":"444fced8.33ecb","name":"Luz do Quarto On/Off","func":"if( \n       msg.payload.description.summary.includes('desliga')===false &&\n       msg.payload.description.summary.includes('desligar')===false &&\n       msg.payload.description.summary.includes('desligue')===false && \n    (msg.payload.description.summary.includes('liga a luz do quarto maria')===true||\n    msg.payload.description.summary.includes('acende luz do quarto maria')===true||\n    msg.payload.description.summary.includes('liga luz do quarto maria')===true||\n    msg.payload.description.summary.includes('liga as luzes do quarto maria')===true||\n    msg.payload.description.summary.includes('liga luzes do quarto maria')===true ||\n    msg.payload.description.summary.includes('ligar a luz do quarto maria')===true||\n    msg.payload.description.summary.includes('ligar luz do quarto maria')===true||\n    msg.payload.description.summary.includes('ligar as luzes do quarto maria')===true||\n    msg.payload.description.summary.includes('ligar luzes do quarto maria')===true ||\n    msg.payload.description.summary.includes('acende a luz do quarto maria')===true||\n    msg.payload.description.summary.includes('acende as luzes do quarto maria')===true||\n    msg.payload.description.summary.includes('ligue a luz do quarto maria')===true||\n    msg.payload.description.summary.includes('ligue luz do quarto maria')===true||\n    msg.payload.description.summary.includes('ligue as luzes do quarto maria')===true||\n    msg.payload.description.summary.includes('ligue luzes do quarto maria')===true ||\n    (msg.payload.name===\"Echo Dot do Quarto Maria\" &&\n       (\n       msg.payload.description.summary.includes('acende a luz')===true ||\n       msg.payload.description.summary.includes('liga a luz')===true ||\n       msg.payload.description.summary.includes('liga luz')===true||\n       msg.payload.description.summary.includes('liga luzes')===true ||\n       msg.payload.description.summary.includes('liga as luzes')===true ||\n       msg.payload.description.summary.includes('ligar a luz')===true ||\n       msg.payload.description.summary.includes('ligar luz')===true||\n       msg.payload.description.summary.includes('ligar luzes')===true ||\n       msg.payload.description.summary.includes('ligar as luzes')===true||\n       msg.payload.description.summary.includes('ligue a luz')===true ||\n       msg.payload.description.summary.includes('ligue luz')===true||\n       msg.payload.description.summary.includes('ligue luzes')===true ||\n       msg.payload.description.summary.includes('ligue as luzes')===true\n       )))\n    ){\n    var newMsg;\n    var date = new Date();\n    var Hour = date.getHours();\n    if(Hour < 22){\n        newMsg= {payload : {\n                    \"domain\": \"light\",\n                    \"service\": \"turn_on\",\n                    data:{\n                        \n                        \"entity_id\": \"light.luz_do_quarto_maria\",\n                        \"brightness\": 255,\n                        \"color_temp\": 204\n                    }\n        }};    \n    }\n    else{\n        newMsg= {payload : {\n                    \"domain\": \"light\",\n                    \"service\": \"turn_on\",\n                    data:{\n                        \n                        \"entity_id\": \"light.luz_do_quarto_maria\",\n                        \"brightness\": 255,\n                        \"color_temp\": 305\n                    }\n        }};    \n    }\n    return newMsg;\n}\nif(\n    (msg.payload.description.summary.includes('desliga a luz do quarto maria')===true||\n    msg.payload.description.summary.includes('desliga luz do quarto maria')===true||\n    msg.payload.description.summary.includes('desliga as luzes do quarto maria')===true||\n    msg.payload.description.summary.includes('desliga luzes do quarto maria')===true ||\n    msg.payload.description.summary.includes('desligar a luz do quarto maria')===true||\n    msg.payload.description.summary.includes('desligar luz do quarto maria')===true||\n    msg.payload.description.summary.includes('desligar as luzes do quarto maria')===true||\n    msg.payload.description.summary.includes('desligar luzes do quarto maria')===true ||\n    msg.payload.description.summary.includes('desligue a luz do quarto maria')===true||\n    msg.payload.description.summary.includes('desligue luz do quarto maria')===true||\n    msg.payload.description.summary.includes('desligue as luzes do quarto maria')===true||\n    msg.payload.description.summary.includes('desligue luzes do quarto maria')===true ||\n    \n       msg.payload.description.summary.includes('apaga as luzes do quarto maria')===true ||\n       msg.payload.description.summary.includes('apagar as luzes do quarto maria')===true ||\n       msg.payload.description.summary.includes('apague as luzes do quarto maria')===true  ||\n       msg.payload.description.summary.includes('apaga a luz do quarto maria')===true ||\n       msg.payload.description.summary.includes('apagar a luz do quarto maria')===true ||\n       msg.payload.description.summary.includes('apague a luz do quarto maria')===true   ||\n       msg.payload.description.summary.includes('apaga luz do quarto maria')===true ||\n       msg.payload.description.summary.includes('apagar luz do quarto maria')===true ||\n       msg.payload.description.summary.includes('apague luz do quarto maria')===true   ||\n       msg.payload.description.summary.includes('apaga luzes do quarto maria')===true ||\n       msg.payload.description.summary.includes('apagar luzes do quarto maria')===true ||\n       msg.payload.description.summary.includes('apague luzes do quarto maria')===true ||\n    (msg.payload.name===\"Echo Dot do Quarto Maria\" &&\n       (\n       msg.payload.description.summary.includes('desliga a luz')===true ||\n       msg.payload.description.summary.includes('desliga luz')===true||\n       msg.payload.description.summary.includes('desliga luzes')===true ||\n       msg.payload.description.summary.includes('desliga as luzes')===true ||\n       msg.payload.description.summary.includes('desligar a luz')===true ||\n       msg.payload.description.summary.includes('desligar luz')===true||\n       msg.payload.description.summary.includes('desligar luzes')===true ||\n       msg.payload.description.summary.includes('desligar as luzes')===true||\n       msg.payload.description.summary.includes('desligue a luz')===true ||\n       msg.payload.description.summary.includes('desligue luz')===true||\n       msg.payload.description.summary.includes('desligue luzes')===true ||\n       msg.payload.description.summary.includes('desligue as luzes')===true ||\n       msg.payload.description.summary.includes('apaga as luzes')===true ||\n       msg.payload.description.summary.includes('apagar as luzes')===true ||\n       msg.payload.description.summary.includes('apague as luzes')===true  ||\n       msg.payload.description.summary.includes('apaga a luz')===true ||\n       msg.payload.description.summary.includes('apagar a luz')===true ||\n       msg.payload.description.summary.includes('apague a luz')===true   ||\n       msg.payload.description.summary.includes('apaga luz')===true ||\n       msg.payload.description.summary.includes('apagar luz')===true ||\n       msg.payload.description.summary.includes('apague luz')===true   ||\n       msg.payload.description.summary.includes('apaga luzes')===true ||\n       msg.payload.description.summary.includes('apagar luzes')===true ||\n       msg.payload.description.summary.includes('apague luzes')===true \n       )))\n    ){\n    var newMsg;\n    newMsg= {payload : {\n                \"domain\": \"light\",\n                \"service\": \"turn_off\",\n                data:{\n                    \n                    \"entity_id\": \"light.luz_do_quarto_maria_hk\"\n                }\n    }};    \n    node.send(newMsg);\n    \n    newMsg= {payload : {\n                \"domain\": \"light\",\n                \"service\": \"turn_off\",\n                data:{\n                    \n                    \"entity_id\": \"light.luz_do_quarto_maria\"\n                }\n    }};    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2320,"y":1800,"wires":[["15b2c5ff.4798da"]]},{"id":"15b2c5ff.4798da","type":"api-call-service","z":"444fced8.33ecb","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2560,"y":1800,"wires":[[]]},{"id":"e477db0a.b41ee8","type":"function","z":"444fced8.33ecb","name":"Turn Off","func":"var newMsg;\n        newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"switch.tomada_tv_quarto_nedi\"\n            }\n        }};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":900,"y":3280,"wires":[["afd4fae.477e508"]]},{"id":"afd4fae.477e508","type":"api-call-service","z":"444fced8.33ecb","name":"Tomada TV Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"swich","service":"turn_on","entityId":"switch.tomada_tv_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1110,"y":3280,"wires":[[]]},{"id":"a82d5004.fa947","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1200,"y":2980,"wires":[["37ff20ad.93adf"]]},{"id":"37ff20ad.93adf","type":"function","z":"444fced8.33ecb","name":"Turn Off","func":"var newMsg;\n        newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"switch.tv_do_quarto_ir\"\n            }\n        }};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1360,"y":2980,"wires":[["47a824b0.aad36c"]]},{"id":"21584626.818daa","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"20","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2593,"y":760,"wires":[["ea037758.f44ef8","b2839b13.870d78"]]},{"id":"5629061c.c5f038","type":"server-state-changed","z":"444fced8.33ecb","name":"FireTV?","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"media_player.fire_tv","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":130,"y":3040,"wires":[["8f67b7ba.ee8b58","53449976.28f948"]]},{"id":"359f1927.973516","type":"server-state-changed","z":"444fced8.33ecb","name":"FireTV?","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"media_player.fire_tv_2","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":130,"y":3100,"wires":[["8f67b7ba.ee8b58","71828cef.b0d2d4"]]},{"id":"8f67b7ba.ee8b58","type":"function","z":"444fced8.33ecb","name":"Atividade","func":"var jaAconteceu = global.get(\"fireTVNediAtividade\");\nif(msg.payload === \"playing\"){\n    if(jaAconteceu === false){\n        global.set(\"fireTVNediAtividade\", true);\n        return msg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":3080,"wires":[["c16309d1.f94448"]]},{"id":"53449976.28f948","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":250,"y":3000,"wires":[]},{"id":"71828cef.b0d2d4","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":250,"y":3140,"wires":[]},{"id":"25a91864.7e1e18","type":"server-state-changed","z":"444fced8.33ecb","name":"FireTV?","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"media_player.fire_tv_maria","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":2270,"y":1640,"wires":[["ebb95505.ab8a58"]]},{"id":"4cdbd812.6242c8","type":"server-state-changed","z":"444fced8.33ecb","name":"FireTV?","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"media_player.fire_tv_maria_android","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":2270,"y":1720,"wires":[["ebb95505.ab8a58"]]},{"id":"ebb95505.ab8a58","type":"function","z":"444fced8.33ecb","name":"Atividade","func":"var jaAconteceu = global.get(\"fireTVMariaAtividade\");\nif(jaAconteceu === false){\n    global.set(\"fireTVMariaAtividade\", true);\n    if(msg.payload === \"playing\"){\n        var newMsg;\n            newMsg = {payload:{}}\n        newMsg.payload = {\n            \"domain\": \"switch\",\n            \"service\": \"turn_on\",\n            \"data\":{\n              \"entity_id\": \"switch.tv_do_quarto_maria\",\n            }\n        }\n        node.send(newMsg);\n        newMsg= {payload : \n                    {\n                        \"domain\": \"media_player\",\n                        \"service\": \"turn_on\",\n                        \"data\":{\n                            \"entity_id\": \"media_player.fire_tv_maria\"\n                        }\n                    }\n                };\n        node.send(newMsg);\n            newMsg = {payload:{}}\n        newMsg.payload = {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n              \"entity_id\": \"switch.tv_do_quarto_maria\",\n            }\n        }\n        return newMsg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2460,"y":1680,"wires":[["f099b08a.13bcc"]]},{"id":"f3b4eb80.267c38","type":"function","z":"444fced8.33ecb","name":"Aux","func":"var newMsg;\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_on\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_HDMI3\"\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"select_source\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"source\": \"Playstation\"\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\"\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\"\n        }\n    }\n    return newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2570,"y":500,"wires":[["decd862e.05afd8"]]},{"id":"243cf25b.8e5d2e","type":"inject","z":"444fced8.33ecb","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"description\":{\"summary\":\"globo\"}}","payloadType":"json","x":230,"y":2300,"wires":[["6cc082a4.cebc2c"]]},{"id":"e998b33d.9019e","type":"function","z":"444fced8.33ecb","name":"Ar Condicionado On/Off","func":"var newMsg;\nif(\n    (msg.payload.name===\"Echo Dot da Sala\" &&\n       (\n       msg.payload.description.summary.includes('liga o ar')===true ||\n       msg.payload.description.summary.includes('ligar o ar')===true ||\n       msg.payload.description.summary.includes('ligue o ar')===true||\n       msg.payload.description.summary.includes('liga o ar condicionado')===true ||\n       msg.payload.description.summary.includes('ligar o ar condicionado')===true ||\n       msg.payload.description.summary.includes('ligue o ar condicionado')===true ||\n       msg.payload.description.summary.includes('liga ar')===true ||\n       msg.payload.description.summary.includes('ligar ar')===true ||\n       msg.payload.description.summary.includes('ligue ar')===true||\n       msg.payload.description.summary.includes('liga ar condicionado')===true ||\n       msg.payload.description.summary.includes('ligar ar condicionado')===true ||\n       msg.payload.description.summary.includes('ligue ar condicionado')===true\n       )&&\n       msg.payload.description.summary.includes('quarto')===false &&\n       msg.payload.description.summary.includes('desliga')===false &&\n       msg.payload.description.summary.includes('desligar')===false &&\n       msg.payload.description.summary.includes('desligue')===false\n       )\n    ){\n    newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_on\",\n                data:{\n                    \n                    \"entity_id\": \"switch.ar_condicionado_sala\"\n                }\n    }};    \n    \n    return newMsg;\n}\nif(\n    (msg.payload.name===\"Echo Dot da Sala\" &&\n       (\n       msg.payload.description.summary.includes('desliga o ar')===true ||\n       msg.payload.description.summary.includes('desligar o ar')===true ||\n       msg.payload.description.summary.includes('desligue o ar')===true||\n       msg.payload.description.summary.includes('desliga o ar condicionado')===true ||\n       msg.payload.description.summary.includes('desligar o ar condicionado')===true ||\n       msg.payload.description.summary.includes('desligue o ar condicionado')===true ||\n       msg.payload.description.summary.includes('desliga ar')===true ||\n       msg.payload.description.summary.includes('desligar ar')===true ||\n       msg.payload.description.summary.includes('desligue ar')===true||\n       msg.payload.description.summary.includes('desliga ar condicionado')===true ||\n       msg.payload.description.summary.includes('desligar ar condicionado')===true ||\n       msg.payload.description.summary.includes('desligue ar condicionado')===true\n       )&&\n       msg.payload.description.summary.includes('quarto')===false\n       )\n    ){\n    newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_off\",\n                data:{\n                    \n                    \"entity_id\": \"switch.ar_condicionado_sala\"\n                }\n    }};    \n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2330,"y":1860,"wires":[["a43f1528.87a788","fb1f5313.600ad"]]},{"id":"a43f1528.87a788","type":"api-call-service","z":"444fced8.33ecb","name":"Ar Condicionado da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.ar_condicionado_sala","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2570,"y":1860,"wires":[[]]},{"id":"cfc108ca.2de478","type":"api-call-service","z":"444fced8.33ecb","name":"Ar Condicionado do Quarto","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.ar_condicionado_quarto","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2580,"y":2020,"wires":[[]]},{"id":"fbf8feee.e0037","type":"function","z":"444fced8.33ecb","name":"Ar Condicionado On/Off","func":"var newMsg;\nif(\n    (msg.payload.name===\"Echo Dot do Quarto Nédi\" &&\n       (\n       msg.payload.description.summary.includes('liga o ar')===true ||\n       msg.payload.description.summary.includes('ligar o ar')===true ||\n       msg.payload.description.summary.includes('ligue o ar')===true||\n       msg.payload.description.summary.includes('liga o ar condicionado')===true ||\n       msg.payload.description.summary.includes('ligar o ar condicionado')===true ||\n       msg.payload.description.summary.includes('ligue o ar condicionado')===true ||\n       msg.payload.description.summary.includes('liga ar')===true ||\n       msg.payload.description.summary.includes('ligar ar')===true ||\n       msg.payload.description.summary.includes('ligue ar')===true||\n       msg.payload.description.summary.includes('liga ar condicionado')===true ||\n       msg.payload.description.summary.includes('ligar ar condicionado')===true ||\n       msg.payload.description.summary.includes('ligue ar condicionado')===true\n       )&&\n       msg.payload.description.summary.includes('sala')===false &&\n       msg.payload.description.summary.includes('desliga')===false &&\n       msg.payload.description.summary.includes('desligar')===false &&\n       msg.payload.description.summary.includes('desligue')===false\n       )\n    ){\n    newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_on\",\n                data:{\n                    \n                    \"entity_id\": \"switch.ar_condicionado_quarto\"\n                }\n    }};    \n    \n    return newMsg;\n}\nif(\n    (msg.payload.name===\"Echo Dot do Quarto Nédi\" &&\n       (\n       msg.payload.description.summary.includes('desliga o ar')===true ||\n       msg.payload.description.summary.includes('desligar o ar')===true ||\n       msg.payload.description.summary.includes('desligue o ar')===true||\n       msg.payload.description.summary.includes('desliga o ar condicionado')===true ||\n       msg.payload.description.summary.includes('desligar o ar condicionado')===true ||\n       msg.payload.description.summary.includes('desligue o ar condicionado')===true ||\n       msg.payload.description.summary.includes('desliga ar')===true ||\n       msg.payload.description.summary.includes('desligar ar')===true ||\n       msg.payload.description.summary.includes('desligue ar')===true||\n       msg.payload.description.summary.includes('desliga ar condicionado')===true ||\n       msg.payload.description.summary.includes('desligar ar condicionado')===true ||\n       msg.payload.description.summary.includes('desligue ar condicionado')===true\n       )&&\n       msg.payload.description.summary.includes('sala')===false\n       )\n    ){\n    newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_off\",\n                data:{\n                    \n                    \"entity_id\": \"switch.ar_condicionado_quarto\"\n                }\n    }};    \n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2330,"y":2020,"wires":[["cfc108ca.2de478","cf439f99.ba5b8"]]},{"id":"5f97b48b.c94a3c","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"milliseconds","rate":"3","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":930,"y":500,"wires":[["d196ec5f.195d8"]]},{"id":"20341ed1.c87122","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Home Assistant","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"group.luzes_da_sala, group.luzes_do_escritorio","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1280,"y":500,"wires":[[]]},{"id":"f057b86c.5276b8","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":990,"y":280,"wires":[["aa54b7b4.3a3f08"]]},{"id":"95061fca.046ce","type":"function","z":"444fced8.33ecb","name":"Ventilador On/Off","func":"var newMsg;\nif(\n    (msg.payload.name===\"Echo Dot da Sala\" &&\n       (\n       msg.payload.description.summary.includes('liga o ventilador')===true ||\n       msg.payload.description.summary.includes('ligar o ventilador')===true ||\n       msg.payload.description.summary.includes('ligue o ventilador')===true||\n       msg.payload.description.summary.includes('liga ventilador')===true ||\n       msg.payload.description.summary.includes('ligar ventilador')===true ||\n       msg.payload.description.summary.includes('ligue ventilador')===true\n       )&&\n       msg.payload.description.summary.includes('quarto')===false &&\n       msg.payload.description.summary.includes('desliga')===false &&\n       msg.payload.description.summary.includes('desligar')===false &&\n       msg.payload.description.summary.includes('desligue')===false\n       )\n    ){\n    newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_on\",\n                data:{\n                    \n                    \"entity_id\": \"switch.ventilador_da_sala\"\n                }\n    }};    \n    \n    return newMsg;\n}\n\nif(\n    (msg.payload.name===\"Echo Dot da Sala\" &&\n       (\n       msg.payload.description.summary.includes('desliga o ventilador')===true ||\n       msg.payload.description.summary.includes('desligar o ventilador')===true ||\n       msg.payload.description.summary.includes('desligue o ventilador')===true||\n       msg.payload.description.summary.includes('desliga ventilador')===true ||\n       msg.payload.description.summary.includes('desligar ventilador')===true ||\n       msg.payload.description.summary.includes('desligue ventilador')===true\n       )&&\n       msg.payload.description.summary.includes('quarto')===false\n       )\n    ){\n    newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_off\",\n                data:{\n                    \n                    \"entity_id\": \"switch.ventilador_da_sala\"\n                }\n    }};    \n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2310,"y":1960,"wires":[["f8869d6c.70f02","fb1f5313.600ad"]]},{"id":"f8869d6c.70f02","type":"api-call-service","z":"444fced8.33ecb","name":"Ventilador da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.ventilador_da_sala","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2550,"y":1960,"wires":[[]]},{"id":"965e33f8.26b12","type":"api-call-service","z":"444fced8.33ecb","name":"Ventilador do Quarto","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.ventilador","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2560,"y":2120,"wires":[[]]},{"id":"9f5c17e3.69c048","type":"function","z":"444fced8.33ecb","name":"Ventilador On/Off","func":"var newMsg;\nif(\n    (msg.payload.name===\"Echo Dot do Quarto Nédi\" &&\n       (\n       msg.payload.description.summary.includes('liga o ventilador')===true ||\n       msg.payload.description.summary.includes('ligar o ventilador')===true ||\n       msg.payload.description.summary.includes('ligue o ventilador')===true||\n       msg.payload.description.summary.includes('liga ventilador')===true ||\n       msg.payload.description.summary.includes('ligar ventilador')===true ||\n       msg.payload.description.summary.includes('ligue ventilador')===true\n       ) &&\n       msg.payload.description.summary.includes('sala')===false &&\n       msg.payload.description.summary.includes('desliga')===false &&\n       msg.payload.description.summary.includes('desligar')===false &&\n       msg.payload.description.summary.includes('desligue')===false\n       )\n    ){\n    newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_on\",\n                data:{\n                    \n                    \"entity_id\": \"switch.ventilador\"\n                }\n    }};    \n    \n    return newMsg;\n}\nif(\n    (msg.payload.name===\"Echo Dot do Quarto Nédi\" &&\n       (\n       msg.payload.description.summary.includes('desliga o ventilador')===true ||\n       msg.payload.description.summary.includes('desligar o ventilador')===true ||\n       msg.payload.description.summary.includes('desligue o ventilador')===true||\n       msg.payload.description.summary.includes('desliga ventilador')===true ||\n       msg.payload.description.summary.includes('desligar ventilador')===true ||\n       msg.payload.description.summary.includes('desligue ventilador')===true\n       ) &&\n       msg.payload.description.summary.includes('quarto')===false\n       )\n    ){\n    newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_off\",\n                data:{\n                    \n                    \"entity_id\": \"switch.ventilador\"\n                }\n    }};    \n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2310,"y":2120,"wires":[["965e33f8.26b12","cf439f99.ba5b8"]]},{"id":"830ed247.f6566","type":"api-current-state","z":"859b066a.dd8128","name":"Quantos Lux?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"sensor.sensor_de_luz_quarto_nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":960,"y":200,"wires":[["8cdaac78.f22c5"]]},{"id":"8cdaac78.f22c5","type":"function","z":"859b066a.dd8128","name":"Escuro?","func":"if(msg.payload < 15){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1160,"y":220,"wires":[["8f838da2.c2148"]]},{"id":"6ad71445.4314fc","type":"api-current-state","z":"859b066a.dd8128","name":"Quantos Lux?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"sensor.sensor_de_luz_quarto_aqara","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":960,"y":260,"wires":[["8cdaac78.f22c5"]]},{"id":"8f838da2.c2148","type":"api-current-state","z":"859b066a.dd8128","name":"Vou Dormir","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.vou_dormir","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1350,"y":220,"wires":[["60668b28.01f924"],["60668b28.01f924"]]},{"id":"60668b28.01f924","type":"function","z":"859b066a.dd8128","name":"Dormindo?","func":"if(msg.payload === false){\n    global.set(\"horaDoSonoMaria\", false);\n    return msg;\n}\nelse{\n    global.set(\"horaDoSonoMaria\", true);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1530,"y":220,"wires":[["895843e4.08998"]]},{"id":"b48925a9.c662d8","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"40"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":690,"y":3960,"wires":[[]]},{"id":"92571614.e14db8","type":"yeelight-compat-hue-state","z":"e7cd1901.ee2408","name":"","server":"5a8bf4db.2d6bcc","x":1170,"y":160,"wires":[["cd61a227.139cd","d9ecfe9c.db8c9"]]},{"id":"e70cfc56.e6d9a","type":"change","z":"e7cd1901.ee2408","name":"","rules":[{"t":"set","p":"triggered4","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":990,"y":160,"wires":[["92571614.e14db8"]]},{"id":"d9ecfe9c.db8c9","type":"debug","z":"e7cd1901.ee2408","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1390,"y":100,"wires":[]},{"id":"9eaf56fb.0da888","type":"yeelight-compat-hue-state","z":"5767c936.cabd18","name":"","server":"2db68ab1.bee496","x":1470,"y":220,"wires":[["af808a53.16f078"]]},{"id":"db6caf2c.e2ac4","type":"change","z":"5767c936.cabd18","name":"","rules":[{"t":"set","p":"triggered5","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":220,"wires":[["9eaf56fb.0da888"]]},{"id":"f663ec98.82fab","type":"yeelight-compat-hue-state","z":"5767c936.cabd18","name":"","server":"2db68ab1.bee496","x":485,"y":984,"wires":[["89d8380b.afdd68","c85d1e41.e0972"]]},{"id":"ace843be.a34e7","type":"yeelight-compat-hue-state","z":"5767c936.cabd18","name":"","server":"14b837c9.ab10c","x":485,"y":1044,"wires":[["89d8380b.afdd68"]]},{"id":"89d8380b.afdd68","type":"function","z":"5767c936.cabd18","name":"aux","func":"global.set(\"EscritorioOn\",msg.payload.state.on);\n    ","outputs":0,"noerr":0,"initialize":"","finalize":"","x":685,"y":1004,"wires":[]},{"id":"dac5d209.cd354","type":"yeelight-compat-hue-state","z":"e7cd1901.ee2408","name":"","server":"56814891.18c868","x":1140,"y":560,"wires":[["918da8b0.372e78"]]},{"id":"1cac4780.e4df98","type":"yeelight-compat-hue-state","z":"e7cd1901.ee2408","name":"","server":"5a8bf4db.2d6bcc","x":1130,"y":620,"wires":[["918da8b0.372e78"]]},{"id":"918da8b0.372e78","type":"function","z":"e7cd1901.ee2408","name":"aux","func":"global.set(\"SalaOn\",msg.payload.state.on);\n    ","outputs":0,"noerr":0,"initialize":"","finalize":"","x":1350,"y":580,"wires":[]},{"id":"df23e8e7.d31c08","type":"debug","z":"5767c936.cabd18","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1780,"y":180,"wires":[]},{"id":"a991685f.ed5a28","type":"function","z":"c3fa9bdb.b5c4c8","name":"Delay + 25 min","func":"msg.delay = 1500000;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2760,"y":4500,"wires":[["273820d4.f2e2f"]]},{"id":"665518b0.bbb868","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"hours","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3400,"y":4600,"wires":[["5e7102ae.783dcc"]]},{"id":"5e7102ae.783dcc","type":"function","z":"c3fa9bdb.b5c4c8","name":"Ocioso","func":"    var newMsg;\n    flow.set(\"vibrationCount\", 0);\n    newMsg = {payload:{\n              \"domain\": \"input_select\",\n              \"service\": \"select_option\",\n              \"data\":{\n              \"entity_id\": \"input_select.maquina_de_lavar_roupas\",\n                \"option\": \"Ocioso\"\n            }\n        }\n    }\n    flow.set(\"washingMachineStage\", \"Ocioso\")\n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3550,"y":4600,"wires":[["2dc4b323.2ea56c"]]},{"id":"73e3053.c96eefc","type":"function","z":"c3fa9bdb.b5c4c8","name":"Vibrando?","func":"    vibrationCount = flow.get(\"vibrationCount\");\n    if(vibrationCount < 5){\n        flow.set(\"vibrationCount\", 0);\n    }\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3090,"y":4700,"wires":[[]]},{"id":"5e405b73.b1cb44","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Nédi, é sua vez de estender a roupa.\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1550,"y":4960,"wires":[[]]},{"id":"6052aaa5.23f7e4","type":"debug","z":"c3fa9bdb.b5c4c8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2560,"y":4500,"wires":[]},{"id":"736e54ee.c8b8ec","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":540,"y":960,"wires":[]},{"id":"d1e04599.855a58","type":"mqtt in","z":"859b066a.dd8128","d":true,"name":"Porta Armário","topic":"zigbee2mqtt/0x00158d0002b5f422","qos":"0","datatype":"auto","broker":"64936db9.640564","x":270,"y":940,"wires":[["736e54ee.c8b8ec"]]},{"id":"b505abed.645648","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 15 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":150,"y":420,"wires":[["7808a35c.4235dc"]]},{"id":"7808a35c.4235dc","type":"function","z":"4c9c764d.9c4468","name":"Aux","func":"msg.payload.latitude = -30.01009828\nmsg.payload.longitude = -51.18650436\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":280,"y":420,"wires":[["dd17d6d1.214528"]]},{"id":"876134ca.f66868","type":"api-call-service","z":"4c9c764d.9c4468","name":"Abajur","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":1799,"y":1400,"wires":[[]]},{"id":"117d06e2.d815f9","type":"function","z":"4c9c764d.9c4468","name":"Turn Off","func":"    var newMsg;\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.abajur_esquerda\",\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.abajur_direita\",\n        }\n    }\n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1651,"y":1400,"wires":[["876134ca.f66868"]]},{"id":"fdb87cd7.4a536","type":"function","z":"4c9c764d.9c4468","name":"Turn On","func":"msg.payload = {\"on\": true,\"bri\":45, \"hex\": \"#00F8F0\"};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":920,"wires":[["466a9556.18c7dc","ed4c24ad.4fd578"]]},{"id":"466a9556.18c7dc","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":1170,"y":900,"wires":[]},{"id":"ed4c24ad.4fd578","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"14b837c9.ab10c","x":1170,"y":960,"wires":[]},{"id":"d4012601.43bbf8","type":"function","z":"4c9c764d.9c4468","name":"Playing?","func":"var ocupado = global.get(\"tvAuxFilme\");\nif(ocupado === false){\n    if(msg.payload === \"playing\"){\n        global.set(\"tvAuxFilme\", true);\n        return {payload: \"playing\"};\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":380,"y":1380,"wires":[["9c98b28c.4c8bd","cebfe46c.10f188","c4d0a5ba.4a5f78"]]},{"id":"819033b5.665a6","type":"inject","z":"c3fa9bdb.b5c4c8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":"0.1","topic":"","payload":"true","payloadType":"bool","x":2390,"y":4780,"wires":[["cf4aeb3d.09c6a8"]]},{"id":"cf4aeb3d.09c6a8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Inicia variaveis","func":"flow.set(\"vibrationCount\", 0);\nflow.set(\"washingMachineStage\", \"Ocioso\")","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2600,"y":4780,"wires":[[]]},{"id":"7a0509bc.a29978","type":"api-call-service","z":"444fced8.33ecb","name":"Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_off","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2530,"y":2180,"wires":[[]]},{"id":"f040f242.d8f4e","type":"function","z":"444fced8.33ecb","name":"Desliga o Quarto","func":"if(\n    msg.payload.name===\"Echo Dot do Quarto Nédi\" &&((\n    msg.payload.description.summary.includes('desliga')===true ||\n    msg.payload.description.summary.includes('desligar')===true||\n    msg.payload.description.summary.includes('desligue')===true) &&\n    (\n    msg.payload.description.summary.includes('quarto')===true ||\n    msg.payload.description.summary.includes('quarto nédi')===true ||\n    msg.payload.description.summary.includes('quarto net')===true ||\n    msg.payload.description.summary.includes('quarto mano')===true\n    )\n    )){\n    \n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"group.luzes_do_quarto_nedi\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"group.luzes_do_quarto_nedi\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"media_player.fire_tv\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"media_player.fire_tv_2\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_nedi\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.rgb_strip\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.flor\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.tomada_tv_quarto\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.lampada\"\n        }\n    }};\n    \n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.umidificador\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ventilador\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.fita_cama\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ar_condicionado_quarto\"\n        }\n    }};\n    return newMsg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2310,"y":2180,"wires":[["7a0509bc.a29978","cf439f99.ba5b8"]]},{"id":"6d9fe5ab.c6b28c","type":"api-call-service","z":"444fced8.33ecb","name":"Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_off","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2530,"y":2240,"wires":[[]]},{"id":"8cee0e9f.ac9c1","type":"function","z":"444fced8.33ecb","name":"Desliga o Quarto","func":"if(\n    msg.payload.name===\"Echo Dot do Quarto Maria\" &&((\n    msg.payload.description.summary.includes('desliga')===true ||\n    msg.payload.description.summary.includes('desligar')===true||\n    msg.payload.description.summary.includes('desligue')===true) &&\n    (\n    msg.payload.description.summary.includes('quarto')===true ||\n    msg.payload.description.summary.includes('quarto maria')===true ||\n    msg.payload.description.summary.includes('quarto mana')===true\n    )\n    )){\n    \n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"group.luzes_do_quarto_maria\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"group.luzes_do_quarto_maria\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.galaxia_maria\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_maria\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_maria_hk\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.tv_do_quarto_maria\"\n        }\n    }};\n    return newMsg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2310,"y":2240,"wires":[["6d9fe5ab.c6b28c","db574882.3ed228"]]},{"id":"c4c5e231.078db","type":"function","z":"c3fa9bdb.b5c4c8","name":"Delay + 5 min","func":"if( msg.payload === \"vibration\" ||\n    msg.payload === \"tilt\" ||\n    msg.payload === \"drop\" \n    ){\n        msg.delay = 300000;\n        return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2580,"y":4640,"wires":[["fc90d2cd.bdbf7"]]},{"id":"fc90d2cd.bdbf7","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delayv","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2740,"y":4640,"wires":[["933a76a0.1f90d8"]]},{"id":"33450829.619f48","type":"inject","z":"c3fa9bdb.b5c4c8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"1800","crontab":"","once":true,"onceDelay":"15","topic":"","payload":"","payloadType":"date","x":2370,"y":4700,"wires":[["c4c5e231.078db","73e3053.c96eefc"]]},{"id":"8737707d.3bb5d","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"As roupas estão prontas na máquina.\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\",\"media_player.echo_dot_do_quarto_pai\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":3650,"y":4420,"wires":[["9fa95be4.5e5d38"]]},{"id":"dc104c0e.649cc","type":"alexa-remote-routine","z":"c3fa9bdb.b5c4c8","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"50"},"mode":"set","devices":["7c757a5cc13e48da91a35e14b6ac58f3"]}},"x":3430,"y":4420,"wires":[["8737707d.3bb5d"]]},{"id":"8e1b7269.68b89","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"OK                                                          "},"volume":{"type":"num","value":"40"},"mode":"set","devices":["G090XG1103420J46"]}},"x":2751,"y":2300,"wires":[[]]},{"id":"93da222c.6ffaf","type":"function","z":"444fced8.33ecb","name":"Turn On","func":"var newMsg;\nif((msg.payload.name===\"Echo Dot da Sala\" && \n   \n   (msg.payload.description.summary.includes('ligar a t.v.')===true ||\n   msg.payload.description.summary.includes('ligar a t. v.')===true||\n   msg.payload.description.summary.includes('ligar t.v.')===true ||\n   msg.payload.description.summary.includes('ligar t. v.')===true ||\n   msg.payload.description.summary.includes('liga a t.v.')===true ||\n   msg.payload.description.summary.includes('liga a t. v.')===true||\n   msg.payload.description.summary.includes('liga t.v.')===true ||\n   msg.payload.description.summary.includes('liga t. v.')===true ||\n   msg.payload.description.summary.includes('ligue a t.v.')===true ||\n   msg.payload.description.summary.includes('ligue a t. v.')===true||\n   msg.payload.description.summary.includes('ligue t.v.')===true ||\n   msg.payload.description.summary.includes('ligue t. v.')===true ||\n    ((msg.payload.description.summary.includes('liga')===true  ||\n    msg.payload.description.summary.includes('ligar')===true  ||\n    msg.payload.description.summary.includes('ligue')===true ) &&\n    msg.payload.description.summary.includes('t.')===true &&\n    msg.payload.description.summary.includes('v.')===true) && \n    msg.payload.description.summary.includes('desliga') === false &&\n    msg.payload.description.summary.includes('desligue') === false\n    ))\n   ){\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_on\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n        }\n    }\n    return newMsg;\n}\nif(msg.payload.description.summary.includes('desliga a t.v. da sala')===true||\n   msg.payload.description.summary.includes('desliga a t. v. da sala')===true||\n   \n        (msg.payload.name===\"Echo Dot da Sala\" && \n    msg.payload.description.summary.includes('desligar')===true||\n    msg.payload.description.summary.includes('desligue')===true||\n    msg.payload.description.summary.includes('desliga')===true) &&\n    (msg.payload.description.summary.includes('TV')===true||\n    msg.payload.description.summary.includes('t.v.')===true||\n    msg.payload.description.summary.includes('t v')===true||\n    (msg.payload.description.summary.includes('t.')===true&&\n    msg.payload.description.summary.includes('v.')===true))\n   ){\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\"\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":2360,"wires":[["4be760da.d877"]]},{"id":"2e5b0b31.17bbf4","type":"inject","z":"e7cd1901.ee2408","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":770,"y":60,"wires":[["e70cfc56.e6d9a"]]},{"id":"aee1b41.116d148","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"str","x":690,"y":1100,"wires":[["fdb87cd7.4a536","d86e7a62.6c6db8","a15f542b.7479e8","c4d0a5ba.4a5f78"]]},{"id":"2766e049.4cdbf","type":"inject","z":"5767c936.cabd18","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":235,"y":1004,"wires":[["f663ec98.82fab","ace843be.a34e7"]]},{"id":"c85d1e41.e0972","type":"debug","z":"5767c936.cabd18","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":680,"y":948,"wires":[]},{"id":"1789d9d5.93db16","type":"function","z":"444fced8.33ecb","name":"Turn Off","func":"msg.payload = {\"on\": false};\n\n    node.send(msg);\n    node.status({text:\"Desligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2580,"y":1080,"wires":[["e7bb1eea.7c473","f6f2e80d.89bb38"]]},{"id":"e7bb1eea.7c473","type":"yeelight-compat-hue-out","z":"444fced8.33ecb","name":"","server":"56814891.18c868","x":2780,"y":1080,"wires":[]},{"id":"f6f2e80d.89bb38","type":"yeelight-compat-hue-out","z":"444fced8.33ecb","name":"","server":"5a8bf4db.2d6bcc","x":2770,"y":1140,"wires":[]},{"id":"b69ddfbe.51b82","type":"inject","z":"d67ca66.293d758","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"On\":true}","payloadType":"json","x":680,"y":340,"wires":[["8c0cc7c1.3bbbb8"]]},{"id":"8111e6a1.7e5eb8","type":"inject","z":"c3fa9bdb.b5c4c8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":3230,"y":4420,"wires":[["dc104c0e.649cc"]]},{"id":"e26a2c5c.ca85","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"hour","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":3070,"y":4500,"wires":[["e7df2829.b0fe88"]]},{"id":"72cc7c65.6be7a4","type":"function","z":"c3fa9bdb.b5c4c8","name":"Reset Ocioso","func":"msg.reset = true\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3220,"y":4600,"wires":[["665518b0.bbb868"]]},{"id":"c4d0a5ba.4a5f78","type":"function","z":"4c9c764d.9c4468","name":"Desliga Automação","func":"    var newMsg;\n    global.set(\"desabilitaAutomacao\", true);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.desabilita_automacao_sala_escritorio\"\n        }\n    }};\n    return newMsg;\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":969,"y":1720,"wires":[["d4205229.97a6e","e193b984.bb20b8"]]},{"id":"e193b984.bb20b8","type":"api-call-service","z":"4c9c764d.9c4468","name":"Desabilita Automação","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.desabilita_automacao_sala_escritorio","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1560,"y":1720,"wires":[[]]},{"id":"173b8a0d.bb1566","type":"function","z":"5767c936.cabd18","name":"Turn On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.sala_ocupada_switch\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2400,"y":860,"wires":[["c635d49e.ea96a8"]]},{"id":"f0109079.cd84","type":"change","z":"5767c936.cabd18","name":"","rules":[{"t":"set","p":"triggered6","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":120,"wires":[["e4e654de.ca4be8"]]},{"id":"e4e654de.ca4be8","type":"yeelight-compat-hue-state","z":"5767c936.cabd18","name":"","server":"14b837c9.ab10c","x":1058,"y":120,"wires":[["7769c674.4d0128"]]},{"id":"950bacc8.dd4ff","type":"function","z":"5767c936.cabd18","name":"Turn On","func":"if(global.get(\"desabilitaAutomacao\") === false){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":680,"y":260,"wires":[["dcd2984c.8ee318"]]},{"id":"4d99acb0.658954","type":"function","z":"e7cd1901.ee2408","name":"Turn On","func":"if(global.get(\"desabilitaAutomacao\") === false){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":600,"y":120,"wires":[["9f86e19e.674de"]]},{"id":"da058ed5.3f35f","type":"inject","z":"e7cd1901.ee2408","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1430,"y":60,"wires":[["dea9e275.a6cd1"]]},{"id":"2f499135.405dce","type":"inject","z":"444fced8.33ecb","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2250,"y":1400,"wires":[["503759f7.d0e928"]]},{"id":"554e3bcc.cfda44","type":"inject","z":"5767c936.cabd18","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":650,"y":40,"wires":[["62da1cb0.8b2cd4","f0109079.cd84"]]},{"id":"7769c674.4d0128","type":"function","z":"5767c936.cabd18","name":"auxCT","func":"if(flow.get(\"triggered6\")===true){\n    flow.set(\"triggered6\", false);\n    if(msg.payload.state.on === true){\n        flow.set(\"auxCT\",msg.payload.state.ct);\n        if(!msg.payload.state.ct){\n            flow.set(\"auxCT\",parseInt(msg.payload.raw.ct));\n        }\n        if(!msg.payload.raw.ct){\n            flow.set(\"auxCT\",6100);\n        }\n        flow.set(\"countBrightnessLuz\",msg.payload.state.bri);\n    }\n}","outputs":0,"noerr":0,"initialize":"","finalize":"","x":1230,"y":120,"wires":[]},{"id":"5ec55b77.d22a14","type":"link out","z":"5767c936.cabd18","name":"Reset Automation 2","links":["2889a3d3.f4edac","1b697df.c112282"],"x":3710,"y":384,"wires":[]},{"id":"2889a3d3.f4edac","type":"link in","z":"5767c936.cabd18","name":"","links":["124b61c8.1527fe","5ec55b77.d22a14"],"x":895,"y":400,"wires":[["ba6a4e16.62ac7"]]},{"id":"124b61c8.1527fe","type":"link out","z":"5767c936.cabd18","name":"Reset Automation","links":["2889a3d3.f4edac"],"x":2500,"y":364,"wires":[]},{"id":"5b0dc24f.60623c","type":"link out","z":"e7cd1901.ee2408","name":"Reset Automation 2","links":["a9bcf9d2.4e8338"],"x":3675,"y":320,"wires":[]},{"id":"701ddd3a.218e34","type":"link out","z":"e7cd1901.ee2408","name":"Reset Automation","links":["a9bcf9d2.4e8338"],"x":2455,"y":300,"wires":[]},{"id":"a9bcf9d2.4e8338","type":"link in","z":"e7cd1901.ee2408","name":"","links":["5b0dc24f.60623c","701ddd3a.218e34"],"x":775,"y":200,"wires":[["b2a76711.ae4398"]]},{"id":"933a76a0.1f90d8","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"3","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2900,"y":4640,"wires":[["73e3053.c96eefc"]]},{"id":"30ebe780.fd8ac8","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"30","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":3220,"y":4540,"wires":[["9c867cd6.62ccf"]]},{"id":"2dc4b323.2ea56c","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"30","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":3720,"y":4600,"wires":[["9c867cd6.62ccf"]]},{"id":"9fa95be4.5e5d38","type":"alexa-remote-routine","z":"c3fa9bdb.b5c4c8","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"40"},"mode":"set","devices":["3280160611704f9bbef1e7c2aa967417"]}},"x":3870,"y":4400,"wires":[[]]},{"id":"79e2892d.bbd1e8","type":"function","z":"859b066a.dd8128","name":"Escuro?","func":"global.set(\"luxQuarto\", msg.payload);\nvar quartoEscuro = global.get(\"quartoEscuro\");\nif(typeof QuartoEscuro !== \"undefined\"){\n    if(QuartoEscuro === true){\n        if(msg.payload > 30){\n            global.set(\"quartoEscuro\", false);\n            node.status({fill:\"yellow\",shape:\"dot\",text:\"QuartoEscuro false\"});\n        }\n    }\n    else{\n        if(msg.payload < 15 && msg.payload > 0){\n                global.set(\"quartoEscuro\", true);\n                node.status({fill:\"green\",shape:\"dot\",text:\"QuartoEscuro true\"});\n                node.send(msg);\n        }\n    }\n}\nelse{\n        if(msg.payload < 15 && msg.payload > 0){\n                global.set(\"quartoEscuro\", true);\n                node.status({fill:\"green\",shape:\"dot\",text:\"QuartoEscuro true\"});\n                node.send(msg);\n        }\n        else{\n            if(msg.payload > 30){\n                global.set(\"quartoEscuro\", false);\n                node.status({fill:\"yellow\",shape:\"dot\",text:\"QuartoEscuro false\"});\n            }\n        }\n}\n\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);","outputs":1,"noerr":0,"x":660,"y":360,"wires":[[]]},{"id":"e44f4352.2fbe5","type":"mqtt in","z":"859b066a.dd8128","name":"Sensor Luz Quarto Nédi","topic":"QuartoNedi/currentLight","qos":"0","datatype":"json","broker":"64936db9.640564","x":210,"y":360,"wires":[["85bc1430.9d6528"]]},{"id":"85bc1430.9d6528","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":460,"y":360,"wires":[["79e2892d.bbd1e8"]]},{"id":"140d5720.b26f19","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1340,"y":1780,"wires":[["e193b984.bb20b8","a9cff849.a11ca8"]]},{"id":"d801b6d8.f3b728","type":"server-state-changed","z":"4c9c764d.9c4468","name":"Desabilita Automação","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.desabilita_automacao_sala_escritorio","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":1000,"y":260,"wires":[["668d034a.5f7a6c"]]},{"id":"668d034a.5f7a6c","type":"function","z":"4c9c764d.9c4468","name":"Aux Function","func":"if(msg.payload === \"on\"){\n    global.set(\"desabilitaAutomacao\", true)\n    var newMsg = {payload:\"reset\", reset: true}\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1190,"y":260,"wires":[["7840428.2ec55bc"]]},{"id":"a9858188.21d7c","type":"debug","z":"7b0de646.c85c78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1270,"y":2560,"wires":[]},{"id":"a00845b0.2978f8","type":"debug","z":"7b0de646.c85c78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1010,"y":2720,"wires":[]},{"id":"e8f0f070.a02ca","type":"debug","z":"7b0de646.c85c78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1230,"y":2420,"wires":[]},{"id":"9b96b45f.e89648","type":"function","z":"7b0de646.c85c78","name":"Volume","func":"msg.params = [ {volumePercent:40, device_id: msg.params[0].deviceIds[0]} ]; \nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1640,"y":2460,"wires":[["628fe55c.bc1fdc"]]},{"id":"628fe55c.bc1fdc","type":"spotify","z":"7b0de646.c85c78","name":"","auth":"3b9d50b6.bca4e","api":"setVolume","x":1810,"y":2460,"wires":[[]]},{"id":"39b352c7.4b2f3e","type":"debug","z":"7b0de646.c85c78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1470,"y":2400,"wires":[]},{"id":"532d45.1ad952bc","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1480,"y":2460,"wires":[["9b96b45f.e89648"]]},{"id":"190248cb.085527","type":"change","z":"e7cd1901.ee2408","name":"","rules":[{"t":"set","p":"triggered5","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":990,"y":380,"wires":[["e1ea086.6e68cf8"]]},{"id":"e1ea086.6e68cf8","type":"yeelight-compat-hue-state","z":"e7cd1901.ee2408","name":"","server":"56814891.18c868","x":1180,"y":380,"wires":[["a9712f7d.32284"]]},{"id":"a9712f7d.32284","type":"function","z":"e7cd1901.ee2408","name":"auxCT","func":"if(flow.get(\"triggered5\")=== true){\n    flow.set(\"triggered5\", false);\n    if(msg.payload.state.on === true){\n        flow.set(\"auxCT\",msg.payload.state.ct);\n        flow.set(\"countBrightness\",msg.payload.state.bri);\n    }\n}\n\n","outputs":0,"noerr":0,"initialize":"","finalize":"","x":1330,"y":380,"wires":[]},{"id":"d4205229.97a6e","type":"function","z":"4c9c764d.9c4468","name":"Desliga Automação","func":"    var newMsg;\n    \n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.desabilita_automacao_sala_escritorio\"\n        }\n    }};\n    return newMsg;\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1170,"y":1780,"wires":[["140d5720.b26f19"]]},{"id":"cfd0b69b.fd4be8","type":"api-call-service","z":"4c9c764d.9c4468","name":"Abajur","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":1090,"y":840,"wires":[[]]},{"id":"d86e7a62.6c6db8","type":"function","z":"4c9c764d.9c4468","name":"Turn Off","func":"    var newMsg;\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.abajur_esquerda\",\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.abajur_direita\",\n        }\n    }\n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":942,"y":840,"wires":[["cfd0b69b.fd4be8"]]},{"id":"b344c41b.9672e8","type":"function","z":"444fced8.33ecb","name":"Clarice Veio On","func":"if(((\n    msg.payload.description.summary.includes('clarice')===true ||\n    msg.payload.description.summary.includes('clarisse')===true||\n    msg.payload.description.summary.includes('clarise')===true) &&\n    (\n    msg.payload.description.summary.includes('veio')===true ||\n    msg.payload.description.summary.includes('vem')===true \n    )\n    )){\n    \n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.clarice_veio\"\n        }\n    }};\n    return newMsg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2300,"y":2340,"wires":[["fc47ebd4.755278","c54f95b7.561948"]]},{"id":"fc47ebd4.755278","type":"api-call-service","z":"444fced8.33ecb","name":"Clarice Veio","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2530,"y":2360,"wires":[[]]},{"id":"c54f95b7.561948","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                          "},"volume":{"type":"num","value":"40"},"mode":"set","devices":["3280160611704f9bbef1e7c2aa967417"]}},"x":2570,"y":2420,"wires":[[]]},{"id":"db574882.3ed228","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2540,"y":2300,"wires":[["8e1b7269.68b89"]]},{"id":"9d02cc65.57cc1","type":"inject","z":"4c9c764d.9c4468","name":"Duolingo","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"05 15 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":250,"y":1940,"wires":[["cf2d7c6a.1d1bd"]]},{"id":"6af2a66d.b4b638","type":"api-call-service","z":"4c9c764d.9c4468","name":"Luz da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1170,"y":1940,"wires":[[]]},{"id":"e7f33a4d.175e28","type":"function","z":"4c9c764d.9c4468","name":"WhatsApp Effect","func":"var newMsg;\n\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\",\n            \"effect\": \"WhatsApp\",\n            \"rgb_color\": [0, 100, 0]\n        }\n    }};\n    node.send(newMsg);\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\",\n            \"effect\": \"WhatsApp\",\n            \"rgb_color\": [0, 100, 0]\n        }\n    }};\n    node.send(newMsg);\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\"\n        }\n    }};\n    return newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":770,"y":1940,"wires":[["8e5b4c4.508b6b"]]},{"id":"e0224238.70a07","type":"function","z":"4c9c764d.9c4468","name":"Home?","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg = {payload: {\"On\":true}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":580,"y":1940,"wires":[["e7f33a4d.175e28","a163ae3c.0194"]]},{"id":"cf2d7c6a.1d1bd","type":"api-current-state","z":"4c9c764d.9c4468","name":"Nédi home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":410,"y":1940,"wires":[["e0224238.70a07"]]},{"id":"a163ae3c.0194","type":"function","z":"4c9c764d.9c4468","name":"Abajur Flicker","func":"var newMsg;\n\nnewMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"switch.abajur_esquerda\"\n        }\n    }};\n    node.send(newMsg);\nnewMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.abajur_esquerda\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"switch.abajur_esquerda\"\n        }\n    }};\n    node.send(newMsg);\nnewMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.abajur_esquerda\"\n        }\n    }};\n    return newMsg ;\n    ","outputs":1,"noerr":0,"initialize":"","finalize":"","x":760,"y":2000,"wires":[["bc74c381.903e5"]]},{"id":"cb2a513c.90da2","type":"api-call-service","z":"4c9c764d.9c4468","name":"Abajur da Esquerda","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1200,"y":2000,"wires":[[]]},{"id":"8e5b4c4.508b6b","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":980,"y":1940,"wires":[["6af2a66d.b4b638"]]},{"id":"bc74c381.903e5","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":970,"y":2000,"wires":[["cb2a513c.90da2"]]},{"id":"5ccf382b.737b58","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"OK                                                          "},"volume":{"type":"num","value":"40"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":2750,"y":1912,"wires":[[]]},{"id":"fb1f5313.600ad","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2540,"y":1912,"wires":[["5ccf382b.737b58"]]},{"id":"cf439f99.ba5b8","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2540,"y":2069,"wires":[["562c270e.f934a8"]]},{"id":"562c270e.f934a8","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"OK                                                          "},"volume":{"type":"num","value":"40"},"mode":"set","devices":["G090XG0894430B3V"]}},"x":2750,"y":2069,"wires":[[]]},{"id":"ff4db3ea.6494a","type":"debug","z":"d3db5d74.fb8fa","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1810,"y":2020,"wires":[]},{"id":"1a87657.8904d1b","type":"debug","z":"d3db5d74.fb8fa","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1770,"y":2160,"wires":[]},{"id":"eaa67a7f.f32758","type":"function","z":"d3db5d74.fb8fa","name":"Vento forte?","func":"var date = new Date();\nvar Day = date.getDay(); \nvar Hour = date.getHours();\nif( (msg.data.currently.summary.includes(\"rain\")=== true ||\n    msg.data.currently.summary.includes(\"Rain\")=== true  ||\n    msg.data.currently.windSpeed > 35)\n    && (Hour > 9 && Hour < 23)\n    ){\n    \n    global.set(\"ventoAux\",true);\n    return {payload:1};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1930,"y":2120,"wires":[[]]},{"id":"10dc082e.ac79a","type":"function","z":"d3db5d74.fb8fa","name":"Vento forte?","func":"if(msg.payload.includes(\"rain\")===true &&\n    msg.data.attributes.wind_speed > 35){\n    global.set(\"ventoAux\", true);\n    return {payload:1};\n}\nelse{\n    global.set(\"ventoAux\", false);\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1910,"y":1980,"wires":[[]]},{"id":"6bb839fe.173d58","type":"function","z":"444fced8.33ecb","name":"Desliga Automação","func":"    var newMsg;\n    global.set(\"desabilitaAutomacao\", true);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.desabilita_automacao_sala_escritorio\"\n        }\n    }};\n    return newMsg;\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2610,"y":940,"wires":[["3d3b8369.b08bac","5d2fd9a0.dcdf18"]]},{"id":"5d2fd9a0.dcdf18","type":"api-call-service","z":"444fced8.33ecb","name":"Desabilita Automação","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.desabilita_automacao_sala_escritorio","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3201,"y":940,"wires":[[]]},{"id":"d462fdc6.15aa8","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2981,"y":1000,"wires":[["5d2fd9a0.dcdf18","7a92a30d.aa702c"]]},{"id":"3d3b8369.b08bac","type":"function","z":"444fced8.33ecb","name":"Desliga Automação","func":"    var newMsg;\n    \n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.desabilita_automacao_sala_escritorio\"\n        }\n    }};\n    return newMsg;\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2811,"y":1000,"wires":[["d462fdc6.15aa8"]]},{"id":"205f6563.b004fa","type":"inject","z":"444fced8.33ecb","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2330,"y":900,"wires":[["6bb839fe.173d58"]]},{"id":"a9cff849.a11ca8","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"hours","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1530,"y":1820,"wires":[["ab9302fc.8c29d"]]},{"id":"ab9302fc.8c29d","type":"function","z":"4c9c764d.9c4468","name":"Reset Aux Var","func":"\n    global.set(\"desabilitaAutomacao\", false)\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1700,"y":1820,"wires":[[]]},{"id":"7a92a30d.aa702c","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"hours","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3160,"y":1040,"wires":[["be5e2f6.c8a21d"]]},{"id":"be5e2f6.c8a21d","type":"function","z":"444fced8.33ecb","name":"Reset Aux Var","func":"\n    global.set(\"desabilitaAutomacao\", false)\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3330,"y":1040,"wires":[[]]},{"id":"e8adc93c.06d4f8","type":"function","z":"e7cd1901.ee2408","name":"Reset Aux Var","func":"\n    global.set(\"desabilitaAutomacao\", false)\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1040,"y":460,"wires":[[]]},{"id":"ff1586d2.1093f8","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"hours","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":870,"y":460,"wires":[["e8adc93c.06d4f8"]]},{"id":"4fc7f5e1.c037dc","type":"server-state-changed","z":"5767c936.cabd18","name":"Movimento Sala Aux","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.movimento_sala_aux","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":190,"y":1180,"wires":[["89f9ccf9.399a6"]]},{"id":"89f9ccf9.399a6","type":"function","z":"5767c936.cabd18","name":"Moveu?","func":"if(msg.payload === \"on\"){        \n    msg = {payload: {MotionDetected: true}};\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":360,"y":1180,"wires":[["9ee7bdef.1a795"]]},{"id":"4f18b6c5.078a28","type":"function","z":"d3db5d74.fb8fa","name":"Delay","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour > 18){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"light.aqara_hub\",\n        }\n    }};\n    newMsg.delay = 300000\n    return newMsg;\n} ","outputs":1,"noerr":0,"initialize":"","finalize":"","x":710,"y":1160,"wires":[["d56aaec0.5c80a"]]},{"id":"9318bc52.48ab4","type":"change","z":"d3db5d74.fb8fa","name":"","rules":[{"t":"delete","p":"delay","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1030,"y":1160,"wires":[["b27ad273.029bd"]]},{"id":"9087ade6.99d3","type":"function","z":"d3db5d74.fb8fa","name":"Delay","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nvar newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"light.aqara_hub\",\n        }\n    }};\nnewMsg.delay = 300000\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1350,"y":1240,"wires":[["130a6775.a0e089"]]},{"id":"af71570d.6eabe8","type":"change","z":"d3db5d74.fb8fa","name":"","rules":[{"t":"delete","p":"delay","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1650,"y":1240,"wires":[["c3558e1c.f8358"]]},{"id":"cdfb9483.1eb448","type":"function","z":"859b066a.dd8128","name":"Delay","func":"msg.delay = 600000\nreturn msg;\n ","outputs":1,"noerr":0,"initialize":"","finalize":"","x":930,"y":560,"wires":[["4b134ac6.c0d974"]]},{"id":"4b134ac6.c0d974","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delayv","timeout":"10","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1080,"y":560,"wires":[["e0a29728.f21988"]]},{"id":"e0a29728.f21988","type":"change","z":"859b066a.dd8128","name":"","rules":[{"t":"delete","p":"delay","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":560,"wires":[["1f8cffab.901a3"]]},{"id":"ab6e20fa.2fccc","type":"function","z":"d67ca66.293d758","name":"","func":"global.set(\"desabilitaAutomacao\", true);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":580,"y":2860,"wires":[[]]},{"id":"311324ac.e2d41c","type":"server-state-changed","z":"e7cd1901.ee2408","name":"Alguém em Casa","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.alguem_em_casa","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"true","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":420,"y":500,"wires":[["2e8209b5.a68e96"],["2e8209b5.a68e96"]]},{"id":"2e8209b5.a68e96","type":"function","z":"e7cd1901.ee2408","name":"Alguém chegou","func":"if(msg.payload === \"on\" || msg.payload === true){\n    var date = new Date();\n    var Hour = date.getHours();\n    if(Hour > 17 || Hour < 9){\n        return msg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":640,"y":500,"wires":[["b2a76711.ae4398","ef7a1a0d.c6fa18"]]},{"id":"1d6c795b.fc6b87","type":"function","z":"5767c936.cabd18","name":"Alguém chegou","func":"if(msg.payload === \"on\" || msg.payload === true){\n    var date = new Date();\n    var Hour = date.getHours();\n    if(Hour > 16 || Hour < 9){\n        return msg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":320,"y":520,"wires":[["ba6a4e16.62ac7","2f2f0c14.47f9e4"]]},{"id":"f91b8c6.ee4027","type":"server-state-changed","z":"5767c936.cabd18","name":"Alguém em Casa","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.alguem_em_casa","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"true","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":140,"y":520,"wires":[["1d6c795b.fc6b87"],["1d6c795b.fc6b87"]]},{"id":"96c98e71.db341","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1140,"y":140,"wires":[["fa95f894.fa4f98"]]},{"id":"ef7a1a0d.c6fa18","type":"function","z":"e7cd1901.ee2408","name":"Escuro?","func":"var salaEscura = global.get(\"salaEscura\")\nif (salaEscura === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":620,"y":440,"wires":[["4d99acb0.658954"]]},{"id":"2f2f0c14.47f9e4","type":"function","z":"5767c936.cabd18","name":"Escuro?","func":"var escritorioEscuro = global.get(\"escritorioEscuro\")\nif (escritorioEscuro === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":520,"wires":[["950bacc8.dd4ff"]]},{"id":"91868a33.c4af98","type":"change","z":"2bbba447.a4759c","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1780,"y":580,"wires":[["fa56b44c.6d8ce8","48a71a45.f09914"]]},{"id":"48bf75a2.de0a2c","type":"debug","z":"2bbba447.a4759c","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2270,"y":660,"wires":[]},{"id":"c1b62f28.bfdd7","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2240,"y":480,"wires":[["35d81f25.70efe"]]},{"id":"ece6e1e6.9f9c1","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2340,"y":580,"wires":[["48a71a45.f09914"]]},{"id":"eaf959ca.c2b768","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1900,"y":540,"wires":[["fa56b44c.6d8ce8"]]},{"id":"7afc35c.093f9cc","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Luz Noturna","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"light.aqara_hub","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":1050,"y":1240,"wires":[["fbe96195.54045"],["fbe96195.54045"]]},{"id":"56b8f146.369a5","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Luz Noturna","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"light.aqara_hub","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1050,"y":1300,"wires":[["fbe96195.54045"],[]]},{"id":"18f45fa6.be13a","type":"inject","z":"d3db5d74.fb8fa","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"600","crontab":"","once":true,"onceDelay":"120","topic":"","payload":"true","payloadType":"bool","x":910,"y":1300,"wires":[["56b8f146.369a5"]]},{"id":"a406512.4ee3ab","type":"delay","z":"de7173c1.b1a8c","name":"","pauseType":"delayv","timeout":"5","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":480,"y":240,"wires":[["5ceea522.cef27c"]]},{"id":"b4c67add.4332a8","type":"api-current-state","z":"de7173c1.b1a8c","name":"Cozinha escura?","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"100","halt_if_type":"num","halt_if_compare":"lt","override_topic":false,"entity_id":"sensor.sensor_de_luz_cozinha","state_type":"num","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":650,"y":180,"wires":[["401d1fde.06374"],["401d1fde.06374"]]},{"id":"793d498f.fcd508","type":"function","z":"de7173c1.b1a8c","name":"Delay","func":"var newMsg;\nnewMsg.delay = 900000\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":330,"y":240,"wires":[["a406512.4ee3ab"]]},{"id":"5ceea522.cef27c","type":"change","z":"de7173c1.b1a8c","name":"","rules":[{"t":"delete","p":"delay","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":650,"y":240,"wires":[["9a9f6052.0b22c"]]},{"id":"f250c7af.142328","type":"yeelight-compat-hue-out","z":"de7173c1.b1a8c","d":true,"name":"","server":"56814891.18c868","x":1040,"y":180,"wires":[]},{"id":"401d1fde.06374","type":"function","z":"de7173c1.b1a8c","name":"Turn On","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nvar newMsg;\nif(Hour > 15 ||Hour < 10 || msg.payload < 30){\n    if(Hour > 15){ \n\n            newMsg = {payload : {\"On\": true, \"on\": true}};\n            newMsg.payload.brightness = 255\n            newMsg.payload.ct = 6200\n            newMsg.payload.duration = 2000\n            return newMsg;\n        \n    }\n    if(Hour < 2) {\n            newMsg = {payload : {\"On\": true, \"on\": true}};\n            newMsg.payload.brightness = 191\n            newMsg.payload.ct = 6200\n            newMsg.payload.duration = 1500\n            return newMsg;\n    }\n    if(Hour < 10) {\n            newMsg = {payload : {\"On\": true, \"on\": true}};\n            newMsg.payload.brightness = 165\n            newMsg.payload.ct = 6200\n            newMsg.payload.duration = 1500\n            return newMsg;\n    }\n} ","outputs":1,"noerr":0,"initialize":"","finalize":"","x":820,"y":180,"wires":[["f250c7af.142328"]]},{"id":"9a9f6052.0b22c","type":"function","z":"de7173c1.b1a8c","name":"Turn Off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg = {payload : {\"On\": false, \"on\": false}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":820,"y":240,"wires":[["f250c7af.142328"]]},{"id":"50fa0f15.9f41e","type":"comment","z":"de7173c1.b1a8c","name":"Trocar pra Luz da Cozinha","info":"","x":1040,"y":140,"wires":[]},{"id":"25bef91.7b6ff06","type":"link in","z":"de7173c1.b1a8c","name":"Movimento Cozinha","links":["14440e93.eb1131"],"x":195,"y":180,"wires":[["b4c67add.4332a8","793d498f.fcd508"]]},{"id":"bf7fa2f1.7bfb","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"delay","timeout":"40","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":620,"y":960,"wires":[["eb61e7a8.2252c8"]]},{"id":"49ff7959.acaf78","type":"switch","z":"ec27da7d.cad118","name":"","property":"payload.On","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":430,"y":967,"wires":[["bf7fa2f1.7bfb","c146f4b9.bcc6a8"]]},{"id":"76985b00.bb5f94","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":260,"y":967,"wires":[["49ff7959.acaf78"]]},{"id":"eb61e7a8.2252c8","type":"change","z":"ec27da7d.cad118","name":"","rules":[{"t":"set","p":"botaoQuarto","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"turnOffDelay","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":800,"y":960,"wires":[[]]},{"id":"c146f4b9.bcc6a8","type":"change","z":"ec27da7d.cad118","name":"","rules":[{"t":"set","p":"botaoQuarto","pt":"global","to":"true","tot":"bool"},{"t":"set","p":"turnOffDelay","pt":"global","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":620,"y":1020,"wires":[[]]},{"id":"680b4884.f09218","type":"function","z":"ec27da7d.cad118","name":"","func":"var newMsg;\nnewMsg = {payload:\"on\",\n          data:{attributes:{brightness: 10}}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":250,"y":860,"wires":[["80c9290a.43e178","26cde2d1.6506fe","925ae9f7.e35a28","6ea82b64.ad8f0c"]]},{"id":"6b2d6985.55d498","type":"function","z":"ec27da7d.cad118","name":"Turn Off","func":"if(msg.payload === true ){\n    global.set(\"quartoOn\",false);\n    var newMsg;\n    newMsg = {payload : {}};\n    newMsg.payload.On = false;\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2485,"y":740,"wires":[["3df81b1.4ae3ee4","af1efc62.f0d48","643966a.44bb498","5528942f.327e2c"]]},{"id":"2e6f205b.63928","type":"function","z":"ec27da7d.cad118","name":"Turn On","func":"if(msg.payload === false){\n        \n    global.set(\"quartoOn\",true);\n    var newMsg;\n    newMsg = {payload : {}};\n    newMsg.payload.On = true;\n    return newMsg;\n}","outputs":1,"noerr":0,"x":2480,"y":800,"wires":[["cf1038e1.47d758","16f6b349.ce684d","2c537599.a80802"]]},{"id":"5e461018.21956","type":"comment","z":"ec27da7d.cad118","name":"Se luz do quarto estiver ligada baixinho, aumentar o brilho","info":"","x":2110,"y":1120,"wires":[]},{"id":"687b5fdb.d7185","type":"function","z":"ec27da7d.cad118","name":"","func":"if(msg.payload === \"on\"){\n        if(msg.data.attributes.brightness < 128)\n        {\n            msg.ajuda = 1;\n            return msg;\n        }\n        else{\n            \n            msg.ajuda = 2;\n            return msg;\n        }\n}\nelse{\n    \n            msg.ajuda = 1;\n            return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":620,"y":820,"wires":[["f4d52cbc.9f891","97472857.85c768"]]},{"id":"800b696c.ec6fd8","type":"switch","z":"ec27da7d.cad118","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"2","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":1030,"y":820,"wires":[["682544d7.1d47ac","3a9bfd4b.2c31e2","7c9ff439.4b387c"],["298c59c1.8a2826"]]},{"id":"f9724306.dfdcb","type":"function","z":"ec27da7d.cad118","name":"Turn On","func":"msg.payload = {};\nmsg.payload.On = true;\nreturn msg;","outputs":1,"noerr":0,"x":1570,"y":1060,"wires":[[]]},{"id":"682544d7.1d47ac","type":"function","z":"ec27da7d.cad118","name":"Luz do Quarto Topic","func":"var newMsg;\nif(msg.payload === \"on\")\n{\n    global.set(\"quartoOn\",true);\n    newMsg = {\"topic\":\"Luz\",\"payload\": true};\n    return newMsg;\n}\nif(msg.payload === \"off\")\n{\n    newMsg = {\"topic\":\"Luz\",\"payload\": false};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1280,"y":920,"wires":[["c3940dbe.b8495"]]},{"id":"d1c3ee81.577fd","type":"function","z":"ec27da7d.cad118","name":"","func":"var newMsg;\nif(msg.payload.On === true)\n{\n    global.set(\"quartoOn\",true);\n    newMsg = {\"topic\":\"Projetor Ceu\",\"payload\": true};\n    return newMsg;\n}\nif(msg.payload.On === false)\n{\n    newMsg = {\"topic\":\"Projetor Ceu\",\"payload\": false};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1540,"y":860,"wires":[["73d01fba.9eb56"]]},{"id":"73d01fba.9eb56","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1700,"y":860,"wires":[["8190319d.dd5f9"]]},{"id":"c3940dbe.b8495","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1700,"y":920,"wires":[["8190319d.dd5f9"]]},{"id":"8d1c227b.23b4b","type":"debug","z":"ec27da7d.cad118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2150,"y":680,"wires":[]},{"id":"26cde2d1.6506fe","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":440,"y":880,"wires":[["687b5fdb.d7185"]]},{"id":"44ae79df.bb2aa8","type":"function","z":"ec27da7d.cad118","name":"","func":"flow.set(\"respondeu\", true);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":660,"y":740,"wires":[[]]},{"id":"4ac6e851.ffbe08","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2315,"y":740,"wires":[["6b2d6985.55d498"]]},{"id":"83130f1b.74205","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2320,"y":800,"wires":[["2e6f205b.63928"]]},{"id":"298c59c1.8a2826","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1260,"y":1000,"wires":[["f9724306.dfdcb","173329e5.707476","55b0f004.ab5e08"]]},{"id":"f4d52cbc.9f891","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":820,"y":820,"wires":[["800b696c.ec6fd8"]]},{"id":"d2099053.ea8a2","type":"debug","z":"ec27da7d.cad118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":650,"y":680,"wires":[]},{"id":"7476a97e.8e1ac8","type":"inject","z":"ec27da7d.cad118","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":720,"wires":[["680b4884.f09218"]]},{"id":"6550fd86.f9de14","type":"comment","z":"ec27da7d.cad118","name":"Botão foi clicado","info":"Ligar as luzes se estiverem desligadas\nDesligar as luzes se estiverem ligadas e acima de 50% de brilho\nAumentar o brilho caso estiverem abaixo de 50%","x":160,"y":660,"wires":[]},{"id":"cf1038e1.47d758","type":"function","z":"ec27da7d.cad118","name":"Turn On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"input_boolean.quarto_ocupado\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":2860,"y":720,"wires":[["e1fea16f.cbad5"]]},{"id":"3df81b1.4ae3ee4","type":"function","z":"ec27da7d.cad118","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"input_boolean.quarto_ocupado\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":2860,"y":660,"wires":[["e1fea16f.cbad5"]]},{"id":"bf1670e7.f4493","type":"link in","z":"ec27da7d.cad118","name":"Botao Quarto","links":["a5bada24.753448"],"x":115,"y":860,"wires":[["76985b00.bb5f94","680b4884.f09218"]]},{"id":"97472857.85c768","type":"debug","z":"ec27da7d.cad118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":770,"y":880,"wires":[]},{"id":"9a5cfa12.450d88","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1420,"y":800,"wires":[["d1c3ee81.577fd"]]},{"id":"3a9bfd4b.2c31e2","type":"function","z":"ec27da7d.cad118","name":"In Case of Error","func":"var newMsg;\nnewMsg = {payload:{\"On\":true}}\nreturn newMsg;","outputs":1,"noerr":0,"x":1260,"y":800,"wires":[["9a5cfa12.450d88"]]},{"id":"9aec77e5.985858","type":"inject","z":"ec27da7d.cad118","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1030,"y":1040,"wires":[["298c59c1.8a2826"]]},{"id":"cadf467c.e88338","type":"function","z":"ec27da7d.cad118","name":"Turn On 100%","func":"var i = parseInt(flow.get(\"iterLuzDoQuartoMariaInc\"));\n\nvar newMsg;\nif (i > 255) {\n    \n    newMsg= {payload : {\n                \"domain\": \"light\",\n                \"service\": \"turn_on\",\n                data:{\n                    \n                    \"entity_id\": \"light.luz_do_quarto_maria\",\n                    \"brightness\": 255,\n                    \"color_temp\": 204\n                }\n    }};    \n    node.send(newMsg);\n        return {reset: 1};\n}\nnewMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.luz_do_quarto_maria\",\n                \"brightness\": i,\n                \"color_temp\": 204\n            }\n}};    \ni += 50\nflow.set(\"iterLuzDoQuartoMariaInc\", i);\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1988,"y":1240,"wires":[["e34c58.03ba13a8"]]},{"id":"2fafcf00.09fec2","type":"trigger","z":"ec27da7d.cad118","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-250","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":1788,"y":1240,"wires":[["cadf467c.e88338"]]},{"id":"173329e5.707476","type":"function","z":"ec27da7d.cad118","name":"Aux Function","func":"flow.set(\"iterLuzDoQuartoMariaInc\", 20);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1578,"y":1240,"wires":[["2fafcf00.09fec2"]]},{"id":"43b2cef7.18b87","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"4","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2320,"y":1240,"wires":[["4b56eb36.77f2e4"]]},{"id":"79d3625b.2b8acc","type":"function","z":"ec27da7d.cad118","name":"Turn On 100%","func":"var i = parseInt(flow.get(\"iterLuzDoQuartoMariaInc\"));\n\nvar newMsg;\nif (i > 255) {\n    \n    newMsg= {payload : {\n                \"domain\": \"light\",\n                \"service\": \"turn_on\",\n                data:{\n                    \n                    \"entity_id\": \"light.luz_do_quarto_maria\",\n                    \"brightness\": 255,\n                    \"color_temp\": 204\n                }\n    }};    \n    send.node(newMsg);\n        return {reset: true};\n}\nnewMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.luz_do_quarto_maria\",\n                \"brightness\": i,\n                \"color_temp\": 204\n            }\n}};    \ni += 30\nflow.set(\"iterLuzDoQuartoMariaInc\", i);\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3280,"y":980,"wires":[["4c8321e.2502ce"]]},{"id":"cb5727e2.a1d598","type":"trigger","z":"ec27da7d.cad118","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-250","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":3080,"y":980,"wires":[["79d3625b.2b8acc"]]},{"id":"16f6b349.ce684d","type":"function","z":"ec27da7d.cad118","name":"Aux Function","func":"flow.set(\"iterLuzDoQuartoMariaInc\", 20);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2870,"y":980,"wires":[["cb5727e2.a1d598"]]},{"id":"dfb08a04.433068","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"4","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3820,"y":980,"wires":[["22b6ecb4.30c204"]]},{"id":"7826a563.49cacc","type":"function","z":"ec27da7d.cad118","name":"Turn Off","func":"var i = parseInt(flow.get(\"iterLuzDoQuartoMariaDec\"));\nif (i <= 0) {      \n        newMsg= {payload : {        \n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            data:{\n                \"entity_id\": \"light.luz_do_quarto_maria\"\n            }},reset: true };\n        return newMsg;\n}\nelse{\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n                    \n            \"entity_id\": \"light.luz_do_quarto_maria\",\n            \"brightness\": i,\n            \"rgb_color\": [i, i, i]\n        }\n        }};\n    if(i < 60){ \n            \n            newMsg= {payload : {\n                \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \"entity_id\": \"light.luz_do_quarto_maria\",\n                \"brightness\": 0,\n                \"rgb_color\": [0, 0, 0]\n            }\n        }};\n        node.send(newMsg);          \n        newMsg= {payload : {        \n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            data:{\n                \"entity_id\": \"light.luz_do_quarto_maria\"\n            }}};\n    }\n}\ni-= 50\n        \nflow.set(\"iterLuzDoQuartoMariaDec\", i);\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3480,"y":900,"wires":[["2fa9254f.07028a"]]},{"id":"b25b4c2b.e805e","type":"trigger","z":"ec27da7d.cad118","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-250","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":3300,"y":900,"wires":[["7826a563.49cacc"]]},{"id":"55697b3e.d48544","type":"function","z":"ec27da7d.cad118","name":"Aux Function","func":"if(msg.payload === \"on\"){\n    flow.set(\"iterLuzDoQuartoMariaDec\", parseInt(msg.data.attributes.brightness));\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3090,"y":900,"wires":[["b25b4c2b.e805e"]]},{"id":"2fa9254f.07028a","type":"switch","z":"ec27da7d.cad118","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":3620,"y":940,"wires":[["dfb08a04.433068"],["b25b4c2b.e805e"]]},{"id":"4c8321e.2502ce","type":"switch","z":"ec27da7d.cad118","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":3440,"y":1040,"wires":[["dfb08a04.433068"],["cb5727e2.a1d598"]]},{"id":"e34c58.03ba13a8","type":"switch","z":"ec27da7d.cad118","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":2160,"y":1280,"wires":[["43b2cef7.18b87"],["2fafcf00.09fec2"]]},{"id":"80c9290a.43e178","type":"alexa-remote-smarthome","z":"ec27da7d.cad118","d":true,"name":"","account":"421d4b0d.32a884","config":{"option":"query","value":[]},"outputs":1,"x":430,"y":820,"wires":[["687b5fdb.d7185","44ae79df.bb2aa8"]]},{"id":"e1fea16f.cbad5","type":"api-call-service","z":"ec27da7d.cad118","name":"Quarto Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"binary_sensor.quarto_ocupado","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3050,"y":680,"wires":[[]]},{"id":"4b56eb36.77f2e4","type":"api-call-service","z":"ec27da7d.cad118","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2520,"y":1240,"wires":[[]]},{"id":"22b6ecb4.30c204","type":"api-call-service","z":"ec27da7d.cad118","name":"Luz do Quarto","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4000,"y":980,"wires":[[]]},{"id":"925ae9f7.e35a28","type":"api-current-state","z":"ec27da7d.cad118","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_maria","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":440,"y":760,"wires":[["687b5fdb.d7185","d2099053.ea8a2"]]},{"id":"af1efc62.f0d48","type":"api-current-state","z":"ec27da7d.cad118","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_maria","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2905,"y":900,"wires":[["55697b3e.d48544"]]},{"id":"8190319d.dd5f9","type":"BooleanLogicUltimate","z":"ec27da7d.cad118","name":"","filtertrue":"both","persist":false,"sInitializeWith":"WaitForPayload","triggertopic":"trigger","outputtriggeredby":"all","inputCount":"2","topic":"result","x":1920,"y":800,"wires":[[],["8d1c227b.23b4b","4ac6e851.ffbe08","83130f1b.74205"],[]]},{"id":"7c9ff439.4b387c","type":"api-current-state","z":"ec27da7d.cad118","name":"Galáxia","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"light.galaxia_maria","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1240,"y":860,"wires":[["d1c3ee81.577fd"],["d1c3ee81.577fd"]]},{"id":"98809f52.3a83f","type":"function","z":"ec27da7d.cad118","name":"Turn On 100%","func":"var i = parseInt(flow.get(\"iterLuzDoQuartoMariaInc\"));\nif (i > 255) {\n        return {reset: true};\n}\nvar newMsg;\nnewMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.luz_do_quarto_maria_hk\",\n                \"brightness\": i,\n                \"rgb_color\": [i, i, i]\n            }\n}};    \ni += 30\nflow.set(\"iterLuzDoQuartoMariaInc\", i);\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3280,"y":1180,"wires":[["5be18145.f233e8"]]},{"id":"7e4a1875.c5def8","type":"trigger","z":"ec27da7d.cad118","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-250","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":3080,"y":1180,"wires":[["98809f52.3a83f"]]},{"id":"2c537599.a80802","type":"function","z":"ec27da7d.cad118","d":true,"name":"Aux Function","func":"flow.set(\"iterLuzDoQuartoMariaInc\", 20);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2870,"y":1180,"wires":[["7e4a1875.c5def8"]]},{"id":"e3005c36.a26","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"4","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3820,"y":1180,"wires":[["7cf8acad.05839c"]]},{"id":"74bfb5a8.40e0cc","type":"function","z":"ec27da7d.cad118","name":"Turn Off","func":"var i = parseInt(flow.get(\"iterLuzDoQuartoMariaDec\"));\nif (i <= 0) {      \n        newMsg= {payload : {        \n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            data:{\n                \"entity_id\": \"light.luz_do_quarto_maria_hk\"\n            }},reset: true };\n        return newMsg;\n}\nelse{\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n                    \n            \"entity_id\": \"light.luz_do_quarto_maria_hk\",\n            \"brightness\": i,\n            \"rgb_color\": [i, i, i]\n        }\n        }};\n    if(i < 60){ \n            \n            newMsg= {payload : {\n                \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \"entity_id\": \"light.luz_do_quarto_maria_hk\",\n                \"brightness\": 0,\n                \"rgb_color\": [0, 0, 0]\n            }\n        }};\n        node.send(newMsg);          \n        newMsg= {payload : {        \n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            data:{\n                \"entity_id\": \"light.luz_do_quarto_maria_hk\"\n            }}};\n    }\n}\ni-= 50\n        \nflow.set(\"iterLuzDoQuartoMariaDec\", i);\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3480,"y":1100,"wires":[["4345f1b6.ec862"]]},{"id":"410cbc0.75e67c4","type":"trigger","z":"ec27da7d.cad118","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-250","extend":false,"overrideDelay":false,"units":"ms","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":3300,"y":1100,"wires":[["74bfb5a8.40e0cc"]]},{"id":"6502b88f.289da8","type":"function","z":"ec27da7d.cad118","name":"Aux Function","func":"if(msg.payload === \"on\"){\n    flow.set(\"iterLuzDoQuartoMariaDec\", parseInt(msg.data.attributes.brightness));\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3090,"y":1100,"wires":[["410cbc0.75e67c4"]]},{"id":"4345f1b6.ec862","type":"switch","z":"ec27da7d.cad118","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":3620,"y":1140,"wires":[["e3005c36.a26"],["410cbc0.75e67c4"]]},{"id":"5be18145.f233e8","type":"switch","z":"ec27da7d.cad118","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":3440,"y":1240,"wires":[["e3005c36.a26"],["7e4a1875.c5def8"]]},{"id":"643966a.44bb498","type":"api-current-state","z":"ec27da7d.cad118","name":"Luz do Quarto Maria HK","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_maria_hk","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2890,"y":1100,"wires":[["6502b88f.289da8"]]},{"id":"7cf8acad.05839c","type":"api-call-service","z":"ec27da7d.cad118","name":"Luz do Quarto Maria HK","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_maria_hk","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":4030,"y":1180,"wires":[[]]},{"id":"6ea82b64.ad8f0c","type":"api-current-state","z":"ec27da7d.cad118","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_maria_hk","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":440,"y":700,"wires":[["687b5fdb.d7185"]]},{"id":"b76cbf74.d82fb","type":"link in","z":"ec27da7d.cad118","name":"Cozy Time Maria","links":["a1c8520.4e51ab"],"x":175,"y":1140,"wires":[["191ee8af.3886e7","1575cb07.78abd5"]]},{"id":"191ee8af.3886e7","type":"function","z":"ec27da7d.cad118","name":"Pouco brilho e colorido","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.luz_do_quarto_maria\",\n        \"brightness\": 150,\n        \"rgb_color\": [50,255,193]\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.luz_do_quarto_maria_hk\",\n        \"brightness\": 150,\n        \"rgb_color\": [50,255,193]\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":360,"y":1120,"wires":[["8f2c7843.2dc4c8"]]},{"id":"8f2c7843.2dc4c8","type":"api-call-service","z":"ec27da7d.cad118","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.luz_do_quarto_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":580,"y":1120,"wires":[[]]},{"id":"1575cb07.78abd5","type":"function","z":"ec27da7d.cad118","name":"Galáxia On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.galaxia_maria\",\n        \"brightness\": 60\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":330,"y":1180,"wires":[["951bb41e.ef7928"]]},{"id":"951bb41e.ef7928","type":"api-call-service","z":"ec27da7d.cad118","name":"Galáxia Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.galaxia_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":560,"y":1180,"wires":[[]]},{"id":"5528942f.327e2c","type":"function","z":"ec27da7d.cad118","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.galaxia_maria\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2860,"y":780,"wires":[["401ac49a.5ad02c"]]},{"id":"401ac49a.5ad02c","type":"api-call-service","z":"ec27da7d.cad118","name":"Galáxia","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.galaxia_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3020,"y":780,"wires":[[]]},{"id":"49c9da93.55a4c4","type":"yeelight-compat-hue-out","z":"ec27da7d.cad118","name":"Luz da Sala","server":"3e6ae01c.bd204","x":3860,"y":700,"wires":[]},{"id":"97879518.eb77b8","type":"function","z":"ec27da7d.cad118","name":"Turn On","func":"\n    msg.payload =\n        {\n        \"on\": true,\n        \"bri\": 255,\n        \"ct\": 6000\n        };\n    return msg;\n    ","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3640,"y":700,"wires":[["49c9da93.55a4c4"]]},{"id":"af498959.54cc1","type":"function","z":"ec27da7d.cad118","name":"Turn On 100%","func":"var i = parseInt(flow.get(\"iterLuzDoQuartoMariaInc\"));\nif (i > 255) {\n        return {reset: 1};\n}\nvar newMsg;\nnewMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.luz_do_quarto_maria_hk\",\n                \"brightness\": i,\n                \"rgb_color\": [i, i, i]\n            }\n}};    \ni += 50\nflow.set(\"iterLuzDoQuartoMariaInc\", i);\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1980,"y":1360,"wires":[["49488d40.275024"]]},{"id":"2183ba5d.f094d6","type":"trigger","z":"ec27da7d.cad118","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-250","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":1780,"y":1360,"wires":[["af498959.54cc1"]]},{"id":"55b0f004.ab5e08","type":"function","z":"ec27da7d.cad118","d":true,"name":"Aux Function","func":"flow.set(\"iterLuzDoQuartoMariaInc\", 20);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1570,"y":1360,"wires":[["2183ba5d.f094d6"]]},{"id":"445d5dcf.5a2184","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"4","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2312,"y":1360,"wires":[["b553dfff.1e6968"]]},{"id":"49488d40.275024","type":"switch","z":"ec27da7d.cad118","name":"Reset?","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":2152,"y":1400,"wires":[["445d5dcf.5a2184"],["2183ba5d.f094d6"]]},{"id":"b553dfff.1e6968","type":"api-call-service","z":"ec27da7d.cad118","name":"Luz do Quarto Maria HK","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_maria_hk","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2510,"y":1360,"wires":[[]]},{"id":"f5475c8f.c2f46","type":"function","z":"de7173c1.b1a8c","name":"Turn On","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg = {payload : {\n        \"on\": true,\n        \"bri\": 255,\n        \"ct\": 6100,\n        \"duration\": 2000\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2040,"y":540,"wires":[["243087c9.22fa68"]]},{"id":"3c4328f6.a5cd88","type":"function","z":"de7173c1.b1a8c","name":"Start","func":"return msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":350,"y":540,"wires":[["34a7c617.5228fa","a7da0d9c.8d5c5"]]},{"id":"8081d83.1012c28","type":"comment","z":"de7173c1.b1a8c","name":"Botao Cozinha foi clicado","info":"","x":210,"y":440,"wires":[]},{"id":"ddb1bdd4.17734","type":"link in","z":"de7173c1.b1a8c","name":"Botao Clique Escritorio ","links":[],"x":175,"y":540,"wires":[["3c4328f6.a5cd88"]]},{"id":"e2550c6f.f7389","type":"function","z":"de7173c1.b1a8c","name":"Add Topic","func":"var newMsg;\nif(typeof msg.ajuda !== \"undefined\"){\n    if(msg.ajuda === 1){\n        newMsg = {\"topic\":\"Luz1\", \"payload\": true};\n        flow.set(\"triggered3\", false);\n        return newMsg;\n    }\n}\nif(flow.get(\"triggered3\")===true){\n    flow.set(\"triggered3\", false);\n    if(msg.payload.state.on === true)\n    {\n        newMsg = {\"topic\":\"Luz1\", \"payload\": true};\n        return newMsg;\n    }\n    if(msg.payload.state.on === false)\n    {\n        newMsg = {\"topic\":\"Luz1\",\"payload\": false};\n        return newMsg;\n    }\n\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1040,"y":440,"wires":[["1e34fe9a.27cd61"]]},{"id":"34a7c617.5228fa","type":"change","z":"de7173c1.b1a8c","name":"","rules":[{"t":"set","p":"triggered3","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":590,"y":440,"wires":[["e9294587.f92ae8","42e0f363.1c0d6c"]]},{"id":"cf267433.da83f8","type":"function","z":"de7173c1.b1a8c","name":"Turn Off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg = {payload : {\"On\": false, \"on\": false}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2040,"y":480,"wires":[["243087c9.22fa68"]]},{"id":"3ce9898f.93a326","type":"inject","z":"de7173c1.b1a8c","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":200,"y":600,"wires":[["3c4328f6.a5cd88"]]},{"id":"42e0f363.1c0d6c","type":"delay","z":"de7173c1.b1a8c","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":760,"y":380,"wires":[["117594df.e82cab"]]},{"id":"117594df.e82cab","type":"function","z":"de7173c1.b1a8c","name":"In Case of Error","func":"msg.ajuda = 1;\nreturn msg;","outputs":1,"noerr":0,"x":920,"y":380,"wires":[["e2550c6f.f7389"]]},{"id":"642f0670.106128","type":"debug","z":"de7173c1.b1a8c","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1690,"y":460,"wires":[]},{"id":"1e34fe9a.27cd61","type":"delay","z":"de7173c1.b1a8c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1220,"y":440,"wires":[["f8be8d99.0c2e9"]]},{"id":"f8be8d99.0c2e9","type":"BooleanLogicUltimate","z":"de7173c1.b1a8c","name":"","filtertrue":"both","persist":false,"sInitializeWith":"false","triggertopic":"trigger","outputtriggeredby":"all","inputCount":"2","topic":"result","x":1480,"y":540,"wires":[[],["d266f759.28e168","642f0670.106128","cf267433.da83f8"],[]]},{"id":"d266f759.28e168","type":"InvertUltimate","z":"de7173c1.b1a8c","name":"Invert","x":1750,"y":540,"wires":[["f5475c8f.c2f46"]]},{"id":"e9294587.f92ae8","type":"yeelight-compat-hue-state","z":"de7173c1.b1a8c","name":"","server":"2db68ab1.bee496","x":840,"y":440,"wires":[["e2550c6f.f7389"]]},{"id":"243087c9.22fa68","type":"yeelight-compat-hue-out","z":"de7173c1.b1a8c","d":true,"name":"","server":"2db68ab1.bee496","x":2370,"y":500,"wires":[]},{"id":"4df02595.c0529c","type":"function","z":"de7173c1.b1a8c","name":"Add Topic","func":"var newMsg;\nif(typeof msg.ajuda !== \"undefined\"){\n    if(msg.ajuda === 1){\n        newMsg = {\"topic\":\"Luz2\", \"payload\": true};\n        flow.set(\"triggered3\", false);\n        return newMsg;\n    }\n}\nif(flow.get(\"triggered4\")===true){\n    flow.set(\"triggered4\", false);\n    if(msg.payload === \"on\")\n    {\n        newMsg = {\"topic\":\"Luz2\", \"payload\": true};\n        return newMsg;\n    }\n    if(msg.payload === \"off\")\n    {\n        newMsg = {\"topic\":\"Luz2\",\"payload\": false};\n        return newMsg;\n    }\n\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1040,"y":560,"wires":[["899ce996.07cb98"]]},{"id":"a7da0d9c.8d5c5","type":"change","z":"de7173c1.b1a8c","name":"","rules":[{"t":"set","p":"triggered4","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":590,"y":560,"wires":[["3d022baf.13eb04","bdfe7694.ab6798"]]},{"id":"3d022baf.13eb04","type":"delay","z":"de7173c1.b1a8c","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":760,"y":500,"wires":[["7e5657c9.9e22d8"]]},{"id":"7e5657c9.9e22d8","type":"function","z":"de7173c1.b1a8c","name":"In Case of Error","func":"msg.ajuda = 1;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":920,"y":500,"wires":[["4df02595.c0529c"]]},{"id":"899ce996.07cb98","type":"delay","z":"de7173c1.b1a8c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1220,"y":560,"wires":[["f8be8d99.0c2e9"]]},{"id":"bdfe7694.ab6798","type":"api-current-state","z":"de7173c1.b1a8c","name":"Luz do Escriório 2 HK","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_escritorio_2_hk","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":820,"y":560,"wires":[["4df02595.c0529c"]]},{"id":"d196ec5f.195d8","type":"function","z":"d3db5d74.fb8fa","name":"","func":"var newMsg;            \nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"group.sala\"\n        }\n}};\nnode.send(newMsg)\n\nnewMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"group.sala\"\n        }\n}};\nnode.send(newMsg)\nnewMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"group.sala\"\n        }\n}};\nnode.send(newMsg)\n\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"group.luzes_do_escritorio\"\n        }\n}};\nnode.send(newMsg)\n\nnewMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"group.luzes_do_escritorio\"\n        }\n}};\n        \nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1100,"y":500,"wires":[["20341ed1.c87122"]]},{"id":"f99c7f0b.3d30d","type":"comment","z":"de7173c1.b1a8c","name":"Trocar pra Luz da Cozinha","info":"","x":790,"y":340,"wires":[]},{"id":"82452009.70367","type":"comment","z":"de7173c1.b1a8c","name":"Trocar pra Botao da Cozinha","info":"","x":140,"y":480,"wires":[]},{"id":"33a3a6e2.a907ca","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"1100","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":620,"y":980,"wires":[["bd1063d0.32879"]]},{"id":"bd1063d0.32879","type":"function","z":"e7cd1901.ee2408","name":"Add Topic","func":"var newMsg;\nnewMsg = {\"topic\":\"trigger\", \"payload\": false};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1280,"y":980,"wires":[["b7203386.43b91"]]},{"id":"2837e772.a35338","type":"function","z":"5767c936.cabd18","name":"Add Topic","func":"var newMsg;\nnewMsg = {\"topic\":\"trigger\", \"payload\": false};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1300,"y":860,"wires":[["a4f518c2.079878"]]},{"id":"44824a8e.596a94","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"1100","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":640,"y":860,"wires":[["2837e772.a35338"]]},{"id":"ab61f5d5.6dc488","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2280,"y":820,"wires":[["532314fa.f2012c"]]},{"id":"544a034e.fdb21c","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2280,"y":720,"wires":[["586425e0.aad894"]]},{"id":"f3e49289.041b7","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2400,"y":920,"wires":[["ef0dad43.78086"]]},{"id":"f085972.585a668","type":"function","z":"5767c936.cabd18","name":"Abajures Escritorio On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"switch.abajur_esquerda\"\n        }\n    }};\n    node.send(newMsg);\n    \n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"switch.abajur_direita\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2440,"y":980,"wires":[["1d0f6961.fccf07"]]},{"id":"1d0f6961.fccf07","type":"api-call-service","z":"5767c936.cabd18","name":"Abajures","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.abajur_direita","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2660,"y":980,"wires":[[]]},{"id":"3cdaf074.5db4f","type":"function","z":"bbb64533.9844f8","name":"Turn On","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg = {payload : {\n        \"on\": true,\n        \"bri\": 255,\n        \"ct\": 6100,\n        \"duration\": 2000\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2120,"y":300,"wires":[["9c84d5ae.e9dd38"]]},{"id":"59d8aaa7.eb0534","type":"function","z":"bbb64533.9844f8","name":"Start","func":"return msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":430,"y":300,"wires":[["2df8c031.3a154","df56f1ae.4a62e"]]},{"id":"1fff84f6.dbd9db","type":"comment","z":"bbb64533.9844f8","name":"Botao Cantinho foi clicado","info":"","x":290,"y":200,"wires":[]},{"id":"53dcae2c.a36a2","type":"link in","z":"bbb64533.9844f8","name":"Botao Clique Cantinho","links":[],"x":255,"y":300,"wires":[["59d8aaa7.eb0534"]]},{"id":"e14e7ae5.c0e458","type":"function","z":"bbb64533.9844f8","name":"Add Topic","func":"var newMsg;\nif(typeof msg.ajuda !== \"undefined\"){\n    if(msg.ajuda === 1){\n        newMsg = {\"topic\":\"Luz1\", \"payload\": true};\n        flow.set(\"triggered3\", false);\n        return newMsg;\n    }\n}\nif(flow.get(\"triggered3\")===true){\n    flow.set(\"triggered3\", false);\n    if(msg.payload.state.on === true)\n    {\n        newMsg = {\"topic\":\"Luz1\", \"payload\": true};\n        return newMsg;\n    }\n    if(msg.payload.state.on === false)\n    {\n        newMsg = {\"topic\":\"Luz1\",\"payload\": false};\n        return newMsg;\n    }\n\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1120,"y":200,"wires":[["d025ff47.cd7d6"]]},{"id":"2df8c031.3a154","type":"change","z":"bbb64533.9844f8","name":"","rules":[{"t":"set","p":"triggered3","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":670,"y":200,"wires":[["7dcf7bd3.421ca4","7383cdd.6e1a634"]]},{"id":"26e7b9e.aedfb46","type":"function","z":"bbb64533.9844f8","name":"Turn Off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg = {payload : {\"On\": false, \"on\": false}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2120,"y":240,"wires":[["9c84d5ae.e9dd38"]]},{"id":"6b6cda8a.8980f4","type":"inject","z":"bbb64533.9844f8","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":280,"y":360,"wires":[["59d8aaa7.eb0534"]]},{"id":"7383cdd.6e1a634","type":"delay","z":"bbb64533.9844f8","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":840,"y":140,"wires":[["845117d0.873e38"]]},{"id":"845117d0.873e38","type":"function","z":"bbb64533.9844f8","name":"In Case of Error","func":"msg.ajuda = 1;\nreturn msg;","outputs":1,"noerr":0,"x":1000,"y":140,"wires":[["e14e7ae5.c0e458"]]},{"id":"f7ba00e9.af1ae","type":"debug","z":"bbb64533.9844f8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1770,"y":220,"wires":[]},{"id":"d025ff47.cd7d6","type":"delay","z":"bbb64533.9844f8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1300,"y":200,"wires":[["a2987d0a.6c8a3"]]},{"id":"a2987d0a.6c8a3","type":"BooleanLogicUltimate","z":"bbb64533.9844f8","name":"","filtertrue":"both","persist":false,"sInitializeWith":"false","triggertopic":"trigger","outputtriggeredby":"all","inputCount":"2","topic":"result","x":1560,"y":300,"wires":[[],["3608ba8a.33faa6","f7ba00e9.af1ae","26e7b9e.aedfb46"],[]]},{"id":"3608ba8a.33faa6","type":"InvertUltimate","z":"bbb64533.9844f8","name":"Invert","x":1830,"y":300,"wires":[["3cdaf074.5db4f"]]},{"id":"7dcf7bd3.421ca4","type":"yeelight-compat-hue-state","z":"bbb64533.9844f8","name":"","server":"2db68ab1.bee496","x":920,"y":200,"wires":[["e14e7ae5.c0e458"]]},{"id":"9c84d5ae.e9dd38","type":"yeelight-compat-hue-out","z":"bbb64533.9844f8","d":true,"name":"","server":"2db68ab1.bee496","x":2450,"y":260,"wires":[]},{"id":"94c6fceb.857d2","type":"function","z":"bbb64533.9844f8","name":"Add Topic","func":"var newMsg;\nif(typeof msg.ajuda !== \"undefined\"){\n    if(msg.ajuda === 1){\n        newMsg = {\"topic\":\"Luz2\", \"payload\": true};\n        flow.set(\"triggered3\", false);\n        return newMsg;\n    }\n}\nif(flow.get(\"triggered4\")===true){\n    flow.set(\"triggered4\", false);\n    if(msg.payload === \"on\")\n    {\n        newMsg = {\"topic\":\"Luz2\", \"payload\": true};\n        return newMsg;\n    }\n    if(msg.payload === \"off\")\n    {\n        newMsg = {\"topic\":\"Luz2\",\"payload\": false};\n        return newMsg;\n    }\n\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1120,"y":320,"wires":[["3389ddcc.848222"]]},{"id":"df56f1ae.4a62e","type":"change","z":"bbb64533.9844f8","name":"","rules":[{"t":"set","p":"triggered4","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":670,"y":320,"wires":[["2f77a6ca.9fa53a","f203ca71.5ec618"]]},{"id":"2f77a6ca.9fa53a","type":"delay","z":"bbb64533.9844f8","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":840,"y":260,"wires":[["f9221612.0d50b8"]]},{"id":"f9221612.0d50b8","type":"function","z":"bbb64533.9844f8","name":"In Case of Error","func":"msg.ajuda = 1;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1000,"y":260,"wires":[["94c6fceb.857d2"]]},{"id":"3389ddcc.848222","type":"delay","z":"bbb64533.9844f8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1300,"y":320,"wires":[["a2987d0a.6c8a3"]]},{"id":"f203ca71.5ec618","type":"api-current-state","z":"bbb64533.9844f8","name":"Luz do Escriório 2 HK","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_escritorio_2_hk","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":900,"y":320,"wires":[["94c6fceb.857d2"]]},{"id":"d7c3bc2c.bbd31","type":"comment","z":"bbb64533.9844f8","name":"Trocar pra Luz do Cantinho e da sacada","info":"","x":910,"y":100,"wires":[]},{"id":"6c3ade94.89395","type":"comment","z":"bbb64533.9844f8","name":"Trocar pra Botao do Cantinho","info":"","x":220,"y":240,"wires":[]},{"id":"a4964caa.4813c","type":"comment","z":"de7173c1.b1a8c","name":"Movimento na Cozinha","info":"","x":320,"y":100,"wires":[]},{"id":"10a2146d.66b9dc","type":"comment","z":"bbb64533.9844f8","name":"Trocar pra Luz do Cantinho e da sacada","info":"","x":2490,"y":200,"wires":[]},{"id":"ec4843ef.17c9d","type":"comment","z":"de7173c1.b1a8c","name":"Trocar pra Luz da Cozinha","info":"","x":2370,"y":440,"wires":[]},{"id":"b3061b2a.42a488","type":"link in","z":"4c9c764d.9c4468","name":"Movimento Sala ou Escritório a noite","links":["1f03bb0a.233655","3e5f80d2.529f1"],"x":255,"y":2160,"wires":[["5f1a4b06.f08244"]]},{"id":"5f1a4b06.f08244","type":"function","z":"4c9c764d.9c4468","name":"Moveu?","func":"if(msg.payload.MotionDetected === true){\n    var date = new Date();\n    var Hour = date.getHours();\n    if(Hour > 20 || Hour < 9){    \n        if(\n            global.get(\"tvAuxFilme\") === false &&\n            global.get(\"tvAuxPlay\") === false &&\n            global.get(\"horaDoFilme\") === false &&\n            global.get(\"EscritorioOn\") === false &&\n            global.get(\"SalaOn\") === false &&\n            global.get(\"desabilitaAutomacao\") === false\n            ){\n                return msg;\n            }\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":360,"y":2160,"wires":[["ef50d8fa.73e338"]]},{"id":"ef50d8fa.73e338","type":"api-current-state","z":"4c9c764d.9c4468","name":"TV On?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"media_player.tv_da_sala","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":540,"y":2160,"wires":[["9a3a136b.85b3c"]]},{"id":"9a3a136b.85b3c","type":"function","z":"4c9c764d.9c4468","name":"Home?","func":"if(msg.payload === false){\n    var newMsg;\n    newMsg = {delay: 600000};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":720,"y":2160,"wires":[["83e5e3e6.aeb5c","5ab4abef.478e84"]]},{"id":"83e5e3e6.aeb5c","type":"function","z":"4c9c764d.9c4468","name":"Turn On","func":"var newMsg;\n\nnewMsg = {payload : {\n        \"on\": true,\n        \"bri\": 1,\n        \"ct\": 3000\n}};\nnode.send(newMsg);\nnewMsg = {payload : {\n        \"on\": true,\n        \"bri\": 50,\n        \"ct\": 3000,\n        \"duration\": 2500\n}};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1080,"y":2160,"wires":[["27cc9661.88529a"]]},{"id":"1d0c8fcb.db4ed","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"14b837c9.ab10c","x":1670,"y":2140,"wires":[]},{"id":"1ccc0505.2d80ab","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":1670,"y":2080,"wires":[]},{"id":"88204b14.396228","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"56814891.18c868","x":1659,"y":2269,"wires":[]},{"id":"c484baa1.0cf908","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"5a8bf4db.2d6bcc","x":1649,"y":2209,"wires":[]},{"id":"5ab4abef.478e84","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delayv","timeout":"10","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":920,"y":2440,"wires":[["d05a503e.dacae"]]},{"id":"f70dc065.70dbf","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"14b837c9.ab10c","x":1670,"y":2400,"wires":[]},{"id":"bd6511fe.20fea","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":1670,"y":2340,"wires":[]},{"id":"e5b3f35f.d05bc","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"56814891.18c868","x":1659,"y":2529,"wires":[]},{"id":"1859ba82.068f25","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"5a8bf4db.2d6bcc","x":1649,"y":2469,"wires":[]},{"id":"a12278b9.ef7ca8","type":"function","z":"4c9c764d.9c4468","name":"Turn Off","func":"var newMsg;\nnewMsg = {payload : {\n        \"on\": false,\n        \"duration\": 2500\n}};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1280,"y":2440,"wires":[["bd6511fe.20fea","f70dc065.70dbf","1859ba82.068f25","e5b3f35f.d05bc"]]},{"id":"50e19147.2ed4b","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"false","payloadType":"bool","x":570,"y":2080,"wires":[["9a3a136b.85b3c"]]},{"id":"4db4adf0.330be4","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"false","payloadType":"bool","x":1150,"y":2500,"wires":[["a12278b9.ef7ca8"]]},{"id":"27cc9661.88529a","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1290,"y":2160,"wires":[["1ccc0505.2d80ab","1d0c8fcb.db4ed","c484baa1.0cf908","88204b14.396228"]]},{"id":"d05a503e.dacae","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"10","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1100,"y":2440,"wires":[["a12278b9.ef7ca8"]]},{"id":"f003a8c9.62dd48","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"},{"p":"reset","v":"true","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"reset","payload":"reset","payloadType":"str","x":760,"y":2500,"wires":[["5ab4abef.478e84"]]},{"id":"ba408d3f.0a3fb","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Tracks","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":570,"y":1600,"wires":[["1ed87c56.afdc94","f68bc936.fdc1b8"]]},{"id":"90d9575b.125a78","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":2690,"y":1600,"wires":[["cbba6bc.ec68798"]]},{"id":"4097645d.cc5b0c","type":"spotify","z":"7b0de646.c85c78","name":"Getting Old Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1270,"y":1600,"wires":[["c828912d.07237","228157.ab2bfeaa"]]},{"id":"1ed87c56.afdc94","type":"function","z":"7b0de646.c85c78","name":"2020-2022","func":"flow.set(\"20211Tracks\", msg.payload.items)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '4MMFbdbRfywp2lSB5umAqC',\n        {offset: 0}\n    ]\n}\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":770,"y":1600,"wires":[["b56d5797.8c88c8"]]},{"id":"c828912d.07237","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"20211OldAux\");\nvar oldArrayAux = flow.get(\"20211OldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"20211ArrayAux\", newOldArrayAux);\nflow.set(\"20211OldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1480,"y":1600,"wires":[["461b7cd6.524704"]]},{"id":"f24da449.87f748","type":"inject","z":"7b0de646.c85c78","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"30 10 * * 1,3,5","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":1600,"wires":[["2680271.17ec2d8"]]},{"id":"2680271.17ec2d8","type":"function","z":"7b0de646.c85c78","name":"2021/1","func":"var newMsg;\nflow.set(\"20211OldAux\", 0);\nflow.set(\"20211OldArrayAux\", []);\nflow.set(\"2020-2022Offset\",100);\nnewMsg = {\n    \"params\":[\n        '3szB690Xq6L24GyDRfkk7W'\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":330,"y":1600,"wires":[["ba408d3f.0a3fb"]]},{"id":"90c31cc2.3cc2b","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1880,"y":1600,"wires":[["cfb76cba.68bf8"],["e3603778.4570d8","38d6ef3c.23158"]]},{"id":"cfb76cba.68bf8","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"discoverWeeklyOffset = flow.get(\"2020-2022Offset\");\nflow.set(\"2020-2022Offset\",discoverWeeklyOffset+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '4MMFbdbRfywp2lSB5umAqC',\n        {offset: discoverWeeklyOffset}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1800,"y":1520,"wires":[["4097645d.cc5b0c"]]},{"id":"e3603778.4570d8","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"20211Tracks\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nvar i;\n        for(i=0; i<newTracks.length; i++) {\n            alreadyIn = false;\n            for(var j=0; j<oldTracks.length; j++) {\n                if(newTracks[i].track.id === oldTracks[j].track.id){\n                    alreadyIn = true\n                }\n            }\n            if(alreadyIn === false){\n                auxString = \"['\" + newTracks[i].track.uri + \"']\"\n                newMsg = {\n                    \"params\":[\n                        \"4MMFbdbRfywp2lSB5umAqC\",\n                        [newTracks[i].track.uri]\n                    ]}\n                node.send(newMsg);\n        \n            }\n        }","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2210,"y":1600,"wires":[["d89c8eaa.76455","a7ccd514.0f3e98"]]},{"id":"461b7cd6.524704","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":1600,"wires":[["90c31cc2.3cc2b"]]},{"id":"38d6ef3c.23158","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2200,"y":1680,"wires":[]},{"id":"b56d5797.8c88c8","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1040,"y":1600,"wires":[["4097645d.cc5b0c"]]},{"id":"d89c8eaa.76455","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2450,"y":1600,"wires":[["90d9575b.125a78"]]},{"id":"f68bc936.fdc1b8","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":760,"y":1660,"wires":[]},{"id":"a7ccd514.0f3e98","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2490,"y":1680,"wires":[]},{"id":"cbba6bc.ec68798","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2890,"y":1680,"wires":[]},{"id":"228157.ab2bfeaa","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1450,"y":1660,"wires":[]},{"id":"bf780311.d9c6b","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Tracks","auth":"3b9d50b6.bca4e","api":"getUserPlaylists","x":410,"y":1880,"wires":[["8a9a6caa.7e3b7"]]},{"id":"b0ed9b4e.cc7078","type":"inject","z":"7b0de646.c85c78","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":230,"y":1880,"wires":[["bf780311.d9c6b"]]},{"id":"8a9a6caa.7e3b7","type":"debug","z":"7b0de646.c85c78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":600,"y":1880,"wires":[]},{"id":"757019f9.355f18","type":"inject","z":"ec27da7d.cad118","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":160,"y":1240,"wires":[["1575cb07.78abd5","191ee8af.3886e7"]]},{"id":"a5cdafa0.24208","type":"function","z":"d3db5d74.fb8fa","name":"Janela Fechada","func":"if(msg.topic === \"binary_sensor.janela_sala\"){\n    if(msg.payload === false){\n        global.set(\"janelaSala\",false);\n        msg.reset = true;\n        msg.payload = \"reset\"; \n        return msg;\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":2200,"wires":[["86c97a42.dedca8"]]},{"id":"f5060f92.9d594","type":"function","z":"d3db5d74.fb8fa","name":"Janela Aberta","func":"if(msg.topic === \"binary_sensor.janela_sala\"){\n    if(msg.payload === true){\n        global.set(\"janelaSala\",true);\n        return msg;\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":2140,"wires":[["86c97a42.dedca8"]]},{"id":"619b8463.3e7cdc","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Janela Sala Esquerda","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.janela_sala_esquerda","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":320,"y":2180,"wires":[["f5060f92.9d594"],["a5cdafa0.24208"]]},{"id":"b9dc8e30.7f553","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":740,"y":1800,"wires":[["3a03e9ad.c6b0d6"]]},{"id":"3a03e9ad.c6b0d6","type":"function","z":"d3db5d74.fb8fa","name":"Turn Off","func":"var newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_off\",\n                data:{\n                    \"entity_id\": \"switch.ar_condicionado_quarto\"\n                }\n        }};\nnode.send(newMsg);\nnewMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_off\",\n                data:{\n                    \"entity_id\": \"switch.ventilador\"\n                }\n        }};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":880,"y":1800,"wires":[["6ae80fb3.6c708"]]},{"id":"6ae80fb3.6c708","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Ar Condicionado do Quarto","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.ar_condicionado_quarto","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1080,"y":1800,"wires":[[]]},{"id":"86c97a42.dedca8","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":740,"y":2100,"wires":[["7e80e7ff.24abc8"]]},{"id":"7e80e7ff.24abc8","type":"function","z":"d3db5d74.fb8fa","name":"Turn Off","func":"var newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_off\",\n                data:{\n                    \"entity_id\": \"switch.ar_condicionado_quarto\"\n                }\n        }};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":880,"y":2100,"wires":[["1188d9d4.70e7c6"]]},{"id":"1188d9d4.70e7c6","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Ar Condicionado do Quarto","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.ar_condicionado_quarto","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1080,"y":2100,"wires":[[]]}]
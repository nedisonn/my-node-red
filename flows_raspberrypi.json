[{"id":"2ea7fd8b.7e0bb2","type":"tab","label":"Occupancy","disabled":false,"info":""},{"id":"444fced8.33ecb","type":"tab","label":"Alexa","disabled":false,"info":""},{"id":"e7cd1901.ee2408","type":"tab","label":"Sala","disabled":false,"info":""},{"id":"5767c936.cabd18","type":"tab","label":"Escritorio","disabled":false,"info":""},{"id":"4c9c764d.9c4468","type":"tab","label":"Geral","disabled":false,"info":""},{"id":"859b066a.dd8128","type":"tab","label":"Quarto Nédi","disabled":false,"info":""},{"id":"ec27da7d.cad118","type":"tab","label":"Quarto Maria","disabled":false,"info":""},{"id":"de7173c1.b1a8c","type":"tab","label":"Cozinha","disabled":false,"info":""},{"id":"bbb64533.9844f8","type":"tab","label":"Cantinho & Sacada","disabled":false,"info":""},{"id":"d3db5d74.fb8fa","type":"tab","label":"Aqara Sensores","disabled":false,"info":""},{"id":"d67ca66.293d758","type":"tab","label":"Home Assistant","disabled":false,"info":""},{"id":"7b0de646.c85c78","type":"tab","label":"Spotify Helpers","disabled":false,"info":""},{"id":"c3fa9bdb.b5c4c8","type":"tab","label":"Tarefas","disabled":false,"info":""},{"id":"554bb518.994efc","type":"tab","label":"Funcoes Auxiliares","disabled":false,"info":""},{"id":"2bbba447.a4759c","type":"tab","label":"Banheiro","disabled":false,"info":""},{"id":"64936db9.640564","type":"mqtt-broker","name":"MQTT","broker":"localhost","port":"1883","clientid":"Node-Red","usetls":false,"compatmode":false,"protocolVersion":"4","keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthRetain":"false","birthPayload":"","birthMsg":{},"closeTopic":"","closeQos":"0","closeRetain":"false","closePayload":"","closeMsg":{},"willTopic":"","willQos":"0","willRetain":"false","willPayload":"","willMsg":{},"sessionExpiry":""},{"id":"d14d7300.ae20c","type":"server","name":"Home Assistant","legacy":false,"addon":false,"rejectUnauthorizedCerts":false,"ha_boolean":"y|yes|true|on|home|open","connectionDelay":true,"cacheJson":true},{"id":"421d4b0d.32a884","type":"alexa-remote-account","name":"Alexa","authMethod":"proxy","proxyOwnIp":"raspberrypi.local","proxyPort":"3456","cookieFile":"/home/homeassistant/homeassistant/alexaauxiliar","refreshInterval":"3","alexaServiceHost":"pitangui.amazon.com","amazonPage":"amazon.com","acceptLanguage":"en-US","userAgent":"","useWsMqtt":"on","autoInit":"on"},{"id":"8f012b2f.669ef8","type":"darksky-credentials","key_identifier":"DarkSky"},{"id":"5a8bf4db.2d6bcc","type":"yeelight-compat-hue-config","hostname":"YeelightColorBulb-098F.local","port":"55443","name":"Luz da Sala"},{"id":"2db68ab1.bee496","type":"yeelight-compat-hue-config","hostname":"YeelightColorBulb-023F.local","port":"55443","name":"Luz do Escritório 1"},{"id":"efa96182.3c09a","type":"pushbullet-config","name":"Pushbullet"},{"id":"56814891.18c868","type":"yeelight-compat-hue-config","hostname":"YeelightColorBulb-235A.local","port":"55443","name":"Luz da Entrada"},{"id":"3b9d50b6.bca4e","type":"spotify-auth","name":"Spotify","scope":"ugc-image-upload\nuser-read-recently-played\nuser-top-read\nuser-read-playback-position\nuser-read-playback-state\nuser-modify-playback-state\nuser-read-currently-playing\napp-remote-control\nstreaming\nplaylist-modify-public\nplaylist-modify-private\nplaylist-read-private\nplaylist-read-collaborative\nuser-follow-modify\nuser-follow-read\nuser-library-modify\nuser-library-read\nuser-read-email\nuser-read-private"},{"id":"14b837c9.ab10c","type":"yeelight-compat-hue-config","hostname":"192.168.0.7","port":"55443","name":"Luz do Escritório 2"},{"id":"3e6ae01c.bd204","type":"yeelight-compat-hue-config","hostname":"192.168.0.12","port":"55443","name":"Luz do Quarto Maria"},{"id":"9db1d7d0.459aa8","type":"yeelight-compat-hue-config","hostname":"YeelightColorBulb-8190.local","port":"55443","name":"Luz da Cozinha"},{"id":"bd7d7dee.f60af","type":"yeelight-compat-hue-config","hostname":"YeelightTunableBulb-6E29.local","port":"55443","name":"Luz da Sacada Sala"},{"id":"2812cb35.9c26a4","type":"yeelight-compat-hue-config","hostname":"YeelightTunableBulb-48A8.local","port":"55443","name":"Luz do Cantinho"},{"id":"e588ecf4.3d63d","type":"function","z":"2ea7fd8b.7e0bb2","name":"True?","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":570,"y":320,"wires":[["2f7e965e.742a2a"]]},{"id":"19554fb4.898e3","type":"function","z":"4c9c764d.9c4468","name":"Hora do Filme?","func":"var ocupado = global.get(\"horaDoFilme\");\nglobal.set(\"SalaOnFirstTime\", true);\nglobal.set(\"SalaOn\",false);\nglobal.set(\"EscritorioOnFirstTime\", true);\nif(     msg.payload === \"playing\" \n    ){\n    if(ocupado === false){\n        global.set(\"horaDoFilme\", true);\n        var date = new Date();\n        var Day = date.getDay(); \n        var Hour = date.getHours();\n        if(Day === 0 || Day === 6 || (Day < 6 && Day > 0)&& Hour >18) {\n                var newMsg;\n                newMsg = {payload: {\"On\":true}};\n                \n                node.status({fill:\"green\",shape:\"dot\",text:\"Movie Night On\"});\n                node.send(newMsg);\n                setTimeout(function(){\n                node.status({text:\"\"});\n                }, 15000);\n            }\n        }\n}\nif(\n    msg.payload.horaDoFilme === true\n    ){\n    return {payload: {\"On\":true}};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":740,"y":1240,"wires":[["863a7cae.0b5e3","169e61b.b1afd9e","56cf118.6c95df","a15f542b.7479e8","c4d0a5ba.4a5f78"]]},{"id":"bd53e302.56acc","type":"function","z":"4c9c764d.9c4468","name":"Escuro?","func":"if(msg.payload < 35 && msg.payload > 0){\n                global.set(\"salaEscura\", true);\n                node.status({fill:\"green\",shape:\"dot\",text:\"SalaEscura true\"});\n                flow.set(\"triggered\", true);\n                node.send(msg);\n}\nelse if(msg.payload > 200){\n                global.set(\"salaEscura\", false);\n                node.status({fill:\"yellow\",shape:\"dot\",text:\"SalaEscura false\"});\n}\nif(msg.payload < 100 && msg.payload > 0){\n                global.set(\"escritorioEscuro\", true);\n                node.status({fill:\"green\",shape:\"dot\",text:\"EscritorioEscuro true\"});\n                flow.set(\"triggered\", true);\n                node.send(msg);\n}\nelse if(msg.payload > 200){\n                global.set(\"escritorioEscuro\", false);\n                node.status({fill:\"yellow\",shape:\"dot\",text:\"EscritorioEscuro false\"});\n}\n\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":920,"y":480,"wires":[["55f5a77a.253908"]]},{"id":"a2a4940d.a23088","type":"function","z":"4c9c764d.9c4468","name":"Sala On","func":"if(msg.payload === true){\n    var date = new Date();\n    var Hour = date.getHours(); //hours in 0-23\n    var minutes = \"0\" + date.getMinutes();\n    minutes = parseInt(minutes.substr(-2), 10);\n    var seconds = \"0\" + date.getSeconds();\n    seconds = parseInt(seconds.substr(-2), 10);\n    global.set(\"lastChangeSec\", seconds);\n    global.set(\"lastChangeMinute\", minutes);\n    var salaEscura = global.get(\"salaEscura\");\n    if(Hour > 15 && Hour < 23 && salaEscura === true){\n        if(\n            global.get(\"desabilitaAutomacao\") === false && \n            global.get(\"tvAuxFilme\") === false && \n            global.get(\"tvAuxPlay\") === false  \n        ){\n            if(global.get(\"SalaOn\") === false){\n                global.set(\"SalaOn\",true);\n                msg = {\"payload\": {\"On\":true}};\n                node.status({fill:\"green\",shape:\"dot\",text:\"Sala On\"});\n                node.send(msg);\n            }\n        }\n    }\n    setTimeout(function(){\n        node.status({text:\"\"});\n    }, 15000);\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1720,"y":400,"wires":[["2d1b0bfd.410a84"]]},{"id":"dbdc7788.7a4228","type":"mqtt in","z":"4c9c764d.9c4468","name":"Sensor Luz Sala","topic":"Sala/currentLight","qos":"0","datatype":"json","broker":"64936db9.640564","x":220,"y":460,"wires":[["6f27f94e.d021f8"]]},{"id":"40d8ecc9.126694","type":"function","z":"4c9c764d.9c4468","name":"Sunset?","func":"\nif(msg.payload === \"sunsetStart\" || \nmsg.payload === \"sunset\"|| \nmsg.payload === \"goldenHour\"|| \nmsg.payload ===\"dusk\"){\n    node.status({fill:\"green\",shape:\"dot\",text:\"Sunset started\"});\n    flow.set(\"triggered\", true);\n    node.send(msg);\n    global.set(\"escritorioEscuro\", true);\n    global.set(\"salaEscura\", true);\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":920,"y":540,"wires":[["55f5a77a.253908"]]},{"id":"e53fd18b.10dd3","type":"function","z":"4c9c764d.9c4468","name":"Escritório On","func":"var contEscritorio = global.get(\"contEscritorio\");\nvar overrideEscritorio = global.get(\"overrideEscritorio\");\nvar escritorioEscuro = global.get(\"escritorioEscuro\");\nif(msg.payload === true){\n    if((contEscritorio < 2700 || overrideEscritorio === true) && escritorioEscuro === true){\n        var date = new Date();\n        var Day = date.getDay(); \n        var Hour = date.getHours();\n        if(Hour > 8 && global.get(\"auxTurnOnEscritorio\") === true){\n            if(global.get(\"EscritorioOn\") === false){\n                if(global.get(\"desabilitaAutomacao\") === false){\n                        global.set(\"EscritorioOn\",true);\n                        node.status({fill:\"green\",shape:\"dot\",text:\"Escritorio On\"});\n                        msg.payload = {\"On\":true};\n                        node.send(msg);\n                }\n                \n            }\n            setTimeout(function(){\n                node.status({text:\"\"});\n            }, 15000);\n        }\n        if(Hour > 16){\n                if(global.get(\"EscritorioOn\") === false){\n                    if(global.get(\"desabilitaAutomacao\") === false){\n                        global.set(\"EscritorioOn\",true);\n                        node.status({fill:\"green\",shape:\"dot\",text:\"Escritorio On\"});\n                        msg.payload = {\"On\":true};\n                        node.send(msg);\n                    }\n                \n            }\n            setTimeout(function(){\n                node.status({text:\"\"});\n            }, 15000);\n        }\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1410,"y":460,"wires":[["c2b484f3.fef7d8"]]},{"id":"69bf8dca.b2b8a4","type":"switch","z":"554bb518.994efc","d":true,"name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"week day","vt":"str"},{"t":"eq","v":"weekend","vt":"str"},{"t":"eq","v":"any day","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":310,"y":120,"wires":[[],[],[]]},{"id":"a482cdd7.048bd","type":"function","z":"554bb518.994efc","d":true,"name":"","func":"var date = new Date();\nvar Day = date.getDay(); // sunday is 0 saturday is 6\nvar Hour = date.getHours(); //hours in 0-23\nif((Day < 6 && Day > 0)){\n    return \"week day\";\n}\nif(Day === 0 || Day === 6){\n    return \"weekend\";\n}\nelse\n    return \"any day\";","outputs":1,"noerr":0,"x":170,"y":120,"wires":[["69bf8dca.b2b8a4"]]},{"id":"80fbee9c.0c947","type":"comment","z":"554bb518.994efc","name":"Dia da semana","info":"","x":120,"y":80,"wires":[]},{"id":"f03bc12c.2a5a6","type":"inject","z":"554bb518.994efc","d":true,"name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":170,"y":340,"wires":[["e6cd5785.820048"]]},{"id":"9e538973.59fd68","type":"comment","z":"554bb518.994efc","name":"Alexa diz Oi","info":"","x":110,"y":300,"wires":[]},{"id":"2d1b0bfd.410a84","type":"link out","z":"4c9c764d.9c4468","name":"Sala On","links":["f438fd80.ae3b"],"x":1815,"y":480,"wires":[]},{"id":"c2b484f3.fef7d8","type":"link out","z":"4c9c764d.9c4468","name":"Escritorio On","links":["a47983c5.55204","b41dbb9c.dc0e58"],"x":1575,"y":480,"wires":[]},{"id":"863a7cae.0b5e3","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"hours","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1020,"y":1160,"wires":[["470a254d.4cc45c"]]},{"id":"470a254d.4cc45c","type":"function","z":"4c9c764d.9c4468","name":"horaDoFilme False","func":"global.set(\"horaDoFilme\", false);\nglobal.set(\"desabilitaAutomacao\", false);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1190,"y":1160,"wires":[[]]},{"id":"b4038cea.b3677","type":"function","z":"2bbba447.a4759c","name":"","func":"var ocupado = global.get(\"BanheiroOcupado\");\nvar portaAberta = global.get(\"portaAbertaBanheiro\");\nvar newMsg;\nnewMsg = {\"delay\": 2700000};\nglobal.set(\"isOnBanheiro\", true);\nglobal.set(\"BanheiroOcupado\", true);\nnode.send(newMsg);\nnode.status({fill:\"green\",shape:\"dot\",text:\"Ocupado: \"+ ocupado});\nsetTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1800,"y":280,"wires":[["ba04b092.60bc8","8e6d6d01.463f3","d0ddc950.fa7118"]]},{"id":"ba04b092.60bc8","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"delayv","timeout":"45","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2180,"y":300,"wires":[["a2c55b1b.216528","3665f12e.70f2ee"]]},{"id":"8e6d6d01.463f3","type":"function","z":"2bbba447.a4759c","name":"Turn On","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\n\n//if(Hour > 16 || Hour < 8 || \n//    global.get(\"botaoBanheiro\")=== true){\n//    if(msg.payload.On === true){\n            var newMsg;\n            newMsg = {payload: {\"on\":true}};\n            return newMsg;\n//    }\n//}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2200,"y":360,"wires":[["8073258b.621728"]]},{"id":"f438fd80.ae3b","type":"link in","z":"e7cd1901.ee2408","name":"Sala On","links":["2d1b0bfd.410a84"],"x":235,"y":260,"wires":[["44a26901.b5a568","3ce0001a.577de"]]},{"id":"b41dbb9c.dc0e58","type":"link in","z":"5767c936.cabd18","name":"Escritorio On","links":["c2b484f3.fef7d8"],"x":135,"y":460,"wires":[["82188a35.1349f8","8a61a341.0fa5d"]]},{"id":"9b49a101.0f52c","type":"change","z":"e7cd1901.ee2408","name":"Turn On","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"On\": true} ","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":460,"wires":[["a82fb664.7fec48"]]},{"id":"723cac3c.588f44","type":"change","z":"5767c936.cabd18","name":"Turn On","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"On\": true} ","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":460,"wires":[["9692d760.196b88"]]},{"id":"ab2e6085.0b03d","type":"inject","z":"4c9c764d.9c4468","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":" {\"On\":true}","payloadType":"json","x":1420,"y":560,"wires":[["2d1b0bfd.410a84","c2b484f3.fef7d8"]]},{"id":"82188a35.1349f8","type":"function","z":"5767c936.cabd18","name":"Set Flow Variables","func":"\n\nif(global.get(\"EscritorioOnFirstTime\") === true){\n    global.set(\"EscritorioOnFirstTime\", false);    \n    \n    var date = new Date();\n    var hours = date.getHours(); //hourss in 0-23\n    var minutes = \"0\" + date.getMinutes();\n    minutes = parseInt(minutes.substr(-2), 10);\n    var seconds = \"0\" + date.getSeconds();\n    seconds = parseInt(seconds.substr(-2), 10);\n\n    flow.set(\"lastChangeSec\", seconds);\n    flow.set(\"lastChangeMinute\", minutes);\n    flow.set(\"lastChangeHour\", hours);\n    \n    flow.set(\"countBrightnessLuz\", 1);\n    flow.set(\"increasing\", true);\n    flow.set(\"auxCT\", 6100);\n    return {\"ajuda\": 1};\n}\nif(global.get(\"EscritorioOnFirstTime\") === false){\n    return {\"ajuda\": 2};\n}\nelse{\n    return {\"ajuda\": 3};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":310,"y":240,"wires":[["37b6f853.dc8188"]]},{"id":"ba6a4e16.62ac7","type":"trigger","z":"5767c936.cabd18","name":"","op1":"true","op2":"0","op1type":"json","op2type":"str","duration":"-10","extend":false,"overrideDelay":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":1010,"y":320,"wires":[["4c385597.4d019c"]]},{"id":"7eb5668e.10c808","type":"function","z":"5767c936.cabd18","name":"Turn On","func":"var date = new Date();\nvar hours = date.getHours(); //hourss in 0-23\nvar minutes = \"0\" + date.getMinutes();\nminutes = parseInt(minutes.substr(-2), 10);\nvar seconds = \"0\" + date.getSeconds();\nseconds = parseInt(seconds.substr(-2), 10);\nvar secondsLast = flow.get(\"lastChangeSec\");\nvar minutesLast = flow.get(\"lastChangeMinute\");\nvar hoursLast = flow.get(\"lastChangeHour\");\nvar increasing = flow.get(\"increasing\");\nvar auxBrightness = flow.get(\"countBrightnessLuz\");\nvar auxCT = flow.get(\"auxCT\");\nif(hours >= 20){\n        increasing = false;\n        flow.set(\"increasing\", false)\n}\nif(msg.ajuda === 1){\n      msg.payload =\n        {\n        \"on\": true,\n        \"bri\": auxBrightness,\n        \"ct\": auxCT\n        };\n        flow.set(\"lastChangeSec\", seconds);\n        flow.set(\"lastChangeMinute\", minutes);\n        flow.set(\"lastChangeHour\", hours);\n        return msg;\n}\nif(hours > hoursLast || seconds > secondsLast+20 || minutes > minutesLast){\n\n    if(auxBrightness < msg.payload.state.bri-20 || auxBrightness > msg.payload.state.bri+20){\n        auxBrightness = msg.payload.state.bri;\n        flow.set(\"countBrightnessLuz\", auxBrightness);\n        \n    }    \n    if(auxCT < msg.payload.state.ct-100 || auxCT > msg.payload.state.ct+100){\n        auxCT = msg.payload.state.ct;\n        flow.set(\"auxCT\", auxCT);\n        \n    }\n    if(auxBrightness < 256 && increasing === true){\n        auxBrightness = auxBrightness + 1;\n        flow.set(\"countBrightnessLuz\",auxBrightness);\n    }\n    \n    if(auxCT < 6100 && increasing === true){\n        auxCT = auxCT +5;\n        flow.set(\"auxCT\", auxCT);\n    }\n    if(auxBrightness >192 && increasing === false){\n        auxBrightness = auxBrightness - 1;\n        flow.set(\"countBrightnessLuz\",auxBrightness);\n    }\n    if(auxCT > 3500 && increasing === false){\n        auxCT = auxCT -5;\n        flow.set(\"auxCT\", auxCT);\n    }\n    \n    msg.payload =\n        {\n        \"on\": true,\n        \"bri\": auxBrightness,\n        \"ct\": auxCT\n        };\n    flow.set(\"lastChangeSec\", seconds);\n    flow.set(\"lastChangeMinute\", minutes);\n    flow.set(\"lastChangeHour\", hours);    \n    if(auxBrightness > 254 && auxCT > 6100 && increasing === true){\n        msg.reset = 1;\n    }  \n    if(auxBrightness < 192 && auxCT < 2550 && increasing === false){\n        msg.reset = 1;\n    }\n    global.set(\"EscritorioOnFirstTime\", false);\n    global.set(\"EscritorioOn\", true);\n    return msg;\n    \n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3020,"y":220,"wires":[["716a6073.796fd","2a719e87.b34be2","833e30e1.2f909"]]},{"id":"44a26901.b5a568","type":"function","z":"e7cd1901.ee2408","name":"Set Flow Variables","func":"\nif(global.get(\"SalaOnFirstTime\") === true){\n    global.set(\"SalaOnFirstTime\", false);\n    \n    var date = new Date();\n    var hours = date.getHours(); //hourss in 0-23\n    var minutes = \"0\" + date.getMinutes();\n    minutes = parseInt(minutes.substr(-2), 10);\n    var seconds = \"0\" + date.getSeconds();\n    seconds = parseInt(seconds.substr(-2), 10);\n\n    flow.set(\"lastChangeSec\", seconds);\n    flow.set(\"lastChangeMinute\", minutes);\n    flow.set(\"lastChangeHour\", hours);\n    \n    flow.set(\"countBrightness\", 1);\n    flow.set(\"increasing\", true);\n    flow.set(\"auxCT\", 6100);\n    return {\"ajuda\": 1};\n}\nif(global.get(\"SalaOnFirstTime\") === false){\n    return {\"ajuda\": 2};\n}\nelse{\n    return {\"ajuda\": 3};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":450,"y":200,"wires":[["f6750518.b798d8"]]},{"id":"b2a76711.ae4398","type":"trigger","z":"e7cd1901.ee2408","name":"","op1":"true","op2":"0","op1type":"json","op2type":"str","duration":"-10","extend":false,"overrideDelay":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":1270,"y":260,"wires":[["2389b8f5.93f1f8"]]},{"id":"df00c052.2c6a1","type":"function","z":"e7cd1901.ee2408","name":"Turn On","func":"var date = new Date();\nvar hours = date.getHours(); //hourss in 0-23\nvar minutes = \"0\" + date.getMinutes();\nminutes = parseInt(minutes.substr(-2), 10);\nvar seconds = \"0\" + date.getSeconds();\nseconds = parseInt(seconds.substr(-2), 10);\nvar hoursLast = flow.get(\"lastChangeHour\");\nvar secondsLast = flow.get(\"lastChangeSec\");\nvar minutesLast = flow.get(\"lastChangeMinute\");\nvar increasing = flow.get(\"increasing\");\nvar auxBrightness = flow.get(\"countBrightness\");\nvar auxCT = flow.get(\"auxCT\");\nif(hours >= 20){\n        increasing = false;\n        flow.set(\"increasing\", false)\n}\nif(msg.ajuda === 1){\n        msg.payload =\n        {\n        \"on\": true,\n        \"bri\": auxBrightness,\n        \"ct\": auxCT\n        };\n        flow.set(\"lastChangeSec\", seconds);\n        flow.set(\"lastChangeMinute\", minutes);\n        flow.set(\"lastChangeHour\", hours);\n        return msg;\n}\nif(hours > hoursLast || seconds > secondsLast+20 || minutes > minutesLast){\n\n    if(auxBrightness < msg.payload.state.bri-20 || auxBrightness > msg.payload.state.bri+20){\n        auxBrightness = msg.payload.state.bri;\n        flow.set(\"countBrightness\", auxBrightness);\n        \n    }    \n    if(auxCT < msg.payload.state.ct-100 || auxCT > msg.payload.state.ct+100){\n        auxCT = msg.payload.state.ct;\n        flow.set(\"auxCT\", auxCT);\n        \n    }\n    if(auxBrightness < 256 && increasing === true){\n        auxBrightness = auxBrightness + 1;\n        flow.set(\"countBrightness\",auxBrightness);\n    }\n    \n    if(auxCT < 6100 && increasing === true){\n        auxCT = auxCT +5;\n        flow.set(\"auxCT\", auxCT);\n    }\n    if(auxBrightness >128 && increasing === false){\n        auxBrightness = auxBrightness - 1;\n        flow.set(\"countBrightness\",auxBrightness);\n    }\n    if(auxCT > 2500 && increasing === false){\n        auxCT = auxCT -5;\n        flow.set(\"auxCT\", auxCT);\n    }\n    \n    flow.set(\"lastChangeSec\", seconds);\n    flow.set(\"lastChangeMinute\", minutes);\n    flow.set(\"lastChangeHour\", hours);\n    \n    msg.payload =\n        {\n        \"on\": true,\n        \"bri\": auxBrightness,\n        \"ct\": auxCT\n        };\n    if(auxBrightness > 254 && auxCT > 6000 && increasing === true){\n        msg.reset = 1;\n    }  \n    if(auxBrightness < 128 && auxCT < 2550 && increasing === false){\n        msg.reset = 1;\n    }\n    \n    global.set(\"SalaOnFirstTime\", false);\n    global.set(\"SalaOn\", true);\n    \n    return msg;\n    \n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3240,"y":180,"wires":[["a375134b.1d234","9cb07780.bcfb08","fdaa18d0.27a2c8"]]},{"id":"5349675d.bda988","type":"switch","z":"5767c936.cabd18","name":"","property":"payload.resetar","propertyType":"msg","rules":[{"t":"null"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":2270,"y":320,"wires":[["70421787.bbae78"],["34650f4f.5e35c"]]},{"id":"c3ea9f65.00d64","type":"change","z":"5767c936.cabd18","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":3575,"y":384,"wires":[["5ec55b77.d22a14"]]},{"id":"cd51c7bb.dfa688","type":"inject","z":"5767c936.cabd18","name":"Turn lights warmer and dimmer","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/20 22 * * *","once":true,"onceDelay":"","topic":"Status","payload":"{\"status\": \"status\"}","payloadType":"json","x":390,"y":80,"wires":[["62da1cb0.8b2cd4","f0109079.cd84","950bacc8.dd4ff"]]},{"id":"37b6f853.dc8188","type":"switch","z":"5767c936.cabd18","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":495,"y":236,"wires":[["db6caf2c.e2ac4","f0109079.cd84","62da1cb0.8b2cd4","950bacc8.dd4ff"],["62da1cb0.8b2cd4","950bacc8.dd4ff"]]},{"id":"dcd2984c.8ee318","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":840,"y":260,"wires":[["ba6a4e16.62ac7"]]},{"id":"a6f0a69b.827558","type":"inject","z":"e7cd1901.ee2408","name":"Turn lights warmer and dimmer","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/20 21 * * *","once":true,"onceDelay":"","topic":"Status","payload":"{\"status\": \"status\"}","payloadType":"json","x":510,"y":320,"wires":[["4d99acb0.658954","190248cb.085527","aa48fad2.d67908"]]},{"id":"f6750518.b798d8","type":"switch","z":"e7cd1901.ee2408","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":200,"wires":[["e70cfc56.e6d9a","4d99acb0.658954"],["b2a76711.ae4398","aa48fad2.d67908","190248cb.085527"]]},{"id":"9f86e19e.674de","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1020,"y":140,"wires":[["b2a76711.ae4398","aa48fad2.d67908","190248cb.085527"]]},{"id":"eb4434ec.ed1628","type":"function","z":"2bbba447.a4759c","name":"Turn On/Off","func":"//diferentes brightness dependendo da hora\nvar date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nvar newMsg;\nnewMsg = {payload:{}};\nif(msg.payload.on === true){\n    if(Hour === 23){\n            newMsg.payload =\n            {\n            \"on\": true,\n            \"bri\": 50,\n            \"ct\": 5000\n            };\n            global.set(\"isOnBanheiro\", true);\n            \n            node.status({fill:\"green\",shape:\"dot\",text:\"Liga\"});\n            node.send(newMsg);\n            \n    }\n    if(Hour >= 0 && Hour < 8){\n            newMsg.payload =\n            {\n            \"on\": true,\n            \"bri\": 30,\n            \"ct\": 2500\n            };\n            global.set(\"isOnBanheiro\", true);\n            \n            node.status({fill:\"green\",shape:\"dot\",text:\"Liga\"});\n            node.send(newMsg);\n            \n    }\n    if((Hour > 17 && Hour < 22) || \n            global.get(\"botaoBanheiro\") === true){\n            global.set(\"botaoBanheiro\", false);\n            global.set(\"isOnBanheiro\", true);\n            newMsg.payload = \n                {\n                \"on\": true,\n                \"bri\": 255,\n                \"ct\": 6200\n                \n    };\n    node.status({fill:\"green\",shape:\"dot\",text:\"Liga\"});\n    node.send(newMsg);\n}\nelse{\n    newMsg.payload.on = false\n    node.status({fill:\"green\",shape:\"dot\",text:\"Desliga\"});\n    node.send(newMsg);\n}\nsetTimeout(function(){\n            node.status({text:\"\"});\n            }, 15000);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3110,"y":360,"wires":[["2aeb6d7.b81e592"]]},{"id":"bbb346a4.f7ad58","type":"inject","z":"554bb518.994efc","d":true,"name":"Turn lights warmer and dimmer","repeat":"","crontab":"00 21 * * *","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":230,"y":500,"wires":[[]]},{"id":"80760c35.5968d","type":"function","z":"4c9c764d.9c4468","name":"Sunset?","func":"var dateNow = new Date();\nvar hoursNow = dateNow.getHours();\nvar minutesNow = \"0\" + dateNow.getMinutes();\nminutesNow = minutesNow.substr(-2)\nvar auxTime;\nif(msg.data.currently.summary.includes(\"cloudy\") === true ||\n    msg.data.currently.summary.includes(\"Cloudy\")=== true ||\n    msg.data.currently.summary.includes(\"rain\")=== true ||\n    msg.data.currently.summary.includes(\"Rain\")=== true  ||\n    msg.payload.clouds === 1){\n    auxTime = 2000;\n}\nelse{\n    auxTime = 1500;\n}\nvar dateSunset = new Date((msg.data.daily.data[0].sunsetTime-auxTime) * 1000);\nvar hoursSunset = dateSunset.getHours();\nvar minutesSunset = \"0\" + dateSunset.getMinutes();\nminutesSunset = minutesSunset.substr(-2)\n//msg = {payload: hoursSunset+\":\"+minutesSunset};\nif(hoursNow >= hoursSunset && minutesNow >= minutesSunset){\n    node.status({fill:\"green\",shape:\"dot\",text:\"Sunset started\"});\n    flow.set(\"triggered\", true);\n    node.send(msg);\n    global.set(\"escritorioEscuro\", true);\n    global.set(\"salaEscura\", true);\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":920,"y":600,"wires":[["55f5a77a.253908"]]},{"id":"75fea52c.e1a99c","type":"link in","z":"859b066a.dd8128","name":"Quarto On","links":["e434c7b2.a0c848"],"x":95,"y":220,"wires":[["4486ff2d.764ba"]]},{"id":"af808a53.16f078","type":"function","z":"5767c936.cabd18","name":"Begin Luz","func":"if(flow.get(\"triggered5\")=== true){\n    flow.set(\"triggered5\", false);\n    if(global.get(\"desabilitaAutomacao\") === false){\n        if(msg.payload.state.on === true){\n            flow.set(\"auxCT\",msg.payload.state.ct);\n            flow.set(\"countBrightnessLuz\",msg.payload.state.bri);\n            msg = {\"payload\":{\"state\":{\"on\":true,\"bri\" : msg.payload.state.bri+1, \"ct\":msg.payload.state.ct+5}}, \"ajuda\": 1}\n            flow.set(\"auxEmissor\", \"Yeelight\");\n            return msg;\n        }\n        else{\n            flow.set(\"auxCT\", 6100);\n            flow.set(\"countBrightnessLuz\", 1);\n            msg = {\"payload\":{\"state\":{\"on\":true,\"bri\" : 1, \"ct\":6100}}, \"ajuda\": 1}\n            flow.set(\"auxEmissor\", \"Yeelight\");\n            return msg;\n        }\n    }\n}\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1640,"y":220,"wires":[["7eb5668e.10c808","df23e8e7.d31c08"]]},{"id":"5276a510.bf584c","type":"function","z":"859b066a.dd8128","name":"Time Check","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\n\nif((Hour >= 16 && Hour < 22)){\n    msg = {\"payload\": 1};\n    return msg;\n}\nelse if((Hour <= 8 && Hour >= 22)){\n    msg = {\"payload\": 2};\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2470,"y":240,"wires":[["292a71aa.8f158e","d685bbde.8cfa28"]]},{"id":"292a71aa.8f158e","type":"switch","z":"859b066a.dd8128","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":2640,"y":260,"wires":[["b61e9737.cbda68","17851e1b.05b0da"],["afe62e37.a0aa2","17851e1b.05b0da"]]},{"id":"e2b2e733.f96968","type":"comment","z":"859b066a.dd8128","name":"Alguém entrou no quarto","info":"Alguém entrou no quarto e estava com as luzes desligada.","x":1140,"y":160,"wires":[]},{"id":"cc9f5a0e.42b368","type":"comment","z":"554bb518.994efc","name":"Injetar numa hora do dia","info":"","x":150,"y":460,"wires":[]},{"id":"fd265517.bf6a28","type":"catch","z":"859b066a.dd8128","name":"","scope":null,"uncaught":false,"x":260,"y":4780,"wires":[["3ba6112b.c647ce","87d03259.0b985"]]},{"id":"afa730cd.3a975","type":"function","z":"859b066a.dd8128","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no Quarto Automation.\"});\n\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            msg.payload = msg.payload + \"Erro numero \"+ i +\n            \"id: \" + msg.error[i].source.id+\". \"+\n            msg.error[i].source.name+ \". Tipo de erro:\" + \n            msg.error[i].source.type + \". Mensagem: \" +\n            msg.error[i].message + \"\\n\\n\";\n            \n        }\n    }\n    else{\n        msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n        msg.error.source.name+ \". Tipo de erro:\" + \n        msg.error.source.type + \". Mensagem: \" +\n        msg.error.message;\n    }\n   \n        return msg;\n}\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"x":1010,"y":4760,"wires":[["c853cb4a.0f97e8","181802f.9d709fd","56750238.a127ac"]]},{"id":"3ba6112b.c647ce","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":370,"y":4880,"wires":[["9d033a12.67a0b8"]]},{"id":"9d033a12.67a0b8","type":"function","z":"859b066a.dd8128","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);\nglobal.set(\"ContCatchErrors\", 0);","outputs":0,"noerr":0,"x":600,"y":4880,"wires":[]},{"id":"3be32b3b.50c3b4","type":"catch","z":"5767c936.cabd18","name":"","scope":null,"uncaught":false,"x":345,"y":2076,"wires":[["33d7c27e.598f5e","b56501ec.610c1"]]},{"id":"62e833ea.f66b1c","type":"function","z":"5767c936.cabd18","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no Escritório Automation.\"});\n\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            msg.payload = msg.payload + \"Erro numero \"+ i +\n            \"id: \" + msg.error[i].source.id+\". \"+\n            msg.error[i].source.name+ \". Tipo de erro:\" + \n            msg.error[i].source.type + \". Mensagem: \" +\n            msg.error[i].message + \"\\n\\n\";\n            \n        }\n    }\n    else{\n        msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n        msg.error.source.name+ \". Tipo de erro:\" + \n        msg.error.source.type + \". Mensagem: \" +\n        msg.error.message;\n    }\n   \n        return msg;\n}\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"x":1135,"y":2076,"wires":[["f83d952e.27ae68","6ff94495.22d69c","6f662fa4.16836"]]},{"id":"33d7c27e.598f5e","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":355,"y":2196,"wires":[["7038fa42.9e0d84"]]},{"id":"7038fa42.9e0d84","type":"function","z":"5767c936.cabd18","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":0,"noerr":0,"x":585,"y":2196,"wires":[]},{"id":"e7322349.d3431","type":"catch","z":"e7cd1901.ee2408","name":"","scope":null,"uncaught":false,"x":260,"y":1500,"wires":[["30279141.8e593e","406176e6.6856c8"]]},{"id":"d49980.2763d68","type":"function","z":"e7cd1901.ee2408","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no Sala Automation.\"});\n\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            msg.payload = msg.payload + \"Erro numero \"+ i +\n            \"id: \" + msg.error[i].source.id+\". \"+\n            msg.error[i].source.name+ \". Tipo de erro:\" + \n            msg.error[i].source.type + \". Mensagem: \" +\n            msg.error[i].message + \"\\n\\n\";\n            \n        }\n    }\n    else{\n        msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n        msg.error.source.name+ \". Tipo de erro:\" + \n        msg.error.source.type + \". Mensagem: \" +\n        msg.error.message;\n    }\n   \n        return msg;\n}\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"x":1100,"y":1500,"wires":[["2fecdaad.39a646","90ac006a.915e5","22e8c512.56e11a"]]},{"id":"30279141.8e593e","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":290,"y":1600,"wires":[["696decb3.d48c04"]]},{"id":"696decb3.d48c04","type":"function","z":"e7cd1901.ee2408","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":0,"noerr":0,"x":490,"y":1600,"wires":[]},{"id":"e2748376.9b2ff","type":"catch","z":"4c9c764d.9c4468","name":"","scope":null,"uncaught":false,"x":220,"y":4780,"wires":[["f60cc26b.39fc4","ab16533d.36a69"]]},{"id":"15278717.eb0cf9","type":"function","z":"4c9c764d.9c4468","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no HomeKit Automation.\"});\n\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            msg.payload = msg.payload + \"Erro numero \"+ i +\n            \"id: \" + msg.error[i].source.id+\". \"+\n            msg.error[i].source.name+ \". Tipo de erro:\" + \n            msg.error[i].source.type + \". Mensagem: \" +\n            msg.error[i].message + \"\\n\\n\";\n            \n        }\n    }\n    else{\n        msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n        msg.error.source.name+ \". Tipo de erro:\" + \n        msg.error.source.type + \". Mensagem: \" +\n        msg.error.message;\n    }\n   \n        return msg;\n}\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"x":960,"y":4780,"wires":[["4814f202.46ea2c","d6b32035.1477","d97529c0.f2bc68"]]},{"id":"f60cc26b.39fc4","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":370,"y":4860,"wires":[["4b5b4751.958bb8"]]},{"id":"4b5b4751.958bb8","type":"function","z":"4c9c764d.9c4468","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);","outputs":0,"noerr":0,"x":570,"y":4860,"wires":[]},{"id":"d5cfe4d1.5aaeb8","type":"switch","z":"859b066a.dd8128","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":730,"y":4780,"wires":[["afa730cd.3a975"],["d9115222.59d29"]]},{"id":"1dc7a307.88d84d","type":"function","z":"859b066a.dd8128","name":"Cont++","func":"if(global.get(\"ContCatchErrors\") === 0){\n\n    global.set(\"ContCatchErrors\", 1);\n    msg = Object.assign({}, msg, {ajuda:1});\n    return msg;\n}\nif(global.get(\"ContCatchErrors\") > 0){\n    global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n\n    msg = Object.assign({}, msg, {ajuda:2});\n    return msg;\n    \n}\n","outputs":1,"noerr":0,"x":580,"y":4780,"wires":[["d5cfe4d1.5aaeb8"]]},{"id":"d9115222.59d29","type":"join","z":"859b066a.dd8128","name":"","mode":"custom","build":"array","property":"error","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":850,"y":4800,"wires":[["afa730cd.3a975"]]},{"id":"6e501955.9ec438","type":"join","z":"5767c936.cabd18","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":935,"y":2116,"wires":[["62e833ea.f66b1c"]]},{"id":"2d5a9b35.09bd54","type":"switch","z":"5767c936.cabd18","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":815,"y":2076,"wires":[["62e833ea.f66b1c"],["6e501955.9ec438"]]},{"id":"a3d0a93.6515e58","type":"function","z":"5767c936.cabd18","name":"Cont++","func":"if(global.get(\"ContCatchErrors\") === 0){\n\n    global.set(\"ContCatchErrors\", 1);\n    msg.ajuda = 1;    \n    return msg;\n}\nif(global.get(\"ContCatchErrors\") > 0){\n    global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n    msg.ajuda = 2;\n    return msg;\n    \n}\n","outputs":1,"noerr":0,"x":685,"y":2076,"wires":[["2d5a9b35.09bd54"]]},{"id":"25a88406.78639c","type":"join","z":"e7cd1901.ee2408","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":910,"y":1540,"wires":[["d49980.2763d68"]]},{"id":"f8f033ae.d265c","type":"switch","z":"e7cd1901.ee2408","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":1500,"wires":[["d49980.2763d68"],["25a88406.78639c"]]},{"id":"2f85fde6.8ac3b2","type":"function","z":"e7cd1901.ee2408","name":"Cont++","func":"if(global.get(\"ContCatchErrors\") === 0){\n\n    global.set(\"ContCatchErrors\", 1);\n    msg.ajuda = 1;    \n    return msg;\n}\nif(global.get(\"ContCatchErrors\") > 0){\n    global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n    msg.ajuda = 2;\n    return msg;\n    \n}\n","outputs":1,"noerr":0,"x":600,"y":1500,"wires":[["f8f033ae.d265c"]]},{"id":"af4d2af0.c1d0e8","type":"join","z":"4c9c764d.9c4468","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":770,"y":4820,"wires":[["15278717.eb0cf9"]]},{"id":"23d64f47.19d9e","type":"switch","z":"4c9c764d.9c4468","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":650,"y":4780,"wires":[["15278717.eb0cf9"],["af4d2af0.c1d0e8"]]},{"id":"6f5ac1c8.1469a","type":"function","z":"4c9c764d.9c4468","name":"Cont++","func":"if(global.get(\"ContCatchErrors\") === 0){\n\n    global.set(\"ContCatchErrors\", 1);\n    msg.ajuda = 1;    \n    return msg;\n}\nif(global.get(\"ContCatchErrors\") > 0){\n    global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n    msg.ajuda = 2;\n    return msg;\n    \n}\n","outputs":1,"noerr":0,"x":520,"y":4780,"wires":[["23d64f47.19d9e"]]},{"id":"ad1d3dc3.760cf","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1050,"y":80,"wires":[["889f8e96.2787a"]]},{"id":"889f8e96.2787a","type":"function","z":"554bb518.994efc","name":"","func":"global.set(\"CatchErrors\",false);\nglobal.set(\"ContCatchErrors\", 0);","outputs":0,"noerr":0,"x":1190,"y":120,"wires":[]},{"id":"e9ee7b98.efc5d8","type":"function","z":"554bb518.994efc","name":"","func":"global.set(\"SalaOnFirstTime\", true);\nglobal.set(\"SalaOn\",false);\nglobal.set(\"salaEscura\",false);\nglobal.set(\"luzDaMesaOn\", false);\n        \nglobal.set(\"EscritorioOnFirstTime\", true);\nglobal.set(\"EscritorioOn\",false);\nglobal.set(\"escritorioEscuro\",false);\nglobal.set(\"overrideEscritorio\",false);\nglobal.set(\"contEscritorio\", 0); \nglobal.set(\"auxTurnOnEscritorio\", false);\n\nglobal.set(\"contBanheiro\", 0); \nglobal.set(\"botaoBanheiro\", false); \nglobal.set(\"abertaMuitoTempo\", false); \nglobal.set(\"portaAbertaBanheiro\", false);\n\nglobal.set(\"LampadaOn\", false); \nglobal.set(\"turnOffDelay\", false); \nglobal.set(\"vouDormir\", false); \nglobal.set(\"botaoQuarto\", false); \nglobal.set(\"quartoOn\",false);\nglobal.set(\"fireTVNediAtividade\", false)\n\nglobal.set(\"fireTVMariaAtividade\", false);\n\nglobal.set(\"horaDoFilme\", false);\nglobal.set(\"tvAuxFilme\", false);\nglobal.set(\"alexaCafeAux\", false);\nglobal.set(\"auxContStatus\", 0);\n\nglobal.set(\"chuvaAux\", false);\nglobal.set(\"ventoAux\", false);\nglobal.set(\"chuvaNotifAux\", false);\n\nglobal.set(\"desabilitaAutomacao\", false);\nglobal.set(\"boaNoiteCasa\", false);\nglobal.set(\"salaOnNoite\", false);\n\nglobal.set(\"luzNoturnaOn\", false);","outputs":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1370,"y":440,"wires":[]},{"id":"3b4f20b5.427b5","type":"inject","z":"554bb518.994efc","name":"Restart variables in the morning","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/30 6-7 * * *","once":true,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":1140,"y":400,"wires":[["e9ee7b98.efc5d8"]]},{"id":"361835ca.3bf73a","type":"comment","z":"554bb518.994efc","name":"CatchErrors setup","info":"","x":1050,"y":40,"wires":[]},{"id":"9c4c4122.9a59b","type":"comment","z":"554bb518.994efc","name":"Alexa Activity","info":"On Device Activity\nalexa-remote-event\n\n\n//input:\nmsg.payload.domainAttributes.nBestList[0].questionText;\n//or \nmsg.payload.description.summary;\n\n//alexa answer \nmsg.payload.domainAttributes.nBestList[0].answerText;\nreturn msg;\n\n\n","x":120,"y":600,"wires":[]},{"id":"22e8c512.56e11a","type":"function","z":"e7cd1901.ee2408","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"x":1340,"y":1440,"wires":[["f389a2c9.12d75"]]},{"id":"6f662fa4.16836","type":"function","z":"5767c936.cabd18","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"x":1315,"y":2016,"wires":[["b2bff029.0ca5"]]},{"id":"56750238.a127ac","type":"function","z":"859b066a.dd8128","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"x":1230,"y":4700,"wires":[["b22531d9.33f41"]]},{"id":"d97529c0.f2bc68","type":"function","z":"4c9c764d.9c4468","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"x":1180,"y":4720,"wires":[["cc01888e.654468"]]},{"id":"513bcfbd.260c2","type":"catch","z":"2bbba447.a4759c","d":true,"name":"","scope":null,"uncaught":false,"x":220,"y":1160,"wires":[["d19fe0be.7ccbf","7507e100.92d15"]]},{"id":"e5ea72a7.dabbc","type":"function","z":"2bbba447.a4759c","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no Banheiro Automation.\"});\n\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            msg.payload = msg.payload + \"Erro numero \"+ i +\n            \"id: \" + msg.error[i].source.id+\". \"+\n            msg.error[i].source.name+ \". Tipo de erro:\" + \n            msg.error[i].source.type + \". Mensagem: \" +\n            msg.error[i].message + \"\\n\\n\";\n            \n        }\n    }\n    else{\n        msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n        msg.error.source.name+ \". Tipo de erro:\" + \n        msg.error.source.type + \". Mensagem: \" +\n        msg.error.message;\n    }\n   \n        return msg;\n}\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"x":1040,"y":1140,"wires":[["dd589a32.8ce048","6b52e091.61a56","5f0444a0.2d4bec"]]},{"id":"d19fe0be.7ccbf","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":290,"y":1280,"wires":[["aad8173d.b06638"]]},{"id":"aad8173d.b06638","type":"function","z":"2bbba447.a4759c","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);\nglobal.set(\"ContCatchErrors\", 0);\n","outputs":1,"noerr":0,"x":470,"y":1280,"wires":[[]]},{"id":"2669e0bb.35eb8","type":"join","z":"2bbba447.a4759c","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":870,"y":1200,"wires":[["e5ea72a7.dabbc"]]},{"id":"c7d4afb4.22d4c","type":"switch","z":"2bbba447.a4759c","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":730,"y":1160,"wires":[["e5ea72a7.dabbc"],["2669e0bb.35eb8"]]},{"id":"d716cb61.3b71c8","type":"function","z":"2bbba447.a4759c","name":"Cont++","func":"if(global.get(\"ContCatchErrors\") === 0){\n\n    global.set(\"ContCatchErrors\", 1);\n    msg.ajuda = 1;    \n    return msg;\n}\nif(global.get(\"ContCatchErrors\") > 0){\n    global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n    msg.ajuda = 2;\n    return msg;\n    \n}\n","outputs":1,"noerr":0,"x":510,"y":1160,"wires":[["c7d4afb4.22d4c"]]},{"id":"5f0444a0.2d4bec","type":"function","z":"2bbba447.a4759c","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"x":1230,"y":1100,"wires":[["3a01f365.64a05c"]]},{"id":"9f8391be.fe414","type":"comment","z":"4c9c764d.9c4468","name":"Automações do Escritório e Sala","info":"","x":470,"y":180,"wires":[]},{"id":"f77deeee.76d3","type":"comment","z":"4c9c764d.9c4468","name":"Automações do Movie Night","info":"","x":400,"y":1100,"wires":[]},{"id":"4725f860.704098","type":"comment","z":"2bbba447.a4759c","name":"Catching Errors and notifying","info":"","x":260,"y":1100,"wires":[]},{"id":"6d6589bb.0e28d8","type":"comment","z":"e7cd1901.ee2408","name":"Catching Errors and notifying","info":"","x":280,"y":1460,"wires":[]},{"id":"37b1d63c.abb3ea","type":"comment","z":"5767c936.cabd18","name":"Catching Errors and notifying","info":"","x":305,"y":2036,"wires":[]},{"id":"6a750461.d877fc","type":"comment","z":"859b066a.dd8128","name":"Catching Errors and notifying","info":"","x":320,"y":4720,"wires":[]},{"id":"338770dd.53918","type":"comment","z":"4c9c764d.9c4468","name":"Catching Errors and notifying","info":"","x":320,"y":4700,"wires":[]},{"id":"ddadea9.4332e18","type":"inject","z":"554bb518.994efc","name":"Started!","repeat":"","crontab":"","once":true,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":1060,"y":260,"wires":[["ce0283b8.18c0d","1c697dc3.2f69f2"]]},{"id":"182b364d.d4e2ea","type":"comment","z":"554bb518.994efc","name":"Start variables","info":"","x":1030,"y":200,"wires":[]},{"id":"ce0283b8.18c0d","type":"function","z":"554bb518.994efc","name":"","func":"//Errors Variables\nglobal.set(\"CatchErrors\",false);\nglobal.set(\"ContCatchErrors\", 0);\n\n//Quarto Nedi Variables\nglobal.set(\"turnOffDelay\", false);\nglobal.set(\"quartoOn\", false);\nglobal.set(\"vouDormir\", false);\nglobal.set(\"botaoQuarto\", false);\nglobal.set(\"luxQuarto\", 25); \nglobal.set(\"fireTVNediAtividade\", false)\n\n//Quarto Maria Variables\nglobal.set(\"horaDoSonoMaria\", false);\nglobal.set(\"fireTVMariaAtividade\", false);\n\n//Hora do filme Variables\nglobal.set(\"horaDoFilme\", false);\n\n//Sala and Escritorio Variables\nvar date = new Date();\nvar hours = date.getHours();\nvar minutes = \"0\" + date.getMinutes();\nminutes = parseInt(minutes.substr(-2), 10);\nvar seconds = \"0\" + date.getSeconds();\nseconds = parseInt(seconds.substr(-2), 10);\nglobal.set(\"lastChangeSec\", seconds);\nglobal.set(\"lastChangeMinute\", minutes);\nglobal.set(\"lastChangeHour\", hours);\nglobal.set(\"SalaOnFirstTime\", true);\nglobal.set(\"SalaOn\",false);\nglobal.set(\"EscritorioOnFirstTime\", true);\nglobal.set(\"EscritorioOn\",false);\nglobal.set(\"salaEscura\",false);\nglobal.set(\"escritorioEscuro\",false);\nglobal.set(\"overrideEscritorio\", true);\nglobal.set(\"contEscritorio\", 0);\nglobal.set(\"luzDaMesaOn\", false);\nglobal.set(\"auxTurnOnEscritorio\", false);\n\n//Banheiro variables\nglobal.set(\"BanheiroOcupado\", false);\nglobal.set(\"contBanheiro\", 0);\nglobal.set(\"botaoBanheiro\", false);\nglobal.set(\"auxEmissorBanheiro\", \"\");\nglobal.set(\"isOnBanheiro\", false);\nglobal.set(\"abertaMuitoTempo\", false);\nglobal.set(\"portaAbertaBanheiro\", false);\n\nglobal.set(\"auxContStatus\", 0);\nglobal.set(\"alexaCafeAux\", false);\nglobal.set(\"tvAuxFilme\", false);\nglobal.set(\"tvAuxPlay\", false);\n\nglobal.set(\"chuvaAux\", false);\nglobal.set(\"ventoAux\", false);\nglobal.set(\"chuvaNotifAux\", false);\n\nglobal.set(\"desabilitaAutomacao\", false);\nglobal.set(\"boaNoiteCasa\", false);\nglobal.set(\"salaOnNoite\", false);\n\nglobal.set(\"luzNoturnaOn\", false);","outputs":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1240,"y":280,"wires":[]},{"id":"53ffdf0c.5803c","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"8","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2800,"y":280,"wires":[["7eb5668e.10c808"]]},{"id":"bceedc42.6aad4","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"8","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":3080,"y":220,"wires":[["df00c052.2c6a1","3001e3b1.19278c"]]},{"id":"d4569428.841038","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"40","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":780,"y":1380,"wires":[["8d51d582.5ce628"]]},{"id":"718583b3.1d2c4c","type":"comment","z":"859b066a.dd8128","name":"Ligar as luzes de manha","info":"Ligar as luzes de manha caso o quarto esteja muito escuro.","x":330,"y":2860,"wires":[]},{"id":"882c55b.9a7d9a8","type":"inject","z":"859b066a.dd8128","name":"Turn lights in the morning","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"30 09 * * 1,2,3,4,5,6","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":360,"y":2940,"wires":[["ea6f97d8.d53738"]]},{"id":"407ae073.bab95","type":"function","z":"859b066a.dd8128","name":"","func":"var luxQuarto = global.get(\"luxQuarto\");\nif(luxQuarto < 50 && luxQuarto > 0){\n    msg = {payload: {\"On\":true}};\n    return msg;\n\n}","outputs":1,"noerr":0,"x":790,"y":2940,"wires":[["761491ab.47174"]]},{"id":"724fd675.fd5e88","type":"mqtt out","z":"859b066a.dd8128","name":"setOn RGB Strip","topic":"QuartoNedi/setOnRGB","qos":"","retain":"","broker":"64936db9.640564","x":1570,"y":2940,"wires":[]},{"id":"72871881.f1e7e8","type":"mqtt out","z":"859b066a.dd8128","name":"setRGB RGB Strip","topic":"QuartoNedi/setRGB","qos":"","retain":"","broker":"64936db9.640564","x":1750,"y":3000,"wires":[]},{"id":"ffeae1f.5cc272","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"msg = {payload:1};\nreturn msg;","outputs":1,"noerr":0,"x":1350,"y":2980,"wires":[["724fd675.fd5e88","3cec2fe.6ac6ed"]]},{"id":"3cec2fe.6ac6ed","type":"function","z":"859b066a.dd8128","name":"White","func":"msg = {payload:\"FFFFFF\"};\nreturn msg;","outputs":1,"noerr":0,"x":1540,"y":3020,"wires":[["72871881.f1e7e8"]]},{"id":"169e61b.b1afd9e","type":"function","z":"4c9c764d.9c4468","name":"Anunciar Bom Filme","func":"var date = new Date();\nvar Day = date.getDay(); \nvar Hour = date.getHours();\nif(Hour >16 && Hour <5) {\n                msg = {payload: {\"On\":true}};\n                \n    node.send(msg);\n    node.status({text:\"Enviou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1060,"y":1240,"wires":[["45637419.03f15c"]]},{"id":"d3645fef.a44f5","type":"switch","z":"4c9c764d.9c4468","name":"","property":"payload.state.on","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1559,"y":1580,"wires":[["afb74b1c.399c78"],["cec68f9.efd5a7","117d06e2.d815f9"]]},{"id":"afb74b1c.399c78","type":"function","z":"4c9c764d.9c4468","name":"Turn On Dim","func":"msg.payload = {\"on\": true,\"bri\":25, \"ct\": 3500};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1739,"y":1560,"wires":[["f127ac0f.face3"]]},{"id":"bee5557c.627e48","type":"function","z":"859b066a.dd8128","name":"","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg = {payload: {\"On\":true}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1120,"y":2940,"wires":[["ffeae1f.5cc272","e5fea666.eaa338","3ee9b545.16afba"]]},{"id":"250ab27.747084e","type":"function","z":"2bbba447.a4759c","name":"","func":"var newMsg;\nnewMsg = {\"payload\": {\"On\": false}};\nglobal.set(\"isOnBanheiro\", false);\nglobal.set(\"BanheiroOcupado\", false);\nreturn newMsg;\n","outputs":1,"noerr":0,"x":1800,"y":220,"wires":[["3665f12e.70f2ee","a2c55b1b.216528"]]},{"id":"b61e9737.cbda68","type":"function","z":"859b066a.dd8128","d":true,"name":"","func":"var aux = [{},{},{}]\naux[0].entity = \"Luz do Quarto\";\naux[0].action = \"setColorTemperature\";\naux[0].value = \"cool\";\n\naux[1].entity = \"Luz do Quarto\";\naux[1].action = \"setBrightness\";\naux[1].value = 100;\n\naux[2].entity = \"Luz do Quarto\";\naux[2].action = \"turnOn\";\n\nmsg.payload = aux;\nreturn msg;","outputs":1,"noerr":0,"x":2818,"y":120,"wires":[["10c8544d.2497dc"]]},{"id":"afe62e37.a0aa2","type":"function","z":"859b066a.dd8128","d":true,"name":"","func":"var aux = [{},{},{}]\naux[0].entity = \"Luz do Quarto\";\naux[0].action = \"setColorTemperature\";\naux[0].value = \"warm_white\";\n\naux[1].entity = \"Luz do Quarto\";\naux[1].action = \"setBrightness\";\naux[1].value = 20;\n\naux[2].entity = \"Luz do Quarto\";\naux[2].action = \"turnOn\";\n\nmsg.payload = aux;\nreturn msg;","outputs":1,"noerr":0,"x":2820,"y":180,"wires":[["f31d5496.2b7e18"]]},{"id":"a87e7163.650af","type":"switch","z":"2bbba447.a4759c","name":"","property":"payload.state.on","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1410,"y":200,"wires":[["3180f91a.e24496"],["439df96c.0e4a48"]]},{"id":"71ba2d22.7c82a4","type":"function","z":"e7cd1901.ee2408","name":"Start","func":"\n    return msg;","outputs":1,"noerr":0,"x":410,"y":1060,"wires":[["c7ff1e9c.b4318","a4b1a47.d185b58","33a3a6e2.a907ca"]]},{"id":"78eed8d.a5d0028","type":"function","z":"e7cd1901.ee2408","name":"Turn Off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg = {payload : {\"on\": false}};\n    global.set(\"SalaOn\", false);\n    global.set(\"SalaEscura\", false);\n    return newMsg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2050,"y":1000,"wires":[["79c5edf6.bf7ca4","83022ff1.d18fb","8ec1a11b.56e75","33d7f2cf.e657ee","ddbd9add.1002e8","4c93361b.8a2798","4fed96c8.787008"]]},{"id":"465bdde4.286d34","type":"function","z":"e7cd1901.ee2408","name":"Turn On","func":"if(msg.payload === true){\n    global.set(\"boaNoiteCasa\", false);\n    global.set(\"desabilitaAutomacao\", false);\n    global.set(\"horaDoFilme\", false);\n    var newMsg;\n    newMsg = {payload : {\n        \"on\": true,\n        \"bri\": 255,\n        \"ct\": 6100,\n        \"duration\": 2000\n    }};\n    global.set(\"SalaOn\", true);\n    return newMsg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2050,"y":1060,"wires":[["a363d670.bc5818","ab61f5d5.6dc488","544a034e.fdb21c","4fed96c8.787008"]]},{"id":"b4ab05eb.477fe8","type":"comment","z":"e7cd1901.ee2408","name":"Botao sala foi clicado","info":"","x":260,"y":980,"wires":[]},{"id":"9802b432.06b398","type":"function","z":"5767c936.cabd18","name":"Turn On","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg = {payload : {\n        \"on\": true,\n        \"bri\": 255,\n        \"ct\": 6100,\n        \"duration\": 2000\n    }};\n    global.set(\"EscritorioOn\", true);\n    global.set(\"boaNoiteCasa\", false);\n    global.set(\"desabilitaAutomacao\", false);\n    global.set(\"horaDoFilme\", false);\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2100,"y":940,"wires":[["173b8a0d.bb1566","f3e49289.041b7","f085972.585a668","6f5b3cf0.be2454"]]},{"id":"3914d48b.1018fc","type":"function","z":"5767c936.cabd18","name":"Start","func":"return msg;\n","outputs":1,"noerr":0,"x":410,"y":940,"wires":[["684afb0c.39a754","b4ad0947.84e188","44824a8e.596a94"]]},{"id":"c467e8cb.1f49f8","type":"comment","z":"5767c936.cabd18","name":"Botao escritorio foi clicado","info":"","x":270,"y":840,"wires":[]},{"id":"f75f5e50.13d69","type":"switch","z":"859b066a.dd8128","name":"","property":"payload.On","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":590,"y":1387,"wires":[["d4569428.841038","bbc2df9b.e0d17"]]},{"id":"badfa912.45dbf8","type":"function","z":"2bbba447.a4759c","name":"Set Triggered","func":"global.set(\"contBanheiro\", 0);\nflow.set(\"triggered1\", true);\nvar date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\n\n//if(Hour < 18 && Hour > 7){\n//    msg.isDay = true;\n//} else{\n//    msg.isDay = false\n//}\nmsg.isDay = true;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":400,"y":360,"wires":[["6e07605b.68b1c"]]},{"id":"f3d623af.878a1","type":"switch","z":"2bbba447.a4759c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"ON","vt":"str"},{"t":"eq","v":"OFF","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1410,"y":280,"wires":[["a78b03ac.299d4"],["1aae8118.22a5ff"]]},{"id":"c96db932.46c878","type":"function","z":"2bbba447.a4759c","name":"Turn On","func":"//diferentes brightness dependendo da hora\nvar date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(typeof msg.payload.on === \"undefined\"){\n    msg.payload ={\"on\": msg.payload.On};\n}\n\nif(typeof msg.payload.On === \"undefined\"){\n    msg.payload = {\"On\": msg.payload.on};\n}\n\nif(msg.payload.on === true || msg.payload.On === true ){\n    if(Hour > 17 && Hour < 22){\n        msg.payload = \n            {\n            \"powerState\": \"ON\",\n            \"brightness\": 255,\n            \"colorTemperatureInKelvin\": 6200\n            \n            };\n            \n    }\n    if(Hour === 23){\n        msg.payload =\n        {\n        \"powerState\": \"ON\",\n        \"brightness\": 50,\n        \"colorTemperatureInKelvin\": 5000\n        };\n    }\n    if(Hour >= 0 && Hour < 8){\n        msg.payload =\n        {\n        \"powerState\": \"ON\",\n        \"brightness\": 30,\n        \"colorTemperatureInKelvin\": 2500\n        };\n        \n    }\n    var aux = [{},{},{}]\n    aux[0].entity = \"Luz do Banheiro\";\n    aux[0].action = \"setColorTemperature\";\n    aux[0].value = msg.payload.colorTemperatureInKelvin;\n    \n    aux[1].entity = \"Luz do Banheiro\";\n    aux[1].action = \"setBrightness\";\n    aux[1].value = msg.payload.brightness;\n    \n    \n    aux[2].entity = \"Luz do Banheiro\";\n    aux[2].action = \"turnOn\";\n    \n    msg.payload = aux;\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3240,"y":180,"wires":[["a3b3a99d.ff7468","4c0810be.0e397"]]},{"id":"3665f12e.70f2ee","type":"function","z":"2bbba447.a4759c","name":"Turn Off","func":"var newMsg;\nnewMsg = { \"payload\" : {\"on\":false}};\nnode.status({fill:\"green\",shape:\"dot\",text:\"Desliga\"});\nnode.send(newMsg);    \nglobal.set(\"botaoBanheiro\", false);\nglobal.set(\"BanheiroOcupado\", false);\nglobal.set(\"isOnBanheiro\", false);\nsetTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2500,"y":280,"wires":[["5797c620.129498","1004281c.91e608"]]},{"id":"fe5dc8bd.a35d18","type":"function","z":"2bbba447.a4759c","name":"Query","func":"var aux = [{}]\naux[0].entity = \"SKILL_eyJza2lsbElkIjoiYW16bjEuYXNrLnNraWxsLjZiYjkxNzE0LWFiNWQtNDFiOS1hYzI5LWI3ZWQ4YWFiNmNjNCIsInN0YWdlIjoibGl2ZSJ9_312904351\";\naux[0].property = \"powerState\";\nmsg.payload = aux;\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":360,"wires":[["9eb428b1.d1d508"]]},{"id":"6f27f94e.d021f8","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":580,"y":460,"wires":[["940ee253.3159e"]]},{"id":"87d03259.0b985","type":"switch","z":"859b066a.dd8128","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":430,"y":4780,"wires":[[],["1dc7a307.88d84d"]]},{"id":"b56501ec.610c1","type":"switch","z":"5767c936.cabd18","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":535,"y":2076,"wires":[[],["a3d0a93.6515e58"]]},{"id":"406176e6.6856c8","type":"switch","z":"e7cd1901.ee2408","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":430,"y":1500,"wires":[[],["2f85fde6.8ac3b2"]]},{"id":"7507e100.92d15","type":"switch","z":"2bbba447.a4759c","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":370,"y":1160,"wires":[[],["d716cb61.3b71c8"]]},{"id":"ab16533d.36a69","type":"switch","z":"4c9c764d.9c4468","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":370,"y":4780,"wires":[[],["6f5ac1c8.1469a"]]},{"id":"cd61a227.139cd","type":"function","z":"e7cd1901.ee2408","name":"Begin Luz","func":"if(flow.get(\"triggered4\")=== true){\n    flow.set(\"triggered4\", false);\n    if(global.get(\"desabilitaAutomacao\") === false){\n        if(msg.payload.state.on === true){\n            flow.set(\"auxCT\",msg.payload.state.ct);\n            flow.set(\"countBrightness\",msg.payload.state.bri);\n            msg = {\"payload\":{\"state\":{\"on\":true,\"bri\" : msg.payload.state.bri+1, \"ct\":msg.payload.state.ct+5}}, \"ajuda\": 1}\n            flow.set(\"auxEmissor\", \"Yeelight\");\n            return msg;\n        }\n        else{\n            flow.set(\"auxCT\", 6100);\n            flow.set(\"countBrightness\", 1);\n            msg = {\"payload\":{\"state\":{\"on\":true,\"bri\" : 1, \"ct\":6100}}, \"ajuda\": 1}\n            flow.set(\"auxEmissor\", \"Yeelight\");\n            return msg;\n        }\n    }\n}\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1640,"y":180,"wires":[["df00c052.2c6a1"]]},{"id":"cec68f9.efd5a7","type":"function","z":"4c9c764d.9c4468","name":"Turn On Dimmer","func":"msg.payload = {\"on\": true, \"bri\":5, \"ct\": 3500};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"x":1759,"y":1620,"wires":[["6494e447.1fb45c"]]},{"id":"a32a9915.70db78","type":"switch","z":"859b066a.dd8128","name":"","property":"payload.On","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":630,"y":3760,"wires":[["465e6f86.2aa25","d05f28c5.230358","32a79da4.741ed2","2007e720.2de1f8","d1df1e50.00d2","5f2b24be.7303cc","6153407f.e6c52","de7289f.2511178"],["9d539b87.6c8318"]]},{"id":"465e6f86.2aa25","type":"function","z":"859b066a.dd8128","d":true,"name":"","func":"global.set(\"vouDormir\", true);\nvar aux = [{}, {}]\naux[0].entity = \"Fita do Quarto\";\naux[0].action = \"turnOff\";\n\naux[1].entity = \"Fita do Quarto\";\naux[1].action = \"turnOff\";\n\nmsg.payload = aux;\nreturn msg;","outputs":1,"noerr":0,"x":830,"y":3740,"wires":[["27cc348a.a12c9c"]]},{"id":"f478af2b.e1114","type":"mqtt out","z":"859b066a.dd8128","name":"setOn","topic":"QuartoNedi/setOnRGB","qos":"","retain":"","broker":"64936db9.640564","x":1030,"y":3800,"wires":[]},{"id":"d05f28c5.230358","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"msg = {payload:0};\nreturn msg;","outputs":1,"noerr":0,"x":890,"y":3800,"wires":[["f478af2b.e1114"]]},{"id":"9d539b87.6c8318","type":"function","z":"859b066a.dd8128","name":"","func":"global.set(\"vouDormir\", false);\nglobal.set(\"botaoQuarto\", false);","outputs":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":740,"y":3900,"wires":[]},{"id":"d851d997.3c2738","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1240,"y":320,"wires":[["a87e7163.650af","f3d623af.878a1","e3f28710.c14ba8"]]},{"id":"8073258b.621728","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2460,"y":360,"wires":[["13788a95.fdf4b5","7b3ccae7.cb3de4"]]},{"id":"5797c620.129498","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2700,"y":280,"wires":[["7b3ccae7.cb3de4"]]},{"id":"4532ff26.67bba","type":"function","z":"2bbba447.a4759c","name":"Turn Off","func":"if(typeof msg.payload.on === \"undefined\"){\n    msg.payload ={ \"on\": msg.payload.On};\n}\nelse{\n    if(typeof msg.payload.On === \"undefined\"){\n        msg.payload = {\"On\": msg.payload.on};\n    }\n}\nif(msg.payload.on === false || msg.payload.On === false ){\n    var aux = [{}];\n    \n    aux[0].entity = \"Luz do Banheiro\";\n    aux[0].action = \"turnOff\";\n    \n    msg.payload = aux;\n    return msg;\n}","outputs":1,"noerr":0,"x":3240,"y":260,"wires":[["d588617e.d700b","906d3b33.1f3308"]]},{"id":"4c0810be.0e397","type":"debug","z":"2bbba447.a4759c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3310,"y":140,"wires":[]},{"id":"906d3b33.1f3308","type":"debug","z":"2bbba447.a4759c","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3390,"y":240,"wires":[]},{"id":"fa56b44c.6d8ce8","type":"trigger","z":"2bbba447.a4759c","name":"","op1":"1","op2":"0","op1type":"num","op2type":"str","duration":"-10","extend":false,"overrideDelay":false,"units":"s","reset":"reset","bytopic":"all","topic":"topic","outputs":1,"x":2130,"y":580,"wires":[["ece6e1e6.9f9c1"]]},{"id":"48a71a45.f09914","type":"function","z":"2bbba447.a4759c","name":"Cont++","func":"var contBanheiro = global.get(\"contBanheiro\");\nvar portaAberta = global.get(\"portaAbertaBanheiro\");\nvar newMsg;\nif(portaAberta === false || msg.reset === true){\n    newMsg = {\"reset\" : 1};\n    global.set(\"contBanheiro\", 0);        \n    node.send(newMsg);\n    global.set(\"abertoMuitoTempo\", false);\n    node.status({fill:\"green\",shape:\"dot\",text:\"Porta aberta\"});\n}\nelse{\n    if(contBanheiro == 300){\n        newMsg = {\"payload\" : {\"On\":false}, \"ajuda\": 1};\n        global.set(\"contBanheiro\", contBanheiro+10)   \n        node.send(newMsg);\n        node.status({fill:\"green\",shape:\"dot\",text:\"Desliga corredor\"});\n        \n    }\n    else if(contBanheiro == 1200){\n        newMsg = {\"payload\" : {\"On\":false}, \"ajuda\": 2};\n        global.set(\"contBanheiro\", contBanheiro+10)   \n        node.send(newMsg);\n        node.status({fill:\"green\",shape:\"dot\",text:\"Desliga corredor\"});\n        \n    }\n    else if(contBanheiro == 2400){\n        newMsg = {\"reset\" : 1};\n        global.set(\"contBanheiro\", 0);\n        global.set(\"abertoMuitoTempo\", true);\n        node.send(newMsg);\n        node.status({fill:\"green\",shape:\"dot\",text:\"Desliga a luz\"});\n        \n    }\n    else{\n        global.set(\"contBanheiro\", contBanheiro+10)   \n        newMsg = {payload: true}\n        node.status({fill:\"green\",shape:\"dot\",text:\"cont\"+contBanheiro});\n    }\n}\nsetTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2040,"y":480,"wires":[["48bf75a2.de0a2c","c1b62f28.bfdd7","eaf959ca.c2b768"]]},{"id":"30379d06.5c9d22","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"8","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":3375,"y":384,"wires":[["c3ea9f65.00d64"]]},{"id":"895843e4.08998","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"30","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1790,"y":220,"wires":[["b7254c11.8a6fe"]]},{"id":"ea6f97d8.d53738","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"30","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":620,"y":2940,"wires":[["407ae073.bab95"]]},{"id":"98a685fb.a9a358","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"10","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":460,"y":3720,"wires":[["a32a9915.70db78"]]},{"id":"78d25414.be2c8c","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":230,"y":360,"wires":[["badfa912.45dbf8"]]},{"id":"e740020e.82078","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":420,"y":1387,"wires":[["f75f5e50.13d69"]]},{"id":"17b7df66.4128b1","type":"link in","z":"859b066a.dd8128","name":"Vou dormir","links":["1162d52e.d59a7b","182aa26e.838abe","54089fcf.dd297"],"x":295,"y":3600,"wires":[["98a685fb.a9a358"]]},{"id":"7b3ccae7.cb3de4","type":"switch","z":"2bbba447.a4759c","d":true,"name":"","property":"auxEmissorBanheiro","propertyType":"global","rules":[{"t":"eq","v":"Alexa","vt":"str"},{"t":"eq","v":"Yeelight","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":2910,"y":320,"wires":[["c7b58f47.7b00b","a2739762.e57528"],["f4e44398.a95af","ddad8255.72c54","eb4434ec.ed1628"]]},{"id":"c7b58f47.7b00b","type":"switch","z":"2bbba447.a4759c","name":"","property":"isOnBanheiro","propertyType":"global","rules":[{"t":"false"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":3090,"y":240,"wires":[["c96db932.46c878"],["4532ff26.67bba"]]},{"id":"3180f91a.e24496","type":"change","z":"2bbba447.a4759c","name":"set aux","rules":[{"t":"set","p":"auxEmissorBanheiro","pt":"global","to":"Yeelight","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":160,"wires":[["250ab27.747084e"]]},{"id":"439df96c.0e4a48","type":"change","z":"2bbba447.a4759c","name":"set aux","rules":[{"t":"set","p":"auxEmissorBanheiro","pt":"global","to":"Yeelight","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":200,"wires":[["b4038cea.b3677"]]},{"id":"fb61a0f6.7dc42","type":"function","z":"444fced8.33ecb","name":"Cozy time","func":"if(\n    msg.payload.name===\"Echo Dot do Quarto Nédi\" &&(\n    \n    msg.payload.description.summary.includes('vou')===true && \n    (\n    msg.payload.description.summary.includes('descansar')===true || \n    msg.payload.description.summary.includes('descansa')===true || \n    msg.payload.description.summary.includes('cama')===true\n    ))){\n\n    global.set(\"turnOffDelay\", true);\n    var newMsg;\n    newMsg = {\"payload\": {\"On\": true}};\n    return newMsg;\n    \n    \n    \n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":680,"wires":[["5790296f.677688","2741fe30.9edf62"]]},{"id":"cc00dde9.77d34","type":"comment","z":"554bb518.994efc","name":"Javascript helpers","info":"if(typeof Variable !== \"undefined\"){\n}","x":510,"y":620,"wires":[]},{"id":"4c385597.4d019c","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"8","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1200,"y":320,"wires":[["335a614.475419e"]]},{"id":"c7025749.a03158","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"8","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1660,"y":260,"wires":[["dea9e275.a6cd1","532bb30e.51d0dc"]]},{"id":"8d51d582.5ce628","type":"change","z":"859b066a.dd8128","name":"","rules":[{"t":"set","p":"botaoQuarto","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"turnOffDelay","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":960,"y":1380,"wires":[[]]},{"id":"bbc2df9b.e0d17","type":"change","z":"859b066a.dd8128","name":"","rules":[{"t":"set","p":"botaoQuarto","pt":"global","to":"true","tot":"bool"},{"t":"set","p":"turnOffDelay","pt":"global","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":780,"y":1440,"wires":[[]]},{"id":"bbdbe498.e75468","type":"function","z":"5767c936.cabd18","name":"auxCT","func":"if(flow.get(\"triggered2\")===true){\n    flow.set(\"triggered2\", false);\n    if(msg.payload.state.on === true){\n        flow.set(\"auxCT\",msg.payload.state.ct);\n        if(!msg.payload.state.ct){\n            flow.set(\"auxCT\",parseInt(msg.payload.raw.ct));\n        }\n        if(!msg.payload.raw.ct){\n            flow.set(\"auxCT\",6100);\n        }\n        flow.set(\"countBrightnessLuz\",msg.payload.state.bri);\n    }\n}","outputs":0,"noerr":0,"initialize":"","finalize":"","x":1250,"y":60,"wires":[]},{"id":"be6ae750.e08a88","type":"function","z":"e7cd1901.ee2408","name":"auxCT","func":"if(flow.get(\"triggered2\")=== true){\n    flow.set(\"triggered2\", false);\n    if(msg.payload.state.on === true){\n        flow.set(\"auxCT\",msg.payload.state.ct);\n        flow.set(\"countBrightness\",msg.payload.state.bri);\n    }\n}\n\n","outputs":0,"noerr":0,"initialize":"","finalize":"","x":1670,"y":340,"wires":[]},{"id":"b3cdb622.ddf5c8","type":"function","z":"d3db5d74.fb8fa","name":"Botão Quarto Nédi Click","func":"if(msg.payload.entity_id === \"binary_sensor.botao_quarto_nedi\" && msg.payload.event.click_type === \"single\"){\n\n    global.set(\"botaoQuarto\",true);\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":440,"wires":[["c1f2906e.f1bc6"]]},{"id":"c1f2906e.f1bc6","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Clique Quarto Nédi","links":["fda88def.b69f6","51fa6e7f.a5e2f"],"x":715,"y":440,"wires":[]},{"id":"e2812321.99f76","type":"function","z":"d3db5d74.fb8fa","name":"Botão Quarto Nédi Double","func":"if(msg.payload.entity_id === \"binary_sensor.botao_quarto_nedi\" && msg.payload.event.click_type === \"double\"){\n\n    \n    global.set(\"botaoQuarto\",true);\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"x":540,"y":480,"wires":[["3e659e3a.ee1442"]]},{"id":"3e659e3a.ee1442","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Duplo Clique Quarto Nédi","links":["9879af65.10ae48"],"x":715,"y":480,"wires":[]},{"id":"31339c0.ecc2764","type":"function","z":"d3db5d74.fb8fa","name":"Movimento Quarto Nédi","func":"if(msg.payload.entity_id === \"binary_sensor.movimento_quarto_nedi\"){\n        var newMsg;\n        newMsg = {payload:{On : true}};\n        return newMsg;\n}\n//sensor_motion.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":1140,"wires":[["e434c7b2.a0c848"]]},{"id":"e434c7b2.a0c848","type":"link out","z":"d3db5d74.fb8fa","name":"Movimento Quarto Nédi","links":["45668a49.9722e4","75fea52c.e1a99c"],"x":715,"y":1140,"wires":[]},{"id":"910ee8ec.c1bba8","type":"function","z":"d3db5d74.fb8fa","name":"Botão Cozy Time Click","func":"if(msg.payload.entity_id === \"binary_sensor.botao_cozy_time\" && msg.payload.event.click_type === \"single\"){\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":520,"wires":[["36ae8580.9cd94a"]]},{"id":"1849eadb.cfb485","type":"function","z":"d3db5d74.fb8fa","name":"Botão Cozy Time Double","func":"if(msg.payload.entity_id === \"binary_sensor.botao_cozy_time\" && msg.payload.event.click_type === \"double\"){\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":560,"wires":[["dffc58c5.987c58"]]},{"id":"36ae8580.9cd94a","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Clique Cozy Time","links":["56beed64.231ab4","2707961c.839a4a"],"x":715,"y":520,"wires":[]},{"id":"182aa26e.838abe","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Duplo Clique Cozy Time","links":["17b7df66.4128b1"],"x":835,"y":580,"wires":[]},{"id":"451128d7.e51fd8","type":"comment","z":"d3db5d74.fb8fa","name":"Mensagens do Aqara","info":"Clique do botão:\n\n    fromip: \"192.168.0.56:4321\"\n    ip: \"192.168.0.56\"\n    port: 4321\n    payload: object\n    cmd: \"report\"\n    model: \"sensor_switch.aq2\"\n    sid: \"158d00023e8629\"\n    params: array[1]\n    0: object\n    button_0: \"click\"\n    _msgid: \"1203d8b7.5ccdd7\"\n    \nDuplo clique do botão:\n    fromip: \"192.168.0.56:4321\"\n    ip: \"192.168.0.56\"\n    port: 4321\n    payload: object\n    cmd: \"report\"\n    model: \"sensor_switch.aq2\"\n    sid: \"158d00023e8629\"\n    params: array[1]\n    0: object\n    button_0: \"double_click\"\n    _msgid: \"ebe10ada.859dd8\"\n\nSensor de movimento:\n    fromip: \"192.168.0.56:4321\"\n    ip: \"192.168.0.56\"\n    port: 4321\n    payload: object\n    cmd: \"report\"\n    model: \"sensor_motion.aq2\"\n    sid: \"158d00035feb3d\"\n    params: array[2]\n    0: object\n    illumination: 0\n    1: object\n    lux: 0\n    _msgid: \"d9c2a184.98232\"\n    \n    fromip: \"192.168.0.56:4321\"\n    ip: \"192.168.0.56\"\n    port: 4321\n    payload: object\n    cmd: \"report\"\n    model: \"sensor_motion.aq2\"\n    sid: \"158d00035feb3d\"\n    params: array[1]\n    0: object\n    motion_status: \"motion\"\n    _msgid: \"f691105f.78934\"\n        ","x":240,"y":460,"wires":[]},{"id":"14440e93.eb1131","type":"link out","z":"d3db5d74.fb8fa","name":"Movimento Cozinha","links":["25bef91.7b6ff06"],"x":715,"y":1200,"wires":[]},{"id":"97ed078d.d825b8","type":"function","z":"d3db5d74.fb8fa","name":"Movimento Cozinha","func":"if(msg.payload.entity_id === \"binary_sensor.movimento_cozinha\"){\n        var newMsg;\n        newMsg = {payload:{On : true}};\n        return newMsg;\n}\n//sensor_motion.aq2","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":1200,"wires":[["14440e93.eb1131"]]},{"id":"b7edb068.d2035","type":"function","z":"d3db5d74.fb8fa","name":"Botão Sala Double","func":"if(msg.payload.entity_id === \"binary_sensor.botao_sala\"){\n    if(msg.payload.event.click_type === \"double\"){\n        return msg;\n    }\n}\n//remote.b286acn01\n\n","outputs":1,"noerr":0,"x":510,"y":740,"wires":[["4b42a86c.e9e038"]]},{"id":"38389231.38335e","type":"function","z":"d3db5d74.fb8fa","name":"Botão Sala Click","func":"if(msg.payload.entity_id === \"binary_sensor.botao_sala\"){\n    if(msg.payload.event.click_type === \"single\"){\n        return msg;\n    }\n}\n//remote.b286acn01\n\n","outputs":1,"noerr":0,"x":500,"y":700,"wires":[["45609596.267fbc"]]},{"id":"45609596.267fbc","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Clique Sala","links":["89389c62.930d4"],"x":715,"y":700,"wires":[]},{"id":"4b42a86c.e9e038","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Duplo Clique Sala","links":["a1715e17.4597b"],"x":715,"y":740,"wires":[]},{"id":"968300f.8aadb","type":"function","z":"d3db5d74.fb8fa","name":"Porta Fechada","func":"if(msg.topic === \"binary_sensor.porta_banheiro\"){\n    if(msg.payload === false){\n        global.set(\"portaAbertaBanheiro\",false);\n        //abriu\n        return msg;\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":1780,"wires":[["a1db54df.1c33d8"]]},{"id":"8cd6b99e.6b2b18","type":"function","z":"d3db5d74.fb8fa","name":"Porta Aberta","func":"if(msg.topic === \"binary_sensor.porta_banheiro\"){\n    if(msg.payload === true){\n        global.set(\"portaAbertaBanheiro\",true);\n        msg = {payload: {ContactSensorState : false}}\n        //abriu\n        return msg;\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":510,"y":1720,"wires":[["42528d90.963b34"]]},{"id":"42528d90.963b34","type":"link out","z":"d3db5d74.fb8fa","name":"Porta Banheiro Aberta","links":["afeb6c53.3a416","c21ba8da.c2fe28","2888f5bb.ace53a"],"x":715,"y":1720,"wires":[]},{"id":"a1db54df.1c33d8","type":"link out","z":"d3db5d74.fb8fa","name":"Porta Banheiro Fechada","links":["9c30b842.8e9818","939f7c5f.f82bb"],"x":715,"y":1780,"wires":[]},{"id":"f762ec29.df263","type":"function","z":"d3db5d74.fb8fa","name":"Botão Escritório Double","func":"if(msg.payload.entity_id === \"binary_sensor.botao_escritorio\"){\n    if(msg.payload.event.click_type === \"double\"){\n        return msg;\n    }\n}\n//remote.b286acn01\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":820,"wires":[["1b8c3fb3.a193c"]]},{"id":"153e6887.fab7b7","type":"function","z":"d3db5d74.fb8fa","name":"Botão Escritório Click","func":"if(msg.payload.entity_id === \"binary_sensor.botao_escritorio\"){\n    if(msg.payload.event.click_type === \"single\"){\n        return msg;\n    }\n}\n//remote.b286acn01\n\n","outputs":1,"noerr":0,"x":520,"y":780,"wires":[["d7eca66b.88bb28"]]},{"id":"d7eca66b.88bb28","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Clique Escritorio","links":["6e3aee4a.c5c39","62256981.1a5a98"],"x":715,"y":780,"wires":[]},{"id":"1b8c3fb3.a193c","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Duplo Clique Escritorio","links":["a1715e17.4597b"],"x":715,"y":820,"wires":[]},{"id":"debd4025.dcc25","type":"function","z":"d3db5d74.fb8fa","name":"Botão Entrada Double","func":"if(msg.payload.entity_id === \"binary_sensor.botao_entrada\" && msg.payload.event.click_type === \"double\"){\n\n    global.set(\"botaoBanheiro\", true);\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":900,"wires":[["d57439e1.373828"]]},{"id":"bbc954fe.34ca28","type":"function","z":"d3db5d74.fb8fa","name":"Botão Entrada Click","func":"if(msg.payload.entity_id === \"binary_sensor.botao_entrada\" && msg.payload.event.click_type === \"single\"){\n\n    global.set(\"botaoBanheiro\", true);\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":860,"wires":[["9e3b29f6.ffe448"]]},{"id":"9e3b29f6.ffe448","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Clique Entrada","links":["6e3aee4a.c5c39","89389c62.930d4","62256981.1a5a98"],"x":715,"y":860,"wires":[]},{"id":"d57439e1.373828","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Duplo Clique Entrada","links":["5ff82e19.d35f4","381169a.db1de96"],"x":715,"y":900,"wires":[]},{"id":"7a2d4a63.4ad274","type":"link in","z":"2bbba447.a4759c","name":"Botao Banheiro","links":[],"x":115,"y":329,"wires":[["78d25414.be2c8c"]]},{"id":"c21ba8da.c2fe28","type":"link in","z":"2bbba447.a4759c","name":"Porta Banheiro Aberta","links":["42528d90.963b34"],"x":115,"y":389,"wires":[["78d25414.be2c8c"]]},{"id":"89389c62.930d4","type":"link in","z":"e7cd1901.ee2408","name":"Botao Clique Sala","links":["45609596.267fbc","9e3b29f6.ffe448"],"x":275,"y":1020,"wires":[["71ba2d22.7c82a4"]]},{"id":"6e3aee4a.c5c39","type":"link in","z":"5767c936.cabd18","name":"Botao Clique Escritorio ","links":["d7eca66b.88bb28","9e3b29f6.ffe448"],"x":275,"y":940,"wires":[["3914d48b.1018fc"]]},{"id":"36bb604a.83da8","type":"function","z":"d3db5d74.fb8fa","name":"","func":"if(msg.payload.event.entity_id === \"binary_sensor.vibration\"){\n    if(msg.payload.event.new_state.state === \"on\"){\n        //movimento\n    }\n    if(msg.payload.event.new_state.state === \"off\"){\n        //movimento parou\n        \n    }\n    return msg;\n}\n//vibration.aq1\n","outputs":1,"noerr":0,"x":440,"y":1860,"wires":[[]]},{"id":"a78b03ac.299d4","type":"change","z":"2bbba447.a4759c","name":"set aux","rules":[{"t":"set","p":"auxEmissorBanheiro","pt":"global","to":"Alexa","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":240,"wires":[["250ab27.747084e"]]},{"id":"1aae8118.22a5ff","type":"change","z":"2bbba447.a4759c","name":"set aux","rules":[{"t":"set","p":"auxEmissorBanheiro","pt":"global","to":"Alexa","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":280,"wires":[["b4038cea.b3677"]]},{"id":"9c30b842.8e9818","type":"link in","z":"2bbba447.a4759c","name":"Porta Fechada","links":["a1db54df.1c33d8"],"x":1415,"y":580,"wires":[["e02f792c.1a72b8","5f7a4469.0f7a3c"]]},{"id":"afeb6c53.3a416","type":"link in","z":"2bbba447.a4759c","name":"Porta Banheiro Aberta","links":["42528d90.963b34","2cac04a0.1e088c"],"x":1575,"y":480,"wires":[["c4a667ef.36ae08"]]},{"id":"c4a667ef.36ae08","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1690,"y":480,"wires":[["48a71a45.f09914"]]},{"id":"5f7a4469.0f7a3c","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1570,"y":580,"wires":[["91868a33.c4af98"]]},{"id":"30922957.6bfc26","type":"function","z":"2bbba447.a4759c","name":"Triggered?","func":"if(flow.get(\"triggered1\")===true){\n    flow.set(\"triggered1\", false);\n    return msg;\n}","outputs":1,"noerr":0,"x":1010,"y":300,"wires":[["d851d997.3c2738"]]},{"id":"f39ad338.f1792","type":"function","z":"2bbba447.a4759c","name":"Triggered?","func":"if(flow.get(\"triggered1\")===true){\n    flow.set(\"triggered1\", false);\n    return msg;\n}","outputs":1,"noerr":0,"x":1010,"y":360,"wires":[["d851d997.3c2738"]]},{"id":"aa48fad2.d67908","type":"change","z":"e7cd1901.ee2408","name":"","rules":[{"t":"set","p":"triggered2","pt":"flow","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"status\":\"status\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":340,"wires":[["3db30869.31be08"]]},{"id":"2389b8f5.93f1f8","type":"change","z":"e7cd1901.ee2408","name":"","rules":[{"t":"set","p":"triggered1","pt":"flow","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"status\":\"status\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1460,"y":260,"wires":[["c7025749.a03158"]]},{"id":"c7ff1e9c.b4318","type":"change","z":"e7cd1901.ee2408","name":"","rules":[{"t":"set","p":"triggered3","pt":"flow","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"status\":\"status\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":1000,"wires":[["b0f9627e.ecf18","d701e49c.510258"]]},{"id":"b0fd8aa9.65c008","type":"function","z":"e7cd1901.ee2408","name":"Add Topic","func":"var newMsg;\nif(typeof msg.ajuda !== \"undefined\"){\n    if(msg.ajuda === 1){\n        newMsg = {\"topic\":\"LuzSala\", \"payload\": false};\n        flow.set(\"triggered3\", false);\n        return newMsg;\n    }\n}\nif(flow.get(\"triggered3\")===true){\n    flow.set(\"triggered3\", false);\n        if(msg.payload.state.on === true)\n        {\n            newMsg = {\"topic\":\"LuzSala\", \"payload\": true};\n            return newMsg;\n        }\n        if(msg.payload.state.on === false)\n        {\n            newMsg = {\"topic\":\"LuzSala\",\"payload\": false};\n            return newMsg;\n        }\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1140,"y":1000,"wires":[["b6f15c21.550fa"]]},{"id":"5d67fe55.6d3b9","type":"function","z":"5767c936.cabd18","name":"Add Topic","func":"var newMsg;\nif(typeof msg.ajuda !== \"undefined\"){\n    if(msg.ajuda === 1){\n        newMsg = {\"topic\":\"Luz1\", \"payload\": false};\n        flow.set(\"triggered3\", false);\n        return newMsg;\n    }\n}\nif(flow.get(\"triggered3\")===true){\n    flow.set(\"triggered3\", false);\n    if(msg.payload.state.on === true)\n    {\n        newMsg = {\"topic\":\"Luz1\", \"payload\": true};\n        return newMsg;\n    }\n    if(msg.payload.state.on === false)\n    {\n        newMsg = {\"topic\":\"Luz1\",\"payload\": false};\n        return newMsg;\n    }\n\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1100,"y":840,"wires":[["5d29cf32.e961"]]},{"id":"684afb0c.39a754","type":"change","z":"5767c936.cabd18","name":"","rules":[{"t":"set","p":"triggered3","pt":"flow","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"status\":\"status\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":840,"wires":[["7bf37992.695728","a66eb3dd.9d41a"]]},{"id":"62da1cb0.8b2cd4","type":"change","z":"5767c936.cabd18","name":"","rules":[{"t":"set","p":"triggered2","pt":"flow","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"status\":\"status\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":840,"y":60,"wires":[["4cbb11d6.ab35"]]},{"id":"335a614.475419e","type":"change","z":"5767c936.cabd18","name":"","rules":[{"t":"set","p":"triggered1","pt":"flow","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"status\":\"status\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1380,"y":320,"wires":[["41b9df88.d6a34","fc28320f.6df3"]]},{"id":"9d786bf9.924af8","type":"function","z":"5767c936.cabd18","name":"was triggered?","func":"if(flow.get(\"triggered1\")===true){\n    flow.set(\"triggered1\", false);\n    var newMsg;\n    if(msg.payload.state.on === true){\n        newMsg = {payload:{state:{bri:msg.payload.state.bri,\n                                  ct: msg.payload.state.ct\n                                  }\n                            },\n                            came: \"Yeelight\"\n        };\n        return newMsg;\n    }\n    if(msg.payload.state.on === false){\n        newMsg = {payload:{resetar: true}};\n        return newMsg;\n    }\n}","outputs":1,"noerr":0,"x":1800,"y":340,"wires":[["7ac2d25c.e13b9c"]]},{"id":"5eb62a84.b20844","type":"function","z":"859b066a.dd8128","name":"","func":"var newMsg;\nnewMsg = {payload:\"on\",\n          data:{attributes:{brightness: 10}}};\nreturn newMsg;","outputs":1,"noerr":0,"x":410,"y":1280,"wires":[["c3c08b63.f7a388","67394ee5.2f77f","680d3cd7.7b3284"]]},{"id":"99a5588e.1075d8","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"if(msg.payload === true ){\n    global.set(\"quartoOn\",false);\n    var newMsg;\n    newMsg = {payload : {}};\n    newMsg.payload.On = false;\n    return newMsg;\n}","outputs":1,"noerr":0,"x":2645,"y":1160,"wires":[["75ef8d3.e961874","87921bf9.d6ed98","d3e1203d.5d95a","92015d19.b3c1e"]]},{"id":"5a4c186.69fb7e8","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"if(msg.payload === false){\n        \n    global.set(\"quartoOn\",true);\n    var newMsg;\n    newMsg = {payload : {}};\n    newMsg.payload.On = true;\n    return newMsg;\n}","outputs":1,"noerr":0,"x":2640,"y":1220,"wires":[["afab0c06.ceb72","7332e558.4e464c","711a179a.c64f68"]]},{"id":"ba1ec2e9.d82c8","type":"mqtt out","z":"859b066a.dd8128","name":"setOn RGB Strip","topic":"QuartoNedi/setOnRGB","qos":"","retain":"","broker":"64936db9.640564","x":3210,"y":1120,"wires":[]},{"id":"75ef8d3.e961874","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"msg = {payload:0};\nreturn msg;","outputs":1,"noerr":0,"x":3000,"y":1120,"wires":[["ba1ec2e9.d82c8"]]},{"id":"dffc58c5.987c58","type":"function","z":"d3db5d74.fb8fa","name":"Turn On","func":"msg.payload = {\"On\":true};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":720,"y":580,"wires":[["182aa26e.838abe"]]},{"id":"40f34731.622338","type":"comment","z":"859b066a.dd8128","name":"Se luz do quarto estiver ligada baixinho, aumentar o brilho","info":"","x":2270,"y":1540,"wires":[]},{"id":"1bf5970a.d99939","type":"function","z":"859b066a.dd8128","name":"","func":"if(msg.payload === true){\n        if(msg.data.attributes.brightness < 128)\n        {\n            msg.ajuda = 1;\n            return msg;\n        }\n        else{\n            \n            msg.ajuda = 2;\n            return msg;\n        }\n}\nelse{\n    \n            msg.ajuda = 1;\n            return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":780,"y":1240,"wires":[["e7d4293b.647048","6adec2d1.8d8afc"]]},{"id":"7a532c43.3150c4","type":"switch","z":"859b066a.dd8128","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"2","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":1190,"y":1240,"wires":[["7a7d2b89.5f2054","74c414e5.0afb0c","97a94c63.cf63d","8a64803e.2782f","bd1f6328.84ca2","5cf7e8e4.b41938"],["df7f6951.f1f2f8"]]},{"id":"b388fc68.7a0cc","type":"function","z":"859b066a.dd8128","d":true,"name":"","func":"var aux = [{},{},{}]\naux[0].entity = \"Luz do Quarto\";\naux[0].action = \"setColorTemperature\";\naux[0].value = \"cool\";\n\naux[1].entity = \"Luz do Quarto\";\naux[1].action = \"setBrightness\";\naux[1].value = 100;\n\naux[2].entity = \"Luz do Quarto\";\naux[2].action = \"turnOn\";\n\nmsg.payload = aux;\nreturn msg;","outputs":1,"noerr":0,"x":1730,"y":1540,"wires":[["52bf523a.a2e16c"]]},{"id":"3c7f99bb.540f26","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"msg.payload = {};\nmsg.payload.On = true;\nreturn msg;","outputs":1,"noerr":0,"x":1730,"y":1480,"wires":[[]]},{"id":"7a7d2b89.5f2054","type":"function","z":"859b066a.dd8128","name":"Luz do Quarto Topic","func":"var newMsg;\nif(msg.payload === true)\n{\n    global.set(\"quartoOn\",true);\n    newMsg = {\"topic\":\"Luz\",\"payload\": true};\n    return newMsg;\n}\nif(msg.payload === false)\n{\n    newMsg = {\"topic\":\"Luz\",\"payload\": false};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1440,"y":1340,"wires":[["5c2709a1.4dc318"]]},{"id":"4cf5516a.7f55","type":"function","z":"859b066a.dd8128","name":"","func":"var newMsg;\nif(msg.payload.On === true)\n{\n    global.set(\"quartoOn\",true);\n    newMsg = {\"topic\":\"Projetor Ceu\",\"payload\": true};\n    return newMsg;\n}\nif(msg.payload.On === false)\n{\n    newMsg = {\"topic\":\"Projetor Ceu\",\"payload\": false};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1700,"y":1280,"wires":[["bc66085.c4e0af8"]]},{"id":"ce1bcdf1.593cb","type":"function","z":"859b066a.dd8128","name":"","func":"var newMsg;\nif(msg.payload === true){\n        newMsg = {\"topic\":\"RGB Strip\",\n                \"payload\": true\n        };\n        return newMsg;\n    \n}\nif(msg.payload ===false){\n        newMsg = {\"topic\":\"RGB Strip\",\n                \"payload\": false\n        };\n        return newMsg;\n    \n}\nvar homeassistant = global.get(\"homeassistant\");\nif(homeassistant.homeAssistant.states[\"light.rgb_strip\"].state === \"on\"){\n        newMsg = {\"topic\":\"RGB Strip\",\n                \"payload\": true\n        };\n        return newMsg;\n}\nelse{\n        newMsg = {\"topic\":\"RGB Strip\",\n                \"payload\": false\n        };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1700,"y":1160,"wires":[["87b5da0b.2e59c8"]]},{"id":"87b5da0b.2e59c8","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1860,"y":1160,"wires":[["980435a0.32ea78"]]},{"id":"bc66085.c4e0af8","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1860,"y":1280,"wires":[["980435a0.32ea78"]]},{"id":"5c2709a1.4dc318","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1860,"y":1340,"wires":[["980435a0.32ea78"]]},{"id":"703ec7a2.e01c68","type":"function","z":"5767c936.cabd18","name":"Turn Off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg = {payload : {\"on\": false}};\n    global.set(\"EscritorioOn\", false);\n    global.set(\"EscritorioEscuro\", false);\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2100,"y":880,"wires":[["d7677e76.e2922","3c34f863.bc1ac8","2c5d9c1c.9be264","6f5b3cf0.be2454"]]},{"id":"5bbc4c76.3271a4","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2310,"y":1100,"wires":[]},{"id":"9c786f0f.566a","type":"inject","z":"e7cd1901.ee2408","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":260,"y":1120,"wires":[["71ba2d22.7c82a4"]]},{"id":"2f79ea48.43b926","type":"inject","z":"5767c936.cabd18","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":260,"y":1000,"wires":[["3914d48b.1018fc"]]},{"id":"7bf37992.695728","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":810,"y":780,"wires":[["c1a0492a.9440f8"]]},{"id":"c1a0492a.9440f8","type":"function","z":"5767c936.cabd18","name":"In Case of Error","func":"msg.ajuda = 1;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":980,"y":780,"wires":[["5d67fe55.6d3b9"]]},{"id":"4e1799e9.3bd0f8","type":"function","z":"e7cd1901.ee2408","name":"In Case of Error","func":"msg.ajuda = 1;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":980,"y":960,"wires":[["b0fd8aa9.65c008"]]},{"id":"b0f9627e.ecf18","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":810,"y":960,"wires":[["4e1799e9.3bd0f8"]]},{"id":"d64c8331.8f764","type":"debug","z":"5767c936.cabd18","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1750,"y":860,"wires":[]},{"id":"67394ee5.2f77f","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":610,"y":1300,"wires":[["1bf5970a.d99939"]]},{"id":"da6218d6.54b928","type":"function","z":"859b066a.dd8128","name":"","func":"flow.set(\"respondeu\", true);\nreturn msg;","outputs":1,"noerr":0,"x":770,"y":1180,"wires":[[]]},{"id":"d29ab4df.b0de28","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2475,"y":1160,"wires":[["99a5588e.1075d8"]]},{"id":"a50d5f5c.46e0d","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2480,"y":1220,"wires":[["5a4c186.69fb7e8"]]},{"id":"df7f6951.f1f2f8","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1420,"y":1420,"wires":[["3c7f99bb.540f26","b388fc68.7a0cc","a4c1d4c6.6d3728"]]},{"id":"e7d4293b.647048","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":980,"y":1240,"wires":[["7a532c43.3150c4"]]},{"id":"f4e44398.a95af","type":"debug","z":"2bbba447.a4759c","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3090,"y":300,"wires":[]},{"id":"a2739762.e57528","type":"debug","z":"2bbba447.a4759c","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3090,"y":180,"wires":[]},{"id":"3e5f80d2.529f1","type":"link out","z":"d3db5d74.fb8fa","name":"Movimento Escritório","links":["291b7897.febc08","dacc485e.2fb2e8","b3061b2a.42a488"],"x":715,"y":1340,"wires":[]},{"id":"87bc8837.99e6a8","type":"function","z":"d3db5d74.fb8fa","name":"Movimento Escritório","func":"if(msg.payload.entity_id === \"binary_sensor.movimento_escritorio\"){\n    var newMsg = {payload: {MotionDetected: true}}\n    return newMsg;\n}\n//sensor_motion.aq2","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":1340,"wires":[["3e5f80d2.529f1"]]},{"id":"95d42658.d910a8","type":"trigger","z":"5767c936.cabd18","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-30","extend":false,"overrideDelay":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":910,"y":1720,"wires":[["fc6f1fdc.13022","f7746f7c.67576"]]},{"id":"fc6f1fdc.13022","type":"function","z":"5767c936.cabd18","name":"Cont++","func":"var contEscritorio = global.get(\"contEscritorio\");\nif(msg.payload.MotionDetected === true){\n    global.set(\"contEscritorio\", 0);   \n    node.send(msg);\n    node.status({fill:\"green\",shape:\"dot\",text:\"Movimento no Escritório\"});\n\n}\nelse{\n    if(contEscritorio >= 2700){\n        msg.reset = 1;\n        global.set(\"contEscritorio\", 2700)\n        global.set(\"overrideEscritorio\",false);\n        node.send(msg);\n        node.status({fill:\"green\",shape:\"dot\",text:\"Sem movimento, \"});\n        \n    }\n    else{\n        global.set(\"contEscritorio\", contEscritorio+30);\n        node.status({fill:\"green\",shape:\"dot\",text:\"cont\"+(contEscritorio+30)});\n    }\n}\nsetTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);\n    \n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":930,"y":1640,"wires":[["c6329c13.8e51a","48b7cd69.dc86b4"]]},{"id":"9ee7bdef.1a795","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":590,"y":1640,"wires":[["918b34b6.280628"]]},{"id":"291b7897.febc08","type":"link in","z":"5767c936.cabd18","name":"Movimento Escritório","links":["1f03bb0a.233655","3e5f80d2.529f1"],"x":335,"y":1640,"wires":[["9ee7bdef.1a795"]]},{"id":"6db289b5.2e7be8","type":"link in","z":"4c9c764d.9c4468","name":"Movimento Escritório Escuro","links":["9197a5aa.eb55d8","cc911481.98c798"],"x":955,"y":720,"wires":[["55f5a77a.253908"]]},{"id":"9197a5aa.eb55d8","type":"link out","z":"5767c936.cabd18","name":"Escritorio Movimento Escuro","links":["6db289b5.2e7be8"],"x":1295,"y":1640,"wires":[]},{"id":"48b7cd69.dc86b4","type":"function","z":"5767c936.cabd18","name":"Motion Detected","func":"if(msg.payload.MotionDetected === true){\n    if(!msg.reset){\n        if(global.get(\"escritorioEscuro\")===true && global.get(\"EscritorioOn\")=== false){\n            if(global.get(\"auxTurnOnEscritorio\") === true){ \n                global.set(\"auxTurnOnEscritorio\", false);\n                global.set(\"overrideEscritorio\",true);\n                return msg;\n            } \n        }\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1160,"y":1640,"wires":[["9197a5aa.eb55d8"]]},{"id":"817677be.bad9f8","type":"link in","z":"d67ca66.293d758","name":"LuminariaOnOff","links":["9692d760.196b88","d6f65d1a.11585"],"x":545,"y":280,"wires":[["3839ca65.d6d486"]]},{"id":"8c0cc7c1.3bbbb8","type":"function","z":"d67ca66.293d758","name":"","func":"var newMsg\n    if(msg.payload.On === true){\n        newMsg = {\"payload\" : {\n            \n          \"domain\": \"switch\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"switch.luminaria_direita\"\n\n        }};\n        node.send(newMsg);\n        \n        newMsg = {\"payload\" : {\n            \n          \"domain\": \"switch\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"switch.luminaria_esquerda\"\n\n        }};\n        node.send(newMsg);\n        //return newMsg;\n    }\n    if(msg.payload.On === false){\n        newMsg = {\"payload\" : {\n            \n          \"domain\": \"switch\",\n          \"service\": \"turn_off\",\n          \"entity_id\": \"switch.luminaria_esquerda\"\n\n        }};\n        node.send(newMsg);\n        newMsg = {\"payload\" : {\n            \n          \"domain\": \"switch\",\n          \"service\": \"turn_off\",\n          \"entity_id\": \"switch.luminaria_direita\"\n\n        }};\n        node.send(newMsg);\n        return newMsg;\n        }\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":840,"y":280,"wires":[["f057b86c.5276b8"]]},{"id":"3839ca65.d6d486","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":660,"y":280,"wires":[["8c0cc7c1.3bbbb8"]]},{"id":"a82fb664.7fec48","type":"link out","z":"e7cd1901.ee2408","name":"TunelOnOff","links":["33f61486.af8adc"],"x":695,"y":460,"wires":[]},{"id":"9692d760.196b88","type":"link out","z":"5767c936.cabd18","name":"LuminariaOn","links":["817677be.bad9f8"],"x":1315,"y":460,"wires":[]},{"id":"e340c5bc.183728","type":"link in","z":"4c9c764d.9c4468","name":"Sun down","links":["ea8f030f.c171c","e22ed624.8805a8"],"x":955,"y":660,"wires":[["55f5a77a.253908"]]},{"id":"e02f792c.1a72b8","type":"function","z":"2bbba447.a4759c","name":"Aberto Muito Tempo","func":"var abertoMuitoTempo = global.get(\"abertoMuitoTempo\");\nif(msg.payload.ContactSensorState === false){\n    if(abertoMuitoTempo === true){\n        global.set(\"auxEmissorBanheiro\", \"Yeelight\");\n        global.set(\"isOnBanheiro\", false);\n        msg.ajuda = 1;\n        return msg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1600,"y":440,"wires":[["b4038cea.b3677"]]},{"id":"962c7f2a.f157e","type":"switch","z":"2bbba447.a4759c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"off","vt":"str"},{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":2210,"y":420,"wires":[["3665f12e.70f2ee","1004281c.91e608"],["13788a95.fdf4b5"]]},{"id":"2e96e8b1.fd1438","type":"comment","z":"2bbba447.a4759c","name":"Se a porta fecha com a luz desligada há muito tempo, a luz liga","info":"","x":1810,"y":620,"wires":[]},{"id":"a8183221.9ddba","type":"comment","z":"2bbba447.a4759c","name":"Se a porta fica aberta com a luz ligada há muito tempo, a luz desliga","info":"","x":1820,"y":660,"wires":[]},{"id":"c2a88c88.89825","type":"comment","z":"2bbba447.a4759c","name":"Botão foi clicado","info":"","x":180,"y":269,"wires":[]},{"id":"32a486b0.f5765a","type":"comment","z":"2bbba447.a4759c","name":"A porta foi aberta.","info":"","x":190,"y":449,"wires":[]},{"id":"dea6b65d.76e218","type":"comment","z":"2bbba447.a4759c","name":"Check se a luz do banheiro está ligada","info":"","x":810,"y":120,"wires":[]},{"id":"15f12ff4.d0e12","type":"comment","z":"2bbba447.a4759c","name":"Liga ou desliga a luz conforme a lógica","info":"","x":2870,"y":140,"wires":[]},{"id":"918b34b6.280628","type":"function","z":"5767c936.cabd18","name":"Start Cont","func":"if(msg.payload.MotionDetected === true){\n    if(global.set(\"contEscritorio\") > 1500){        \n        if(global.get(\"auxTurnOnEscritorio\") === false){ \n            global.set(\"auxTurnOnEscritorio\", true);\n        }\n}\n}\nglobal.set(\"contEscritorio\", 0);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":770,"y":1640,"wires":[["fc6f1fdc.13022"]]},{"id":"1004281c.91e608","type":"function","z":"2bbba447.a4759c","name":"Turn On Verde","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nglobal.set(\"BanheiroOcupado\", false);\nif(Hour < 20 && Hour > 6){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \"entity_id\": \"light.aqara_hub\",\n            \"brightness\": 6,\n            \"rgb_color\": [0,10,0]\n        }\n    }};\n    newMsg.delay = 600000\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2700,"y":480,"wires":[["5420eb2f.585104","2bf5265d.fc73fa"]]},{"id":"13788a95.fdf4b5","type":"function","z":"2bbba447.a4759c","name":"Turn On Vermelho","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nglobal.set(\"BanheiroOcupado\", true);\n\nif(Hour < 20 && Hour > 6){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \"entity_id\": \"light.aqara_hub\",\n            \"brightness\": 6,\n            \"rgb_color\": [10,0,0]\n        }\n    }};\n    newMsg.delay = 600000;\n    \n    return newMsg;\n} ","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2710,"y":600,"wires":[["5420eb2f.585104","2bf5265d.fc73fa"]]},{"id":"81a6fdf6.25452","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":730,"y":1120,"wires":[]},{"id":"f97d7621.b40a68","type":"inject","z":"859b066a.dd8128","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":320,"y":1140,"wires":[["5eb62a84.b20844"]]},{"id":"5dbf333.b939dcc","type":"function","z":"444fced8.33ecb","name":"Hora do Filme","func":"if(\n    \n    msg.payload.name===\"Echo Dot da Sala\" &&(\n    msg.payload.description.summary.includes('hora do filme')===true||\n    msg.payload.description.summary.includes('filme')===true\n    \n    )){\n    var newMsg;\n    newMsg = {\"payload\": {\"horaDoFilme\": true}};\n    global.set(\"boaNoiteCasa\", false)\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":1780,"wires":[["c2eda9b.cf38a58","41cbc1bd.13f36"]]},{"id":"c2eda9b.cf38a58","type":"link out","z":"444fced8.33ecb","name":"Hora do filme","links":["a3cf5b54.d11ca8"],"x":735,"y":1780,"wires":[]},{"id":"a3cf5b54.d11ca8","type":"link in","z":"4c9c764d.9c4468","name":"Hora do Filme","links":["c2eda9b.cf38a58","9a1c72b3.da05c"],"x":815,"y":1060,"wires":[["19554fb4.898e3","7fd58a3e.124184","fdb87cd7.4a536","c4d0a5ba.4a5f78","d86e7a62.6c6db8"]]},{"id":"247b7d18.10da82","type":"function","z":"444fced8.33ecb","name":"Luz do Quarto On/Off","func":"var newMsg;\nif(msg.payload.description.summary.includes('liga a luz do quarto')===true||\n    msg.payload.description.summary.includes('acende luz do quarto')===true||\n    msg.payload.description.summary.includes('liga luz do quarto')===true||\n    msg.payload.description.summary.includes('liga as luzes do quarto')===true||\n    msg.payload.description.summary.includes('liga luzes do quarto')===true ||\n    msg.payload.description.summary.includes('ligar a luz do quarto')===true||\n    msg.payload.description.summary.includes('ligar luz do quarto')===true||\n    msg.payload.description.summary.includes('ligar as luzes do quarto')===true||\n    msg.payload.description.summary.includes('ligar luzes do quarto')===true ||\n    msg.payload.description.summary.includes('acende a luz do quarto')===true||\n    msg.payload.description.summary.includes('acende as luzes do quarto')===true||\n    msg.payload.description.summary.includes('ligue a luz do quarto')===true||\n    msg.payload.description.summary.includes('ligue luz do quarto')===true||\n    msg.payload.description.summary.includes('ligue as luzes do quarto')===true||\n    msg.payload.description.summary.includes('ligue luzes do quarto')===true ||\n    (msg.payload.name===\"Echo Dot do Quarto Nédi\" &&\n       (\n       msg.payload.description.summary.includes('acende a luz')===true ||\n       msg.payload.description.summary.includes('liga a luz')===true ||\n       msg.payload.description.summary.includes('liga luz')===true||\n       msg.payload.description.summary.includes('liga luzes')===true ||\n       msg.payload.description.summary.includes('liga as luzes')===true ||\n       msg.payload.description.summary.includes('ligar a luz')===true ||\n       msg.payload.description.summary.includes('ligar luz')===true||\n       msg.payload.description.summary.includes('ligar luzes')===true ||\n       msg.payload.description.summary.includes('ligar as luzes')===true||\n       msg.payload.description.summary.includes('ligue a luz')===true ||\n       msg.payload.description.summary.includes('ligue luz')===true||\n       msg.payload.description.summary.includes('ligue luzes')===true ||\n       msg.payload.description.summary.includes('ligue as luzes')===true\n       )) &&\n       msg.payload.description.summary.includes('desliga') === false &&\n       msg.payload.description.summary.includes('desligue') === false &&\n       msg.payload.description.summary.includes('desligar') === false &&\n       msg.payload.description.summary.includes('apaga') === false &&\n       msg.payload.description.summary.includes('apagar') === false &&\n       msg.payload.description.summary.includes('apague') === false\n    ){\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_nedi\",\n            \"rgb_color\": [255, 255, 255],\n            \"brightness\": 255,\n            \"transition\": 20\n        }\n    }};\n    \n    return newMsg;\n}\nif(msg.payload.description.summary.includes('desliga a luz do quarto')===true||\n    msg.payload.description.summary.includes('desliga luz do quarto')===true||\n    msg.payload.description.summary.includes('desliga as luzes do quarto')===true||\n    msg.payload.description.summary.includes('desliga luzes do quarto')===true ||\n    msg.payload.description.summary.includes('desligar a luz do quarto')===true||\n    msg.payload.description.summary.includes('desligar luz do quarto')===true||\n    msg.payload.description.summary.includes('desligar as luzes do quarto')===true||\n    msg.payload.description.summary.includes('desligar luzes do quarto')===true ||\n    msg.payload.description.summary.includes('desligue a luz do quarto')===true||\n    msg.payload.description.summary.includes('desligue luz do quarto')===true||\n    msg.payload.description.summary.includes('desligue as luzes do quarto')===true||\n    msg.payload.description.summary.includes('desligue luzes do quarto')===true ||\n    (msg.payload.name===\"Echo Dot do Quarto Nédi\" &&\n       (\n       msg.payload.description.summary.includes('desliga a luz')===true ||\n       msg.payload.description.summary.includes('desliga luz')===true||\n       msg.payload.description.summary.includes('desliga luzes')===true ||\n       msg.payload.description.summary.includes('desliga as luzes')===true ||\n       msg.payload.description.summary.includes('desligar a luz')===true ||\n       msg.payload.description.summary.includes('desligar luz')===true||\n       msg.payload.description.summary.includes('desligar luzes')===true ||\n       msg.payload.description.summary.includes('desligar as luzes')===true || \n       msg.payload.description.summary.includes('desligue a luz')===true ||\n       msg.payload.description.summary.includes('desligue luz')===true||\n       msg.payload.description.summary.includes('desligue luzes')===true ||\n       msg.payload.description.summary.includes('desligue as luzes')===true\n       ))\n    ){\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"light.luz_do_quarto_nedi\"\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":540,"y":600,"wires":[["d49ef7c3.77a7c8","5790296f.677688"]]},{"id":"ef9cc054.943","type":"function","z":"d67ca66.293d758","name":"Sunset","func":"\nif(msg.data.new_state.attributes.elevation < 4){\n        return msg;\n}\n//Sunset","outputs":1,"noerr":0,"x":470,"y":880,"wires":[["ff66883f.0ea258","f7d3c69.eeaf438"]]},{"id":"f7d3c69.eeaf438","type":"function","z":"d67ca66.293d758","name":"","func":"msg.payload = \"Sunset \" + msg.data.new_state.attributes.elevation;\nmsg.topic = \"Sunset\";\nglobal.set(\"salaEscura\", true);\nglobal.set(\"escritorioEscuro\", true);\nreturn msg;","outputs":1,"noerr":0,"x":620,"y":860,"wires":[["e22ed624.8805a8"]]},{"id":"ff66883f.0ea258","type":"debug","z":"d67ca66.293d758","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":600,"y":920,"wires":[]},{"id":"e22ed624.8805a8","type":"link out","z":"d67ca66.293d758","name":"Sun down","links":["e340c5bc.183728"],"x":725,"y":860,"wires":[]},{"id":"dcf3f583.9a5608","type":"inject","z":"2bbba447.a4759c","name":"Passou das 20h","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 20 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":2930,"y":460,"wires":[["a1e68de0.e2c7"]]},{"id":"6cc082a4.cebc2c","type":"function","z":"444fced8.33ecb","name":"Globo","func":"if(\n   (msg.payload.name===\"Echo Dot da Sala\" && \n    msg.payload.description.summary.includes('globo')===true ||\n    msg.payload.description.summary.includes('novela')===true||\n    msg.payload.description.summary.includes('jornal')===true\n    )\n   ){\n    var newMsg;\n    global.set(\"boaNoiteCasa\", false)\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_on\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_TV\"\n        }\n    }\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\",\n            \"media_content_id\": 12,\n            \"media_content_type\": \"channel\"\n        }\n    }};\n    \n    node.send(newMsg);\n    return;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":490,"y":2100,"wires":[["4be760da.d877"]]},{"id":"ddad8255.72c54","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3100,"y":420,"wires":[["7786e05.84eaa2"]]},{"id":"7786e05.84eaa2","type":"function","z":"2bbba447.a4759c","name":"Make sure it turned off","func":"flow.set(\"triggered2\", true);\nflow.set(\"didItTurnOffCheck\",msg.payload.on);\nreturn msg;\n","outputs":1,"noerr":0,"x":3290,"y":420,"wires":[["89308aa8.40e6a8"]]},{"id":"57b1a1b4.9a528","type":"function","z":"2bbba447.a4759c","name":"Turn Off","func":"if(flow.get(\"triggered2\")===true){\n    var newMsg;\n    flow.set(\"triggered2\", false);\n    if(flow.get(\"didItTurnOffCheck\")===false){\n        newMsg = { payload : {\"on\":false}};\n        node.status({fill:\"green\",shape:\"dot\",text:\"Desliga\"});\n        node.send(newMsg);   \n    }\n}","outputs":1,"noerr":0,"x":3680,"y":420,"wires":[["e1ea9a2.31bd168"]]},{"id":"24d07955.b49ff6","type":"function","z":"444fced8.33ecb","name":"Volume -","func":"if( (msg.payload.name===\"Echo Dot da Sala\" && (\n        msg.payload.description.summary.includes('muito alto')===true||\n        ((\n            msg.payload.description.summary.includes('abaixa')===true || \n            msg.payload.description.summary.includes('abaixe')===true ||\n            msg.payload.description.summary.includes('baixa')===true ||\n            msg.payload.description.summary.includes('baixe')===true ||\n            msg.payload.description.summary.includes('volume')===true\n        )&&\n            msg.payload.description.summary.includes('volume')===true\n        &&\n        (\n            msg.payload.description.summary.includes('tv')===true ||\n            msg.payload.description.summary.includes('t')===true ||\n            msg.payload.description.summary.includes('v')===true\n        ))&&\n            msg.payload.description.summary.includes('aumenta')===false &&\n            msg.payload.description.summary.includes('aumente')===false &&\n            msg.payload.description.summary.includes('sobe')===false)\n    )){\n    for(var i = 0 ; i < 9 ; i++){\n        newMsg= {payload : {\n            \"domain\": \"media_player\",\n            \"service\": \"volume_down\",\n            \"data\":{\n                \"entity_id\": \"media_player.tv_da_sala\"\n            }\n        }};\n        \n        node.send(newMsg);\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":1900,"wires":[["d182aed8.519e"]]},{"id":"225c0d0d.39b7a2","type":"function","z":"444fced8.33ecb","name":"Volume + ","func":"if( (msg.payload.name===\"Echo Dot da Sala\" && (\n        msg.payload.description.summary.includes('muito baixo')===true||\n        ((\n            msg.payload.description.summary.includes('aumenta')===true || \n            msg.payload.description.summary.includes('aumente')===true ||\n            msg.payload.description.summary.includes('sobe')===true\n        )&&\n            msg.payload.description.summary.includes('volume')===true\n        &&\n        (\n            msg.payload.description.summary.includes('tv')===true ||\n            msg.payload.description.summary.includes('t')===true ||\n            msg.payload.description.summary.includes('v')===true\n        )) &&\n            msg.payload.description.summary.includes('dimunui')===false &&\n            msg.payload.description.summary.includes('dimunua')===false &&\n            msg.payload.description.summary.includes('baixa')===false &&\n            msg.payload.description.summary.includes('baixe')===false\n    ))){\n    var newMsg;\n    global.set(\"boaNoiteCasa\", false)\n    for(var i = 0 ; i < 9 ; i++){\n        newMsg= {payload : {\n            \"domain\": \"media_player\",\n            \"service\": \"volume_up\",\n            \"data\":{\n                \"entity_id\": \"media_player.tv_da_sala\"\n            }\n        }};\n        \n        node.send(newMsg);\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":1960,"wires":[["d182aed8.519e"]]},{"id":"69eec2df.5b7ccc","type":"comment","z":"444fced8.33ecb","name":"Abaixa o volume","info":"","x":280,"y":2160,"wires":[]},{"id":"554f8a3e.a570c4","type":"comment","z":"444fced8.33ecb","name":"Aumenta o volume","info":"","x":270,"y":2220,"wires":[]},{"id":"e6bedbb4.585b48","type":"comment","z":"444fced8.33ecb","name":"Troca de canal","info":"","x":280,"y":2040,"wires":[]},{"id":"ae466c3b.c0827","type":"function","z":"444fced8.33ecb","name":"Pausar","func":"if((msg.payload.name===\"Echo Dot do Sala\" && (\n        msg.payload.description.summary.includes('pausa')===true||\n        msg.payload.description.summary.includes('pausar')===true||\n        msg.payload.description.summary.includes('já volto')===true||\n        msg.payload.description.summary.includes('vou ao banheiro')===true||\n        msg.payload.description.summary.includes('vou no banheiro')===true\n    ))){\n    var newMsg;\n    global.set(\"boaNoiteCasa\", false)\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"media_stop\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\"\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":2220,"wires":[["c682411d.2f234","4be760da.d877"]]},{"id":"c682411d.2f234","type":"function","z":"444fced8.33ecb","name":"","func":"\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"media_play_pause\",\n        \"data\":{\n            \"entity_id\": \"media_player.apple_tv\"\n        }\n    }};\n    return newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":760,"y":2200,"wires":[["2a0e2015.b584f"]]},{"id":"1e067aee.66c0b5","type":"function","z":"444fced8.33ecb","name":"Mute TV","func":"var newMsg;\nif(     (msg.payload.name===\"Echo Dot do Sala\" && (\n        msg.payload.description.summary.includes('silêncio')===true||\n        msg.payload.description.summary.includes('silencio')===true||\n        msg.payload.description.summary.includes('silencia')===true||\n        msg.payload.description.summary.includes('silenciar')===true||\n        msg.payload.description.summary.includes('mudo')===true||\n        msg.payload.description.summary.includes('vaca amarela')===true\n    ))){\n    global.set(\"boaNoiteCasa\", false)\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"volume_mute\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\",\n            \"is_volume_muted\": false\n        }\n    }};\n    \n    return newMsg;\n}\n\nif(     (msg.payload.name===\"Echo Dot do Sala\" && ( \n        msg.payload.description.summary.includes('volta ao normal')===true||\n        msg.payload.description.summary.includes('normal')===true||\n        msg.payload.description.summary.includes('silencia')===true||\n        msg.payload.description.summary.includes('silenciar')===true||\n        msg.payload.description.summary.includes('mudo')===true||\n        msg.payload.description.summary.includes('vaca amarela')===true\n    ))){\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"volume_mute\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\",\n            \"is_volume_muted\": true\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":2260,"wires":[["4be760da.d877"]]},{"id":"99b28482.d3f3d8","type":"function","z":"554bb518.994efc","name":"Tocar ringtone no acpartner","func":"\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"xiaomi_aqara\",\n        \"service\": \"play_ringtone\",\n        \"data\":{\n            \"gw_mac\": \"44237c81c932\",\n            \"ringtone_id\": 11,\n            \"ringtone_vol\": 100\n\n        }\n    }};\n    return newMsg;\n    \n/*\nAlarms\n    0 - Police car 1\n    1 - Police car 2\n    2 - Accident\n    3 - Countdown\n    4 - Ghost\n    5 - Sniper rifle\n    6 - Battle\n    7 - Air raid\n    8 - Bark\nDoorbells\n    10 - Doorbell\n    11 - Knock at a door\n    12 - Amuse\n    13 - Alarm clock\nAlarm clock\n    20 - MiMix\n    21 - Enthusiastic\n    22 - GuitarClassic\n    23 - IceWorldPiano\n    24 - LeisureTime\n    25 - ChildHood\n    26 - MorningStreamLiet\n    27 - MusicBox\n    28 - Orange\n    29 - Thinker\n*/","outputs":1,"noerr":0,"initialize":"","finalize":"","x":400,"y":700,"wires":[["293815f6.1c67ea"]]},{"id":"7eac7957.0a0eb8","type":"debug","z":"d3db5d74.fb8fa","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":430,"y":1920,"wires":[]},{"id":"9542dcaf.e3052","type":"function","z":"d3db5d74.fb8fa","name":"Movimento Corredor","func":"if(msg.payload.entity_id === \"binary_sensor.movimento_corredor\"){\n    var newMsg;\n    newMsg = {payload:{entity_id:\"sensor.sensor_de_luz_corredor\"}};\n    return newMsg;\n}\n//sensor_motion.aq2","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":1400,"wires":[["b19f1845.20a6e8","4f18b6c5.078a28"]]},{"id":"eb38b384.65fda","type":"function","z":"d3db5d74.fb8fa","name":"Turn On","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nvar banheiroOcupado = global.get(\"BanheiroOcupado\");\nvar newMsg;\nif(Hour > 18 ||Hour < 7 || msg.payload < 5){\n    if(Hour < 18 && Hour > 6){ \n        if(banheiroOcupado === false){\n            \n            newMsg= {payload : {\n                \"domain\": \"light\",\n                \"service\": \"turn_on\",\n                data:{\n                    \"entity_id\": \"light.aqara_hub\",\n                    \"brightness\": 6,\n                    \"rgb_color\": [0,10,0]\n                }\n            }};\n        \n            return newMsg;\n        }\n        \n        if(banheiroOcupado === true){\n            \n            newMsg= {payload : {\n                \"domain\": \"light\",\n                \"service\": \"turn_on\",\n                data:{\n                    \"entity_id\": \"light.aqara_hub\",\n                    \"brightness\": 6,\n                    \"rgb_color\": [10,0,0]\n                }\n            }};\n        \n            return newMsg;\n        }\n    }\n    else{\n        if(global.get(\"luzNoturnaOn\") === false){\n            global.set(\"luzNoturnaOn\", true);\n            newMsg= {payload : {\n                \"domain\": \"light\",\n                \"service\": \"turn_on\",\n                data:{\n                    \"entity_id\": \"light.aqara_hub\",\n                    \"rgb_color\": [10, 10, 10],\n                    \"brightness_pct\": 1,\n                    \"transition\": 5\n                }\n            }};\n            node.send(newMsg);\n            for(var i = 0; i < 28 ; i++){\n                newMsg= {payload : {\n                    \"domain\": \"light\",\n                    \"service\": \"turn_on\",\n                    data:{\n                        \n                        \"entity_id\": \"light.aqara_hub\",\n                        \"rgb_color\": [255, 255, 255],\n                        \"brightness_step_pct\": 1,\n                        \"transition\": 5\n                    }\n                }};\n                node.send(newMsg);\n            }\n            \n            return newMsg;\n        }\n    } \n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":940,"y":1400,"wires":[["1c4332ad.1287ad"]]},{"id":"d56aaec0.5c80a","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delayv","timeout":"5","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":900,"y":1460,"wires":[["9318bc52.48ab4"]]},{"id":"b27ad273.029bd","type":"function","z":"d3db5d74.fb8fa","name":"Turn Off","func":"var newMsg;\nglobal.set(\"luzNoturnaOn\", false);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \"entity_id\": \"light.aqara_hub\",\n    }\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1620,"y":1460,"wires":[["720b2e2a.c4b74"]]},{"id":"b09d4ce2.2903e","type":"debug","z":"d3db5d74.fb8fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":470,"y":1560,"wires":[]},{"id":"935d70a4.0388a","type":"debug","z":"d3db5d74.fb8fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":470,"y":180,"wires":[]},{"id":"7fd58a3e.124184","type":"function","z":"4c9c764d.9c4468","name":"Liga a TV","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"media_player\",\n    \"service\": \"turn_on\",\n    \"data\":{\n        \"entity_id\": \"media_player.tv_da_sala\"\n    }\n}};\n    \nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1020,"y":1100,"wires":[["f241c1a3.11968"]]},{"id":"4892980c.666928","type":"function","z":"5767c936.cabd18","name":"Turned off, reset cont","func":"var date = new Date();\nvar Hour = date.getHours();\nif(Hour >= 19 && Hour < 23){\n    if(msg.payload.state.on === false){\n        msg.reset = 1;\n        return msg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":700,"y":1780,"wires":[["95d42658.d910a8"]]},{"id":"35d81f25.70efe","type":"switch","z":"2bbba447.a4759c","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"2","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":2450,"y":480,"wires":[["3665f12e.70f2ee","a2c55b1b.216528"],["1004281c.91e608"]]},{"id":"850c5203.11224","type":"comment","z":"859b066a.dd8128","name":"Botão foi clicado","info":"Ligar as luzes se estiverem desligadas\nDesligar as luzes se estiverem ligadas e acima de 50% de brilho\nAumentar o brilho caso estiverem abaixo de 50%","x":320,"y":1080,"wires":[]},{"id":"2c66b73a.38dde8","type":"inject","z":"d67ca66.293d758","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 23 * * 1,2,3,4,0","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":310,"y":1340,"wires":[["c6b71da4.2c7e9"]]},{"id":"22707317.1314ac","type":"inject","z":"d67ca66.293d758","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 22 * * 1,2,3,4,0","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":310,"y":1220,"wires":[["65c3a007.04cbf"]]},{"id":"5f47a6a3.438368","type":"inject","z":"d67ca66.293d758","name":"","repeat":"","crontab":"30 22 * * 1,2,3,4,0","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":310,"y":1280,"wires":[["728d2cc5.4c4054"]]},{"id":"13e736de.8dd489","type":"inject","z":"d67ca66.293d758","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"30 23 * * 1,2,3,4,0","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":310,"y":1400,"wires":[["bccea612.2ccc08"]]},{"id":"65c3a007.04cbf","type":"function","z":"d67ca66.293d758","name":"Volume 20","func":"if(global.get(\"horaDoFilme\") === false &&\n    global.get(\"tvAuxFilme\") === false &&\n    global.get(\"tvAuxPlay\") === false\n){\n    var newMsg;\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_VOL20\"\n        }\n    }\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":470,"y":1220,"wires":[["7511e273.ed96cc"]]},{"id":"728d2cc5.4c4054","type":"function","z":"d67ca66.293d758","name":"Volume 18","func":"if(global.get(\"horaDoFilme\") === false &&\n    global.get(\"tvAuxFilme\") === false &&\n    global.get(\"tvAuxPlay\") === false\n){\n    var newMsg;\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_VOL18\"\n        }\n    }\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":470,"y":1280,"wires":[["7511e273.ed96cc"]]},{"id":"c6b71da4.2c7e9","type":"function","z":"d67ca66.293d758","name":"Volume 16","func":"if(global.get(\"horaDoFilme\") === false &&\n    global.get(\"tvAuxFilme\") === false &&\n    global.get(\"tvAuxPlay\") === false\n){\n    var newMsg;\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_VOL16\"\n        }\n    }\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":470,"y":1340,"wires":[["7511e273.ed96cc"]]},{"id":"bccea612.2ccc08","type":"function","z":"d67ca66.293d758","name":"Volume 14","func":"if(global.get(\"horaDoFilme\") === false){\n    var newMsg;\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_VOL14\"\n        }\n    }\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":470,"y":1400,"wires":[["7511e273.ed96cc"]]},{"id":"56cf118.6c95df","type":"change","z":"4c9c764d.9c4468","name":"Turn Off","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"On\": false} ","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1020,"y":1400,"wires":[["d6f65d1a.11585"]]},{"id":"d6f65d1a.11585","type":"link out","z":"4c9c764d.9c4468","name":"LumariaOnOff","links":["817677be.bad9f8"],"x":1111,"y":1400,"wires":[]},{"id":"b0a4829f.24c6b","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":680,"wires":[["99b28482.d3f3d8"]]},{"id":"80088c33.a8a6e","type":"function","z":"554bb518.994efc","name":"Yeelight modes","func":"\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"xiaomi_aqara\",\n        \"service\": \"play_ringtone\",\n        \"data\":{\n            \"gw_mac\": \"44237c81c932\",\n            \"ringtone_id\": 10,\n            \"ringtone_vol\": 30\n\n        }\n    }};\n    return newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":360,"y":820,"wires":[["f21d5385.706d6"]]},{"id":"7fafbe1b.f5017","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":800,"wires":[["80088c33.a8a6e"]]},{"id":"37b09774.ccc7b8","type":"debug","z":"5767c936.cabd18","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1790,"y":380,"wires":[]},{"id":"716a6073.796fd","type":"debug","z":"5767c936.cabd18","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3170,"y":180,"wires":[]},{"id":"187514be.470c7b","type":"change","z":"5767c936.cabd18","name":"","rules":[{"t":"delete","p":"reset","pt":"msg"},{"t":"delete","p":"came","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":300,"wires":[["53ffdf0c.5803c"]]},{"id":"2a719e87.b34be2","type":"function","z":"5767c936.cabd18","name":"Reset","func":"if(msg.reset === 1){  \n    return {payload: true};\n}","outputs":1,"noerr":0,"x":3205,"y":384,"wires":[["30379d06.5c9d22"]]},{"id":"2c10f23c.fcb11e","type":"function","z":"e7cd1901.ee2408","name":"was triggered?","func":"if(flow.get(\"triggered1\")===true){\n    flow.set(\"triggered1\", false);\n    var newMsg;\n    if(msg.payload.state.on === true){\n        newMsg = {payload:{state:{bri:msg.payload.state.bri,\n                                  ct: msg.payload.state.ct\n                                  }\n                            },\n                            came: \"Yeelight\"\n        };\n        return newMsg;\n    }\n    if(msg.payload.state.on === false){\n        newMsg = {payload:{resetar: true}};\n        return newMsg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2060,"y":280,"wires":[["2d2b471d.051b18"]]},{"id":"2a05ae59.9f7e02","type":"switch","z":"e7cd1901.ee2408","name":"","property":"payload.resetar","propertyType":"msg","rules":[{"t":"istype","v":"undefined","vt":"undefined"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":2530,"y":280,"wires":[["94317e5a.295e5"],["5a48819f.5863b"]]},{"id":"a375134b.1d234","type":"function","z":"e7cd1901.ee2408","name":"Reset","func":"if(msg.reset === 1){  \n    return {payload: true};\n}","outputs":1,"noerr":0,"x":3410,"y":340,"wires":[["7a51d5af.d3467c"]]},{"id":"dd5a2759.0b99d8","type":"debug","z":"d3db5d74.fb8fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":490,"y":1660,"wires":[]},{"id":"18d78045.d4bfc","type":"function","z":"444fced8.33ecb","name":"Liga a Fire TV","func":"if(\n        msg.payload.description.summary.includes('liga a t. v. do quarto')===true ||\n        msg.payload.description.summary.includes('liga t. v. do quarto')===true||\n        msg.payload.description.summary.includes('ligue a t. v. do quarto')===true||\n        msg.payload.description.summary.includes('ligue t. v. do quarto')===true||       \n        (msg.payload.name===\"Echo Dot do Quarto Nédi\" && ((\n       (msg.payload.description.summary.includes('liga')===true) ||\n       (msg.payload.description.summary.includes('ligar')===true) ||\n       (msg.payload.description.summary.includes('ligue')===true) ) &&\n       msg.payload.description.summary.includes('t.')===true &&\n       msg.payload.description.summary.includes('v.')===true))\n    ){\n        var newMsg;\n        newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"light.luz_do_quarto_nedi\"\n            }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":2660,"wires":[["42be937b.e17c5c","650e012d.d0af3","a01e83c8.dd1b","c16309d1.f94448"]]},{"id":"817f8363.e868e","type":"function","z":"444fced8.33ecb","name":"Turn off Fire TV","func":"if(\n        msg.payload.description.summary.includes('desliga a t. v. do quarto')===true ||\n        msg.payload.description.summary.includes('desliga t. v. do quarto')===true||\n        msg.payload.description.summary.includes('desligar a t. v. do quarto')===true ||\n        msg.payload.description.summary.includes('desligar t. v. do quarto')===true||\n        msg.payload.description.summary.includes('desligue a t. v. do quarto')===true||\n        msg.payload.description.summary.includes('desligue t. v. do quarto')===true||\n       (msg.payload.name===\"Echo Dot do Quarto Nédi\" && ((\n       (msg.payload.description.summary.includes('desliga')===true) ||\n       (msg.payload.description.summary.includes('desligar')===true) ||\n       (msg.payload.description.summary.includes('desligue')===true) ) &&\n       msg.payload.description.summary.includes('t.')===true &&\n       msg.payload.description.summary.includes('v.')===true\n    ))){\n    var newMsg;\n    newMsg= {payload : \n                {\n                    \"domain\": \"media_player\",\n                    \"service\": \"turn_off\",\n                    \"data\":{\n                        \"entity_id\": \"media_player.fire_tv\"\n                    }\n                }\n            };\n    node.send(newMsg);\n    \n    newMsg= {payload : \n                {\n                    \"domain\": \"media_player\",\n                    \"service\": \"turn_off\",\n                    \"data\":{\n                        \"entity_id\": \"media_player.fire_tv_2\"\n                    }\n                }\n            };\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":2960,"wires":[["13cd65e3.056f3a","68868c0e.937504","e477db0a.b41ee8"]]},{"id":"72eb2504.4f5bfc","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload : \n            {\n                \"domain\": \"media_player\",\n                \"service\": \"volume_set\",\n                \"data\":{\n                    \"entity_id\": \"media_player.fire_tv\",\n                    \"volume_level\": 0.6\n                }\n            }\n        };\nnode.send(newMsg);\n\nnewMsg= {payload : \n            {\n                \"domain\": \"media_player\",\n                \"service\": \"volume_set\",\n                \"data\":{\n                    \"entity_id\": \"media_player.fire_tv_2\",\n                    \"volume_level\": 0.6\n                }\n            }\n        };\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":910,"y":2740,"wires":[["7275fc50.c70e94"]]},{"id":"c49663a7.22026","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload : \n            {\n                \"domain\": \"media_player\",\n                \"service\": \"select_source\",\n                \"data\":{\n                    \"entity_id\": \"media_player.fire_tv\",\n                    \"source\": 'com.netflix.ninja'\n                }\n            }\n        };\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":910,"y":2800,"wires":[["7275fc50.c70e94"]]},{"id":"999a7cb8.da7e9","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg= {payload : \n            {\n                \"domain\": \"media_player\",\n                \"service\": \"media_pause\",\n                \"data\":{\n                    \"entity_id\": \"media_player.fire_tv\"\n                }\n            }\n        };\nnode.send(newMsg);\n\nnewMsg= {payload : \n            {\n                \"domain\": \"media_player\",\n                \"service\": \"media_pause\",\n                \"data\":{\n                    \"entity_id\": \"media_player.fire_tv_2\"\n                }\n            }\n        };\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":720,"y":3020,"wires":[["13cd65e3.056f3a"]]},{"id":"6640a3fe.73843c","type":"function","z":"444fced8.33ecb","name":"Já volto / pausa","func":"if(\n    (msg.payload.name===\"Echo Dot do Quarto Nédi\" && \n        (msg.payload.description.summary.includes('já volto')===true || \n        msg.payload.description.summary.includes('pausa')===true || \n        msg.payload.description.summary.includes('pausar')===true\n        ))\n    ){\n        var newMsg;\n        newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            \"data\":{\n                \"entity_id\": \"light.luz_do_quarto_nedi\",\n                \"brightness\":50\n            }\n            }}; \n    node.send(newMsg); \n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":3020,"wires":[["999a7cb8.da7e9","c882366e.e8ab78","68868c0e.937504"]]},{"id":"3ce0001a.577de","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"8","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":440,"y":460,"wires":[["9b49a101.0f52c"]]},{"id":"dff2994.6096e68","type":"comment","z":"5767c936.cabd18","name":"Liga o escritório aos poucos","info":"","x":240,"y":180,"wires":[]},{"id":"1662b04f.e49fe","type":"comment","z":"e7cd1901.ee2408","name":"Liga a sala aos poucos","info":"","x":240,"y":160,"wires":[]},{"id":"ee178deb.261c6","type":"inject","z":"e7cd1901.ee2408","name":"Reset","props":[{"p":"payload"},{"p":"topic","vt":"str"},{"p":"reset","v":"true","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"reset","payload":"","payloadType":"str","x":570,"y":260,"wires":[["b2a76711.ae4398"]]},{"id":"377bc19e.e584ae","type":"inject","z":"5767c936.cabd18","name":"Reset","props":[{"p":"payload"},{"p":"topic","vt":"str"},{"p":"reset","v":"true","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"reset","payloadType":"str","x":530,"y":320,"wires":[["ba6a4e16.62ac7"]]},{"id":"9c98b28c.4c8bd","type":"function","z":"4c9c764d.9c4468","name":"Trigger","func":"flow.set(\"triggered\", true);\nmsg = {\"payload\": {\"status\": \"status\"}};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1019,"y":1580,"wires":[["25b6724e.fcf97e"]]},{"id":"b52cd23d.eabd2","type":"function","z":"4c9c764d.9c4468","name":"Was Triggered?","func":"if(flow.set(\"triggered\")===true){\n    flow.set(\"triggered\", false);\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1409,"y":1580,"wires":[["d3645fef.a44f5"]]},{"id":"57ed58fd.5a6c18","type":"function","z":"444fced8.33ecb","name":"Mute TV","func":"var newMsg;\nif(     (msg.payload.name===\"Echo Dot do Quarto Nédi\" && (\n        msg.payload.description.summary.includes('silêncio')===true||\n        msg.payload.description.summary.includes('silencio')===true||\n        msg.payload.description.summary.includes('silencia')===true||\n        msg.payload.description.summary.includes('silenciar')===true||\n        msg.payload.description.summary.includes('mudo')===true||\n        msg.payload.description.summary.includes('vaca amarela')===true\n    ))){\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"volume_mute\",\n        \"data\":{\n            \"entity_id\": \"media_player.fire_tv\",\n            \"is_volume_muted\": false\n        }\n    }};\n    node.send(newMsg);\n    \n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"volume_mute\",\n        \"data\":{\n            \"entity_id\": \"media_player.fire_tv_2\",\n            \"is_volume_muted\": false\n        }\n    }};\n    \n    return newMsg;\n}\n\nif(     (msg.payload.name===\"Echo Dot do Quarto\" && ( \n        msg.payload.description.summary.includes('volta ao normal')===true||\n        msg.payload.description.summary.includes('normal')===true\n    ))){\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"volume_mute\",\n        \"data\":{\n            \"entity_id\": \"media_player.fire_tv\",\n            \"is_volume_muted\": true\n        }\n    }};\n    node.send(newMsg);\n    \n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"volume_mute\",\n        \"data\":{\n            \"entity_id\": \"media_player.fire_tv_2\",\n            \"is_volume_muted\": true\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":2920,"wires":[["13cd65e3.056f3a","68868c0e.937504"]]},{"id":"a01e83c8.dd1b","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":720,"y":2780,"wires":[["72eb2504.4f5bfc","c49663a7.22026"]]},{"id":"470c17ea.7843e8","type":"function","z":"444fced8.33ecb","name":"Claro","func":"if(     (msg.payload.name===\"Echo Dot da Sala\" && ((\n        msg.payload.description.summary.includes('bota')===true ||\n        msg.payload.description.summary.includes('botar')===true ||\n        msg.payload.description.summary.includes('bote')===true) &&\n        (\n        msg.payload.description.summary.includes('claro')===true || \n        msg.payload.description.summary.includes('vivo')===true\n        )\n    ))){\n    var newMsg;\n    global.set(\"boaNoiteCasa\", false)\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_TV\"\n        }\n    }\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":490,"y":2300,"wires":[["4be760da.d877"]]},{"id":"7f30c5cb.ec303c","type":"change","z":"e7cd1901.ee2408","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":3830,"y":340,"wires":[["5b0dc24f.60623c"]]},{"id":"7a51d5af.d3467c","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"8","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":3610,"y":340,"wires":[["7f30c5cb.ec303c"]]},{"id":"2bf5265d.fc73fa","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"delayv","timeout":"10","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2900,"y":560,"wires":[["a1e68de0.e2c7"]]},{"id":"a1e68de0.e2c7","type":"function","z":"2bbba447.a4759c","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \"entity_id\": \"light.aqara_hub\",\n    }\n}};\nreturn newMsg;\n ","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3100,"y":560,"wires":[["5420eb2f.585104"]]},{"id":"92f82708.2d3838","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1030,"y":4540,"wires":[]},{"id":"a97fd117.493ab","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg = {};\nglobal.set(\"HA-ShoppingList-old\", msg.payload);\nvar shoppingListHA = msg.payload;\nvar shoppingListAlexa = global.get(\"Alexa-ShoppingList-aux\");\nvar adicionarFlag = 0;\nfor(var i = 0; i < shoppingListAlexa.length; i++){\n    if(shoppingListAlexa[i].completed === false){\n        for(var j = 0; j < shoppingListHA.length; j++){\n            if(shoppingListHA[j].name.toLowerCase() === shoppingListAlexa[i].value.toLowerCase()){\n                adicionarFlag = 1\n            }\n        }\n        if(adicionarFlag === 0){\n                newMsg = {payload : \n                    {\n                    \"domain\": \"shopping_list\",\n                    \"service\": \"add_item\",\n                    \"data\":{\n                        \"name\": shoppingListAlexa[i].value.charAt(0).toUpperCase() + shoppingListAlexa[i].value.slice(1)\n                        }\n                    }\n                }\n                node.send(newMsg);\n        }\n        adicionarFlag = 0;\n    }\n    else{\n        \n        for(var j = 0; j < shoppingListHA.length; j++){\n            if(shoppingListHA[j].name.toLowerCase() === shoppingListAlexa[i].value.toLowerCase()){\n                if(shoppingListHA[j].complete === false){\n                    newMsg = {payload : \n                        {\n                        \"domain\": \"shopping_list\",\n                        \"service\": \"complete_item\",\n                        \"data\":{\n                            \"name\": shoppingListHA[j].name\n                            }\n                        }\n                    }\n                    node.send(newMsg);\n                }\n            }\n        }\n    }\n}\n","outputs":1,"noerr":0,"x":1210,"y":4340,"wires":[["431cbd93.d5b3f4"]]},{"id":"7d63ea8e.4a9ef4","type":"function","z":"444fced8.33ecb","name":"Apple TV On","func":"if(msg.payload.description.summary.includes('apple')===true &&\n   msg.payload.description.summary.includes(\"sai da apple\") === false    \n    ){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"media_player.apple_tv\"\n        }\n    }};\n    node.send(newMsg);\n    \n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_HDMI2\"\n        }\n    }\n    node.send(newMsg);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":1700,"wires":[["eb95127f.26f2d","41cbc1bd.13f36"]]},{"id":"b33f043a.003cf8","type":"comment","z":"444fced8.33ecb","name":"Sincronizar a Lista Alexa com HA","info":"","x":350,"y":4300,"wires":[]},{"id":"72ca570b.9ae3d8","type":"debug","z":"d67ca66.293d758","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":420,"y":820,"wires":[]},{"id":"47d2250d.065b8c","type":"debug","z":"d67ca66.293d758","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":440,"y":920,"wires":[]},{"id":"42a9f340.1fc55c","type":"function","z":"444fced8.33ecb","name":"","func":"global.set(\"HA-ShoppingList-aux\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":1030,"y":4460,"wires":[["f490c4f5.2b7b38"]]},{"id":"b92c0f3f.12e8c","type":"inject","z":"444fced8.33ecb","name":"","repeat":"","crontab":"*/30 7-22 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":230,"y":4340,"wires":[["b0feba76.29ab18"]]},{"id":"62fba09.68b566","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":890,"y":4540,"wires":[["92f82708.2d3838"]]},{"id":"415161f9.53369","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":890,"y":4460,"wires":[["42a9f340.1fc55c"]]},{"id":"3929b2fd.756b8e","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":430,"y":4500,"wires":[["d5c139e2.85a738"]]},{"id":"a3321db6.f2b2e","type":"function","z":"444fced8.33ecb","name":"","func":"var shoppingListHA = global.get(\"HA-ShoppingList-aux\");\nvar shoppingListAlexa = msg.payload;\nvar newMsg;\nvar noNewItem = true;\nvar newItemPosition = [];\nvar i;\nfor(i = 0; i< shoppingListHA.length; i++){\n    for(var j = 0; j <shoppingListAlexa.length; j++){\n            if(\n                    shoppingListHA[i].name.toLowerCase() === shoppingListAlexa[j].value.toLowerCase()\n                ){\n                    \n                if(\n                    shoppingListHA[i].complete === true && \n                    shoppingListAlexa[j].completed === false\n                    ){\n                        newMsg = {payload:{\n                                  id: shoppingListAlexa[j].id,\n                                  item: shoppingListAlexa[j].value,\n                                  list: \"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0=\"\n                                },\n                                  id: shoppingListAlexa[j].id,\n                                  item: shoppingListAlexa[j].value,\n                                  list: \"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0=\",\n                                ajuda: true\n                        };\n                        node.send(newMsg);\n                    }\n                noNewItem = false;\n            }\n        }\n        if(noNewItem === true && shoppingListHA[i].complete === false){\n            newItemPosition.push(i);\n        }\n        noNewItem = true;\n}\nif(newItemPosition.length > 0){\n    for(i=0; i< newItemPosition.length; i++){\n        if(shoppingListHA[newItemPosition[i]].complete === false){\n            newMsg = {payload:{item: shoppingListHA[newItemPosition[i]].name, \n                      list: \"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0=\",\n                      ajuda: false}};\n            node.send(newMsg);\n        }\n    }\n}","outputs":1,"noerr":0,"x":1390,"y":4460,"wires":[["c5fd3cbd.356fb"]]},{"id":"87de823c.02e22","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":470,"y":4560,"wires":[]},{"id":"d5c139e2.85a738","type":"function","z":"444fced8.33ecb","name":"","func":"var newMsg;\nnewMsg = {payload: true};\nreturn newMsg;","outputs":1,"noerr":0,"x":590,"y":4500,"wires":[["4f152b26.364244"]]},{"id":"e6a01969.9876f8","type":"function","z":"444fced8.33ecb","name":"Desliga o escritório","func":"if(\n    ((msg.payload.description.summary.includes('desliga')===true ||\n    msg.payload.description.summary.includes('desligar')===true || \n    msg.payload.description.summary.includes('desligue')===true) &&\n    msg.payload.description.summary.includes('luz')===false &&\n    msg.payload.description.summary.includes('luzes')===false &&\n    (msg.payload.description.summary.includes('escritório')===true|| \n    msg.payload.description.summary.includes('escritorio')===true)) ||\n    \n    (msg.payload.description.summary.includes('desliga')===true || \n    msg.payload.description.summary.includes('desligue')===true  )&& \n    ((msg.payload.description.summary.includes('p.')===true && \n        msg.payload.description.summary.includes('c.')===true)  ||\n        msg.payload.description.summary.includes('p.c.')===true||\n        msg.payload.description.summary.includes('PC')===true\n    )\n        \n    ){\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n\n        \"topic\": \"iotlink/workgroup/soft-pc/commands/shutdown\",\n        \"payload\": \"\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":280,"wires":[["330dd2a9.829e9e"]]},{"id":"bf90c51a.246768","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2110,"y":4400,"wires":[]},{"id":"4c92db9c.4ac3b4","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":550,"y":4400,"wires":[]},{"id":"2b507ce1.829ea4","type":"function","z":"554bb518.994efc","name":"","func":"global.set(\"HA-ShoppingList-old\", msg.payload);\nvar newMsg;\nnewMsg = {payload: true};\nreturn newMsg;","outputs":1,"noerr":0,"x":1580,"y":340,"wires":[[]]},{"id":"a1c0ec4a.6ba0e","type":"function","z":"444fced8.33ecb","name":"","func":"global.set(\"Alexa-ShoppingList-aux\", msg.payload);\nvar newMsg;\nnewMsg = {payload: true};\nreturn newMsg;","outputs":1,"noerr":0,"x":560,"y":4340,"wires":[["1e721130.88e9ff","b64bd9f1.625ab8"]]},{"id":"431cbd93.d5b3f4","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1390,"y":4340,"wires":[["4473ffa5.c6242","a84377ff.317638"]]},{"id":"cabd4650.f81098","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1030,"y":4340,"wires":[["a97fd117.493ab"]]},{"id":"1e721130.88e9ff","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":710,"y":4340,"wires":[["43cb6e36.b3727"]]},{"id":"d9f3301a.9e26d","type":"switch","z":"444fced8.33ecb","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"false"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":1730,"y":4460,"wires":[["9a05cb5e.a141b8"],["c2925e7d.d0847"]]},{"id":"4273f70c.a2f798","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2110,"y":4540,"wires":[]},{"id":"c5fd3cbd.356fb","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1550,"y":4460,"wires":[["d9f3301a.9e26d","92d2bc2b.25961"]]},{"id":"92d2bc2b.25961","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1690,"y":4400,"wires":[]},{"id":"a84377ff.317638","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1570,"y":4280,"wires":[]},{"id":"9548fd60.1d0ed","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1350,"y":4400,"wires":[]},{"id":"fad19841.0c97e8","type":"function","z":"444fced8.33ecb","name":"","func":"var shoppingListHA = global.get(\"HA-ShoppingList-aux\");\nvar shoppingListAlexa = msg.payload;\nvar newMsg;\nvar noNewItem = true;\nvar newItemPosition = [];\nvar i;\n    for(var j = 0; j <shoppingListAlexa.length; j++){\n        if(shoppingListAlexa[j].completed === true){\n                        newMsg = {payload:{\n                                  id: shoppingListAlexa[j].id,\n                                  item: shoppingListAlexa[j].value,\n                                  list: \"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0=\"\n                                },\n                                  id: shoppingListAlexa[j].id,\n                                  item: shoppingListAlexa[j].value,\n                                  list: \"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0=\",\n                                ajuda: true\n                        };\n                        node.send(newMsg);\n        }\n    }","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1730,"y":4540,"wires":[["c2925e7d.d0847"]]},{"id":"d9cb0ed8.27163","type":"inject","z":"444fced8.33ecb","name":"","repeat":"432000","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1350,"y":4540,"wires":[["4f1abce4.d33704"]]},{"id":"2a6e2a13.beec36","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1710,"y":4600,"wires":[]},{"id":"8ec1a11b.56e75","type":"function","z":"e7cd1901.ee2408","name":"TV da Sala Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2320,"y":800,"wires":[["c18acf0.2ec693"]]},{"id":"79c5edf6.bf7ca4","type":"function","z":"e7cd1901.ee2408","name":"Luz da Sala Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":2320,"y":980,"wires":[["1dc6a3d6.67629c"]]},{"id":"6683f650.ea72b8","type":"function","z":"444fced8.33ecb","name":"Boa noite Sala","func":"if(\n    msg.payload.name===\"Echo Dot da Sala\" &&(\n    msg.payload.description.summary.includes('boa noite')===true || \n    msg.payload.description.summary.includes('vou dormir')===true\n    )){\n    global.set(\"boaNoiteCasa\", true);\n    var newMsg;\n    newMsg= {payload : true};\n    node.send(newMsg);\n    \n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":1560,"wires":[["ccc80da.d5973f"]]},{"id":"2df5031e.7be11c","type":"function","z":"444fced8.33ecb","name":"Boa noite Quarto","func":"if(\n    msg.payload.name===\"Echo Dot do Quarto Nédi\" &&(\n    msg.payload.description.summary.includes('boa noite')===true ||\n    msg.payload.description.summary.includes('vou dormir')===true\n    )){\n    \n    var newMsg;\n    newMsg = {\"payload\": true} \n    return newMsg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":530,"y":1160,"wires":[["1162d52e.d59a7b"]]},{"id":"1162d52e.d59a7b","type":"link out","z":"444fced8.33ecb","name":"Vou dormir alexa","links":["17b7df66.4128b1"],"x":695,"y":1160,"wires":[]},{"id":"379789b5.f21f06","type":"function","z":"444fced8.33ecb","name":"Faz o café","func":"if(\n    msg.payload.name===\"Echo Dot da Cozinha\" &&(\n    msg.payload.description.summary.includes('café')===true && (\n    msg.payload.description.summary.includes('faça')===true  || \n    msg.payload.description.summary.includes('faz')===true\n\n    ))){\n    global.set(\"alexaCafeAux\", true);\n    var newMsg;\n    newMsg= {payload : {\"On\":true }};\n    node.send(newMsg);\n    \n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":510,"y":1260,"wires":[["c09e3f0a.b5ec8","21d08a78.8505b6"]]},{"id":"4be760da.d877","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"0.5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":740,"y":2120,"wires":[["d893df70.4923f","41cbc1bd.13f36"]]},{"id":"5f6ea653.0463e8","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= { \"payload\": \"Olá\", \"data\": { \"type\": \"tts\" }, \"target\": \"alexa_media_echo_dot_da_sala\" };\nreturn newMsg;","outputs":1,"noerr":0,"x":340,"y":960,"wires":[["d1bb1156.06898"]]},{"id":"191674f4.ceb1fb","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":960,"wires":[["5f6ea653.0463e8"]]},{"id":"f20ff60c.1bfd68","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= { \"payload\": \"Olá\", \"data\": { \"type\": \"tts\" }, \"target\": \"alexa_media_echo_dot_da_sala\" };\nreturn newMsg;","outputs":1,"noerr":0,"x":340,"y":1020,"wires":[["ed1efe74.9b07a"]]},{"id":"fb5b9fc8.99d46","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":1020,"wires":[["f20ff60c.1bfd68"]]},{"id":"192d5e1.c13aca2","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= {\n\"payload\":\"<amazon:effect name='whispered'>I am whispering this.</amazon:effect>\",\n\"data\":{\"type\":\"announce\", \"method\":\"speak\"},\n\"target\":[\"Guest Room\", \"media_player.kitchen\", \"serialNumber\"]\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":340,"y":1080,"wires":[["aa85408.edca4c"]]},{"id":"ea11dfc2.6ca59","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":1080,"wires":[["192d5e1.c13aca2"]]},{"id":"6e07605b.68b1c","type":"switch","z":"2bbba447.a4759c","name":"","property":"isDay","propertyType":"msg","rules":[{"t":"false"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":550,"y":360,"wires":[["2f8ed67d.22b95a","fe5dc8bd.a35d18"],["89da767e.34ade8"]]},{"id":"e3f28710.c14ba8","type":"switch","z":"2bbba447.a4759c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1550,"y":320,"wires":[["250ab27.747084e"],["b4038cea.b3677"]]},{"id":"f614d0f7.ccce2","type":"comment","z":"2bbba447.a4759c","name":"Se for de dia, só checa o aux","info":"","x":780,"y":500,"wires":[]},{"id":"87902325.656bf","type":"function","z":"444fced8.33ecb","name":"Almoço","func":"if(msg.payload.description.summary.includes('almoço')===true ||\n    msg.payload.description.summary.includes('hora do almoço')===true\n   ){\n    var newMsg;\n        newMsg = {payload:{}}\n    global.set(\"boaNoiteCasa\", false)\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_on\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n        }\n    }\n    node.send(newMsg);\n\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_TV\"\n        }\n    }\n    node.send(newMsg);\n\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\",\n            \"media_content_id\": 12,\n            \"media_content_type\": \"channel\"\n        }\n    }};\n    node.send(newMsg);\n\n    newMsg= {payload : {\n    \"domain\": \"media_player\",\n    \"service\": \"play_media\",\n    \"data\":{\n      \"entity_id\": \"media_player.tv_da_sala\",\n      \"media_content_type\": \"send_key\",\n      \"media_content_id\": \"ST_VOL18\"\n    }   \n    }};\n    node.send(newMsg);\n    \n    \n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":2340,"wires":[["4be760da.d877","58efd41a.208bec"]]},{"id":"64fce5b5.d5d89c","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"delay","timeout":"9","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":580,"y":1740,"wires":[["87ddd14.3c9613"]]},{"id":"b9fb4f5d.09759","type":"function","z":"d67ca66.293d758","name":"Turn off","func":"var newMsg;\n    newMsg = {payload:{\n            \n          \"domain\": \"switch\",\n          \"service\": \"turn_off\",\n          \"data\":{\n          \"entity_id\": \"switch.cafeteira\",\n        }\n    }\n}\n    return newMsg;","outputs":1,"noerr":0,"x":980,"y":1620,"wires":[["73661948.9a4f58"]]},{"id":"64e3e55d.98c86c","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":490,"y":60,"wires":[]},{"id":"32a79da4.741ed2","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"media_player\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"media_player.fire_tv\"\n    }\n}};\nnode.send(newMsg);\n\nnewMsg= {payload : {\n    \"domain\": \"media_player\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"media_player.fire_tv_2\"\n    }\n}};\nnode.send(newMsg);\n","outputs":1,"noerr":0,"x":840,"y":3500,"wires":[["67687946.7e8118"]]},{"id":"bd0e87aa.31bc78","type":"function","z":"859b066a.dd8128","name":"Vou dormir?","func":"var newMsg;\nnewMsg = {payload: {}};\nif(msg.payload === true){\n    newMsg.payload = {\"On\": true};\n}\nif(msg.payload === false){\n    newMsg.payload = {\"On\": false};\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":480,"y":3780,"wires":[["a32a9915.70db78"]]},{"id":"87ddd14.3c9613","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"10","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":740,"y":1740,"wires":[["b9fb4f5d.09759","7837a8bf.76d0c8","1464f5f6.04b21a","cdde1573.915d88","3f801c92.47f5f4","a7423af1.5b9b38","d0d5856d.88cc1"]]},{"id":"aff57b37.026a28","type":"function","z":"d67ca66.293d758","name":"if true","func":"var alexaCafeAux = global.get(\"alexaCafeAux\");\nif(msg.payload === true){\n    if(alexaCafeAux === false){\n        return msg;\n    }\n    else{\n        global.set(\"alexaCafeAux\", false);\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":430,"y":1740,"wires":[["64fce5b5.d5d89c","b235294.859eed8"]]},{"id":"aa3e8e1b.c2b91","type":"function","z":"444fced8.33ecb","name":"Adicionar à lista do HA","func":"if(\n        msg.payload.description.summary.includes('adiciona')===true || \n        msg.payload.description.summary.includes('lista')===true || \n        msg.payload.description.summary.includes('coloca')===true|| \n        msg.payload.description.summary.includes('colocar')===true|| \n        msg.payload.description.summary.includes('adicionar')===true|| \n        msg.payload.description.summary.includes('poe')===true|| \n        msg.payload.description.summary.includes('põe')===true|| \n        msg.payload.description.summary.includes('põem')===true|| \n        msg.payload.description.summary.includes('poem')===true|| \n        msg.payload.description.summary.includes('bota')===true\n            \n        ){\n    if(typeof msg.payload.domainAttributes !== \"undefined\" && msg.payload.domainAttributes !== null){\n        if(typeof msg.payload.domainAttributes.value !== \"undefined\"){\n                var newMsg;\n                newMsg= {payload : {\n                    \"domain\": \"shopping_list\",\n                    \"service\": \"add_item\",\n                    \"data\":{\n                        \"name\": msg.payload.domainAttributes.value\n                        }\n                    }};\n            \n            return newMsg;\n        }\n    }\n}","outputs":1,"noerr":0,"x":540,"y":220,"wires":[["4376ca8e.370404"]]},{"id":"2f7e965e.742a2a","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"30","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1320,"y":320,"wires":[["985fb0da.440f1","58306fca.39078"]]},{"id":"dbcf6b8f.9c7328","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delayv","timeout":"20","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1800,"y":400,"wires":[["1d2874be.53f38b"]]},{"id":"985fb0da.440f1","type":"function","z":"2ea7fd8b.7e0bb2","name":"Delay + 20 min","func":"var newMsg = { \"reset\": true };\nnode.send(newMsg);\nnewMsg = {\"delay\" : 1200000} ;\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1620,"y":400,"wires":[["dbcf6b8f.9c7328"]]},{"id":"1d2874be.53f38b","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn Off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_off\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1960,"y":400,"wires":[["9bd8b440.a18d68"]]},{"id":"58306fca.39078","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1520,"y":320,"wires":[["2c252d54.6a0d92"]]},{"id":"cbf70672.c70458","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":760,"y":540,"wires":[["40d8ecc9.126694"]]},{"id":"a9a23c75.2095f","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":760,"y":600,"wires":[["80760c35.5968d"]]},{"id":"940ee253.3159e","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":760,"y":460,"wires":[["bd53e302.56acc","7cb7d34c.c828fc"]]},{"id":"afab0c06.ceb72","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.abajur_quarto\",\n        \"color_temp\": 154,\n        \"brightness\": 255,\n        \"transition\": 150\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3000,"y":1400,"wires":[["345fa672.00beea"]]},{"id":"e5fea666.eaa338","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    data:{\n        \"entity_id\": \"switch.lampada\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":1360,"y":2860,"wires":[["793d91c6.19af3"]]},{"id":"3ee9b545.16afba","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"45","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1370,"y":3100,"wires":[["74a5998b.6139c8","9a33931e.b2eee"]]},{"id":"2bfcbde2.ab89c2","type":"mqtt out","z":"859b066a.dd8128","name":"setOff RGB Strip","topic":"QuartoNedi/setOnRGB","qos":"","retain":"","broker":"64936db9.640564","x":1750,"y":3160,"wires":[]},{"id":"9a33931e.b2eee","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"msg = {payload:0};\nreturn msg;","outputs":1,"noerr":0,"x":1560,"y":3160,"wires":[["2bfcbde2.ab89c2"]]},{"id":"74a5998b.6139c8","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_off\",\n    data:{\n        \"entity_id\": \"switch.lampada\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":1554.4443359375,"y":3099.9998779296875,"wires":[["817700e0.41833"]]},{"id":"ef1ca901.caf2a8","type":"inject","z":"e7cd1901.ee2408","name":"Inicializar as variaveis flow","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/30 6 * * *","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1700,"y":580,"wires":[["465b8921.dabc98"]]},{"id":"465b8921.dabc98","type":"function","z":"e7cd1901.ee2408","name":"","func":"flow.set(\"countBrightness\", 1);\nflow.set(\"increasing\", true);\nflow.set(\"auxCT\", 6100);\nflow.set(\"triggered1\", false);\nflow.set(\"triggered2\", false);\nflow.set(\"triggered3\", false);\n\nvar date = new Date();\nvar hours = date.getHours(); //hourss in 0-23\nvar minutes = \"0\" + date.getMinutes();\nminutes = parseInt(minutes.substr(-2), 10);\nvar seconds = \"0\" + date.getSeconds();\nseconds = parseInt(seconds.substr(-2), 10);\n\nflow.set(\"lastChangeSec\", seconds);\nflow.set(\"lastChangeMinute\", minutes);\nflow.set(\"lastChangeHour\", hours);\n    ","outputs":1,"noerr":0,"x":1930,"y":600,"wires":[[]]},{"id":"4f03c7e4.62f298","type":"inject","z":"5767c936.cabd18","name":"Inicializar as variaveis flow","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/30 6 * * *","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1095,"y":1304,"wires":[["49f80ffd.acfac"]]},{"id":"49f80ffd.acfac","type":"function","z":"5767c936.cabd18","name":"","func":"flow.set(\"increasing\", true);\nflow.set(\"countBrightnessLuz\", 1);\nflow.set(\"increasing\", true);\nflow.set(\"auxCT\", 6100);\nflow.set(\"triggered1\", false);\nflow.set(\"triggered2\", false);\nflow.set(\"triggered3\", false);\nflow.set(\"triggered4\", false);\nflow.set(\"triggered5\", false);\n    \nvar date = new Date();\nvar hours = date.getHours(); //hourss in 0-23\nvar minutes = \"0\" + date.getMinutes();\nminutes = parseInt(minutes.substr(-2), 10);\nvar seconds = \"0\" + date.getSeconds();\nseconds = parseInt(seconds.substr(-2), 10);\n\nflow.set(\"lastChangeSec\", seconds);\nflow.set(\"lastChangeMinute\", minutes);\nflow.set(\"lastChangeHour\", hours);\n\nglobal.set(\"auxTurnOnEscritorio\", false);\n    ","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1325,"y":1324,"wires":[[]]},{"id":"e9965ef4.dc795","type":"function","z":"2ea7fd8b.7e0bb2","name":"Detected?","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":570,"y":560,"wires":[["2f7e965e.742a2a"]]},{"id":"d7e2903f.799be","type":"function","z":"2ea7fd8b.7e0bb2","name":"Detected?","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":570,"y":620,"wires":[["2f7e965e.742a2a"]]},{"id":"62aeee38.66017","type":"function","z":"2ea7fd8b.7e0bb2","name":"Detected?","func":"if(msg.payload === \"on\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":570,"y":680,"wires":[["664d1a0d.99fbd4","eb10d419.bb3698"]]},{"id":"8854e815.7cc7e8","type":"function","z":"2ea7fd8b.7e0bb2","name":"Detected?","func":"if(msg.payload === \"on\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":570,"y":860,"wires":[["b0277a70.37f2a8","eb10d419.bb3698"]]},{"id":"aea952f0.7dca8","type":"function","z":"2ea7fd8b.7e0bb2","name":"Detected?","func":"if(msg.payload === \"on\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":570,"y":920,"wires":[["2f7e965e.742a2a","72213a3.890f9c4"]]},{"id":"9df27abe.b95d08","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1260,"y":1000,"wires":[["6ffdbd0.9a4a944","39e201a5.0dd0ae"]]},{"id":"f4c968df.943ee8","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1260,"y":840,"wires":[["23c48ba4.c0be94","ccf25148.857f"]]},{"id":"815320ad.3bfd9","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1260,"y":600,"wires":[["e19e2e86.320b9","aa736933.be4ac8"]]},{"id":"664d1a0d.99fbd4","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn On","func":"var newMsg;\nnewMsg= {payload: {\n      \"domain\": \"input_boolean\",\n      \"service\": \"turn_on\",\n      \"entity_id\": \"input_boolean.sala_ocupada_switch\"\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1100,"y":600,"wires":[["815320ad.3bfd9"]]},{"id":"b0277a70.37f2a8","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn On","func":"var newMsg;\nnewMsg= {payload: {\n      \"domain\": \"input_boolean\",\n      \"service\": \"turn_on\",\n      \"entity_id\": \"input_boolean.cozinha_ocupada_switch\"\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1100,"y":840,"wires":[["f4c968df.943ee8"]]},{"id":"72213a3.890f9c4","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn On","func":"var newMsg;\nnewMsg= {payload: {\n      \"domain\": \"input_boolean\",\n      \"service\": \"turn_on\",\n      \"entity_id\": \"input_boolean.quarto_nedi_ocupado_switch\"\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1100,"y":1000,"wires":[["9df27abe.b95d08"]]},{"id":"a2c55b1b.216528","type":"function","z":"2bbba447.a4759c","name":"Turn Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"input_boolean.banheiro_ocupado_switch\",\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2500,"y":220,"wires":[["f5da50f6.4f0a9"]]},{"id":"d0ddc950.fa7118","type":"function","z":"2bbba447.a4759c","name":"Turn On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        data:{\n            \"entity_id\": \"input_boolean.banheiro_ocupado_switch\",\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2500,"y":160,"wires":[["f5da50f6.4f0a9"]]},{"id":"7332e558.4e464c","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"input_boolean.quarto_ocupado\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3000,"y":1260,"wires":[["63e6332f.2989ac"]]},{"id":"87921bf9.d6ed98","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"input_boolean.quarto_ocupado\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":3000,"y":1200,"wires":[["63e6332f.2989ac"]]},{"id":"83022ff1.d18fb","type":"function","z":"e7cd1901.ee2408","name":"Turn Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.sala_ocupada_switch\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":2300,"y":1180,"wires":[["184e69f9.5c17a6"]]},{"id":"a363d670.bc5818","type":"function","z":"e7cd1901.ee2408","name":"Turn On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.sala_ocupada_switch\"\n        }\n    }};\n    node.send(newMsg)\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.boa_noite_casa\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2300,"y":1220,"wires":[["184e69f9.5c17a6"]]},{"id":"d7677e76.e2922","type":"function","z":"5767c936.cabd18","name":"Turn Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.sala_ocupada_switch\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":2401,"y":991,"wires":[["c635d49e.ea96a8"]]},{"id":"21eee5c4.42f43a","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Tracks","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":570,"y":180,"wires":[["35f1389c.58dbe8","894f73d0.7faf5"]]},{"id":"67df1aa2.acfcf4","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":2690,"y":180,"wires":[["3c855ed7.ebda22"]]},{"id":"1fe978b4.916027","type":"spotify","z":"7b0de646.c85c78","name":"Getting Old Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1270,"y":180,"wires":[["38acba26.313156"]]},{"id":"35f1389c.58dbe8","type":"function","z":"7b0de646.c85c78","name":"Discover Weekly Archive","func":"flow.set(\"discoverWeeklyTracks\", msg.payload.items)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '5Rxn0QVVaFMpp6UmHj53QA',\n        {offset: 0}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":810,"y":180,"wires":[["88ba07cd.6d1548"]]},{"id":"38acba26.313156","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"discoverWeeklyOldAux\");\nvar oldArrayAux = flow.get(\"discoverWeeklyOldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"discoverWeeklyOldArrayAux\", newOldArrayAux);\nflow.set(\"discoverWeeklyOldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n    \n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1480,"y":180,"wires":[["fc2ff4a2.644d28"]]},{"id":"acb51d44.247d9","type":"inject","z":"7b0de646.c85c78","name":"","repeat":"","crontab":"00 12 * * 2,3","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":180,"wires":[["e41be8e0.1fef58"]]},{"id":"e41be8e0.1fef58","type":"function","z":"7b0de646.c85c78","name":"Discover Weekly","func":"var newMsg;\nflow.set(\"discoverWeeklyOldAux\", 0);\nflow.set(\"discoverWeeklyOldArrayAux\", []);\nflow.set(\"discoverWeeklyTracks\", [])\nflow.set(\"discoverWeeklyOffset\",100);\nnewMsg = {\n    \"params\":[\n        '37i9dQZEVXcLnLyPWrETXX'\n    ]\n}\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":370,"y":180,"wires":[["21eee5c4.42f43a"]]},{"id":"e94b8343.e1599","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1880,"y":180,"wires":[["368061d.6d6e49e"],["ae779a88.fa5de8","92ef2381.dbda5"]]},{"id":"368061d.6d6e49e","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"offsetAux = flow.get(\"discoverWeeklyOffset\");\nflow.set(\"discoverWeeklyOffset\",offsetAux+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '5Rxn0QVVaFMpp6UmHj53QA',\n        {offset: offsetAux}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1800,"y":100,"wires":[["1fe978b4.916027"]]},{"id":"ae779a88.fa5de8","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"discoverWeeklyTracks\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nfor(var i=0; i<newTracks.length; i++) {\n    alreadyIn = false;\n    for(var j=0; j<oldTracks.length; j++) {\n        if(newTracks[i].track.id === oldTracks[j].track.id){\n            alreadyIn = true\n        }\n    }\n    if(alreadyIn === false){\n        auxString = \"['\" + newTracks[i].track.uri + \"']\"\n        newMsg = {\n            \"params\":[\n                \"5Rxn0QVVaFMpp6UmHj53QA\",\n                [newTracks[i].track.uri]\n            ]}\n        node.send(newMsg);\n\n    }\n}\nflow.set(\"discoverWeeklyOldArrayAux\", []);\nflow.set(\"discoverWeeklyTracks\", [])","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":180,"wires":[["e9f13be7.5e3408","de5e297d.e24438"]]},{"id":"fc2ff4a2.644d28","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":180,"wires":[["e94b8343.e1599"]]},{"id":"92ef2381.dbda5","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2200,"y":260,"wires":[]},{"id":"88ba07cd.6d1548","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1040,"y":180,"wires":[["1fe978b4.916027"]]},{"id":"e9f13be7.5e3408","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2450,"y":180,"wires":[["67df1aa2.acfcf4"]]},{"id":"894f73d0.7faf5","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":760,"y":240,"wires":[]},{"id":"de5e297d.e24438","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2490,"y":260,"wires":[]},{"id":"3c855ed7.ebda22","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2890,"y":260,"wires":[]},{"id":"7837a8bf.76d0c8","type":"function","z":"d67ca66.293d758","name":"Pisca Banheiro","func":"var newMsg;\nnewMsg = {payload:{\n          \"domain\": \"light\",\n          \"service\": \"turn_on\",\n          \"data\":{\n          \"entity_id\": \"light.luz_da_sala\",\n            \"effect\": \"Twitter\"\n        }\n    }\n}\n    return newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1000,"y":1560,"wires":[["1bc561f3.21090e"]]},{"id":"4a374454.4142ac","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Tracks","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":570,"y":440,"wires":[["a64f6650.16bb58","434b94e8.b4713c"]]},{"id":"1800da54.e85e76","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":2690,"y":440,"wires":[["79936ffe.e8906"]]},{"id":"99917997.b40b98","type":"spotify","z":"7b0de646.c85c78","name":"Getting Old Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1270,"y":440,"wires":[["6fc060a0.cd011"]]},{"id":"a64f6650.16bb58","type":"function","z":"7b0de646.c85c78","name":"Top Brasil Archive","func":"flow.set(\"topBrasilTracks\", msg.payload.items)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '35uWFe4ozJHwjDfrM3yt9X',\n        {offset: 0}\n    ]\n}\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":790,"y":440,"wires":[["7c12d609.7085b8"]]},{"id":"6fc060a0.cd011","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"topBrasilOldAux\");\nvar oldArrayAux = flow.get(\"topBrasilOldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"topBrasilOldArrayAux\", newOldArrayAux);\nflow.set(\"topBrasilOldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n    \n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1480,"y":440,"wires":[["2e8040ad.403d1"]]},{"id":"4c68c70c.82e1a8","type":"inject","z":"7b0de646.c85c78","name":"","repeat":"","crontab":"00 14 * * 3,4","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":440,"wires":[["3034b028.07d7e"]]},{"id":"3034b028.07d7e","type":"function","z":"7b0de646.c85c78","name":"Top Brasil","func":"var newMsg;\nflow.set(\"topBrasilOldAux\", 0);\nflow.set(\"topBrasilOldArrayAux\", []);\nflow.set(\"topBrasilTracks\", [])\nflow.set(\"topBrasilOffset\",100);\nnewMsg = {\n    \"params\":[\n        '37i9dQZF1DX0FOF1IUWK1W'\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":440,"wires":[["4a374454.4142ac"]]},{"id":"9b5fbfce.6c8dc","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1880,"y":440,"wires":[["67a6039a.330dbc"],["1f1121c8.b2b6be","56e4e6cf.9459d8"]]},{"id":"67a6039a.330dbc","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"offsetAux = flow.get(\"topBrasilOffset\");\nflow.set(\"topBrasilOffset\",offsetAux+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '35uWFe4ozJHwjDfrM3yt9X',\n        {offset: offsetAux}\n    ]\n}\nreturn newMsg;\n","outputs":1,"noerr":0,"x":1800,"y":360,"wires":[["99917997.b40b98"]]},{"id":"1f1121c8.b2b6be","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"topBrasilTracks\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nfor(var i=0; i<newTracks.length; i++) {\n    alreadyIn = false;\n    for(var j=0; j<oldTracks.length; j++) {\n        if(newTracks[i].track.id === oldTracks[j].track.id){\n            alreadyIn = true\n        }\n    }\n    if(alreadyIn === false){\n        auxString = \"['\" + newTracks[i].track.uri + \"']\"\n        newMsg = {\n            \"params\":[\n                \"35uWFe4ozJHwjDfrM3yt9X\",\n                [newTracks[i].track.uri]\n            ]}\n        node.send(newMsg);\n\n    }\n}\nflow.set(\"topBrasilOldArrayAux\", []);\nflow.set(\"topBrasilTracks\", [])\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":440,"wires":[["4ca284cd.5ca04c","c5e9a994.3b9308"]]},{"id":"2e8040ad.403d1","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":440,"wires":[["9b5fbfce.6c8dc"]]},{"id":"56e4e6cf.9459d8","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2200,"y":520,"wires":[]},{"id":"7c12d609.7085b8","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1040,"y":440,"wires":[["99917997.b40b98"]]},{"id":"4ca284cd.5ca04c","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2450,"y":440,"wires":[["1800da54.e85e76"]]},{"id":"434b94e8.b4713c","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":760,"y":500,"wires":[]},{"id":"c5e9a994.3b9308","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2490,"y":520,"wires":[]},{"id":"79936ffe.e8906","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2890,"y":520,"wires":[]},{"id":"9526c853.237968","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Tracks","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":570,"y":680,"wires":[["ac54f018.d32e7","f2abd7ed.b85238"]]},{"id":"1449fdf2.e40e42","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":2690,"y":680,"wires":[["9dee9eed.4e4e5"]]},{"id":"f73d72ec.acd28","type":"spotify","z":"7b0de646.c85c78","name":"Getting Old Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1270,"y":680,"wires":[["9308b9d3.af0f18"]]},{"id":"ac54f018.d32e7","type":"function","z":"7b0de646.c85c78","name":"Top Germany Archive","func":"flow.set(\"topGermanyTracks\", msg.payload.items)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '76J4h1CN1vbZltoq7lYB4R',\n        {offset: 0}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":800,"y":680,"wires":[["b7f81fc2.a4d9f"]]},{"id":"9308b9d3.af0f18","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"topGermanyOldAux\");\nvar oldArrayAux = flow.get(\"topGermanyOldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"topGermanyOldArrayAux\", newOldArrayAux);\nflow.set(\"topGermanyOldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n    \n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1480,"y":680,"wires":[["cb029a42.b53af8"]]},{"id":"96ea9b53.d6af88","type":"inject","z":"7b0de646.c85c78","name":"","repeat":"","crontab":"00 15 * * 3,4","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":680,"wires":[["75c460e0.d6bd"]]},{"id":"75c460e0.d6bd","type":"function","z":"7b0de646.c85c78","name":"Top Germany","func":"var newMsg;\nflow.set(\"topGermanyOldAux\", 0);\nflow.set(\"topGermanyOldArrayAux\", []);\nflow.set(\"topGermanyTracks\", [])\nflow.set(\"topGermanyOffset\",100);\nnewMsg = {\n    \"params\":[\n        '6HiZDoQlmYliE3RhFm4Fek'\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":360,"y":680,"wires":[["9526c853.237968"]]},{"id":"3b45c7.2b64aa3a","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1880,"y":680,"wires":[["5c514e54.0051c"],["b613bfd5.3d21","9dd4c7c1.ede508"]]},{"id":"5c514e54.0051c","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"offsetAux = flow.get(\"topGermanyOffset\");\nflow.set(\"topGermanyOffset\",offsetAux+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '76J4h1CN1vbZltoq7lYB4R',\n        {offset: offsetAux}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1800,"y":600,"wires":[["f73d72ec.acd28"]]},{"id":"b613bfd5.3d21","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"topGermanyTracks\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nfor(var i=0; i<newTracks.length; i++) {\n    alreadyIn = false;\n    for(var j=0; j<oldTracks.length; j++) {\n        if(newTracks[i].track.id === oldTracks[j].track.id){\n            alreadyIn = true\n        }\n    }\n    if(alreadyIn === false){\n        auxString = \"['\" + newTracks[i].track.uri + \"']\"\n        newMsg = {\n            \"params\":[\n                \"76J4h1CN1vbZltoq7lYB4R\",\n                [newTracks[i].track.uri]\n            ]}\n        node.send(newMsg);\n\n    }\n}\nflow.set(\"topGermanyOldArrayAux\", []);\nflow.set(\"topGermanyTracks\", [])","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":680,"wires":[["b386b533.a16958","193322b1.238e5d"]]},{"id":"cb029a42.b53af8","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":680,"wires":[["3b45c7.2b64aa3a"]]},{"id":"9dd4c7c1.ede508","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2200,"y":760,"wires":[]},{"id":"b7f81fc2.a4d9f","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1040,"y":680,"wires":[["f73d72ec.acd28"]]},{"id":"b386b533.a16958","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2450,"y":680,"wires":[["1449fdf2.e40e42"]]},{"id":"f2abd7ed.b85238","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":760,"y":740,"wires":[]},{"id":"193322b1.238e5d","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2490,"y":760,"wires":[]},{"id":"9dee9eed.4e4e5","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2890,"y":760,"wires":[]},{"id":"95ecd622.cc6388","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Tracks","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":570,"y":900,"wires":[["d7f8f9f0.61ba68","51770cfc.313aa4"]]},{"id":"63081ad6.b1a454","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":2690,"y":900,"wires":[["eb719cd7.29dee"]]},{"id":"4cec2d74.c449a4","type":"spotify","z":"7b0de646.c85c78","name":"Getting Old Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1270,"y":900,"wires":[["466a0bbb.b6baf4"]]},{"id":"d7f8f9f0.61ba68","type":"function","z":"7b0de646.c85c78","name":"Top Danmark Archive","func":"flow.set(\"topDanmarkTracks\", msg.payload.items)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '1YlehTYisXGTKxCW3Nm32q',\n        {offset: 0}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":800,"y":900,"wires":[["bed80d53.23eb5"]]},{"id":"466a0bbb.b6baf4","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"topDanmarkOldAux\");\nvar oldArrayAux = flow.get(\"topDanmarkOldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n            newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"topDanmarkOldArrayAux\", newOldArrayAux);\nflow.set(\"topDanmarkOldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n    \n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1480,"y":900,"wires":[["bdd45785.4dc018"]]},{"id":"ba6f5458.416e28","type":"inject","z":"7b0de646.c85c78","name":"","repeat":"","crontab":"00 15 * * 3,4","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":900,"wires":[["5a0a074c.c44308"]]},{"id":"5a0a074c.c44308","type":"function","z":"7b0de646.c85c78","name":"Top Danmark","func":"var newMsg;\nflow.set(\"topDanmarkOldAux\", 0);\nflow.set(\"topDanmarkOldArrayAux\", []);\nflow.set(\"topDanmarkTracks\", [])\nflow.set(\"topDanmarkOffset\",100);\nnewMsg = {\n    \"params\":[\n        '3YJe3cIXVuL3Eh3b5QoEu1'\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":350,"y":900,"wires":[["95ecd622.cc6388"]]},{"id":"d1fbe463.6b92c8","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1880,"y":900,"wires":[["2520435e.7eab2c"],["5a71e15d.fa062","aa7d309c.076e4"]]},{"id":"2520435e.7eab2c","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"offsetAux = flow.get(\"topDanmarkOffset\");\nflow.set(\"topDanmarkOffset\",offsetAux+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '1YlehTYisXGTKxCW3Nm32q',\n        {offset: offsetAux}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1800,"y":820,"wires":[["4cec2d74.c449a4"]]},{"id":"5a71e15d.fa062","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"topDanmarkTracks\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nfor(var i=0; i<newTracks.length; i++) {\n    alreadyIn = false;\n    for(var j=0; j<oldTracks.length; j++) {\n        if(newTracks[i].track.id === oldTracks[j].track.id){\n            alreadyIn = true\n        }\n    }\n    if(alreadyIn === false){\n        auxString = \"['\" + newTracks[i].track.uri + \"']\"\n        newMsg = {\n            \"params\":[\n                \"1YlehTYisXGTKxCW3Nm32q\",\n                [newTracks[i].track.uri]\n            ]}\n        node.send(newMsg);\n\n    }\n}\nflow.set(\"topDanmarkOldArrayAux\", []);\nflow.set(\"topDanmarkTracks\", [])","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":900,"wires":[["926e4f0e.04832","d18c7825.592818"]]},{"id":"bdd45785.4dc018","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":900,"wires":[["d1fbe463.6b92c8"]]},{"id":"aa7d309c.076e4","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2200,"y":980,"wires":[]},{"id":"bed80d53.23eb5","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1040,"y":900,"wires":[["4cec2d74.c449a4"]]},{"id":"926e4f0e.04832","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2450,"y":900,"wires":[["63081ad6.b1a454"]]},{"id":"51770cfc.313aa4","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":760,"y":960,"wires":[]},{"id":"d18c7825.592818","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2490,"y":980,"wires":[]},{"id":"eb719cd7.29dee","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2890,"y":980,"wires":[]},{"id":"eab315a0.b32508","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Tracks","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":570,"y":1100,"wires":[["9f180e48.be25f","576113b.438ecec"]]},{"id":"2a8b0457.6890ec","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":2690,"y":1100,"wires":[["7e3bfef.54acc"]]},{"id":"91bdc8a3.79b4b8","type":"spotify","z":"7b0de646.c85c78","name":"Getting Old Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1270,"y":1100,"wires":[["cbb6c18a.5a496"]]},{"id":"9f180e48.be25f","type":"function","z":"7b0de646.c85c78","name":"Global X Archive","func":"flow.set(\"globalXTracks\", msg.payload.items)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '50W5L0TYBG4YG8mWjGFRPl',\n        {offset: 0}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":790,"y":1100,"wires":[["e14cbf2.5776c4"]]},{"id":"cbb6c18a.5a496","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"globalXOldAux\");\nvar oldArrayAux = flow.get(\"globalXOldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"globalXOldArrayAux\", newOldArrayAux);\nflow.set(\"globalXOldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n    \n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1480,"y":1100,"wires":[["36559b7d.cbd544"]]},{"id":"e82f0b79.1baea8","type":"inject","z":"7b0de646.c85c78","name":"","repeat":"","crontab":"00 16 * * 4","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":1100,"wires":[["cbc315d0.e9da88"]]},{"id":"cbc315d0.e9da88","type":"function","z":"7b0de646.c85c78","name":"Global X","func":"var newMsg;\nflow.set(\"globalXOldAux\", 0);\nflow.set(\"globalXOldArrayAux\", []);\nflow.set(\"globalXTracks\", [])\nflow.set(\"globalXOffset\",100);\nnewMsg = {\n    \"params\":[\n        '37i9dQZF1DWUxHPh2rEiHr'\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":1100,"wires":[["eab315a0.b32508"]]},{"id":"65a9568d.250a68","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1880,"y":1100,"wires":[["6f3bb583.34082c"],["e7ef7fdb.13438","c0f3ee22.d1d0b"]]},{"id":"6f3bb583.34082c","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"offsetAux = flow.get(\"globalXOffset\");\nflow.set(\"globalXOffset\",offsetAux+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '50W5L0TYBG4YG8mWjGFRPl',\n        {offset: offsetAux}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"x":1800,"y":1020,"wires":[["91bdc8a3.79b4b8"]]},{"id":"e7ef7fdb.13438","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"globalXTracks\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nfor(var i=0; i<newTracks.length; i++) {\n    alreadyIn = false;\n    for(var j=0; j<oldTracks.length; j++) {\n        if(newTracks[i].track.id === oldTracks[j].track.id){\n            alreadyIn = true\n        }\n    }\n    if(alreadyIn === false){\n        auxString = \"['\" + newTracks[i].track.uri + \"']\"\n        newMsg = {\n            \"params\":[\n                \"50W5L0TYBG4YG8mWjGFRPl\",\n                [newTracks[i].track.uri]\n            ]}\n        node.send(newMsg);\n\n    }\n}\nflow.set(\"globalXOldArrayAux\", []);\nflow.set(\"globalXTracks\", [])","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":1100,"wires":[["964614b1.ac6608","f5bb9ecd.21ea1"]]},{"id":"36559b7d.cbd544","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":1100,"wires":[["65a9568d.250a68"]]},{"id":"c0f3ee22.d1d0b","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2200,"y":1180,"wires":[]},{"id":"e14cbf2.5776c4","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1040,"y":1100,"wires":[["91bdc8a3.79b4b8"]]},{"id":"964614b1.ac6608","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2450,"y":1100,"wires":[["2a8b0457.6890ec"]]},{"id":"576113b.438ecec","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":760,"y":1160,"wires":[]},{"id":"f5bb9ecd.21ea1","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2490,"y":1180,"wires":[]},{"id":"7e3bfef.54acc","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2890,"y":1180,"wires":[]},{"id":"96f1b6c9.bcebc8","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Tracks","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":570,"y":1320,"wires":[["ace14571.337cc8","be04c8f3.ddc9b8"]]},{"id":"89fb334.1345bd","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":2690,"y":1320,"wires":[["ad1eb4b3.a3a608"]]},{"id":"1c0ed305.a524bd","type":"spotify","z":"7b0de646.c85c78","name":"Getting Old Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1270,"y":1320,"wires":[["8dd81a7a.e1d088","b9019e06.741ed"]]},{"id":"ace14571.337cc8","type":"function","z":"7b0de646.c85c78","name":"Top Finland Archive","func":"flow.set(\"topFinlandTracks\", msg.payload.items)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '2FbFhJ9br4ACkAzSWQTlte',\n        {offset: 0}\n    ]\n}\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":790,"y":1320,"wires":[["79c4403c.0a419"]]},{"id":"8dd81a7a.e1d088","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"topFinlandOldAux\");\nvar oldArrayAux = flow.get(\"topFinlandOldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"topFinlandOldArrayAux\", newOldArrayAux);\nflow.set(\"topFinlandOldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1480,"y":1320,"wires":[["80abdb8d.878ec8"]]},{"id":"5afb1af8.29af64","type":"inject","z":"7b0de646.c85c78","name":"","repeat":"","crontab":"00 17 * * 3,4","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":1320,"wires":[["29068bfd.22bb54"]]},{"id":"29068bfd.22bb54","type":"function","z":"7b0de646.c85c78","name":"Top Finland","func":"var newMsg;\nflow.set(\"topFinlandOldAux\", 0);\nflow.set(\"topFinlandOldArrayAux\", []);\nflow.set(\"topFinlandTracks\", [])\nflow.set(\"topFinlandOffset\",100);\nnewMsg = {\n    \"params\":[\n        '37i9dQZEVXbMxcczTSoGwZ'\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":350,"y":1320,"wires":[["96f1b6c9.bcebc8"]]},{"id":"82fa33e2.8c3c","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1880,"y":1320,"wires":[["91f62074.83a54"],["d7d9c589.d3e5a8","e4adab67.da9048"]]},{"id":"91f62074.83a54","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"discoverWeeklyOffset = flow.get(\"topFinlandOffset\");\nflow.set(\"topFinlandOffset\",discoverWeeklyOffset+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '2FbFhJ9br4ACkAzSWQTlte',\n        {offset: discoverWeeklyOffset}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1800,"y":1240,"wires":[["1c0ed305.a524bd"]]},{"id":"d7d9c589.d3e5a8","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"topFinlandTracks\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nvar i;\n        for(i=0; i<newTracks.length; i++) {\n            alreadyIn = false;\n            for(var j=0; j<oldTracks.length; j++) {\n                if(newTracks[i].track.id === oldTracks[j].track.id){\n                    alreadyIn = true\n                }\n            }\n            if(alreadyIn === false){\n                auxString = \"['\" + newTracks[i].track.uri + \"']\"\n                newMsg = {\n                    \"params\":[\n                        \"2FbFhJ9br4ACkAzSWQTlte\",\n                        [newTracks[i].track.uri]\n                    ]}\n                node.send(newMsg);\n        \n            }\n        }\nflow.set(\"topFinlandOldArrayAux\", []);\nflow.set(\"topFinlandTracks\", [])","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":1320,"wires":[["be0d0c47.0b465","7cdd74fa.2c834c"]]},{"id":"80abdb8d.878ec8","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":1320,"wires":[["82fa33e2.8c3c"]]},{"id":"e4adab67.da9048","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2200,"y":1400,"wires":[]},{"id":"79c4403c.0a419","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1040,"y":1320,"wires":[["1c0ed305.a524bd"]]},{"id":"be0d0c47.0b465","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2450,"y":1320,"wires":[["89fb334.1345bd"]]},{"id":"be04c8f3.ddc9b8","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":760,"y":1380,"wires":[]},{"id":"7cdd74fa.2c834c","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2490,"y":1400,"wires":[]},{"id":"ad1eb4b3.a3a608","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2890,"y":1400,"wires":[]},{"id":"b9019e06.741ed","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1450,"y":1380,"wires":[]},{"id":"7840428.2ec55bc","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"20","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1510,"y":400,"wires":[["a2a4940d.a23088"]]},{"id":"4943a9f0.439568","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":990,"y":4280,"wires":[]},{"id":"b64bd9f1.625ab8","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":710,"y":4280,"wires":[]},{"id":"1464f5f6.04b21a","type":"function","z":"d67ca66.293d758","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Café pronto\", \"message\": \"O café está pronto\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":990,"y":1740,"wires":[["744d12ad.5a64ac"]]},{"id":"fda88def.b69f6","type":"link in","z":"859b066a.dd8128","name":"Botao Quarto","links":["c1f2906e.f1bc6","7f6d2d52.017e94"],"x":275,"y":1280,"wires":[["e740020e.82078","5eb62a84.b20844"]]},{"id":"6adec2d1.8d8afc","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":930,"y":1300,"wires":[]},{"id":"a50fec65.4ec2","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1590,"y":1100,"wires":[["ce1bcdf1.593cb"]]},{"id":"315759a.85645a6","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1590,"y":1220,"wires":[["4cf5516a.7f55"]]},{"id":"97a94c63.cf63d","type":"function","z":"859b066a.dd8128","name":"In Case of Error","func":"var newMsg;\nnewMsg = {payload:{\"On\":true}}\nreturn newMsg;","outputs":1,"noerr":0,"x":1420,"y":1220,"wires":[["315759a.85645a6"]]},{"id":"8a64803e.2782f","type":"function","z":"859b066a.dd8128","name":"In Case of Error","func":"var newMsg;\nnewMsg = {payload:true}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1420,"y":1100,"wires":[["a50fec65.4ec2"]]},{"id":"91098119.f77d8","type":"inject","z":"5767c936.cabd18","name":"Liga a Luz","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"1","payloadType":"str","x":1060,"y":180,"wires":[["db6caf2c.e2ac4"]]},{"id":"5d29cf32.e961","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1280,"y":840,"wires":[["a4f518c2.079878"]]},{"id":"b6f15c21.550fa","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1300,"y":1000,"wires":[["b7203386.43b91"]]},{"id":"e164b7af.c75a38","type":"comment","z":"5767c936.cabd18","name":"Ajuda do Sensor de Movimento","info":"","x":330,"y":1500,"wires":[]},{"id":"6e4d9674.425e78","type":"inject","z":"d67ca66.293d758","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"30 00 * * 1,2,3,4,0","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":310,"y":1520,"wires":[["67c9d186.cfabb"]]},{"id":"1ffbc922.856317","type":"inject","z":"d67ca66.293d758","name":"","repeat":"","crontab":"00 00 * * 1,2,3,4,0","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":310,"y":1460,"wires":[["e592bd76.6e2c3"]]},{"id":"41408462.ac874c","type":"inject","z":"d67ca66.293d758","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 01 * * 1,2,3,4,0","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":310,"y":1580,"wires":[["2522c34f.ceba4c"]]},{"id":"e592bd76.6e2c3","type":"function","z":"d67ca66.293d758","name":"Volume 12","func":"if(global.get(\"horaDoFilme\") === false){\n    var newMsg;\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_VOL12\"\n        }\n    }\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":470,"y":1460,"wires":[["7511e273.ed96cc"]]},{"id":"67c9d186.cfabb","type":"function","z":"d67ca66.293d758","name":"Volume 10","func":"if(global.get(\"horaDoFilme\") === false){\n    var newMsg;\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_VOL10\"\n        }\n    }\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":470,"y":1520,"wires":[["7511e273.ed96cc"]]},{"id":"2522c34f.ceba4c","type":"function","z":"d67ca66.293d758","name":"Volume 8","func":"if(global.get(\"horaDoFilme\") === false){\n    var newMsg;\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_VOL8\"\n        }\n    }\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":460,"y":1580,"wires":[["7511e273.ed96cc"]]},{"id":"532314fa.f2012c","type":"function","z":"e7cd1901.ee2408","name":"Luz da Sala On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\",\n            \"brightness_pct\": 100,\n            \"kelvin\": 6200\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2480,"y":1020,"wires":[["1dc6a3d6.67629c"]]},{"id":"d67e4ab.c1b5bb8","type":"catch","z":"d3db5d74.fb8fa","name":"","scope":null,"uncaught":false,"x":240,"y":3120,"wires":[["71498996.90f268","6f7f9381.9d1d6c"]]},{"id":"4e5d0f81.f3bd5","type":"function","z":"d3db5d74.fb8fa","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no Aqara Sensores.\"});\n    var shouldSend = true;\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            if(msg.error[i].message !== \"getaddrinfo EAI_AGAIN api.darksky.net\"){\n                msg.payload = msg.payload + \"Erro numero \"+ i +\n                \"id: \" + msg.error[i].source.id+\". \"+\n                msg.error[i].source.name+ \". Tipo de erro:\" + \n                msg.error[i].source.type + \". Mensagem: \" +\n                msg.error[i].message + \"\\n\\n\";\n            }\n            else{\n                shouldSend = false;\n            }\n            \n        }\n    }\n    else{\n        if(msg.error.message !== \"getaddrinfo EAI_AGAIN api.darksky.net\"){\n            msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n            msg.error.source.name+ \". Tipo de erro:\" + \n            msg.error.source.type + \". Mensagem: \" +\n            msg.error.message;\n        }\n        else{\n            shouldSend = false;\n        }\n    }\n   if(shouldSend){\n        return msg;\n    }\n}\nEAI_AGAIN \nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1060,"y":3100,"wires":[["7ae9832b.29fcac","f415c6d8.4cbf48","2c9b56bf.9f838a"]]},{"id":"71498996.90f268","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":310,"y":3240,"wires":[["2934582d.184ef8"]]},{"id":"2934582d.184ef8","type":"function","z":"d3db5d74.fb8fa","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);\nglobal.set(\"ContCatchErrors\", 0);\n","outputs":1,"noerr":0,"x":490,"y":3240,"wires":[[]]},{"id":"e92d8962.b7bc48","type":"join","z":"d3db5d74.fb8fa","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":890,"y":3160,"wires":[["4e5d0f81.f3bd5"]]},{"id":"44fbab0a.7f3934","type":"switch","z":"d3db5d74.fb8fa","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":750,"y":3120,"wires":[["4e5d0f81.f3bd5"],["e92d8962.b7bc48"]]},{"id":"3706cb36.6a7874","type":"function","z":"d3db5d74.fb8fa","name":"Cont++","func":"if(global.get(\"ContCatchErrors\") === 0){\n\n    global.set(\"ContCatchErrors\", 1);\n    msg.ajuda = 1;    \n    return msg;\n}\nif(global.get(\"ContCatchErrors\") > 0){\n    global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n    msg.ajuda = 2;\n    return msg;\n    \n}\n","outputs":1,"noerr":0,"x":530,"y":3120,"wires":[["44fbab0a.7f3934"]]},{"id":"2c9b56bf.9f838a","type":"function","z":"d3db5d74.fb8fa","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1250,"y":3060,"wires":[["e2dc6379.4e9bb"]]},{"id":"edc059ec.cdd2e8","type":"comment","z":"d3db5d74.fb8fa","name":"Catching Errors and notifying","info":"","x":280,"y":3060,"wires":[]},{"id":"6f7f9381.9d1d6c","type":"switch","z":"d3db5d74.fb8fa","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":390,"y":3120,"wires":[[],["3706cb36.6a7874"]]},{"id":"150ad16c.450bbf","type":"catch","z":"d67ca66.293d758","name":"","scope":null,"uncaught":false,"x":240,"y":4700,"wires":[["2840121.e88ebee","e452b105.67aff"]]},{"id":"b2c539ee.0865c8","type":"function","z":"d67ca66.293d758","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no Home Assistant Automation.\"});\n\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            msg.payload = msg.payload + \"Erro numero \"+ i +\n            \"id: \" + msg.error[i].source.id+\". \"+\n            msg.error[i].source.name+ \". Tipo de erro:\" + \n            msg.error[i].source.type + \". Mensagem: \" +\n            msg.error[i].message + \"\\n\\n\";\n            \n        }\n    }\n    else{\n        msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n        msg.error.source.name+ \". Tipo de erro:\" + \n        msg.error.source.type + \". Mensagem: \" +\n        msg.error.message;\n    }\n   \n        return msg;\n}\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"x":1060,"y":4680,"wires":[["642c7690.ce47d8","2034f8fb.2e2178","867dbbf8.3fce58"]]},{"id":"2840121.e88ebee","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":310,"y":4820,"wires":[["cbd077a.ec12188"]]},{"id":"cbd077a.ec12188","type":"function","z":"d67ca66.293d758","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);\nglobal.set(\"ContCatchErrors\", 0);\n","outputs":1,"noerr":0,"x":490,"y":4820,"wires":[[]]},{"id":"76961ef1.e7a94","type":"join","z":"d67ca66.293d758","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":890,"y":4740,"wires":[["b2c539ee.0865c8"]]},{"id":"d6fd7f59.d5ba3","type":"switch","z":"d67ca66.293d758","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":750,"y":4700,"wires":[["b2c539ee.0865c8"],["76961ef1.e7a94"]]},{"id":"3e4b1469.06937c","type":"function","z":"d67ca66.293d758","name":"Cont++","func":"if(!msg.error[i].message.includes('Conflict'))\n{\n    if(global.get(\"ContCatchErrors\") === 0){\n\n        global.set(\"ContCatchErrors\", 1);\n        msg.ajuda = 1;    \n        return msg;\n    }\n    if(global.get(\"ContCatchErrors\") > 0){\n        global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n        msg.ajuda = 2;\n        return msg;\n        \n    }\n}","outputs":1,"noerr":0,"x":530,"y":4700,"wires":[["d6fd7f59.d5ba3"]]},{"id":"867dbbf8.3fce58","type":"function","z":"d67ca66.293d758","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"x":1250,"y":4640,"wires":[["393f8bc8.a11c74"]]},{"id":"d96e24c2.d84098","type":"comment","z":"d67ca66.293d758","name":"Catching Errors and notifying","info":"","x":280,"y":4640,"wires":[]},{"id":"e452b105.67aff","type":"switch","z":"d67ca66.293d758","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":390,"y":4700,"wires":[[],["3e4b1469.06937c"]]},{"id":"d6a00fa7.28e1f","type":"catch","z":"7b0de646.c85c78","name":"","scope":null,"uncaught":false,"x":340,"y":4660,"wires":[["a7222489.76dc98","2e3122ba.5aa62e"]]},{"id":"ec204fa6.59f2d","type":"function","z":"7b0de646.c85c78","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no Spotify Helpers.\"});\n\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            msg.payload = msg.payload + \"Erro numero \"+ i +\n            \"id: \" + msg.error[i].source.id+\". \"+\n            msg.error[i].source.name+ \". Tipo de erro:\" + \n            msg.error[i].source.type + \". Mensagem: \" +\n            msg.error[i].message + \"\\n\\n\";\n            \n        }\n    }\n    else{\n        msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n        msg.error.source.name+ \". Tipo de erro:\" + \n        msg.error.source.type + \". Mensagem: \" +\n        msg.error.message;\n    }\n   \n        return msg;\n}\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"x":1160,"y":4640,"wires":[["308fbc11.8da8e4","f8ce5a3.d77dfa8","70a1d2a.048b02c"]]},{"id":"a7222489.76dc98","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":410,"y":4780,"wires":[["cd8e5d0d.4a98b"]]},{"id":"cd8e5d0d.4a98b","type":"function","z":"7b0de646.c85c78","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);\nglobal.set(\"ContCatchErrors\", 0);\n","outputs":1,"noerr":0,"x":590,"y":4780,"wires":[[]]},{"id":"97e093fb.01dda","type":"join","z":"7b0de646.c85c78","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":990,"y":4700,"wires":[["ec204fa6.59f2d"]]},{"id":"7ef04449.be5f0c","type":"switch","z":"7b0de646.c85c78","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":850,"y":4660,"wires":[["ec204fa6.59f2d"],["97e093fb.01dda"]]},{"id":"ed7fda08.f17278","type":"function","z":"7b0de646.c85c78","name":"Cont++","func":"if(global.get(\"ContCatchErrors\") === 0){\n\n    global.set(\"ContCatchErrors\", 1);\n    msg.ajuda = 1;    \n    return msg;\n}\nif(global.get(\"ContCatchErrors\") > 0){\n    global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n    msg.ajuda = 2;\n    return msg;\n    \n}\n","outputs":1,"noerr":0,"x":630,"y":4660,"wires":[["7ef04449.be5f0c"]]},{"id":"70a1d2a.048b02c","type":"function","z":"7b0de646.c85c78","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"x":1350,"y":4600,"wires":[["ee70b3b2.cd44d"]]},{"id":"b03a04b4.ef3348","type":"comment","z":"7b0de646.c85c78","name":"Catching Errors and notifying","info":"","x":380,"y":4600,"wires":[]},{"id":"2e3122ba.5aa62e","type":"switch","z":"7b0de646.c85c78","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":490,"y":4660,"wires":[[],["ed7fda08.f17278"]]},{"id":"51882b84.051b14","type":"catch","z":"444fced8.33ecb","name":"","scope":null,"uncaught":false,"x":240,"y":4860,"wires":[["818c9508.d03408","8922b86d.8e2bd8"]]},{"id":"96052d96.01437","type":"function","z":"444fced8.33ecb","name":"Create Error Message","func":"if(global.get(\"CatchErrors\") === false || global.get(\"ContCatchErrors\") > 4){\n    global.set(\"CatchErrors\", true);\n    msg = Object.assign({}, msg, {topic:\"Erro em uma automação no Alexa Automation.\"});\n    var shouldSend = true;\n    if(Array.isArray(msg.error) === true){\n        msg.payload = \" \";  \n     \n        for(var i = 0; i < 5; i++){\n            if(msg.error[i].message !== \"no JSON\"){\n                msg.payload = msg.payload + \"Erro numero \"+ i +\n                \"id: \" + msg.error[i].source.id+\". \"+\n                msg.error[i].source.name+ \". Tipo de erro:\" + \n                msg.error[i].source.type + \". Mensagem: \" +\n                msg.error[i].message + \"\\n\\n\";\n            }\n            else{\n                shouldSend = false;\n            }\n        }\n    }\n    else{\n        if(msg.error.message !== \"no JSON\"){\n            msg.payload = \"Erro \"+ msg.error.source.id+\" \"+\n            msg.error.source.name+ \". Tipo de erro:\" + \n            msg.error.source.type + \". Mensagem: \" +\n            msg.error.message;\n        }\n        else{\n            shouldSend = false;\n        }\n    }\n   if(shouldSend){\n        return msg;\n    }\n}\n\nglobal.set(\"ContCatchErrors\", 0);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1060,"y":4840,"wires":[["9bc14da8.26264","9b2713ec.a2e68"]]},{"id":"818c9508.d03408","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":310,"y":4980,"wires":[["d4ee3b86.fa23b8"]]},{"id":"d4ee3b86.fa23b8","type":"function","z":"444fced8.33ecb","name":"Reset Aux Variables","func":"global.set(\"CatchErrors\",false);\nglobal.set(\"ContCatchErrors\", 0);\n","outputs":1,"noerr":0,"x":490,"y":4980,"wires":[[]]},{"id":"e2a5696f.ad3558","type":"join","z":"444fced8.33ecb","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":890,"y":4900,"wires":[["96052d96.01437"]]},{"id":"1e55bc51.1f9584","type":"switch","z":"444fced8.33ecb","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":750,"y":4860,"wires":[["96052d96.01437"],["e2a5696f.ad3558"]]},{"id":"f719d417.dbe4c8","type":"function","z":"444fced8.33ecb","name":"Cont++","func":"if(global.get(\"ContCatchErrors\") === 0){\n\n    global.set(\"ContCatchErrors\", 1);\n    msg.ajuda = 1;    \n    return msg;\n}\nif(global.get(\"ContCatchErrors\") > 0){\n    global.set(\"ContCatchErrors\",global.get(\"ContCatchErrors\")+1);\n    msg.ajuda = 2;\n    return msg;\n    \n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":530,"y":4860,"wires":[["1e55bc51.1f9584"]]},{"id":"3b2b1ba5.92e3d4","type":"function","z":"444fced8.33ecb","name":"Check if it's day","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour < 23 && Hour > 10){\n    return msg;\n}","outputs":1,"noerr":0,"x":1780,"y":4840,"wires":[["401a175f.c09d28"]]},{"id":"23c71be0.c79dd4","type":"comment","z":"444fced8.33ecb","name":"Catching Errors and notifying","info":"","x":280,"y":4800,"wires":[]},{"id":"8922b86d.8e2bd8","type":"switch","z":"444fced8.33ecb","name":"","property":"error.message","propertyType":"msg","rules":[{"t":"cont","v":"unexpected response","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":390,"y":4860,"wires":[[],["f719d417.dbe4c8"]]},{"id":"77e7d976.53fa78","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delayv","timeout":"20","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1620,"y":660,"wires":[["cf903424.3a44c8"]]},{"id":"aa736933.be4ac8","type":"function","z":"2ea7fd8b.7e0bb2","name":"Delay + 20 min","func":"var newMsg = { \"reset\": true };\nnode.send(newMsg);\nnewMsg = {\"delay\" : 1200000} ;\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1440,"y":660,"wires":[["77e7d976.53fa78"]]},{"id":"cf903424.3a44c8","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload: {\n      \"domain\": \"input_boolean\",\n      \"service\": \"turn_off\",\n      \"entity_id\": \"input_boolean.sala_ocupada_switch\"\n    }};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1780,"y":660,"wires":[["9b4e3a94.a2fa78"]]},{"id":"a74b6985.a8c138","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delayv","timeout":"20","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1620,"y":900,"wires":[["c7e8b158.db904"]]},{"id":"ccf25148.857f","type":"function","z":"2ea7fd8b.7e0bb2","name":"Delay + 20 min","func":"var newMsg = { \"reset\": true };\nnode.send(newMsg);\nnewMsg = {\"delay\" : 1200000} ;\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1440,"y":900,"wires":[["a74b6985.a8c138"]]},{"id":"c7e8b158.db904","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload: {\n      \"domain\": \"input_boolean\",\n      \"service\": \"turn_off\",\n      \"entity_id\": \"input_boolean.cozinha_ocupada_switch\"\n      }};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1780,"y":900,"wires":[["4821aef.fa5a95"]]},{"id":"2c291c4f.3bcaa4","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delayv","timeout":"20","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1620,"y":1060,"wires":[["e8b377fb.080e78"]]},{"id":"39e201a5.0dd0ae","type":"function","z":"2ea7fd8b.7e0bb2","name":"Delay + 20 min","func":"var newMsg = { \"reset\": true };\nnode.send(newMsg);\nnewMsg = {\"delay\" : 1200000} ;\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1440,"y":1060,"wires":[["2c291c4f.3bcaa4"]]},{"id":"e8b377fb.080e78","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload: {\n      \"domain\": \"input_boolean\",\n      \"service\": \"turn_off\",\n      \"entity_id\": \"input_boolean.quarto_nedi_ocupado_switch\"\n    }};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1780,"y":1080,"wires":[["450a41b6.47521"]]},{"id":"eec3239f.5b027","type":"inject","z":"2ea7fd8b.7e0bb2","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"1200","crontab":"","once":true,"onceDelay":"600","topic":"","payload":"true","payloadType":"bool","x":230,"y":320,"wires":[["646d904c.6769f","44f37172.e6c4c","5f47554c.dcf13c","ccea9dd.3ac356"]]},{"id":"9ab5d2cd.a93c5","type":"function","z":"d67ca66.293d758","name":"Notificação","func":"if(msg.payload === \"on\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Update\", \"message\": \"Há uma nova atualização do Home Assistant\"}'\n  \n\n    }\n    }};\n    node.send(newMsg);\n    \n    \n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \"title\": \"Update\",\n        \"message\": \"Há uma nova atualização do Home Assistant\"\n\n    }\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":637,"y":2020,"wires":[["9d43e026.111f9"]]},{"id":"49e2ae6e.3770a","type":"function","z":"2ea7fd8b.7e0bb2","name":"Is it on?","func":"if(msg.payload === \"on\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":569,"y":800,"wires":[["2f7e965e.742a2a","664d1a0d.99fbd4"]]},{"id":"fe55583b.925df8","type":"function","z":"d3db5d74.fb8fa","name":"Botão Quarto Maria Click","func":"if(msg.payload.entity_id === \"binary_sensor.botao_quarto_maria\" && msg.payload.event.click_type === \"single\"){\n\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":340,"wires":[["a5bada24.753448"]]},{"id":"a5bada24.753448","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Clique Quarto Maria","links":["bf1670e7.f4493"],"x":715,"y":340,"wires":[]},{"id":"200a2af8.ab0036","type":"function","z":"d3db5d74.fb8fa","name":"Botão Quarto Maria Double","func":"if(msg.payload.entity_id === \"binary_sensor.botao_quarto_maria\" && msg.payload.event.click_type === \"double\"){\n\n    \n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":540,"y":380,"wires":[["a1c8520.4e51ab"]]},{"id":"a1c8520.4e51ab","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Duplo Clique Quarto Maria","links":["b76cbf74.d82fb","6642b0f3.696f5"],"x":715,"y":380,"wires":[]},{"id":"3774203b.8dc19","type":"function","z":"2ea7fd8b.7e0bb2","name":"At home?","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":560,"y":1040,"wires":[["2f7e965e.742a2a"]]},{"id":"2bede119.72612e","type":"function","z":"2ea7fd8b.7e0bb2","name":"At home?","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":560,"y":1100,"wires":[["2f7e965e.742a2a"]]},{"id":"1d22767b.f129aa","type":"function","z":"2ea7fd8b.7e0bb2","name":"At home?","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":560,"y":1160,"wires":[["2f7e965e.742a2a"]]},{"id":"52b72dee.4176d4","type":"function","z":"2bbba447.a4759c","name":"Triggered?","func":"if(flow.get(\"triggered1\")===true){\n    flow.set(\"triggered1\", false);\n    return msg;\n}","outputs":1,"noerr":0,"x":1010,"y":420,"wires":[["d851d997.3c2738"]]},{"id":"4a4d95ff.2ae1ec","type":"function","z":"444fced8.33ecb","name":"Atividade na Sala","func":"if(msg.payload.name===\"Echo Dot da Sala\"){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.sala_ocupada_switch\"\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":340,"wires":[["181bced0.749d31"]]},{"id":"bd72b3f8.afed","type":"function","z":"444fced8.33ecb","name":"Atividade no Quarto Nédi","func":"if(msg.payload.name===\"Echo Dot do Quarto Nédi\"){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.quarto_nedi_ocupado_swtich\"\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"x":549,"y":400,"wires":[["7b04e543.e5ac8c"]]},{"id":"c2af1e6b.5dd89","type":"function","z":"444fced8.33ecb","name":"Atividade na Cozinha","func":"if(msg.payload.name===\"Echo Dot da Cozinha\"){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.cozinha_ocupada_switch\"\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"x":540,"y":520,"wires":[["916545e5.635aa8"]]},{"id":"1c697dc3.2f69f2","type":"delay","z":"554bb518.994efc","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1220,"y":340,"wires":[["af96622f.78ac9"]]},{"id":"6a8fe430.294a0c","type":"inject","z":"d3db5d74.fb8fa","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":270,"y":1120,"wires":[["31339c0.ecc2764"]]},{"id":"50b47a4d.54fd14","type":"inject","z":"859b066a.dd8128","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2290,"y":80,"wires":[["5276a510.bf584c"]]},{"id":"d685bbde.8cfa28","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2620,"y":160,"wires":[]},{"id":"dd96d778.8e89b8","type":"function","z":"859b066a.dd8128","name":"Check if it's already On","func":"if(msg.payload === \"off\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":2240,"y":220,"wires":[["5276a510.bf584c"]]},{"id":"8f2f5dac.05e15","type":"function","z":"d67ca66.293d758","name":"Boa Noite Casa?","func":"if(\n    msg.payload.event.actionName === \"boa_noite_casa\"\n    ){\n    return {\"payload\": {\"On\": false, \"on\": false}};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":530,"y":2300,"wires":[["4177e2e9.cbc80c","49bcc954.2a4e38"]]},{"id":"93200b37.65da88","type":"function","z":"d67ca66.293d758","name":"Cozy Time?","func":"if(\n    msg.payload.event.actionName === \"cozy_time\"\n    ){\n    return {\"payload\": {\"On\": true}};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":2120,"wires":[["b97bc34b.2fbc2"]]},{"id":"b97bc34b.2fbc2","type":"link out","z":"d67ca66.293d758","name":"Cozy Time Action","links":["56beed64.231ab4","2707961c.839a4a"],"x":689,"y":2120,"wires":[]},{"id":"aeb9c42.5596d38","type":"function","z":"d67ca66.293d758","name":"Vou dormir?","func":"if(\n    msg.payload.event.actionName === \"vou_dormir\"\n    ){\n    return {\"payload\": {\"On\": true}};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":2180,"wires":[["54089fcf.dd297"]]},{"id":"54089fcf.dd297","type":"link out","z":"d67ca66.293d758","name":"Vou dormir Action","links":["17b7df66.4128b1"],"x":689,"y":2180,"wires":[]},{"id":"97ae9d93.03b45","type":"function","z":"d67ca66.293d758","name":"Movie Night?","func":"if(\n    msg.payload.event.actionName === \"movie_night\"\n    ){\n    return {\"payload\": {\"horaDoFilme\": true}};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":2240,"wires":[["9a1c72b3.da05c"]]},{"id":"9a1c72b3.da05c","type":"link out","z":"d67ca66.293d758","name":"Movie Night Action","links":["a3cf5b54.d11ca8"],"x":689,"y":2240,"wires":[]},{"id":"4177e2e9.cbc80c","type":"function","z":"d67ca66.293d758","name":"Turn Off Sala","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\"\n        }\n    }};\n    node.send(newMsg);\n\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\"\n        }\n    }};\n    node.send(newMsg);   \n\n\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.abajur_direita\"\n        }\n    }};\n    node.send(newMsg);         \n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.abajur_esquerda\"\n        }\n    }};\n    node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.luzes_do_escritorio\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.luzes_do_escritorio\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.sala\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.sala\"\n            }\n        }};\n    node.send(newMsg);  \n    \n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.sala_ocupada_switch\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":810,"y":2540,"wires":[["c9648a3c.d6a348"]]},{"id":"a1715e17.4597b","type":"link in","z":"d67ca66.293d758","name":"Boa Noite Casa","links":["4b42a86c.e9e038","1b8c3fb3.a193c"],"x":615,"y":2400,"wires":[["49bcc954.2a4e38","4177e2e9.cbc80c"]]},{"id":"49bcc954.2a4e38","type":"function","z":"d67ca66.293d758","name":"Turn Off","func":"global.set(\"SalaOn\", false);\nreturn {payload : {\"on\": false}};\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":800,"y":2300,"wires":[["aede74be.a867a8"]]},{"id":"225cdd12.c72e02","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"str","x":350,"y":1220,"wires":[["19554fb4.898e3"]]},{"id":"2680ecb7.43a464","type":"inject","z":"4c9c764d.9c4468","name":"Passou das 19:30","repeat":"","crontab":"30 19 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":730,"y":180,"wires":[["bb4ce455.0074a8"]]},{"id":"c41e4981.c0d638","type":"inject","z":"4c9c764d.9c4468","name":"Passou das 19:30","repeat":"","crontab":"30 19 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1350,"y":240,"wires":[["1a8b27f1.115c48"]]},{"id":"72f2a359.5c521c","type":"function","z":"e7cd1901.ee2408","name":"Luz da Sala On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\",\n            \"brightness\": msg.payload.bri,\n            \"kelvin\": msg.payload.ct\n        }\n    }};\n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3580,"y":120,"wires":[["e7c9d71f.790548"]]},{"id":"f047d207.54c4","type":"function","z":"5767c936.cabd18","name":"Luz do Escritório On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_1\",\n            \"brightness\": msg.payload.bri,\n            \"kelvin\": msg.payload.ct\n        }\n    }};\n    node.send(newMsg);\n    \n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2\",\n            \"brightness\": msg.payload.bri,\n            \"kelvin\": msg.payload.ct\n        }\n    }};\n    \n    return newMsg;\n\n// \"brightness\": parseInt((msg.payload.bri/2.55)+1)","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3440,"y":300,"wires":[["142cf903.1b62c7"]]},{"id":"95c52976.c05758","type":"function","z":"e7cd1901.ee2408","name":"In case of Error","func":"var newMsg;\nvar ctAux\nctAux = msg.data.attributes.color_temp\n\nctAux = Math.round(1000000 / ctAux);\n//ctAux = parseInt(ctAux * -12.5+8059)\nif(msg.payload === \"on\"){\n        newMsg = {payload:{state:{bri:msg.data.attributes.brightness,\n            ct: ctAux\n                                  }\n                            },\n                            came: \"HomeAssistant\"\n        };\n        return newMsg;\n}\nif(msg.payload === \"off\"){\n        newMsg = {payload:{resetar: true}};\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2027,"y":220,"wires":[["30e986e4.20ec7a"]]},{"id":"10709ab7.2877a5","type":"function","z":"5767c936.cabd18","name":"In case of Error","func":"var newMsg;\nvar ctAux\nctAux = msg.data.attributes.color_temp\n\nctAux = Math.round(1000000 / ctAux);\n//ctAux = parseInt(ctAux * -12.5+8059)\nif(msg.payload === \"on\"){\n        newMsg = {payload:{state:{bri:msg.data.attributes.brightness,\n            ct: ctAux\n                                  }\n                            },\n                            came: \"HomeAssistant\"\n        };\n        return newMsg;\n}\nif(msg.payload === \"off\"){\n        newMsg = {payload:{resetar: true}};\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1800,"y":280,"wires":[["c38ea8d9.112cc8"]]},{"id":"4b0ffe36.4217f","type":"debug","z":"e7cd1901.ee2408","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2020,"y":160,"wires":[]},{"id":"d9f0e7f6.c5a938","type":"function","z":"d3db5d74.fb8fa","name":"Aux Escritório Escuro","func":"if(msg.payload < 100){\n    global.set(\"escritorioEscuro\", true);\n}\nif(msg.payload < 60){\n    global.set(\"escritorioEscuro\", true);\n    return {\"payload\": {\"On\": true}};\n}","outputs":1,"noerr":0,"x":1260,"y":880,"wires":[["cc911481.98c798"]]},{"id":"7ac2d25c.e13b9c","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"rate","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"8","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2120,"y":300,"wires":[["5349675d.bda988"]]},{"id":"2d2b471d.051b18","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"rate","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"8","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2380,"y":260,"wires":[["2a05ae59.9f7e02"]]},{"id":"c38ea8d9.112cc8","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1960,"y":280,"wires":[["7ac2d25c.e13b9c"]]},{"id":"30e986e4.20ec7a","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2200,"y":220,"wires":[["2d2b471d.051b18"]]},{"id":"833e30e1.2f909","type":"switch","z":"5767c936.cabd18","name":"","property":"auxEmissor","propertyType":"flow","rules":[{"t":"eq","v":"Yeelight","vt":"str"},{"t":"eq","v":"HomeAssistant","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":3200,"y":220,"wires":[["f9ec74d2.448bd8"],["f047d207.54c4"]]},{"id":"70421787.bbae78","type":"function","z":"5767c936.cabd18","name":"Came From","func":"flow.set(\"auxEmissor\", msg.came);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2430,"y":300,"wires":[["187514be.470c7b"]]},{"id":"c8adf277.daab7","type":"change","z":"e7cd1901.ee2408","name":"","rules":[{"t":"delete","p":"reset","pt":"msg"},{"t":"delete","p":"came","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2840,"y":240,"wires":[["bceedc42.6aad4"]]},{"id":"94317e5a.295e5","type":"function","z":"e7cd1901.ee2408","name":"Came From","func":"flow.set(\"auxEmissor\", msg.came);\nreturn msg;","outputs":1,"noerr":0,"x":2670,"y":240,"wires":[["c8adf277.daab7"]]},{"id":"9cb07780.bcfb08","type":"switch","z":"e7cd1901.ee2408","name":"","property":"auxEmissor","propertyType":"flow","rules":[{"t":"eq","v":"HomeAssistant","vt":"str"},{"t":"eq","v":"Yeelight","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":3410,"y":160,"wires":[["72f2a359.5c521c","f56b8e30.19171"],["cecb4513.4195f8","8da5c7fb.88b508"]]},{"id":"72937ef4.b2531","type":"inject","z":"e7cd1901.ee2408","name":"Set bright","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1760,"y":680,"wires":[["56bfa971.e2ee68"]]},{"id":"56bfa971.e2ee68","type":"function","z":"e7cd1901.ee2408","name":"Bright","func":"flow.set(\"countBrightness\", 255);\nflow.set(\"auxCT\", 6100);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1910,"y":700,"wires":[[]]},{"id":"c9648a3c.d6a348","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"milliseconds","rate":"3","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":970,"y":2540,"wires":[["eb756d67.5b8c7"]]},{"id":"5a48819f.5863b","type":"function","z":"e7cd1901.ee2408","name":"Reset","func":"msg.reset = 1;\nreturn msg;","outputs":1,"noerr":0,"x":2650,"y":320,"wires":[["701ddd3a.218e34"]]},{"id":"34650f4f.5e35c","type":"function","z":"5767c936.cabd18","name":"Reset","func":"msg.reset = 1;\nreturn msg;","outputs":1,"noerr":0,"x":2410,"y":364,"wires":[["124b61c8.1527fe"]]},{"id":"cc911481.98c798","type":"link out","z":"d3db5d74.fb8fa","name":"","links":["6db289b5.2e7be8"],"x":1425,"y":880,"wires":[]},{"id":"bb4ce455.0074a8","type":"function","z":"4c9c764d.9c4468","name":"Escuro?","func":"global.set(\"salaEscura\", true);\nglobal.set(\"escritorioEscuro\", true);\nreturn msg;\n","outputs":1,"noerr":0,"x":920,"y":180,"wires":[["55f5a77a.253908"]]},{"id":"3d291f1c.4439","type":"function","z":"444fced8.33ecb","name":"Atividade no Quarto Maria","func":"if(msg.payload.name===\"Echo Dot do Quarto Maria\"){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.quarto_maria_ocupado_swtich\"\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"x":550,"y":460,"wires":[["ba5122b.ccbdfe"]]},{"id":"b649ab01.d53148","type":"function","z":"4c9c764d.9c4468","name":"Escuro?","func":"if(msg.payload < 60 && msg.payload > 0){\n                global.set(\"salaEscura\", true);\n                node.status({fill:\"green\",shape:\"dot\",text:\"SalaEscura true\"});\n                flow.set(\"triggered\", true);\n                node.send(msg);\n}\nif(msg.payload < 40 && msg.payload > 0){\n        global.set(\"auxTurnOnEscritorio\",true);\n    \n}\nelse if(msg.payload > 250){\n                global.set(\"salaEscura\", false);\n                node.status({fill:\"yellow\",shape:\"dot\",text:\"SalaEscura false\"});\n}\nif(msg.payload < 135 && msg.payload > 0){\n                global.set(\"escritorioEscuro\", true);\n                node.status({fill:\"green\",shape:\"dot\",text:\"EscritorioEscuro true\"});\n                flow.set(\"triggered\", true);\n                node.send(msg);\n}\nelse if(msg.payload > 300){\n                global.set(\"escritorioEscuro\", false);\n                node.status({fill:\"yellow\",shape:\"dot\",text:\"EscritorioEscuro false\"});\n}\n\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":920,"y":280,"wires":[["55f5a77a.253908"]]},{"id":"31b9e976.8077f6","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":760,"y":260,"wires":[["b649ab01.d53148","d27fe00c.72864"]]},{"id":"1f9e3931.bcd327","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":580,"y":260,"wires":[["31b9e976.8077f6"]]},{"id":"d1df1e50.00d2","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"group.rgb_strip_efeitos\"\n    }\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":840,"y":3380,"wires":[["6a5fa728.f3daa8"]]},{"id":"6a5fa728.f3daa8","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"3","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":990,"y":3380,"wires":[["2fafdb42.3f1dc4"]]},{"id":"d2cb09e7.582ad8","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3150,"y":1060,"wires":[["2e1d9879.f46658"]]},{"id":"d3e1203d.5d95a","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.rainbow_slow\"\n    }\n}};\nnode.send(newMsg);\n\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.3_cores\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.chase\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.chase_2\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.dark_cloud\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.hollywood\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.holofote\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.loading_bar\"\n    }\n}};\nnode.send(newMsg); \nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.oliver\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.palette\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.purple_green_palette\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.rainbow\"\n    }\n}};\nnode.send(newMsg); \nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.rainbow_stripes\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.random\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.sparkles\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.sparkles_colorido\"\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.unicornio\"\n    }\n}};\nnode.send(newMsg); \nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.rainbow_slow\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":3000,"y":1060,"wires":[["d2cb09e7.582ad8"]]},{"id":"6054501.5c1bbb","type":"exec","z":"554bb518.994efc","command":"journalctl -u nodered -all","addpay":false,"append":"","useSpawn":"true","timer":"","oldrc":false,"name":"last","x":410,"y":1300,"wires":[["8ae1f406.ba0098"],[],[]]},{"id":"8ae1f406.ba0098","type":"function","z":"554bb518.994efc","name":"prepare filename","func":"\nvar d = new Date();\nvar t = d.getTime();\nvar year = d.getFullYear();\nvar month = d.getMonth()+1; \nvar day = d.getDate();\nvar hour  = d.getHours();\nvar minute  = d.getMinutes();\n\nif(month.toString().length == 1) \n{\n    month = '0'+month;\n}\n\nmsg.filename = \"/home/pi/nodeRedLogFiles/nodeRedLog_\"+day+\"-\"+month+\"-\"+year+\"-\"+hour+\":\"+minute+\".csv\";\n\nreturn msg;","outputs":1,"noerr":0,"x":610,"y":1300,"wires":[["d974a220.0c8d3"]]},{"id":"5c663da1.a92fa4","type":"inject","z":"554bb518.994efc","name":"save last nodered-journal","repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":210,"y":1300,"wires":[["6054501.5c1bbb"]]},{"id":"d974a220.0c8d3","type":"file","z":"554bb518.994efc","name":"","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":810,"y":1300,"wires":[[]]},{"id":"13c4832e.98f7cd","type":"comment","z":"554bb518.994efc","name":"Save last journal nodered","info":"","x":170,"y":1240,"wires":[]},{"id":"d27fe00c.72864","type":"function","z":"4c9c764d.9c4468","name":"Escuro?","func":"if(msg.payload < 200 && msg.payload > 0){\n                node.send(msg);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":920,"y":240,"wires":[[]]},{"id":"7cb7d34c.c828fc","type":"function","z":"4c9c764d.9c4468","name":"Escuro?","func":"if(msg.payload < 250 && msg.payload > 0){\n                node.send(msg);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":920,"y":440,"wires":[[]]},{"id":"6e9440a1.3fa3a","type":"function","z":"d67ca66.293d758","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_nedi_title_aux\",\n    \"data\":{\n        \"value\": \"Café\",\n    \"entity_id\":\"input_text.notify_nedi_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_nedi_text_aux\",\n    \"data\":{         \n        \"value\": `{{ [ \"O Café está pronto.\", \"O Café está prontinho.\", \"Tem café quentinho na cozinha.\", \"Tem café na cozinha.\", \"Corre pra cozinha, o café está pronto.\", \"O Café está pronto na cozinha.\", \"O Café está quentinho te esperando.\"]|random }}`,\n    \"entity_id\":\"input_text.notify_nedi_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1190,"y":1820,"wires":[["d0f4c5c4.b63d28"]]},{"id":"d3b8b6e.d569048","type":"inject","z":"d67ca66.293d758","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"10 14 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":297,"y":1960,"wires":[["c580857d.99c3c8"]]},{"id":"59ef2215.5285dc","type":"function","z":"2ea7fd8b.7e0bb2","name":"Detected?","func":"if(msg.payload === \"on\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":570,"y":980,"wires":[["2f7e965e.742a2a","4d9c14f8.a18bcc"]]},{"id":"748845f7.408c5c","type":"function","z":"2ea7fd8b.7e0bb2","name":"Detected?","func":"if(msg.payload === \"on\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"x":570,"y":740,"wires":[["2f7e965e.742a2a","664d1a0d.99fbd4"]]},{"id":"fdc3de8.8813d2","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1260,"y":1160,"wires":[["4aad5e64.a78a5","940dd198.99b4e"]]},{"id":"12b642b0.7b50bd","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delayv","timeout":"20","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1620,"y":1220,"wires":[["3fcd9b73.acc8d4"]]},{"id":"940dd198.99b4e","type":"function","z":"2ea7fd8b.7e0bb2","name":"Delay + 20 min","func":"var newMsg = { \"reset\": true };\nnode.send(newMsg);\nnewMsg = {\"delay\" : 1200000} ;\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1440,"y":1220,"wires":[["12b642b0.7b50bd"]]},{"id":"3fcd9b73.acc8d4","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload: {\n      \"domain\": \"input_boolean\",\n      \"service\": \"turn_off\",\n      \"entity_id\": \"input_boolean.quarto_maria_ocupado_switch\"\n    }};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1780,"y":1240,"wires":[["9a60745.c28a788"]]},{"id":"4d9c14f8.a18bcc","type":"function","z":"2ea7fd8b.7e0bb2","name":"Turn On","func":"var newMsg;\nnewMsg= {payload: {\n      \"domain\": \"input_boolean\",\n      \"service\": \"turn_on\",\n      \"entity_id\": \"input_boolean.quarto_maria_ocupado_switch\"\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1100,"y":1160,"wires":[["fdc3de8.8813d2"]]},{"id":"3001e3b1.19278c","type":"debug","z":"e7cd1901.ee2408","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3220,"y":280,"wires":[]},{"id":"fdaa18d0.27a2c8","type":"debug","z":"e7cd1901.ee2408","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3370,"y":100,"wires":[]},{"id":"cecb4513.4195f8","type":"debug","z":"e7cd1901.ee2408","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3550,"y":300,"wires":[]},{"id":"5619a37.a00cb5c","type":"inject","z":"d67ca66.293d758","name":"7 AM","repeat":"","crontab":"00 07 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"false","payloadType":"bool","x":330,"y":2620,"wires":[["e751ce31.77dd5","feae1bf7.c67b28","d6210037.0c3e5"]]},{"id":"e751ce31.77dd5","type":"function","z":"d67ca66.293d758","name":"Turn Off","func":"    var newMsg;\n    \n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.boa_noite\"\n        }\n    }};\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.boa_noite_casa\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":470,"y":2620,"wires":[["fa9fbc55.e8df4"]]},{"id":"feae1bf7.c67b28","type":"function","z":"d67ca66.293d758","name":"Turn Off","func":"    var newMsg;\n    \n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.vou_dormir\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":470,"y":2680,"wires":[["e21d43ff.c4614"]]},{"id":"a984656a.c4e198","type":"function","z":"d3db5d74.fb8fa","name":"Janela Fechada","func":"if(msg.topic === \"binary_sensor.janela_quarto_maria\"){\n    if(msg.payload === false){\n        global.set(\"janelaQuartoMaria\",false);\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"x":520,"y":2040,"wires":[[]]},{"id":"1d1cb695.50aaa9","type":"function","z":"d3db5d74.fb8fa","name":"Janela Aberta","func":"if(msg.topic === \"binary_sensor.janela_quarto_maria\"){\n    if(msg.payload === true){\n        global.set(\"janelaQuartoMaria\",true);\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"x":520,"y":1980,"wires":[[]]},{"id":"3c9fc7.6938503a","type":"function","z":"d3db5d74.fb8fa","name":"Janela Fechada","func":"if(msg.topic === \"binary_sensor.janela_quarto_nedi\"){\n    if(msg.payload === false){\n        global.set(\"janelaQuartoNedi\",false);\n        msg.reset = true;\n        msg.payload = \"reset\"; \n        return msg;\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":2160,"wires":[["b9dc8e30.7f553"]]},{"id":"604c113d.67dae","type":"function","z":"d3db5d74.fb8fa","name":"Janela Aberta","func":"if(msg.topic === \"binary_sensor.janela_quarto_nedi\"){\n    if(msg.payload === true){\n        global.set(\"janelaQuartoNedi\",true);\n        return msg;\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":2100,"wires":[["b9dc8e30.7f553"]]},{"id":"a9fdd412.daee28","type":"function","z":"d3db5d74.fb8fa","name":"Janela Fechada","func":"if(msg.topic === \"binary_sensor.janela_quarto_pai\"){\n    if(msg.payload === false){\n        global.set(\"janelaQuartoPai\",false);\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"x":520,"y":2280,"wires":[[]]},{"id":"c565ad59.11f79","type":"function","z":"d3db5d74.fb8fa","name":"Janela Aberta","func":"if(msg.topic === \"binary_sensor.janela_quarto_pai\"){\n    if(msg.payload === true){\n        global.set(\"janelaQuartoPai\",true);\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"x":520,"y":2220,"wires":[[]]},{"id":"9c27139a.c24c1","type":"function","z":"d3db5d74.fb8fa","name":"Janela Fechada","func":"if(msg.topic === \"binary_sensor.janela_sala\"){\n    if(msg.payload === false){\n        global.set(\"janelaSala\",false);\n        msg.reset = true;\n        msg.payload = \"reset\"; \n        return msg;\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":2400,"wires":[["86c97a42.dedca8"]]},{"id":"93421936.7e0098","type":"function","z":"d3db5d74.fb8fa","name":"Janela Aberta","func":"if(msg.topic === \"binary_sensor.janela_sala\"){\n    if(msg.payload === true){\n        global.set(\"janelaSala\",true);\n        return msg;\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":2340,"wires":[["86c97a42.dedca8"]]},{"id":"66f9a3a3.4af88c","type":"inject","z":"d3db5d74.fb8fa","name":"Check Windows","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/30 8-22 * * *","once":true,"onceDelay":"600","topic":"","payload":"true","payloadType":"bool","x":1450,"y":2100,"wires":[["96da81b6.00201","3e92f633.39663a","1ad8fab2.69e7a5","49601c4b.d52b24","fdd737c0.8ed7b8","9478d381.e15f1"]]},{"id":"56c92056.79c58","type":"function","z":"d3db5d74.fb8fa","name":"janela aux","func":"global.set(\"janelaQuartoMaria\",msg.payload);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1910,"y":1940,"wires":[[]]},{"id":"b17398e3.0f3eb8","type":"function","z":"d3db5d74.fb8fa","name":"janela aux","func":"global.set(\"janelaQuartoNedi\",msg.payload);\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1910,"y":2000,"wires":[[]]},{"id":"527d99bb.e6e388","type":"function","z":"d3db5d74.fb8fa","name":"janela aux","func":"global.set(\"janelaQuartoPai\",msg.payload);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1910,"y":2060,"wires":[[]]},{"id":"e46425ff.0ef6f8","type":"function","z":"d3db5d74.fb8fa","name":"janela aux","func":"global.set(\"janelaSala\",msg.payload);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1910,"y":2180,"wires":[[]]},{"id":"d9852513.51ccc8","type":"function","z":"d3db5d74.fb8fa","name":"Chuva?","func":"var date = new Date();\nvar Day = date.getDay(); \nvar Hour = date.getHours();\nif( ((msg.data.currently.summary.includes(\"rain\")=== true ||\n    msg.data.currently.summary.includes(\"Rain\")=== true)  &&\n    msg.payload.precipitation > 5 ||\n    msg.data.currently.precipIntensity > 5 ||\n    msg.data.currently.precipProbability > 0.5)\n    && (Hour > 9 && Hour < 23)\n    ){\n    \n    global.set(\"chuvaAux\",true);\n    return {payload:1};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1920,"y":2380,"wires":[["3e2dd5e4.ef0e6a"]]},{"id":"c4144b54.079d28","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1760,"y":2380,"wires":[["d9852513.51ccc8","eaa67a7f.f32758"]]},{"id":"31ec1a11.2d0896","type":"function","z":"d3db5d74.fb8fa","name":"Chuva aux","func":"if(msg.payload.includes(\"rain\")===true &&\n    msg.data.attributes.precipitation > 5){\n    global.set(\"chuvaAux\", true);\n    return {payload:1};\n}\nelse{\n    global.set(\"chuvaAux\", false);\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1910,"y":2240,"wires":[["3e2dd5e4.ef0e6a"]]},{"id":"3e2dd5e4.ef0e6a","type":"function","z":"d3db5d74.fb8fa","name":"","func":"var date = new Date();\nvar Day = date.getDay(); \nvar Hour = date.getHours();\nvar janelaQuartoMaria = global.get(\"janelaQuartoMaria\");\nvar janelaQuartoNedi = global.get(\"janelaQuartoNedi\");\nvar janelaQuartoPai = global.get(\"janelaQuartoPai\");\nvar janelaSala = global.get(\"janelaSala\");\nvar chuvaNotifAux = global.get(\"chuvaNotifAux\");\nif(janelaQuartoMaria === true ||\n    janelaQuartoNedi === true || \n    janelaQuartoPai === true ||\n    janelaSala === true\n){\n    if (Hour > 9 && Hour < 22){\n        if(chuvaNotifAux === false){\n            global.set(\"chuvaNotifAux\", true);\n            return msg;\n        }\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2100,"y":2260,"wires":[["f6b82d7f.4e4bb","3e59019.44ca6fe","8fd21924.6c132","d263cd78.55659","201ebd4d.350902","be2416d8.56baa"]]},{"id":"3e59019.44ca6fe","type":"function","z":"d3db5d74.fb8fa","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Chuva\", \"message\": \"Há chance de chover agora e há janelas abertas.\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2370,"y":2240,"wires":[["b5022911.dfe1e8"]]},{"id":"11700620.30430a","type":"inject","z":"859b066a.dd8128","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1190,"y":1460,"wires":[["df7f6951.f1f2f8"]]},{"id":"f2c4c73c.d2fef8","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2210,"y":300,"wires":[]},{"id":"c6329c13.8e51a","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":720,"y":1720,"wires":[["95d42658.d910a8"]]},{"id":"a81304dc.ed1408","type":"inject","z":"7b0de646.c85c78","d":true,"name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"04 10 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":250,"y":3940,"wires":[["63d3e63.7cb6f18"]]},{"id":"8180ca54.706518","type":"function","z":"7b0de646.c85c78","name":"Play in Echo Dot","func":"for(var i = 0; i < msg.payload.devices.length; i++){\n    if(msg.payload.devices[i].name === \"Echo Dot do Quarto Nédi\" ||\n    msg.payload.devices[i].name === \"Amazon FireTV Stick Gen 2 ♘\" ||\n    msg.payload.devices[i].name === \"Fire TV Mano\" ||\n    msg.payload.devices[i].name === \"8105abdc-7d9f-419e-b855-a3075760c47c\"\n    ){\n        msg.params = [ {deviceIds: [msg.payload.devices[i].id], play: 'true'} ]; \n        return msg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1250,"y":4000,"wires":[["dfd63bec.abecd8","39b352c7.4b2f3e","532d45.1ad952bc"]]},{"id":"dfd63bec.abecd8","type":"spotify","z":"7b0de646.c85c78","name":"","auth":"3b9d50b6.bca4e","api":"transferMyPlayback","x":1490,"y":4040,"wires":[[]]},{"id":"7063225c.fb96cc","type":"spotify","z":"7b0de646.c85c78","name":"","auth":"3b9d50b6.bca4e","api":"play","x":1200,"y":4120,"wires":[[]]},{"id":"c051aae0.0977a8","type":"function","z":"7b0de646.c85c78","name":"Play 2021/1","func":"msg.params = [ {context_uri: \"spotify:playlist:3szB690Xq6L24GyDRfkk7W\"} ]; \nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1020,"y":4080,"wires":[["7063225c.fb96cc","a9858188.21d7c"]]},{"id":"386e1711.812158","type":"spotify","z":"7b0de646.c85c78","name":"Shuffle","auth":"3b9d50b6.bca4e","api":"setShuffle","x":1000,"y":4160,"wires":[[]]},{"id":"3eec978e.67c008","type":"function","z":"7b0de646.c85c78","name":"Set Shuffle","func":"msg.params = [ {state: \"true\"}, \"true\" ]; \nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":820,"y":4120,"wires":[["386e1711.812158","a00845b0.2978f8"]]},{"id":"1fb2f433.413ccc","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"delay","timeout":"4","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":830,"y":4040,"wires":[["c051aae0.0977a8"]]},{"id":"5d874223.5446fc","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":830,"y":3960,"wires":[["bcacc1f7.56127"]]},{"id":"7d6c8c4e.304f14","type":"function","z":"7b0de646.c85c78","name":"Notificação","func":"if(msg.payload === \"home\"){\n    return {payload: true};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":610,"y":3960,"wires":[["3eec978e.67c008","1fb2f433.413ccc","5d874223.5446fc"]]},{"id":"808a5ff8.37167","type":"function","z":"2ea7fd8b.7e0bb2","name":"True?","func":"if(msg.data.attributes.media_title === \"Netflix\" || \nmsg.data.attributes.media_title === \"PrimeVideo\"|| \nmsg.data.attributes.media_title === \"YouTube\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":570,"y":380,"wires":[["664d1a0d.99fbd4","2f7e965e.742a2a"]]},{"id":"bdaa44f3.e86668","type":"function","z":"2ea7fd8b.7e0bb2","name":"True?","func":"if(msg.payload === \"playing\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":570,"y":500,"wires":[["2f7e965e.742a2a","72213a3.890f9c4"]]},{"id":"37a840c9.0b82f","type":"function","z":"2ea7fd8b.7e0bb2","name":"True?","func":"if(msg.payload === \"playing\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":570,"y":440,"wires":[["2f7e965e.742a2a","664d1a0d.99fbd4"]]},{"id":"c5250d18.6422a","type":"function","z":"d67ca66.293d758","name":"Alguém chegou","func":"if(msg.payload === \"on\" || msg.payload === true){\n    var date = new Date();\n    var Hour = date.getHours();\n    if(Hour > 17){\n        return msg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":600,"y":2920,"wires":[["30f8b917.574e16"]]},{"id":"30f8b917.574e16","type":"function","z":"d67ca66.293d758","name":"Turn On","func":"msg.payload =\n    {\n    \"on\": true,\n    \"bri\": 190,\n    \"ct\": 6100\n};    \nglobal.set(\"SalaOnFirstTime\", false);\nglobal.set(\"SalaOn\", true);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":800,"y":2920,"wires":[["f3732032.9a3cb"]]},{"id":"77334325.c1f0bc","type":"function","z":"d67ca66.293d758","name":"Alguém chegou","func":"if(msg.payload === \"on\" || msg.payload === true){\n    var date = new Date();\n    var Hour = date.getHours();\n    if(Hour < 9){\n        return msg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":620,"y":3180,"wires":[["1657b8c3.270107"]]},{"id":"1657b8c3.270107","type":"function","z":"d67ca66.293d758","name":"Turn On","func":"msg.payload =\n    {\n    \"on\": true,\n    \"bri\": 50,\n    \"ct\": 6100\n};    \nglobal.set(\"SalaOnFirstTime\", false);\nglobal.set(\"SalaOn\", true);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":800,"y":3180,"wires":[["81c1d4f6.674d58"]]},{"id":"bcacc1f7.56127","type":"spotify","z":"7b0de646.c85c78","name":"","auth":"3b9d50b6.bca4e","api":"getMyDevices","x":1020,"y":3980,"wires":[["8180ca54.706518","e8f0f070.a02ca"]]},{"id":"8a61a341.0fa5d","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1040,"y":460,"wires":[["723cac3c.588f44"]]},{"id":"9cbf6d55.4769d","type":"function","z":"4c9c764d.9c4468","name":"Escuro?","func":"if(msg.payload < 20 && msg.payload > 0){\n                global.set(\"salaEscura\", true);\n                node.status({fill:\"green\",shape:\"dot\",text:\"SalaEscura true\"});\n                flow.set(\"triggered\", true);\n                node.send(msg);\n}\nelse if(msg.payload > 200){\n                global.set(\"salaEscura\", false);\n                node.status({fill:\"yellow\",shape:\"dot\",text:\"SalaEscura false\"});\n}\nif(msg.payload < 40 && msg.payload > 0){\n        global.set(\"auxTurnOnEscritorio\",true);\n    \n}\nif(msg.payload < 100 && msg.payload > 0){\n                global.set(\"escritorioEscuro\", true);\n                node.status({fill:\"green\",shape:\"dot\",text:\"EscritorioEscuro true\"});\n                flow.set(\"triggered\", true);\n                node.send(msg);\n}\nelse if(msg.payload > 200){\n                global.set(\"escritorioEscuro\", false);\n                node.status({fill:\"yellow\",shape:\"dot\",text:\"EscritorioEscuro false\"});\n}\n\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":920,"y":380,"wires":[["55f5a77a.253908"]]},{"id":"676b28e4.047048","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"15","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":760,"y":360,"wires":[["9cbf6d55.4769d","b3299f65.933ab"]]},{"id":"52ed3553.1f2cec","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":580,"y":360,"wires":[["676b28e4.047048"]]},{"id":"b3299f65.933ab","type":"function","z":"4c9c764d.9c4468","name":"Escuro?","func":"if(msg.payload < 50 && msg.payload > 0){\n                node.send(msg);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":920,"y":340,"wires":[[]]},{"id":"6930c113.943ca","type":"inject","z":"c3fa9bdb.b5c4c8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"15 13 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":210,"y":280,"wires":[["6bddf58.ebf350c"]]},{"id":"ac33d5bc.aa8068","type":"function","z":"c3fa9bdb.b5c4c8","name":"Maria?","func":"if(msg.payload === \"Maria\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":280,"wires":[["c49430f1.7a9de","1923568d.1f84e9","e425d305.db9848"]]},{"id":"5a987bdb.ac6c04","type":"function","z":"c3fa9bdb.b5c4c8","name":"Nédi?","func":"if(msg.payload === \"Nédi\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":500,"wires":[["e790e9be.717668","c967930a.b3464","ecb4430d.70b848"]]},{"id":"68714b3e.4ccae4","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pai?","func":"if(msg.payload === \"Cristofer\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":340,"wires":[["ff5115c0.b26c68","cff68409.de53f8","a147996f.835798"]]},{"id":"d9713983.882208","type":"inject","z":"c3fa9bdb.b5c4c8","d":true,"name":"","repeat":"","crontab":"00 18 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":550,"y":2960,"wires":[["6d293ca8.24be74"]]},{"id":"b91e061a.d39408","type":"function","z":"c3fa9bdb.b5c4c8","name":"Quantos dias?","func":"if(msg.payload != \"0.0\" && msg.payload != \"1.0\" && msg.payload != \"2.0\"){\n    global.set(\"diasSemLavarARoupa\", msg.payload);\n    return msg;\n}","outputs":1,"noerr":0,"x":1000,"y":2960,"wires":[["853118a2.875f38"]]},{"id":"a95e112b.38c53","type":"function","z":"c3fa9bdb.b5c4c8","name":"Maria?","func":"if(msg.payload === \"Maria\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1470,"y":2960,"wires":[["78918ff8.9914","b2a83312.9c275"]]},{"id":"95ade173.f04fe","type":"function","z":"c3fa9bdb.b5c4c8","name":"Nédi?","func":"if(msg.payload === \"Nédi\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1470,"y":3180,"wires":[["d50ff1d0.f48fd","f657f353.86dad","2c93691d.b8b696","26812f11.fb543"]]},{"id":"374c7c18.47d7a4","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pai?","func":"if(msg.payload === \"Cristofer\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1470,"y":3020,"wires":[["dbe6559.6453da8","f83db5ad.07d688"]]},{"id":"2c93691d.b8b696","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Louça\", \"message\": \"Hoje é seu dia de lavar a roupa. Já fazem mais de três dias que não são lavadas.\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"x":1710,"y":3140,"wires":[["90077918.20bc78"]]},{"id":"f657f353.86dad","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_macbook_pro_de_nedison\",\n    data:{\n        \n\n         message: 'Hoje é seu dia de lavar a roupa. Já fazem mais de '+ String(parseInt(global.get(\"diasSemLavarARoupa\")))+ ' dias que não são lavadas.'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1710,"y":3260,"wires":[["cfee3ce7.24f6c"]]},{"id":"d50ff1d0.f48fd","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \n  \n         message: 'Hoje é seu dia de lavar a roupa. Já fazem mais de '+ String(parseInt(global.get(\"diasSemLavarARoupa\")))+ ' dias que não são lavadas.'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1710,"y":3200,"wires":[["cb3cd3e5.3ec49"]]},{"id":"dbe6559.6453da8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_softcelular\",\n    data:{\n        \n         message: 'Hoje é seu dia de lavar a roupa. Já fazem mais de'+ String(parseInt(global.get(\"diasSemLavarARoupa\")))+ ' dias que não são lavadas.'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1710,"y":3020,"wires":[["36312c40.f34eb4"]]},{"id":"78918ff8.9914","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\nnewMsg= {payload : {\n\"domain\": \"notify\",\n\"service\": \"mobile_app_maria_s_iphone\",\ndata:{\n        \n         message: 'Hoje é seu dia de lavar a roupa. Já fazem mais de '+ String(parseInt(global.get(\"diasSemLavarARoupa\")))+ ' dias que não são lavadas.'\n  }\n}};\nreturn newMsg;\n","outputs":1,"noerr":0,"x":1710,"y":2960,"wires":[["562c2738.d5d178"]]},{"id":"ef780a63.9a8708","type":"inject","z":"c3fa9bdb.b5c4c8","d":true,"name":"","repeat":"","crontab":"00 19 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":550,"y":3500,"wires":[["92be78b6.fbb388"]]},{"id":"ebbfc12d.075ab","type":"function","z":"c3fa9bdb.b5c4c8","name":"Quantos dias?","func":"if(msg.payload != \"0.0\" && msg.payload != \"1.0\" && msg.payload != \"2.0\"){\n    global.set(\"diasSemLevarOLixo\", msg.payload);\n    return msg;\n}","outputs":1,"noerr":0,"x":1000,"y":3500,"wires":[["ef75412c.fa12d"]]},{"id":"70f8b4e8.f374ac","type":"function","z":"c3fa9bdb.b5c4c8","name":"Maria?","func":"if(msg.payload === \"Maria\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1470,"y":3500,"wires":[["19761596.e1f28a","a1313278.12632"]]},{"id":"4ec9d9a3.39fd98","type":"function","z":"c3fa9bdb.b5c4c8","name":"Nédi?","func":"if(msg.payload === \"Nédi\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1470,"y":3720,"wires":[["b40172ef.83dc5","2b9a4596.79daea","fe9ad91a.8b4fd8","ed51ac4c.90dbc"]]},{"id":"3d17cc07.1064b4","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pai?","func":"if(msg.payload === \"Cristofer\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1470,"y":3560,"wires":[["e8524f68.bf053","b829a5.308f3658"]]},{"id":"fe9ad91a.8b4fd8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Louça\", \"message\": \"Hoje é seu dia de levar o lixo. Já fazem mais de três dias que não são lavadas.\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"x":1710,"y":3680,"wires":[["17191daa.11b972"]]},{"id":"2b9a4596.79daea","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_macbook_pro_de_nedison\",\n    data:{\n        \n\n          message: 'Hoje é seu dia de levar o lixo. Já fazem mais de '+ String(parseInt(global.get(\"diasSemLevarOLixo\")))+ ' dias que o lixo não é levado.'\n \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1710,"y":3800,"wires":[["f651923f.adf3"]]},{"id":"b40172ef.83dc5","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \n  \n         message: 'Hoje é seu dia de levar o lixo. Já fazem mais de '+ String(parseInt(global.get(\"diasSemLevarOLixo\")))+ ' dias que o lixo não é levado.'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1710,"y":3740,"wires":[["e800b86b.ae0198"]]},{"id":"e8524f68.bf053","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_softcelular\",\n    data:{\n        \n         message: 'Hoje é seu dia de levar o lixo. Já fazem mais de '+ String(parseInt(global.get(\"diasSemLevarOLixo\")))+ ' dias que o lixo não é levado.'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1710,"y":3560,"wires":[["72bafa5e.611894"]]},{"id":"19761596.e1f28a","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\nnewMsg= {payload : {\n\"domain\": \"notify\",\n\"service\": \"mobile_app_maria_s_iphone\",\ndata:{\n        \n         message: 'Hoje é seu dia de levar o lixo. Já fazem mais de '+ String(parseInt(global.get(\"diasSemLevarOLixo\")))+ ' dias que o lixo não é levado.'\n  }\n}};\nreturn newMsg;\n","outputs":1,"noerr":0,"x":1710,"y":3500,"wires":[["cbd6f6e7.574348"]]},{"id":"3d5a35ba.7fd82a","type":"function","z":"c3fa9bdb.b5c4c8","name":"Maria?","func":"if(msg.payload === \"Maria\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1290,"y":4020,"wires":[["882310cc.40d48","669f4194.5e245"]]},{"id":"95918114.2ca78","type":"function","z":"c3fa9bdb.b5c4c8","name":"Nédi?","func":"if(msg.payload === \"Nédi\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1290,"y":4240,"wires":[["9bc85a26.713fd8","e01adce8.f3fcb","ad4e84e6.86bb88","bd2043b.25187c"]]},{"id":"4bc56fc6.d158e","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pai?","func":"if(msg.payload === \"Cristofer\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1290,"y":4080,"wires":[["24252baf.4e77e4","65ca6d3e.6c6414"]]},{"id":"ad4e84e6.86bb88","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Louça\", \"message\": \"A roupa já deve estar seca.\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"x":1530,"y":4200,"wires":[["4ab79159.2d5a9"]]},{"id":"e01adce8.f3fcb","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_macbook_pro_de_nedison\",\n    data:{\n        \n\n        \n         message: 'A roupa já deve estar seca'\n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1530,"y":4320,"wires":[["dec70c72.9e0d3"]]},{"id":"9bc85a26.713fd8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \n  \n         \n         message: 'A roupa já deve estar seca'\n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1530,"y":4260,"wires":[["68d446ac.aa3e78"]]},{"id":"24252baf.4e77e4","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_softcelular\",\n    data:{\n        \n         \n         message: 'A roupa já deve estar seca'\n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1530,"y":4080,"wires":[["8b585c69.df8bd"]]},{"id":"882310cc.40d48","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\nnewMsg= {payload : {\n\"domain\": \"notify\",\n\"service\": \"mobile_app_maria_s_iphone\",\ndata:{\n        \n         message: 'A roupa já deve estar seca'\n  }\n}};\nreturn newMsg;\n","outputs":1,"noerr":0,"x":1530,"y":4020,"wires":[["7300173c.056218"]]},{"id":"e687ec1.d1d911","type":"function","z":"c3fa9bdb.b5c4c8","name":"Seca?","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"x":790,"y":4020,"wires":[["212aa61a.89a2da"]]},{"id":"ff8f90a2.6bc01","type":"function","z":"c3fa9bdb.b5c4c8","name":"Maria?","func":"if(msg.payload === \"Maria\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1310,"y":4600,"wires":[["d086227f.8949b","a563d3b7.22322"]]},{"id":"7692d52d.7a6a2c","type":"function","z":"c3fa9bdb.b5c4c8","name":"Nédi?","func":"if(msg.payload === \"Nédi\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1310,"y":4820,"wires":[["b37dd6ab.62c888","821cfa2f.85c998","9ac12349.76188","5e405b73.b1cb44"]]},{"id":"48db8584.442dac","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pai?","func":"if(msg.payload === \"Cristofer\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":1310,"y":4660,"wires":[["344947c8.88c368","26249e87.c4bb52"]]},{"id":"9ac12349.76188","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Louça\", \"message\": \"A roupa já deve estar seca.\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"x":1550,"y":4780,"wires":[["1804bb95.24e424"]]},{"id":"821cfa2f.85c998","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_macbook_pro_de_nedison\",\n    data:{\n        \n\n        \n         message: 'As roupas estão prontas na máquina.'\n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1550,"y":4900,"wires":[["8d9bf81f.2ea748"]]},{"id":"b37dd6ab.62c888","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \n  \n         \n         message: 'As roupas estão prontas na máquina.'\n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1550,"y":4840,"wires":[["64ea7cd7.760784"]]},{"id":"344947c8.88c368","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_softcelular\",\n    data:{\n        \n         \n         message: 'As roupas estão prontas na máquina.'\n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1550,"y":4660,"wires":[["4a49619b.b11d6"]]},{"id":"d086227f.8949b","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\nnewMsg= {payload : {\n\"domain\": \"notify\",\n\"service\": \"mobile_app_maria_s_iphone\",\ndata:{\n        \n         message: 'As roupas estão prontas na máquina.'\n  }\n}};\nreturn newMsg;\n","outputs":1,"noerr":0,"x":1550,"y":4600,"wires":[["b5d7e180.ae7d3"]]},{"id":"ea5f6616.e4e2c8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pronto?","func":"if(msg.payload === \"Pronto\"){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":4600,"wires":[["21ff783.0175288"]]},{"id":"5b272ae3.79d454","type":"inject","z":"859b066a.dd8128","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 23 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":330,"y":4220,"wires":[["d8661a64.1e9758"]]},{"id":"868ffa70.694c68","type":"function","z":"859b066a.dd8128","name":"Hot?","func":"if(msg.payload > 25){\n    var newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"switch.ventilador\"\n        }\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1010,"y":4220,"wires":[["750e76aa.199378"]]},{"id":"9c93669e.1ad888","type":"function","z":"859b066a.dd8128","name":"Home?","func":"if(msg.payload === \"home\"){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":670,"y":4220,"wires":[["a746ccf6.359e4"]]},{"id":"4613fa06.873564","type":"comment","z":"859b066a.dd8128","name":"Liga o ventilador antes de ir dormir se tiver em casa e quente","info":"","x":450,"y":4140,"wires":[]},{"id":"3131595f.58bac6","type":"function","z":"d3db5d74.fb8fa","name":"Botão Cozinha Click","func":"if(msg.topic === \"sensor.botao_cozinha_action_2\" && msg.payload === \"single\"){\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":540,"y":2840,"wires":[[]]},{"id":"1b17d0d9.4f785f","type":"function","z":"d3db5d74.fb8fa","name":"Botão Cozinha Double","func":"if(msg.topic === \"sensor.botao_cozinha_action_2\" && msg.payload === \"double\"){\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"x":540,"y":2880,"wires":[[]]},{"id":"ebeebd66.a6613","type":"debug","z":"d3db5d74.fb8fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":500,"y":2800,"wires":[]},{"id":"2c8c1735.30eb58","type":"function","z":"d3db5d74.fb8fa","name":"Botão Cozinha","func":"if(msg.topic === \"sensor.botao_cozinha_battery_2\"){\n    return msg;\n}\n//sensor_switch.aq2\n//nao funciona direito, manda o estado da bateria em vez do click","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":2920,"wires":[[]]},{"id":"bbfced5e.c9152","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"if(msg.payload === \"on\"){\n    var newMsg\n    for(var i = 0; i < 8 ; i++){\n        newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.luz_do_quarto_nedi_homekit\",\n                \"rgb_color\": [255, 255, 255],\n                \"brightness_step_pct\": -10,\n                \"transition\": 100\n            }\n        }};\n        node.send(newMsg);\n    }\n    \n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_nedi\",\n            \"transition\": 100\n        }\n    }};\n    node.send(newMsg);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1060,"y":3680,"wires":[["fbcaf420.0b0748"]]},{"id":"9adbba25.db7a78","type":"function","z":"859b066a.dd8128","name":"Movimento dentro?","func":"if(msg.payload === \"off\"){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":730,"y":220,"wires":[["830ed247.f6566","6ad71445.4314fc"]]},{"id":"b6b8d224.65ba2","type":"function","z":"d3db5d74.fb8fa","name":"Movimento Quarto Maria","func":"if(msg.payload.entity_id === \"binary_sensor.movimento_quarto_maria\"){\n        var newMsg;\n        newMsg = {payload:{On : true}};\n        return newMsg;\n}\n//sensor_motion.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":1520,"wires":[["d7496dca.caa2f"]]},{"id":"2d1a39fd.73ad86","type":"function","z":"d3db5d74.fb8fa","name":"Movimento Sala","func":"if(msg.payload.entity_id === \"binary_sensor.movimento_sala\"){\n    var newMsg = {payload: {MotionDetected: true}}\n    return newMsg;\n}\n//sensor_motion.aq2","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":1280,"wires":[["1f03bb0a.233655"]]},{"id":"1f03bb0a.233655","type":"link out","z":"d3db5d74.fb8fa","name":"Movimento Sala","links":["291b7897.febc08","b3061b2a.42a488"],"x":715,"y":1280,"wires":[]},{"id":"d7496dca.caa2f","type":"link out","z":"d3db5d74.fb8fa","name":"Movimento Quarto Maria","links":["a775b02e.913eb"],"x":715,"y":1520,"wires":[]},{"id":"8f9ac090.1149f","type":"link in","z":"2bbba447.a4759c","name":"Movimento Banheiro","links":[],"x":155,"y":800,"wires":[["d6b5f0bc.8c9fa"]]},{"id":"d6b5f0bc.8c9fa","type":"function","z":"2bbba447.a4759c","d":true,"name":"Turn On","func":"//diferentes brightness dependendo da hora\nvar date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nvar newMsg;\nnewMsg = {payload:{}};\nif(Hour === 23){\n        newMsg.payload =\n        {\n        \"on\": true,\n        \"bri\": 50,\n        \"ct\": 5000\n        };\n        global.set(\"isOnBanheiro\", true);\n        \n        node.status({fill:\"green\",shape:\"dot\",text:\"Liga\"});\n        node.send(newMsg);\n        \n}\nif(Hour >= 0 && Hour < 8){\n        newMsg.payload =\n        {\n        \"on\": true,\n        \"bri\": 30,\n        \"ct\": 2500\n        };\n        global.set(\"isOnBanheiro\", true);\n        \n        node.status({fill:\"green\",shape:\"dot\",text:\"Liga\"});\n        node.send(newMsg);\n        \n}\nif((Hour > 17 && Hour < 22) || \n        global.get(\"botaoBanheiro\") === true){\n        global.set(\"botaoBanheiro\", false);\n        global.set(\"isOnBanheiro\", true);\n        newMsg.payload = \n            {\n            \"on\": true,\n            \"bri\": 255,\n            \"ct\": 6200\n            \n};\nnode.status({fill:\"green\",shape:\"dot\",text:\"Liga\"});\nnode.send(newMsg);\n\nsetTimeout(function(){\n            node.status({text:\"\"});\n            }, 15000);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":280,"y":800,"wires":[["71edec0.93a0814","6aed7577.2179ac","e4ec042f.948798"]]},{"id":"6aed7577.2179ac","type":"function","z":"2bbba447.a4759c","name":"Delay + 20 min","func":"msg.delay = 1200000;\nreturn msg;","outputs":1,"noerr":0,"x":460,"y":880,"wires":[["3f7ad307.04971c"]]},{"id":"3f7ad307.04971c","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"delayv","timeout":"20","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":640,"y":880,"wires":[["16d5dc37.bf8364"]]},{"id":"120b8090.260cef","type":"function","z":"2bbba447.a4759c","name":"Turn Off","func":"if(msg.payload === \"off\"){\n    var newMsg;\n    newMsg = { payload : {\"on\":false}, ajuda : false};\n    return newMsg;   \n}\nelse{\n    return {ajuda: true};\n}","outputs":1,"noerr":0,"x":1060,"y":880,"wires":[["f64ae584.fb0c68"]]},{"id":"f64ae584.fb0c68","type":"switch","z":"2bbba447.a4759c","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"false"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":1190,"y":820,"wires":[["74683cb2.be8ac4","e9a4dd30.d6d73"],["6aed7577.2179ac"]]},{"id":"6b30c287.9ff15c","type":"function","z":"4c9c764d.9c4468","name":"Netflix or Prime Video?","func":"var ocupado = global.get(\"tvAuxFilme\");\nif(ocupado === false){\n    if(\n        msg.data.new_state.attributes.media_title === \"org.tizen.netflix-app\" || \n        msg.data.new_state.attributes.media_title === \"Netflix\" || \n        msg.data.new_state.attributes.media_title ===\"Prime Video\"|| \n        msg.data.new_state.attributes.media_title ===\"Apple TV\"|| \n        msg.data.new_state.attributes.media_title ===\"Disney+\"|| \n        msg.data.new_state.attributes.media_title ===\"mycontent-video-player\"){\n        global.set(\"tvAuxFilme\", true);\n        return {payload: \"playing\"};\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":460,"y":1340,"wires":[["19554fb4.898e3","9c98b28c.4c8bd","cebfe46c.10f188"]]},{"id":"e9a4dd30.d6d73","type":"function","z":"2bbba447.a4759c","name":"Turn Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"input_boolean.banheiro_ocupado_switch\",\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1380,"y":820,"wires":[["1af4195f.5b5297"]]},{"id":"e4ec042f.948798","type":"function","z":"2bbba447.a4759c","name":"Turn On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        data:{\n            \"entity_id\": \"input_boolean.banheiro_ocupado_switch\",\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1380,"y":760,"wires":[["1af4195f.5b5297"]]},{"id":"3c34f863.bc1ac8","type":"function","z":"5767c936.cabd18","name":"Luminárias Escritorio Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.abajur_escritorio\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.luminaria_esquerda\"\n        }\n    }};\n    node.send(newMsg);\n    \n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.luminaria_direita\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2451,"y":760,"wires":[["88e11aa0.ea33f8"]]},{"id":"a15f542b.7479e8","type":"function","z":"4c9c764d.9c4468","name":"Turn Off","func":"msg.payload = {\"on\": false};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1020,"y":1300,"wires":[["3b44099e.38c446"]]},{"id":"c16309d1.f94448","type":"function","z":"444fced8.33ecb","name":"Turn On","func":"var newMsg;\n        newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_on\",\n            \"data\":{\n                \"entity_id\": \"switch.tv_do_quarto_ir\"\n            }\n        }};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":720,"y":2580,"wires":[["47a824b0.aad36c","a82d5004.fa947"]]},{"id":"56322f3d.4f55e","type":"function","z":"c3fa9bdb.b5c4c8","name":"Mariana?","func":"if(msg.payload === \"Mariana\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":920,"y":660,"wires":[["6a78346b.28ebdc"]]},{"id":"f9552f8a.45009","type":"function","z":"c3fa9bdb.b5c4c8","name":"Cleusa?","func":"if(msg.payload === \"Cleusa\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":920,"y":740,"wires":[["30c4bd48.a31952"]]},{"id":"cb806604.579fa8","type":"function","z":"444fced8.33ecb","name":"Quem lava a roupa","func":"if(\n        (msg.payload.description.summary.includes('lavar')=== true ||\n        msg.payload.description.summary.includes('lava')=== true\n        )\n        &&\n        (msg.payload.description.summary.includes('roupa')===true ||\n        msg.payload.description.summary.includes('roupas')===true)\n    ){\n        if(msg.payload.name === \"Echo Dot da Cozinha\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_cozinha\") \n        }\n        if(msg.payload.name === \"Echo Dot da Sala\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_sala\")       \n        }\n        if(msg.payload.name === \"Echo Dot do Quarto Nédi\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_nedi\")\n        }\n        \n        if(msg.payload.name === \"Echo Dot do Quarto Maria\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_maria\")\n        }\n        return {payload:true};\n        \n    }","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":3140,"wires":[["1b95a1c2.86787e"]]},{"id":"9150be82.f8d1d","type":"function","z":"444fced8.33ecb","name":"Construct Message","func":"const entity = flow.get(\"alexaDeviceHelper\");\nvar message;\nif(msg.payload === \"Nédi\"){\n    message =  \"Hoje é o Nédi que lava a roupa\";\n}\nif(msg.payload === \"Maria\"){\n    message =  \"Hoje é a Maria que lava a roupa\";\n}\nif(msg.payload === \"Mariana\"){\n    message =  \"Hoje é a Mariana que lava a roupa\";\n}\nif(msg.payload === \"Cristofer\"){\n    message =  \"Hoje é o Cristófer que lava a roupa\";\n}\nreturn {\n    payload:{\n        data: {\n            message: message,\n            data: { type: \"tts\" },\n            target: [entity]\n        }\n    }\n};","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1010,"y":3140,"wires":[["f6c95af8.213898"]]},{"id":"aff3cf91.243c6","type":"function","z":"444fced8.33ecb","name":"Quem lava a louça","func":"if(\n        (msg.payload.description.summary.includes('lavar')=== true ||\n        msg.payload.description.summary.includes('lava')=== true\n        )\n        &&\n        (msg.payload.description.summary.includes('louça')===true)\n    ){\n        if(msg.payload.name === \"Echo Dot da Cozinha\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_cozinha\") \n        }\n        if(msg.payload.name === \"Echo Dot da Sala\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_sala\")       \n        }\n        if(msg.payload.name === \"Echo Dot do Quarto Nédi\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_nedi\")\n        }\n        \n        if(msg.payload.name === \"Echo Dot do Quarto Maria\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_maria\")\n        }\n        return {payload:true};\n        \n    }","outputs":1,"noerr":0,"x":510,"y":3200,"wires":[["f1ef2f51.b93de"]]},{"id":"74be5855.d070e8","type":"function","z":"444fced8.33ecb","name":"Construct Message","func":"const entity = flow.get(\"alexaDeviceHelper\");\nvar message;\nif(msg.payload === \"Nédi\"){\n    message =  \"Hoje é o Nédi que lava a louça\";\n}\nif(msg.payload === \"Maria\"){\n    message =  \"Hoje é a Maria que lava a louça\";\n}\nif(msg.payload === \"Mariana\"){\n    message =  \"Hoje é a Mariana que lava a louça\";\n}\nif(msg.payload === \"Cristofer\"){\n    message =  \"Hoje é o Cristófer que lava a louça\";\n}\nif(msg.payload === \"Cleusa\"){\n    message =  \"Hoje é a Cleusa que lava a louça\";\n}\nreturn {\n    payload:{\n        data: {\n            message: message,\n            data: { type: \"tts\" },\n            target: [entity]\n        }\n    }\n};","outputs":1,"noerr":0,"x":1010,"y":3200,"wires":[["6731d3c5.5a9b0c"]]},{"id":"10ef1a07.b04176","type":"function","z":"444fced8.33ecb","name":"Quem faz o almoço","func":"if(\n        (msg.payload.description.summary.includes('faz')=== true)\n        &&\n        (msg.payload.description.summary.includes('almoço')===true)\n    ){\n        if(msg.payload.name === \"Echo Dot da Cozinha\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_cozinha\") \n        }\n        if(msg.payload.name === \"Echo Dot da Sala\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_sala\")       \n        }\n        if(msg.payload.name === \"Echo Dot do Quarto Nédi\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_nedi\")\n        }\n        \n        if(msg.payload.name === \"Echo Dot do Quarto Maria\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_maria\")\n        }\n        return {payload:true};\n        \n    }","outputs":1,"noerr":0,"x":510,"y":3260,"wires":[["f53f2505.ce6f28"]]},{"id":"212a938a.d4921c","type":"function","z":"444fced8.33ecb","name":"Construct Message","func":"const entity = flow.get(\"alexaDeviceHelper\");\nvar message;\nif(msg.payload === \"Nédi\"){\n    message =  \"Hoje é o Nédi que faz o almoço\";\n}\nif(msg.payload === \"Maria\"){\n    message =  \"Hoje é a Maria que faz o almoço\";\n}\nif(msg.payload === \"Mariana\"){\n    message =  \"Hoje é a Mariana que faz o almoço\";\n}\nif(msg.payload === \"Cristofer\"){\n    message =  \"Hoje é o Cristófer que faz o almoço\";\n}\nreturn {\n    payload:{\n        data: {\n            message: message,\n            data: { type: \"tts\" },\n            target: [entity]\n        }\n    }\n};","outputs":1,"noerr":0,"x":1010,"y":3260,"wires":[["c0122428.4fdf18"]]},{"id":"2c6e3954.48f5a6","type":"function","z":"444fced8.33ecb","name":"Quem lava a cozinha","func":"if(\n        (msg.payload.description.summary.includes('lava')=== true)\n        &&\n        (msg.payload.description.summary.includes('cozinha')===true)\n    ){\n        if(msg.payload.name === \"Echo Dot da Cozinha\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_cozinha\") \n        }\n        if(msg.payload.name === \"Echo Dot da Sala\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_sala\")       \n        }\n        if(msg.payload.name === \"Echo Dot do Quarto Nédi\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_nedi\")\n        }\n        \n        if(msg.payload.name === \"Echo Dot do Quarto Maria\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_maria\")\n        }\n        return {payload:true};\n        \n    }","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":3320,"wires":[["72aa4e3b.7d9b4"]]},{"id":"cbd9c72a.6f64a8","type":"function","z":"444fced8.33ecb","name":"Construct Message","func":"const entity = flow.get(\"alexaDeviceHelper\");\nvar message;\nif(msg.payload === \"Nédi\"){\n    message =  \"Hoje é o Nédi que lava a cozinha\";\n}\nif(msg.payload === \"Maria\"){\n    message =  \"Hoje é a Maria que lava a cozinha\";\n}\nif(msg.payload === \"Mariana\"){\n    message =  \"Hoje é a Mariana que lava a cozinha\";\n}\nif(msg.payload === \"Cristofer\"){\n    message =  \"Hoje é o Cristófer que lava a cozinha\";\n}\nreturn {\n    payload:{\n        data: {\n            message: message,\n            data: { type: \"tts\" },\n            target: [entity]\n        }\n    }\n};","outputs":1,"noerr":0,"x":1010,"y":3320,"wires":[["84c6767b.e68148"]]},{"id":"cced1b08.182ed8","type":"function","z":"444fced8.33ecb","name":"Quem leva o lixo","func":"if(\n        (msg.payload.description.summary.includes('leva')=== true)\n        &&\n        (msg.payload.description.summary.includes('lixo')===true)\n    ){\n        if(msg.payload.name === \"Echo Dot da Cozinha\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_cozinha\") \n        }\n        if(msg.payload.name === \"Echo Dot da Sala\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_sala\")       \n        }\n        if(msg.payload.name === \"Echo Dot do Quarto Nédi\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_nedi\")\n        }\n        \n        if(msg.payload.name === \"Echo Dot do Quarto Maria\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_maria\")\n        }\n        return {payload:true};\n        \n    }","outputs":1,"noerr":0,"x":510,"y":3380,"wires":[["1b1292a7.58a55d"]]},{"id":"c7bb3020.c1e9c","type":"function","z":"444fced8.33ecb","name":"Construct Message","func":"const entity = flow.get(\"alexaDeviceHelper\");\nvar message;\nif(msg.payload === \"Nédi\"){\n    message =  \"Hoje é o Nédi que leva o lixo\";\n}\nif(msg.payload === \"Maria\"){\n    message =  \"Hoje é a Maria que leva o lixo\";\n}\nif(msg.payload === \"Mariana\"){\n    message =  \"Hoje é a Mariana que leva o lixo\";\n}\nif(msg.payload === \"Cristofer\"){\n    message =  \"Hoje é o Cristófer que leva o lixo\";\n}\nreturn {\n    payload:{\n        data: {\n            message: message,\n            data: { type: \"tts\" },\n            target: [entity]\n        }\n    }\n};","outputs":1,"noerr":0,"x":1010,"y":3380,"wires":[["13299b9f.ed8554"]]},{"id":"526dcb0e.aba824","type":"function","z":"444fced8.33ecb","name":"Quem arruma a mesa","func":"if(\n        (msg.payload.description.summary.includes('arruma')=== true)\n        &&\n        (msg.payload.description.summary.includes('mesa')===true)\n    ){\n        if(msg.payload.name === \"Echo Dot da Cozinha\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_cozinha\") \n        }\n        if(msg.payload.name === \"Echo Dot da Sala\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_da_sala\")       \n        }\n        if(msg.payload.name === \"Echo Dot do Quarto Nédi\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_nedi\")\n        }\n        \n        if(msg.payload.name === \"Echo Dot do Quarto Maria\"){\n            flow.set(\"alexaDeviceHelper\", \"media_player.echo_dot_do_quarto_maria\")\n        }\n        return {payload:true};\n        \n    }","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":3440,"wires":[["a999ddd2.11c2"]]},{"id":"a72ef4ba.0e1068","type":"function","z":"444fced8.33ecb","name":"Construct Message","func":"const entity = flow.get(\"alexaDeviceHelper\");\nvar message;\nif(msg.payload === \"Nédi\"){\n    message =  \"Hoje é o Nédi que arruma a mesa\";\n}\nif(msg.payload === \"Maria\"){\n    message =  \"Hoje é a Maria que arruma a mesa\";\n}\nif(msg.payload === \"Mariana\"){\n    message =  \"Hoje é a Mariana que arruma a mesa\";\n}\nif(msg.payload === \"Cristofer\"){\n    message =  \"Hoje é o Cristófer que arruma a mesa\";\n}\nreturn {\n    payload:{\n        data: {\n            message: message,\n            data: { type: \"tts\" },\n            target: [entity]\n        }\n    }\n};","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1010,"y":3440,"wires":[["227d045a.71d77c"]]},{"id":"37aab766.ba5f88","type":"inject","z":"c3fa9bdb.b5c4c8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"15 12 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":150,"y":900,"wires":[["904067dc.365ae8"]]},{"id":"74c0c669.4d0e38","type":"function","z":"c3fa9bdb.b5c4c8","name":"Maria?","func":"if(msg.payload === \"Maria\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":900,"wires":[["446f4589.68cb0c","e3e3ccca.406778","5469e753.84b74"]]},{"id":"2cce545e.db7bbc","type":"function","z":"c3fa9bdb.b5c4c8","name":"Nédi?","func":"if(msg.payload === \"Nédi\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":1120,"wires":[["ab991015.11616","54b83cc6.f86b8c","f1b1b65b.5e48b8"]]},{"id":"130d7896.f47fd7","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pai?","func":"if(msg.payload === \"Cristofer\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":960,"wires":[["b6f5757c.48cd98","2be595c7.b9174a","1b944d5f.d33da3"]]},{"id":"cdaaa9a1.bfd9f8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Mariana?","func":"if(msg.payload === \"Mariana\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":920,"y":1308,"wires":[["f6f84721.a0a328"]]},{"id":"ae9ff12b.eb648","type":"function","z":"c3fa9bdb.b5c4c8","name":"Cleusa?","func":"if(msg.payload === \"Cleusa\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":920,"y":1388,"wires":[["cfa7af2f.b0c2c"]]},{"id":"9103eac3.07f308","type":"inject","z":"c3fa9bdb.b5c4c8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"35 13 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":210,"y":1560,"wires":[["b777a9d8.2e33b8"]]},{"id":"33e7b0a2.2202d","type":"function","z":"c3fa9bdb.b5c4c8","name":"Maria?","func":"if(msg.payload === \"Maria\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":1560,"wires":[["b843169a.9eaa98","d56e1594.d075d8","83d09121.3487c8"]]},{"id":"c8159813.b19808","type":"function","z":"c3fa9bdb.b5c4c8","name":"Nédi?","func":"if(msg.payload === \"Nédi\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":1780,"wires":[["ec9b4920.be1ac8","36fa4d26.dff44a","fe625450.bb6ac"]]},{"id":"2ff0dba8.d52cc4","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pai?","func":"if(msg.payload === \"Cristofer\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":1620,"wires":[["8ef6fd7b.134b8","67ff6714.77b288","d1bd29a8.228bd"]]},{"id":"815a03c6.edb32","type":"function","z":"c3fa9bdb.b5c4c8","name":"Mariana?","func":"if(msg.payload === \"Mariana\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":920,"y":1940,"wires":[["4b6f284e.1139a8"]]},{"id":"1bdbd9a4.c15266","type":"function","z":"c3fa9bdb.b5c4c8","name":"Cleusa?","func":"if(msg.payload === \"Cleusa\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":920,"y":2020,"wires":[["f5000d4b.74a9e"]]},{"id":"e248fc2.f0346","type":"inject","z":"c3fa9bdb.b5c4c8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"30 11 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":170,"y":2200,"wires":[["e21ef9a0.1759d8"]]},{"id":"aec19c0c.746cc","type":"function","z":"c3fa9bdb.b5c4c8","name":"Maria?","func":"if(msg.payload === \"Maria\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":2200,"wires":[["559ef4a7.f7e09c","43e52cf5.3e7ee4"]]},{"id":"12d42236.b0013e","type":"function","z":"c3fa9bdb.b5c4c8","name":"Nédi?","func":"if(msg.payload === \"Nédi\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":2420,"wires":[["7106f681.c5d678","69a996e5.cd57e8","9bafb876.cf0cb8","573b9ed7.9701f"]]},{"id":"b24e941d.0499b8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Pai?","func":"if(msg.payload === \"Cristofer\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":910,"y":2260,"wires":[["7c7966ab.1aabe8","54ff00d4.4fe9"]]},{"id":"9bafb876.cf0cb8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"\n        var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Louça\", \"message\": \"Hoje é seu dia de fazer o almoço\"}'\n  \n\n    }\n    }};\n    \n    return newMsg;","outputs":1,"noerr":0,"x":1150,"y":2380,"wires":[["6f58ca8e.048b94"]]},{"id":"69a996e5.cd57e8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_macbook_pro_de_nedison\",\n    data:{\n        \n\n         message: 'Hoje é seu dia de fazer o almoço'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":2500,"wires":[["31948f25.2f2cd"]]},{"id":"7106f681.c5d678","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \n  \n         message: 'Hoje é seu dia de fazer o almoço'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":2440,"wires":[["58341600.ba1368"]]},{"id":"7c7966ab.1aabe8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_softcelular\",\n    data:{\n        \n         message: 'Hoje é seu dia de fazer o almoço'\n  \n\n    }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":2260,"wires":[["45dd6492.0006cc"]]},{"id":"559ef4a7.f7e09c","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"var newMsg;\nnewMsg= {payload : {\n\"domain\": \"notify\",\n\"service\": \"mobile_app_maria_s_iphone\",\ndata:{\n        \n         message: 'Hoje é seu dia de fazer o almoço'\n  }\n}};\nreturn newMsg;\n","outputs":1,"noerr":0,"x":1150,"y":2200,"wires":[["68b39efe.27e76"]]},{"id":"2993fa55.853746","type":"function","z":"c3fa9bdb.b5c4c8","name":"Mariana?","func":"if(msg.payload === \"Mariana\"){\n    return msg;\n}","outputs":1,"noerr":0,"x":920,"y":2580,"wires":[["23ae8fa.232b57"]]},{"id":"425bffbc.5170a","type":"alexa-remote-event","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","event":"ws-device-activity","x":190,"y":520,"wires":[["fb61a0f6.7dc42","5dbf333.b939dcc","247b7d18.10da82","6cc082a4.cebc2c","24d07955.b49ff6","225c0d0d.39b7a2","ae466c3b.c0827","1e067aee.66c0b5","18d78045.d4bfc","6640a3fe.73843c","57ed58fd.5a6c18","817f8363.e868e","7d63ea8e.4a9ef4","e6a01969.9876f8","6683f650.ea72b8","2df5031e.7be11c","379789b5.f21f06","470c17ea.7843e8","64e3e55d.98c86c","aa3e8e1b.c2b91","c2af1e6b.5dd89","bd72b3f8.afed","4a4d95ff.2ae1ec","3d291f1c.4439","87902325.656bf","cb806604.579fa8","aff3cf91.243c6","10ef1a07.b04176","2c6e3954.48f5a6","cced1b08.182ed8","526dcb0e.aba824","581daa37.ad1a54","9704ea70.dfcb88","b90f92de.0e9e6","548f56c3.b00918","6d30b421.7fdb9c","8f236e2.339c69","93da222c.6ffaf","4d6c4cb4.56d644","834a6685.ae0bf"]]},{"id":"10c8544d.2497dc","type":"alexa-remote-smarthome","z":"859b066a.dd8128","name":"","account":"421d4b0d.32a884","config":{"option":"action","value":[]},"outputs":1,"x":3020,"y":100,"wires":[[]]},{"id":"f31d5496.2b7e18","type":"alexa-remote-smarthome","z":"859b066a.dd8128","name":"","account":"421d4b0d.32a884","config":{"option":"action","value":[]},"outputs":1,"x":3020,"y":160,"wires":[[]]},{"id":"9eb428b1.d1d508","type":"alexa-remote-smarthome","z":"2bbba447.a4759c","d":true,"name":"Luz do Banheiro","account":"421d4b0d.32a884","config":{"option":"query","value":[{"entity":"c2851099-5dda-4848-8575-398d3b867fa0","property":"powerState"}]},"outputs":1,"x":840,"y":360,"wires":[["f39ad338.f1792"]]},{"id":"a3b3a99d.ff7468","type":"alexa-remote-smarthome","z":"2bbba447.a4759c","d":true,"name":"","account":"421d4b0d.32a884","config":{"option":"action","value":[{"entity":"c2851099-5dda-4848-8575-398d3b867fa0","action":"turnOn"}]},"outputs":1,"x":3440,"y":180,"wires":[[]]},{"id":"d588617e.d700b","type":"alexa-remote-smarthome","z":"2bbba447.a4759c","d":true,"name":"","account":"421d4b0d.32a884","config":{"option":"action","value":[{"entity":"c2851099-5dda-4848-8575-398d3b867fa0","action":"turnOff"}]},"outputs":1,"x":3440,"y":280,"wires":[[]]},{"id":"27cc348a.a12c9c","type":"alexa-remote-smarthome","z":"859b066a.dd8128","name":"","account":"421d4b0d.32a884","config":{"option":"action","value":[{"entity":"bb3addbc-ee3f-4720-8237-9797ba33b6e6","action":"turnOff"}]},"outputs":1,"x":1020,"y":3740,"wires":[[]]},{"id":"c3c08b63.f7a388","type":"alexa-remote-smarthome","z":"859b066a.dd8128","d":true,"name":"","account":"421d4b0d.32a884","config":{"option":"query","value":[]},"outputs":1,"x":590,"y":1240,"wires":[["1bf5970a.d99939","da6218d6.54b928"]]},{"id":"52bf523a.a2e16c","type":"alexa-remote-smarthome","z":"859b066a.dd8128","name":"","account":"421d4b0d.32a884","config":{"option":"action","value":[]},"outputs":1,"x":1930,"y":1540,"wires":[[]]},{"id":"e6cd5785.820048","type":"alexa-remote-routine","z":"554bb518.994efc","d":true,"name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"Oi"},"volume":{"type":"num","value":"100"},"mode":"set","devices":["a9d590ebfbcd400dab7f40b75426db6d"]}},"x":410,"y":340,"wires":[["d7147383.eec86"]]},{"id":"d7147383.eec86","type":"alexa-remote-routine","z":"554bb518.994efc","d":true,"name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":""},"volume":{"type":"num","value":"50"},"mode":"set","devices":["a9d590ebfbcd400dab7f40b75426db6d"]}},"x":690,"y":340,"wires":[[]]},{"id":"45637419.03f15c","type":"alexa-remote-routine","z":"4c9c764d.9c4468","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"Bom filme."},"volume":{"type":"num","value":"50"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":1330,"y":1240,"wires":[[]]},{"id":"b22531d9.33f41","type":"alexa-remote-routine","z":"859b066a.dd8128","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do Quarto Automações"},"devices":["G090XG0894430B3V"]}},"x":1440,"y":4700,"wires":[[]]},{"id":"b2bff029.0ca5","type":"alexa-remote-routine","z":"5767c936.cabd18","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do Escritório Automações"},"devices":["G090XG0894430B3V"]}},"x":1500,"y":2000,"wires":[[]]},{"id":"f389a2c9.12d75","type":"alexa-remote-routine","z":"e7cd1901.ee2408","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do Sala Automações"},"devices":["G090XG0894430B3V"]}},"x":1540,"y":1440,"wires":[[]]},{"id":"cc01888e.654468","type":"alexa-remote-routine","z":"4c9c764d.9c4468","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do HomeKit Automações"},"devices":["G090XG0894430B3V"]}},"x":1380,"y":4720,"wires":[[]]},{"id":"3a01f365.64a05c","type":"alexa-remote-routine","z":"2bbba447.a4759c","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do Banheiro Automações"},"devices":["G090XG0894430B3V"]}},"x":1440,"y":1080,"wires":[[]]},{"id":"650e012d.d0af3","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"devices":["G090XG0894430B3V"]}},"x":740,"y":2640,"wires":[[]]},{"id":"6f4a0d7c.b00f04","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"devices":["G090XG0894430B3V"]}},"x":1180,"y":1920,"wires":[[]]},{"id":"5790296f.677688","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"devices":["G090XG0894430B3V"]}},"x":720,"y":720,"wires":[[]]},{"id":"68868c0e.937504","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"devices":["G090XG0894430B3V"]}},"x":820,"y":2860,"wires":[[]]},{"id":"c09e3f0a.b5ec8","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"O café está sendo preparado"},"volume":{"type":"num","value":"40"},"mode":"set","devices":["G090XG1103420J46"]}},"x":810,"y":1260,"wires":[[]]},{"id":"b235294.859eed8","type":"alexa-remote-routine","z":"d67ca66.293d758","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"regular","text":{"type":"str","value":"O café está sendo preparado"},"devices":["G090XG0894430B3V","G090XG1103420J46"]}},"x":600,"y":1840,"wires":[[]]},{"id":"e2dc6379.4e9bb","type":"alexa-remote-routine","z":"d3db5d74.fb8fa","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do Aqara Sensores"},"devices":["G090XG0894430B3V"]}},"x":1440,"y":3040,"wires":[[]]},{"id":"393f8bc8.a11c74","type":"alexa-remote-routine","z":"d67ca66.293d758","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do Home Assistant Automações"},"devices":["G090XG0894430B3V"]}},"x":1440,"y":4620,"wires":[[]]},{"id":"ee70b3b2.cd44d","type":"alexa-remote-routine","z":"7b0de646.c85c78","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do Spotify Helpers"},"devices":["G090XG0894430B3V"]}},"x":1540,"y":4580,"wires":[[]]},{"id":"401a175f.c09d28","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"announcement","text":{"type":"str","value":"Erro na automação do Alexa Automações"},"devices":["G090XG0894430B3V"]}},"x":1980,"y":4840,"wires":[[]]},{"id":"9a05cb5e.a141b8","type":"alexa-remote-other","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","config":{"option":"addListItem","value":{"list":{"type":"str","value":"SHOPPING_ITEM"},"text":{"type":"msg","value":"item"}}},"x":1950,"y":4440,"wires":[["bf90c51a.246768"]]},{"id":"b0feba76.29ab18","type":"alexa-remote-list","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","config":{"option":"getListItems","value":{"list":{"type":"str","value":"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0="}}},"x":380,"y":4340,"wires":[["4c92db9c.4ac3b4","a1c0ec4a.6ba0e"]]},{"id":"c2925e7d.d0847","type":"alexa-remote-list","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","config":{"option":"removeItem","value":{"list":{"type":"str","value":"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0="},"item":{"type":"msg","value":"id"}}},"x":1930,"y":4500,"wires":[["4273f70c.a2f798"]]},{"id":"f490c4f5.2b7b38","type":"alexa-remote-list","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","config":{"option":"getListItems","value":{"list":{"type":"str","value":"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0="}}},"x":1200,"y":4460,"wires":[["a3321db6.f2b2e","9548fd60.1d0ed"]]},{"id":"4f1abce4.d33704","type":"alexa-remote-list","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","config":{"option":"getListItems","value":{"list":{"type":"str","value":"YW16bjEuYWNjb3VudC5BSEZOR1FIUlgyQ1U0RzZSTERSQ01IT1NQV0lBLVNIT1BQSU5HX0lURU0="}}},"x":1540,"y":4540,"wires":[["2a6e2a13.beec36","fad19841.0c97e8"]]},{"id":"2a9c795b.26ed16","type":"server-events","z":"d3db5d74.fb8fa","name":"Click","server":"d14d7300.ae20c","event_type":"xiaomi_aqara.click","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"x":230,"y":640,"wires":[["e2812321.99f76","b3cdb622.ddf5c8","910ee8ec.c1bba8","1849eadb.cfb485","38389231.38335e","b7edb068.d2035","153e6887.fab7b7","f762ec29.df263","bbc954fe.34ca28","debd4025.dcc25","935d70a4.0388a","200a2af8.ab0036","fe55583b.925df8","2873d8ed.ca9528","34c8078e.a5c46","82e9383c.0ad5a8","d829fdb7.3d40f","ab451a74.316f08","e54d1ba1.72c538"]]},{"id":"42d36de4.b8bfd4","type":"server-events","z":"d3db5d74.fb8fa","name":"Movimento","server":"d14d7300.ae20c","event_type":"xiaomi_aqara.motion","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"x":240,"y":1180,"wires":[["31339c0.ecc2764","97ed078d.d825b8","87bc8837.99e6a8","9542dcaf.e3052","b09d4ce2.2903e","b6b8d224.65ba2","2d1a39fd.73ad86"]]},{"id":"973b23ff.50cbc","type":"server-events","z":"d3db5d74.fb8fa","name":"Vibração","server":"d14d7300.ae20c","event_type":"xiaomi_aqara.movement","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"x":290,"y":1860,"wires":[["36bb604a.83da8","7eac7957.0a0eb8"]]},{"id":"bb34c681.a75a08","type":"server-events","z":"444fced8.33ecb","name":"Novo item","server":"d14d7300.ae20c","event_type":"shopping_list_updated","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"x":280,"y":4540,"wires":[["3929b2fd.756b8e","87de823c.02e22"]]},{"id":"87732fdb.f9908","type":"server-events","z":"d67ca66.293d758","name":"iOS Action","server":"d14d7300.ae20c","event_type":"ios.action_fired","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"x":300,"y":2120,"wires":[["8f2f5dac.05e15","93200b37.65da88","aeb9c42.5596d38","97ae9d93.03b45","1155bfd0.e8b278","ebb8fb92.25afb","28866276.68a91e"]]},{"id":"bc52e0ab.cf4ac","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Porta Banheiro","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.porta_banheiro","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":300,"y":1760,"wires":[["8cd6b99e.6b2b18","dd5a2759.0b99d8"],["968300f.8aadb","dd5a2759.0b99d8"]]},{"id":"e7fb71d2.0c53a","type":"server-state-changed","z":"d67ca66.293d758","name":"Sun below horizon","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sun.sun","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"above_horizon","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":260,"y":880,"wires":[["ef9cc054.943","72ca570b.9ae3d8"],["ef9cc054.943","47d2250d.065b8c"]]},{"id":"b39c4ded.6504d","type":"server-state-changed","z":"d67ca66.293d758","name":"Cafeteira","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"switch.cafeteira","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":280,"y":1740,"wires":[["aff57b37.026a28"],["aff57b37.026a28"]]},{"id":"3cd193a7.a0fa2c","type":"server-state-changed","z":"859b066a.dd8128","name":"Vou dormir","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.vou_dormir","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":280,"y":3780,"wires":[["bd0e87aa.31bc78"],["bd0e87aa.31bc78"]]},{"id":"97e377ef.cd5248","type":"server-state-changed","z":"4c9c764d.9c4468","name":"Apple TV On?","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"media_player.apple_tv","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":190,"y":1300,"wires":[["19554fb4.898e3","d4012601.43bbf8"]]},{"id":"21dc15df.611b0a","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Banheiro Ocupado","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.banheiro_ocupado","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":370,"y":560,"wires":[["e9965ef4.dc795"]]},{"id":"aea81ab1.7f20d8","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Sala Ocupada","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.sala_ocupada","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":390,"y":620,"wires":[["d7e2903f.799be"]]},{"id":"e7961457.397778","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Movimento Escritório","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.movimento_escritorio","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":360,"y":680,"wires":[["62aeee38.66017"]]},{"id":"5eebe845.032db8","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Movimento Cozinha","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.movimento_cozinha","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":370,"y":860,"wires":[["8854e815.7cc7e8"]]},{"id":"ce4cf27c.4e149","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Movimento Quarto Nédi","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.movimento_quarto_nedi","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":360,"y":920,"wires":[["aea952f0.7dca8"]]},{"id":"da7d094d.1fa6e8","type":"server-state-changed","z":"2bbba447.a4759c","name":"Banheiro Ocupado","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.banheiro_ocupado","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":1970,"y":420,"wires":[["962c7f2a.f157e"]]},{"id":"6157b5d8.912f1c","type":"server-state-changed","z":"d67ca66.293d758","name":"Updater","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.updater","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"true","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":450,"y":2020,"wires":[["9ab5d2cd.a93c5"],["9ab5d2cd.a93c5"]]},{"id":"d55de659.8068a8","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"TV da Sala","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"media_player.tv_da_sala","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":400,"y":800,"wires":[["49e2ae6e.3770a"]]},{"id":"90d6b55b.eb46c8","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Nedi's iPhone","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"device_tracker.life360_nedison_neto_faria_velloso","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":390,"y":1040,"wires":[["3774203b.8dc19"]]},{"id":"76cc299c.777468","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Maria's iPhone","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"device_tracker.life360_maria_luisa_faria_velloso","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":380,"y":1100,"wires":[["2bede119.72612e"]]},{"id":"b95f1e80.57f14","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Cristofer","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"device_tracker.life360_cristofer_velloso","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":400,"y":1160,"wires":[["1d22767b.f129aa"]]},{"id":"8d1fe0d3.d44fc","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Sensor de Luz Escritório Aqara","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.sensor_de_luz_escritorio_aqara","entityidfiltertype":"exact","outputinitially":false,"state_type":"num","haltifstate":"","halt_if_type":"num","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":990,"y":880,"wires":[["d9f0e7f6.c5a938"]]},{"id":"bdf57e86.f23cc","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Movimento Quarto Maria","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.movimento_quarto_maria","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":350,"y":980,"wires":[["59ef2215.5285dc"]]},{"id":"889ffe0b.6fe08","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"Movimento Sala","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.movimento_sala","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":380,"y":740,"wires":[["748845f7.408c5c"]]},{"id":"fe14e295.1ac16","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Janela Quarto Maria","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.janela_quarto_maria","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":310,"y":2020,"wires":[["1d1cb695.50aaa9"],["a984656a.c4e198"]]},{"id":"c0f3e341.45c75","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Janela Quarto Nédi","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.janela_quarto_nedi","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":310,"y":2140,"wires":[["604c113d.67dae"],["3c9fc7.6938503a"]]},{"id":"946daff2.5753d","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Janela Quarto Pai","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.janela_quarto_pai","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":310,"y":2260,"wires":[["c565ad59.11f79"],["a9fdd412.daee28"]]},{"id":"24e31857.e747b8","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Janela Sala Direita","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.janela_sala_direita","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":310,"y":2380,"wires":[["93421936.7e0098"],["9c27139a.c24c1"]]},{"id":"7e99ca8c.7fe274","type":"server-state-changed","z":"d67ca66.293d758","name":"Alguém em Casa","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.alguem_em_casa","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"true","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":320,"y":2920,"wires":[["c5250d18.6422a","77334325.c1f0bc","ab6e20fa.2fccc"],["c5250d18.6422a","77334325.c1f0bc","ab6e20fa.2fccc"]]},{"id":"536798ce.6fd7b8","type":"server-state-changed","z":"4c9c764d.9c4468","name":"Sensor de Luz Sala","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.sensor_de_luz_sala","entityidfiltertype":"exact","outputinitially":false,"state_type":"num","haltifstate":"","halt_if_type":"num","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":210,"y":360,"wires":[["52ed3553.1f2cec"]]},{"id":"c0ae7a5a.ce6478","type":"server-state-changed","z":"c3fa9bdb.b5c4c8","d":true,"name":"Roupa está Seca","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.esta_seca","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":580,"y":4020,"wires":[["e687ec1.d1d911"]]},{"id":"b1df2b69.18c768","type":"server-state-changed","z":"c3fa9bdb.b5c4c8","name":"Máquina de Lavar Roupas","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_select.maquina_de_lavar_roupas","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":310,"y":4600,"wires":[["ea5f6616.e4e2c8"]]},{"id":"5ebfc60.94d593c","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Botão Cozinha","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.botao_cozinha_action_2","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":300,"y":2860,"wires":[["3131595f.58bac6","1b17d0d9.4f785f","ebeebd66.a6613"]]},{"id":"5d4c4a88.0386a4","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Botão Cozinha","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.botao_cozinha_battery_2","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":300,"y":2920,"wires":[["2c8c1735.30eb58"]]},{"id":"deffa27c.e2d7d","type":"server-state-changed","z":"4c9c764d.9c4468","name":"Netflix?","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"media_player.tv_da_sala","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":210,"y":1360,"wires":[["6b30c287.9ff15c","31004291.3865b6"]]},{"id":"aa54b7b4.3a3f08","type":"api-call-service","z":"d67ca66.293d758","name":"Luminarias OnOff","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"toggle","entityId":"switch.luminaria_direita, switch.luminaria_esquerda","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1170,"y":280,"wires":[[]]},{"id":"75578844.506568","type":"api-call-service","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.luz_do_quarto_nedi, light.luz_do_quarto_nedi_homekit","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1390,"y":3680,"wires":[[]]},{"id":"5420eb2f.585104","type":"api-call-service","z":"2bbba447.a4759c","name":"Luz Noturna","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.aqara_hub","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3250,"y":600,"wires":[[]]},{"id":"d49ef7c3.77a7c8","type":"api-call-service","z":"444fced8.33ecb","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":850,"y":640,"wires":[[]]},{"id":"d893df70.4923f","type":"api-call-service","z":"444fced8.33ecb","name":"TV da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"media_player.tv_da_sala","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":970,"y":2120,"wires":[["cf6e490b.bd57d8"]]},{"id":"5e4ab241.037a1c","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Luz Noturna On","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.aqara_hub","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1280,"y":1400,"wires":[[]]},{"id":"720b2e2a.c4b74","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Luz Noturna Off","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.aqara_hub","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1800,"y":1460,"wires":[[]]},{"id":"f241c1a3.11968","type":"api-call-service","z":"4c9c764d.9c4468","name":"TV da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"media_player.tv_da_sala","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1170,"y":1100,"wires":[[]]},{"id":"7511e273.ed96cc","type":"api-call-service","z":"d67ca66.293d758","name":"TV Set Volume","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"media_play","entityId":"media_player.tv_da_sala","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":720,"y":1380,"wires":[[]]},{"id":"293815f6.1c67ea","type":"api-call-service","z":"554bb518.994efc","name":"","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"xiaomi_aqara","service":"play_ringtone","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":680,"y":700,"wires":[[]]},{"id":"f21d5385.706d6","type":"api-call-service","z":"554bb518.994efc","name":"","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"xiaomi_aqara","service":"play_ringtone","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":680,"y":820,"wires":[[]]},{"id":"42be937b.e17c5c","type":"api-call-service","z":"444fced8.33ecb","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":750,"y":2700,"wires":[[]]},{"id":"7275fc50.c70e94","type":"api-call-service","z":"444fced8.33ecb","name":"Fire TV","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"media_player.fire_tv","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1100,"y":2800,"wires":[[]]},{"id":"c882366e.e8ab78","type":"api-call-service","z":"444fced8.33ecb","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":750,"y":3080,"wires":[[]]},{"id":"13cd65e3.056f3a","type":"api-call-service","z":"444fced8.33ecb","name":"Fire TV","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"media_player.fire_tv","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":900,"y":2960,"wires":[[]]},{"id":"eb95127f.26f2d","type":"api-call-service","z":"444fced8.33ecb","name":"Apple TV","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"media_player.apple_tv","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":740,"y":1700,"wires":[[]]},{"id":"4473ffa5.c6242","type":"api-call-service","z":"444fced8.33ecb","name":"Shopping List","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"","service":"","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1600,"y":4340,"wires":[[]]},{"id":"c18acf0.2ec693","type":"api-call-service","z":"e7cd1901.ee2408","name":"TV da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_off","entityId":"media_player.tv_da_sala","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2510,"y":800,"wires":[[]]},{"id":"1dc6a3d6.67629c","type":"api-call-service","z":"e7cd1901.ee2408","name":"Luz da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"","entityId":"light.luz_da_sala","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2710,"y":1000,"wires":[[]]},{"id":"d1bb1156.06898","type":"api-call-service","z":"554bb518.994efc","name":"Alexa fala Olá pelo HA","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media_echo_dot_da_sala","entityId":"","data":"{ \"message\": \"{{payload}}\", \"data\": { \"type\": \"tts\" }, \"target\": \"{{service}}\" }","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":540,"y":960,"wires":[[]]},{"id":"ed1efe74.9b07a","type":"api-call-service","z":"554bb518.994efc","name":"Alexa anuncia Olá pelo HA","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media_echo_dot_da_sala","entityId":"","data":"{ \"message\": \"{{payload}}\", \"data\": { \"type\": \"announce\" }, \"target\": \"{{service}}\" }","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":560,"y":1020,"wires":[[]]},{"id":"aa85408.edca4c","type":"api-call-service","z":"554bb518.994efc","name":"Alexa anuncia Olá pelo HA","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media_echo_dot_da_sala","entityId":"","data":"{ \"message\": \"{{payload}}\", \"data\": { \"type\": \"announce\", \"method\":\"speak\" }, \"target\": \"{{service}}\" }","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":560,"y":1080,"wires":[[]]},{"id":"73661948.9a4f58","type":"api-call-service","z":"d67ca66.293d758","name":"Desliga a Cafeteira","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.cafeteira","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1190,"y":1620,"wires":[[]]},{"id":"67687946.7e8118","type":"api-call-service","z":"859b066a.dd8128","name":"Fire TV","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_off","entityId":"media_player.fire_tv, media_player.fire_tv_2","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":980,"y":3500,"wires":[[]]},{"id":"4376ca8e.370404","type":"api-call-service","z":"444fced8.33ecb","name":"Add Item Shopping List","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"shopping_list","service":"add_item","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":810,"y":220,"wires":[[]]},{"id":"330dd2a9.829e9e","type":"api-call-service","z":"444fced8.33ecb","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":750,"y":280,"wires":[[]]},{"id":"345fa672.00beea","type":"api-call-service","z":"859b066a.dd8128","name":"Abajur Quarto","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.abajur_quarto","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3160,"y":1400,"wires":[[]]},{"id":"793d91c6.19af3","type":"api-call-service","z":"859b066a.dd8128","name":"Lâmpada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.lampada","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1520,"y":2860,"wires":[[]]},{"id":"817700e0.41833","type":"api-call-service","z":"859b066a.dd8128","name":"Lâmpada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.lampada","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1714.4443359375,"y":3099.9998779296875,"wires":[[]]},{"id":"2c252d54.6a0d92","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Alguém em Casa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.alguem_em_casa","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1710,"y":320,"wires":[[]]},{"id":"9bd8b440.a18d68","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Alguém em Casa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.alguem_em_casa","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2150,"y":400,"wires":[[]]},{"id":"6ffdbd0.9a4a944","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Quarto Nédi Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.quarto_nedi_ocupado_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1460,"y":1000,"wires":[[]]},{"id":"23c48ba4.c0be94","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Cozinha Ocupada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.cozinha_ocupada_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1450,"y":840,"wires":[[]]},{"id":"e19e2e86.320b9","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Sala Ocupada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.sala_ocupada_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1440,"y":600,"wires":[[]]},{"id":"f5da50f6.4f0a9","type":"api-call-service","z":"2bbba447.a4759c","name":"Banheiro Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.banheiro_ocupado_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2693,"y":189,"wires":[[]]},{"id":"63e6332f.2989ac","type":"api-call-service","z":"859b066a.dd8128","name":"Quarto Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"binary_sensor.quarto_ocupado","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3190,"y":1220,"wires":[[]]},{"id":"184e69f9.5c17a6","type":"api-call-service","z":"e7cd1901.ee2408","name":"Sala Ocupada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_off","entityId":"input_boolean.sala_ocupada_switch","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2500,"y":1200,"wires":[[]]},{"id":"2a0e2015.b584f","type":"api-call-service","z":"444fced8.33ecb","name":"Apple TV","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"media_play_pause","entityId":"media_player.apple_tv","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":960,"y":2200,"wires":[[]]},{"id":"c635d49e.ea96a8","type":"api-call-service","z":"5767c936.cabd18","name":"Sala Ocupada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_off","entityId":"input_boolean.sala_ocupada_switch","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2561,"y":1011,"wires":[[]]},{"id":"1bc561f3.21090e","type":"api-call-service","z":"d67ca66.293d758","name":"Luz do Banheiro","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.cafeteira","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1180,"y":1560,"wires":[[]]},{"id":"744d12ad.5a64ac","type":"api-call-service","z":"d67ca66.293d758","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1170,"y":1740,"wires":[[]]},{"id":"9b4e3a94.a2fa78","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Sala Ocupada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"binary_sensor","service":"turn_on","entityId":"binary_sensor.sala_ocupada","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1960,"y":660,"wires":[[]]},{"id":"4821aef.fa5a95","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Cozinha Ocupada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"binary_sensor","service":"turn_on","entityId":"binary_sensor.cozinha_ocupada","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1970,"y":900,"wires":[[]]},{"id":"450a41b6.47521","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Quarto Nédi Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.quarto_nedi_ocupado_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1980,"y":1080,"wires":[[]]},{"id":"9d43e026.111f9","type":"api-call-service","z":"d67ca66.293d758","name":"Notifica","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"","service":"","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":807,"y":2020,"wires":[[]]},{"id":"181bced0.749d31","type":"api-call-service","z":"444fced8.33ecb","name":"Sala Ocupada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"input_boolean.sala_ocupada_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":780,"y":340,"wires":[[]]},{"id":"7b04e543.e5ac8c","type":"api-call-service","z":"444fced8.33ecb","name":"Quarto Nédi Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"input_boolean.quarto_nedi_ocupado_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":800,"y":400,"wires":[[]]},{"id":"916545e5.635aa8","type":"api-call-service","z":"444fced8.33ecb","name":"Cozinha Ocupada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"input_boolean.cozinha_ocupada_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":790,"y":520,"wires":[[]]},{"id":"eb756d67.5b8c7","type":"api-call-service","z":"d67ca66.293d758","name":"Home Assistant","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1140,"y":2540,"wires":[[]]},{"id":"e7c9d71f.790548","type":"api-call-service","z":"e7cd1901.ee2408","name":"Luz da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_da_sala","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3790,"y":120,"wires":[[]]},{"id":"142cf903.1b62c7","type":"api-call-service","z":"5767c936.cabd18","name":"Luz do Escritório 1","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_escritorio_1","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3650,"y":300,"wires":[[]]},{"id":"ba5122b.ccbdfe","type":"api-call-service","z":"444fced8.33ecb","name":"Quarto Maria Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"input_boolean.quarto_maria_ocupado_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":800,"y":460,"wires":[[]]},{"id":"2fafdb42.3f1dc4","type":"api-call-service","z":"859b066a.dd8128","name":"All effects","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.3_cores, light.chase, light.chase_2, light.dark_cloud, light.hollywood, light.holofote, light.loading_bar, light.oliver, light.palette, light.purple_green_palette, light.rainbow, light.rainbow_slow, light.rainbow_stripes, light.random, light.sparkles, light.sparkles_colorido, light.unicornio","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1140,"y":3380,"wires":[[]]},{"id":"2e1d9879.f46658","type":"api-call-service","z":"859b066a.dd8128","name":"All effects","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.3_cores, light.chase, light.chase_2, light.dark_cloud, light.hollywood, light.holofote, light.loading_bar, light.oliver, light.palette, light.purple_green_palette, light.rainbow, light.rainbow_slow, light.rainbow_stripes, light.random, light.sparkles, light.sparkles_colorido, light.unicornio","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3300,"y":1060,"wires":[[]]},{"id":"1ae5f225.e369fe","type":"api-call-service","z":"d67ca66.293d758","name":"Notify Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_nedi_text_aux, input_text.notify_nedi_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1530,"y":1820,"wires":[[]]},{"id":"a7423af1.5b9b38","type":"api-call-service","z":"d67ca66.293d758","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"{{ [\\\"O Café está pronto.\\\",\\\"O Café está prontinho.\\\",\\\"Tem café quentinho na cozinha.\\\",\\\"Tem café na cozinha.\\\",\\\"Corre pra cozinha, o café está pronto.\\\",\\\"O Café está pronto na cozinha.\\\",\\\"O Café está quentinho te esperando.\\\"]|random }}\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\",\"media_player.echo_dot_do_quarto_pai\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":990,"y":1680,"wires":[[]]},{"id":"4aad5e64.a78a5","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Quarto Maria Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.quarto_maria_ocupado_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1460,"y":1160,"wires":[[]]},{"id":"9a60745.c28a788","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Quarto Maria Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.quarto_maria_ocupado_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1980,"y":1240,"wires":[[]]},{"id":"fa9fbc55.e8df4","type":"api-call-service","z":"d67ca66.293d758","name":"Boa noite","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":610,"y":2620,"wires":[[]]},{"id":"e21d43ff.c4614","type":"api-call-service","z":"d67ca66.293d758","name":"Vou Dormir","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":620,"y":2680,"wires":[[]]},{"id":"b5022911.dfe1e8","type":"api-call-service","z":"d3db5d74.fb8fa","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2530,"y":2240,"wires":[[]]},{"id":"f6b82d7f.4e4bb","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Há chance de chover agora e as janelas: {% if is_state(\\\"binary_sensor.janela_quarto_maria\\\", \\\"on\\\") -%} do Quarto Maria, {%- endif %} {% if is_state(\\\"binary_sensor.janela_quarto_nedi\\\", \\\"on\\\") -%} do Quarto Nédi,{%- endif %} {% if is_state(\\\"binary_sensor.janela_quarto_pai\\\", \\\"on\\\") -%} do Quarto Pai,{%- endif %} {% if is_state(\\\"binary_sensor.janela_sala_esquerda\\\", \\\"on\\\") -%} da Sala {%- endif %}  {% if is_state(\\\"binary_sensor.janela_sala_direita\\\", \\\"on\\\") -%} da Sala {%- endif %} estão aberta\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_do_quarto_nedi\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":2370,"y":2180,"wires":[[]]},{"id":"c49430f1.7a9de","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Maria. Hoje é seu dia de lavar a louça\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":160,"wires":[[]]},{"id":"ff5115c0.b26c68","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cristófer. Hoje é seu dia de lavar a louça\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":460,"wires":[[]]},{"id":"e790e9be.717668","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Nédi. Hoje é seu dia de lavar a louça\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":640,"wires":[[]]},{"id":"90077918.20bc78","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1870,"y":3140,"wires":[[]]},{"id":"cfee3ce7.24f6c","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify MacBook","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1900,"y":3260,"wires":[[]]},{"id":"cb3cd3e5.3ec49","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi's iPhone","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1920,"y":3200,"wires":[[]]},{"id":"36312c40.f34eb4","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Pai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_softcelular","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1880,"y":3020,"wires":[[]]},{"id":"b2a83312.9c275","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Maria. Hoje é seu dia de lavar a roupa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1710,"y":2900,"wires":[[]]},{"id":"562c2738.d5d178","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_maria_s_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1890,"y":2960,"wires":[[]]},{"id":"f83db5ad.07d688","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cristófer. Hoje é seu dia de lavar a roupa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1710,"y":3080,"wires":[[]]},{"id":"26812f11.fb543","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Nédi. Hoje é seu dia de lavar a roupa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1710,"y":3320,"wires":[[]]},{"id":"17191daa.11b972","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1870,"y":3680,"wires":[[]]},{"id":"f651923f.adf3","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify MacBook","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1900,"y":3800,"wires":[[]]},{"id":"e800b86b.ae0198","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi's iPhone","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1920,"y":3740,"wires":[[]]},{"id":"72bafa5e.611894","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Pai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_softcelular","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1880,"y":3560,"wires":[[]]},{"id":"a1313278.12632","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Maria. Hoje é seu dia de levar o lixo\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1710,"y":3440,"wires":[[]]},{"id":"cbd6f6e7.574348","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_maria_s_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1890,"y":3500,"wires":[[]]},{"id":"b829a5.308f3658","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cristófer. Hoje é seu dia de levar o lixo\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1710,"y":3620,"wires":[[]]},{"id":"ed51ac4c.90dbc","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Nédi. Hoje é seu dia de levar o lixo\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1710,"y":3860,"wires":[[]]},{"id":"4ab79159.2d5a9","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1690,"y":4200,"wires":[[]]},{"id":"dec70c72.9e0d3","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify MacBook","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1720,"y":4320,"wires":[[]]},{"id":"68d446ac.aa3e78","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi's iPhone","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1740,"y":4260,"wires":[[]]},{"id":"8b585c69.df8bd","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Pai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_softcelular","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1700,"y":4080,"wires":[[]]},{"id":"669f4194.5e245","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Maria. A roupa já deve estar seca\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1530,"y":3960,"wires":[[]]},{"id":"7300173c.056218","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_maria_s_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1710,"y":4020,"wires":[[]]},{"id":"65ca6d3e.6c6414","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cristófer. A roupa já deve estar seca\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1530,"y":4140,"wires":[[]]},{"id":"bd2043b.25187c","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Nédi. A roupa já deve estar seca\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1530,"y":4380,"wires":[[]]},{"id":"1804bb95.24e424","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1710,"y":4780,"wires":[[]]},{"id":"8d9bf81f.2ea748","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify MacBook","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1740,"y":4900,"wires":[[]]},{"id":"64ea7cd7.760784","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi's iPhone","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1760,"y":4840,"wires":[[]]},{"id":"4a49619b.b11d6","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Pai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_softcelular","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1720,"y":4660,"wires":[[]]},{"id":"a563d3b7.22322","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Maria, é sua vez de estender a roupa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1550,"y":4520,"wires":[[]]},{"id":"b5d7e180.ae7d3","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_maria_s_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1730,"y":4600,"wires":[[]]},{"id":"26249e87.c4bb52","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cristófer, é sua vez de estender a roupa.\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_pai\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1550,"y":4720,"wires":[[]]},{"id":"750e76aa.199378","type":"api-call-service","z":"859b066a.dd8128","name":"Ventilador","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.ventilador","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1160,"y":4220,"wires":[[]]},{"id":"1af4195f.5b5297","type":"api-call-service","z":"2bbba447.a4759c","name":"Banheiro Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.banheiro_ocupado_switch","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1550,"y":780,"wires":[[]]},{"id":"88e11aa0.ea33f8","type":"api-call-service","z":"5767c936.cabd18","name":"Abajures","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.abajur_direita","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2661,"y":760,"wires":[[]]},{"id":"6a78346b.28ebdc","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Mariana. Hoje é seu dia de lavar a louça\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":700,"wires":[[]]},{"id":"30c4bd48.a31952","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cleusa. Hoje é seu dia de lavar a louça\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":780,"wires":[[]]},{"id":"f6c95af8.213898","type":"api-call-service","z":"444fced8.33ecb","name":"Notify Alexa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":1230,"y":3140,"wires":[[]]},{"id":"6731d3c5.5a9b0c","type":"api-call-service","z":"444fced8.33ecb","name":"Notify Alexa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":1230,"y":3200,"wires":[[]]},{"id":"c0122428.4fdf18","type":"api-call-service","z":"444fced8.33ecb","name":"Notify Alexa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":1230,"y":3260,"wires":[[]]},{"id":"84c6767b.e68148","type":"api-call-service","z":"444fced8.33ecb","name":"Notify Alexa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":1230,"y":3320,"wires":[[]]},{"id":"13299b9f.ed8554","type":"api-call-service","z":"444fced8.33ecb","name":"Notify Alexa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":1230,"y":3380,"wires":[[]]},{"id":"227d045a.71d77c","type":"api-call-service","z":"444fced8.33ecb","name":"Notify Alexa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":1230,"y":3440,"wires":[[]]},{"id":"446f4589.68cb0c","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Maria. Hoje é seu dia de arrumar a mesa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":840,"wires":[[]]},{"id":"b6f5757c.48cd98","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cristófer. Hoje é seu dia de arrumar a mesa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":1008,"wires":[[]]},{"id":"ab991015.11616","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Nédi. Hoje é seu dia de arrumar a mesa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":1180,"wires":[[]]},{"id":"f6f84721.a0a328","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Mariana. Hoje é seu dia de arrumar a mesa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":1348,"wires":[[]]},{"id":"cfa7af2f.b0c2c","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cleusa. Hoje é seu dia de arrumar a mesa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":1428,"wires":[[]]},{"id":"b843169a.9eaa98","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Maria. Hoje é seu dia de arrumar e limpar a cozinha\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":1480,"wires":[[]]},{"id":"8ef6fd7b.134b8","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cristófer. Hoje é seu dia de arrumar e limpar a cozinha\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":1640,"wires":[[]]},{"id":"ec9b4920.be1ac8","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Nédi. Hoje é seu dia de arrumar e limpar a cozinha\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":1811,"wires":[[]]},{"id":"4b6f284e.1139a8","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Mariana. Hoje é seu dia de arrumar e limpar a cozinha\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":1980,"wires":[[]]},{"id":"f5000d4b.74a9e","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cleusa. Hoje é seu dia de arrumar e limpar a cozinha\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":2060,"wires":[[]]},{"id":"6f58ca8e.048b94","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"mqtt","service":"publish","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1310,"y":2380,"wires":[[]]},{"id":"31948f25.2f2cd","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify MacBook","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1340,"y":2500,"wires":[[]]},{"id":"58341600.ba1368","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi's iPhone","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1360,"y":2440,"wires":[[]]},{"id":"45dd6492.0006cc","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Pai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_softcelular","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1320,"y":2260,"wires":[[]]},{"id":"43e52cf5.3e7ee4","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Maria. Hoje é seu dia de fazer o almoço\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":2140,"wires":[[]]},{"id":"68b39efe.27e76","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_maria_s_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1330,"y":2200,"wires":[[]]},{"id":"54ff00d4.4fe9","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cristófer. Hoje é seu dia de fazer o almoço\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":2320,"wires":[[]]},{"id":"573b9ed7.9701f","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Mariana. Hoje é seu dia de fazer o almoço\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":2560,"wires":[[]]},{"id":"23ae8fa.232b57","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Mariana. Hoje é seu dia de arrumar a mesa\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1150,"y":2620,"wires":[[]]},{"id":"680d3cd7.7b3284","type":"api-current-state","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_nedi_homekit","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":590,"y":1180,"wires":[["1bf5970a.d99939","81a6fdf6.25452"],["1bf5970a.d99939"]]},{"id":"b19f1845.20a6e8","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Corredor escuro?","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"5","halt_if_type":"num","halt_if_compare":"lt","override_topic":false,"entity_id":"sensor.sensor_de_luz_corredor","state_type":"num","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":750,"y":1400,"wires":[["eb38b384.65fda"],["eb38b384.65fda"]]},{"id":"55f5a77a.253908","type":"api-current-state","z":"4c9c764d.9c4468","name":"Sala Ocupada","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.sala_ocupada","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1180,"y":400,"wires":[["e53fd18b.10dd3","7840428.2ec55bc"],["e53fd18b.10dd3","7840428.2ec55bc"]]},{"id":"74c414e5.0afb0c","type":"api-current-state","z":"859b066a.dd8128","name":"RGB Strip","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"light.rgb_strip","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1410,"y":1160,"wires":[["ce1bcdf1.593cb"],["ce1bcdf1.593cb"]]},{"id":"89da767e.34ade8","type":"api-current-state","z":"2bbba447.a4759c","name":"Banheiro Ocupado","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.banheiro_ocupado","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":730,"y":420,"wires":[["52b72dee.4176d4"]]},{"id":"646d904c.6769f","type":"api-current-state","z":"2ea7fd8b.7e0bb2","name":"Vó Em Casa","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.vo_em_casa","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":390,"y":320,"wires":[["e588ecf4.3d63d"],["e588ecf4.3d63d"]]},{"id":"2007e720.2de1f8","type":"api-current-state","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_nedi_homekit","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":870,"y":3680,"wires":[["bbfced5e.c9152"]]},{"id":"b7254c11.8a6fe","type":"api-current-state","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_nedi_homekit","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2000,"y":220,"wires":[["dd96d778.8e89b8","f2c4c73c.d2fef8"]]},{"id":"1a8b27f1.115c48","type":"api-current-state","z":"4c9c764d.9c4468","name":"Sala Ocupada","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.sala_ocupada","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1540,"y":240,"wires":[["a2a4940d.a23088"],["a2a4940d.a23088"]]},{"id":"dea9e275.a6cd1","type":"api-current-state","z":"e7cd1901.ee2408","name":"Luz da Sala","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_da_sala","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1850,"y":220,"wires":[["95c52976.c05758","4b0ffe36.4217f"]]},{"id":"41b9df88.d6a34","type":"api-current-state","z":"5767c936.cabd18","name":"Luz do Escritório","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_escritorio_1","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1610,"y":280,"wires":[["10709ab7.2877a5"]]},{"id":"cdde1573.915d88","type":"api-current-state","z":"d67ca66.293d758","name":"Nédi home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":990,"y":1820,"wires":[["6e9440a1.3fa3a","46242ddd.8b1464"]]},{"id":"761491ab.47174","type":"api-current-state","z":"859b066a.dd8128","name":"Nédi home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":950,"y":2940,"wires":[["bee5557c.627e48"]]},{"id":"c580857d.99c3c8","type":"api-current-state","z":"d67ca66.293d758","name":"Updater?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.updater","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":437,"y":1960,"wires":[["9ab5d2cd.a93c5"]]},{"id":"3f801c92.47f5f4","type":"api-current-state","z":"d67ca66.293d758","name":"Papai home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.cristofer","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":990,"y":1940,"wires":[["df8dda9.e0cb2a8","8c767c8b.4b7048"]]},{"id":"1ad8fab2.69e7a5","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Janela Quarto Maria","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.janela_quarto_maria","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1710,"y":1940,"wires":[["56c92056.79c58"]]},{"id":"96da81b6.00201","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Janela Quarto Nédi","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.janela_quarto_nedi","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1700,"y":2000,"wires":[["b17398e3.0f3eb8"]]},{"id":"3e92f633.39663a","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Janela Quarto Pai","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.janela_quarto_pai","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1700,"y":2060,"wires":[["527d99bb.e6e388"]]},{"id":"49601c4b.d52b24","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Janela Sala Esquerda","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.janela_sala_esquerda","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1710,"y":2180,"wires":[["e46425ff.0ef6f8"]]},{"id":"fdd737c0.8ed7b8","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Chuva?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"weather.home","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1671,"y":2240,"wires":[["31ec1a11.2d0896","ff4db3ea.6494a","10dc082e.ac79a"]]},{"id":"63d3e63.7cb6f18","type":"api-current-state","z":"7b0de646.c85c78","name":"Nédi home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":410,"y":3940,"wires":[["7d6c8c4e.304f14"]]},{"id":"44f37172.e6c4c","type":"api-current-state","z":"2ea7fd8b.7e0bb2","name":"TV da Sala","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"media_player.tv_da_sala","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":390,"y":380,"wires":[["808a5ff8.37167"]]},{"id":"5f47554c.dcf13c","type":"api-current-state","z":"2ea7fd8b.7e0bb2","name":"Fire TV","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"media_player.fire_tv","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":400,"y":500,"wires":[["bdaa44f3.e86668"]]},{"id":"ccea9dd.3ac356","type":"api-current-state","z":"2ea7fd8b.7e0bb2","name":"Apple TV","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"media_player.apple_tv","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":400,"y":440,"wires":[["37a840c9.0b82f"]]},{"id":"1b287783.476148","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Quem Lava a Louça","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_lava_a_louca","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":680,"y":280,"wires":[["ac33d5bc.aa8068","5a987bdb.ac6c04","68714b3e.4ccae4","56322f3d.4f55e","f9552f8a.45009"]]},{"id":"6d293ca8.24be74","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Dias Sem Lavar a Roupa","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_number.dias_sem_lavar_a_roupa","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":770,"y":2960,"wires":[["b91e061a.d39408"]]},{"id":"853118a2.875f38","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Quem Lava a Roupa","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_lava_a_roupa","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1240,"y":2960,"wires":[["a95e112b.38c53","95ade173.f04fe","374c7c18.47d7a4"]]},{"id":"92be78b6.fbb388","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Dias Sem Levar o Lixo","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_number.dias_sem_levar_o_lixo","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":760,"y":3500,"wires":[["ebbfc12d.075ab"]]},{"id":"ef75412c.fa12d","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Quem Leva o Lixo","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_leva_o_lixo","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1230,"y":3500,"wires":[["70f8b4e8.f374ac","4ec9d9a3.39fd98","3d17cc07.1064b4"]]},{"id":"212aa61a.89a2da","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Quem Lava a Roupa","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_lava_a_roupa","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1060,"y":4020,"wires":[["3d5a35ba.7fd82a","95918114.2ca78","4bc56fc6.d158e"]]},{"id":"1f654b42.851ce5","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Quem Lava a Roupa","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_lava_a_roupa","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1080,"y":4600,"wires":[["ff8f90a2.6bc01","7692d52d.7a6a2c","48db8584.442dac"]]},{"id":"a746ccf6.359e4","type":"api-current-state","z":"859b066a.dd8128","name":"Temperatura","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"sensor.temperatura_quarto_nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":840,"y":4220,"wires":[["868ffa70.694c68"]]},{"id":"d8661a64.1e9758","type":"api-current-state","z":"859b066a.dd8128","name":"Nédi home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":500,"y":4220,"wires":[["9c93669e.1ad888"]]},{"id":"e51e3045.5da4d","type":"api-current-state","z":"859b066a.dd8128","name":"Movimento Aux","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_quarto_nedi_aux","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":530,"y":220,"wires":[["9adbba25.db7a78"]]},{"id":"16d5dc37.bf8364","type":"api-current-state","z":"2bbba447.a4759c","d":true,"name":"Movimento Quarto Maria","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_quarto_maria","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":850,"y":880,"wires":[["120b8090.260cef"]]},{"id":"1b95a1c2.86787e","type":"api-current-state","z":"444fced8.33ecb","name":"Quem Lava a Roupa","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_lava_a_roupa","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":760,"y":3140,"wires":[["9150be82.f8d1d"]]},{"id":"f1ef2f51.b93de","type":"api-current-state","z":"444fced8.33ecb","name":"Quem Lava a Louça","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_lava_a_louca","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":760,"y":3200,"wires":[["74be5855.d070e8"]]},{"id":"f53f2505.ce6f28","type":"api-current-state","z":"444fced8.33ecb","name":"Quem Faz o Almoço","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_faz_o_almoco","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":760,"y":3260,"wires":[["212a938a.d4921c"]]},{"id":"72aa4e3b.7d9b4","type":"api-current-state","z":"444fced8.33ecb","name":"Quem Lava a Cozinha","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_lava_a_cozinha","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":760,"y":3320,"wires":[["cbd9c72a.6f64a8"]]},{"id":"1b1292a7.58a55d","type":"api-current-state","z":"444fced8.33ecb","name":"Quem Leva o Lixo","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_leva_o_lixo","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":750,"y":3380,"wires":[["c7bb3020.c1e9c"]]},{"id":"a999ddd2.11c2","type":"api-current-state","z":"444fced8.33ecb","name":"Quem Arruma a Mesa","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_arruma_a_mesa","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":760,"y":3440,"wires":[["a72ef4ba.0e1068"]]},{"id":"770ab6c6.431378","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Quem Arruma a Mesa","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_arruma_a_mesa","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":680,"y":900,"wires":[["74c0c669.4d0e38","2cce545e.db7bbc","130d7896.f47fd7","cdaaa9a1.bfd9f8","ae9ff12b.eb648"]]},{"id":"f24e9eb9.587c8","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Quem Lava a Cozinha","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_lava_a_cozinha","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":680,"y":1560,"wires":[["33e7b0a2.2202d","c8159813.b19808","2ff0dba8.d52cc4","815a03c6.edb32","1bdbd9a4.c15266"]]},{"id":"a6f4d0bb.f96a7","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Quem Faz o Almoço","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_select.quem_faz_o_almoco","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":680,"y":2200,"wires":[["aec19c0c.746cc","12d42236.b0013e","b24e941d.0499b8","2993fa55.853746"]]},{"id":"4f152b26.364244","type":"ha-api","z":"444fced8.33ecb","name":"","server":"d14d7300.ae20c","debugenabled":false,"protocol":"websocket","method":"get","path":"","data":"{\"type\": \"shopping_list/items\"}","dataType":"json","location":"payload","locationType":"msg","responseType":"json","x":730,"y":4460,"wires":[["62fba09.68b566","415161f9.53369"]]},{"id":"43cb6e36.b3727","type":"ha-api","z":"444fced8.33ecb","name":"","server":"d14d7300.ae20c","debugenabled":false,"protocol":"websocket","method":"get","path":"","data":"{\"type\": \"shopping_list/items\"}","dataType":"json","location":"payload","locationType":"msg","responseType":"json","x":870,"y":4340,"wires":[["cabd4650.f81098","4943a9f0.439568"]]},{"id":"af96622f.78ac9","type":"ha-api","z":"554bb518.994efc","name":"","server":"d14d7300.ae20c","debugenabled":false,"protocol":"websocket","method":"get","path":"","data":"{\"type\": \"shopping_list/items\"}","dataType":"json","location":"payload","locationType":"msg","responseType":"json","x":1390,"y":340,"wires":[["2b507ce1.829ea4"]]},{"id":"dd17d6d1.214528","type":"sun events","z":"4c9c764d.9c4468","testmode":false,"verbose":false,"topic":"","name":"Sunset","x":610,"y":540,"wires":[["cbf70672.c70458"]]},{"id":"21a9e8e3.9bbc08","type":"darksky in","z":"4c9c764d.9c4468","d":true,"darksky":"8f012b2f.669ef8","name":"","key":"","lon":"-51.18650436","lat":"-30.01009828","date":"","time":"","lang":"en","units":"ca","x":610,"y":600,"wires":[["a9a23c75.2095f"]]},{"id":"b4748033.2d69f","type":"darksky in","z":"d3db5d74.fb8fa","darksky":"8f012b2f.669ef8","name":"","key":"","lon":"-51.18650436","lat":"-30.01009828","date":"","time":"","lang":"en","units":"ca","x":1610,"y":2380,"wires":[["c4144b54.079d28","1a87657.8904d1b"]]},{"id":"c853cb4a.0f97e8","type":"pushbullet","z":"859b066a.dd8128","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no Quarto Automation.","chan":"","name":"","x":1340,"y":4760,"wires":[]},{"id":"f83d952e.27ae68","type":"pushbullet","z":"5767c936.cabd18","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no Escritório Automation.","chan":"","name":"","x":1495,"y":2076,"wires":[]},{"id":"2fecdaad.39a646","type":"pushbullet","z":"e7cd1901.ee2408","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no SalaAutomation.","chan":"","name":"","x":1430,"y":1520,"wires":[]},{"id":"4814f202.46ea2c","type":"pushbullet","z":"4c9c764d.9c4468","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no HomeKit Automation.","chan":"","name":"","x":1290,"y":4800,"wires":[]},{"id":"dd589a32.8ce048","type":"pushbullet","z":"2bbba447.a4759c","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no Banheiro Automation.","chan":"","name":"","x":1390,"y":1140,"wires":[]},{"id":"7ae9832b.29fcac","type":"pushbullet","z":"d3db5d74.fb8fa","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no Aqara Sensores Automation","chan":"","name":"","x":1430,"y":3100,"wires":[]},{"id":"642c7690.ce47d8","type":"pushbullet","z":"d67ca66.293d758","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no Home Assistant Automation","chan":"","name":"","x":1430,"y":4680,"wires":[]},{"id":"308fbc11.8da8e4","type":"pushbullet","z":"7b0de646.c85c78","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no Spotify Helpers","chan":"","name":"","x":1490,"y":4640,"wires":[]},{"id":"cf6ffdbe.2c237","type":"pushbullet","z":"444fced8.33ecb","config":"efa96182.3c09a","pushtype":"note","title":"Erro em uma automação no Alexa Automation.","chan":"","name":"","x":1880,"y":4900,"wires":[]},{"id":"181802f.9d709fd","type":"e-mail","z":"859b066a.dd8128","server":"smtp.gmail.com","port":"465","secure":true,"tls":true,"name":"nedisonn@me.com","dname":"","x":1250,"y":4820,"wires":[]},{"id":"6ff94495.22d69c","type":"e-mail","z":"5767c936.cabd18","server":"smtp.gmail.com","port":"465","secure":true,"tls":true,"name":"nedisonn@me.com","dname":"","x":1415,"y":2136,"wires":[]},{"id":"90ac006a.915e5","type":"e-mail","z":"e7cd1901.ee2408","server":"smtp.gmail.com","port":"465","secure":true,"tls":true,"name":"nedisonn@me.com","dname":"","x":1350,"y":1580,"wires":[]},{"id":"d6b32035.1477","type":"e-mail","z":"4c9c764d.9c4468","server":"smtp.gmail.com","port":"465","secure":true,"tls":true,"name":"nedisonn@me.com","dname":"","x":1190,"y":4860,"wires":[]},{"id":"6b52e091.61a56","type":"e-mail","z":"2bbba447.a4759c","server":"smtp.gmail.com","port":"465","secure":true,"tls":true,"name":"nedisonn@me.com","dname":"","x":1290,"y":1200,"wires":[]},{"id":"f415c6d8.4cbf48","type":"e-mail","z":"d3db5d74.fb8fa","server":"smtp.gmail.com","port":"465","secure":true,"tls":true,"name":"nedisonn@me.com","dname":"","x":1310,"y":3160,"wires":[]},{"id":"2034f8fb.2e2178","type":"e-mail","z":"d67ca66.293d758","server":"smtp.gmail.com","port":"465","secure":true,"tls":true,"name":"nedisonn@me.com","dname":"","x":1310,"y":4740,"wires":[]},{"id":"f8ce5a3.d77dfa8","type":"e-mail","z":"7b0de646.c85c78","server":"smtp.gmail.com","port":"465","secure":true,"tls":true,"name":"nedisonn@me.com","dname":"","x":1410,"y":4700,"wires":[]},{"id":"93a15a3a.164d48","type":"e-mail","z":"444fced8.33ecb","server":"smtp.gmail.com","port":"465","secure":true,"tls":false,"name":"nedisonn@me.com","dname":"","x":1790,"y":4960,"wires":[]},{"id":"980435a0.32ea78","type":"BooleanLogicUltimate","z":"859b066a.dd8128","name":"","filtertrue":"both","persist":false,"sInitializeWith":"false","triggertopic":"trigger","outputtriggeredby":"onlyonetopic","inputCount":"4","topic":"result","x":2070,"y":1220,"wires":[[],["5bbc4c76.3271a4","d29ab4df.b0de28","a50d5f5c.46e0d"],[]]},{"id":"a4f518c2.079878","type":"BooleanLogicUltimate","z":"5767c936.cabd18","name":"","filtertrue":"both","persist":false,"sInitializeWith":"false","triggertopic":"trigger","outputtriggeredby":"onlyonetopic","inputCount":"3","topic":"result","x":1530,"y":940,"wires":[[],["5e3a273.1f3f4d8","d64c8331.8f764","703ec7a2.e01c68"],[]]},{"id":"b7203386.43b91","type":"BooleanLogicUltimate","z":"e7cd1901.ee2408","name":"","filtertrue":"both","persist":false,"sInitializeWith":"false","triggertopic":"trigger","outputtriggeredby":"onlyonetopic","inputCount":"3","topic":"result","x":1510,"y":1060,"wires":[[],["681f184.384a0e8","78eed8d.a5d0028"],[]]},{"id":"5e3a273.1f3f4d8","type":"InvertUltimate","z":"5767c936.cabd18","name":"Invert","x":1810,"y":940,"wires":[["9802b432.06b398"]]},{"id":"681f184.384a0e8","type":"InvertUltimate","z":"e7cd1901.ee2408","name":"Invert","x":1770,"y":1060,"wires":[["465bdde4.286d34"]]},{"id":"22c1a09f.a9a0d","type":"yeelight-compat-hue-state","z":"5767c936.cabd18","name":"","server":"2db68ab1.bee496","x":1610,"y":340,"wires":[["9d786bf9.924af8","37b09774.ccc7b8"]]},{"id":"d36d2c87.c9cc8","type":"yeelight-compat-hue-state","z":"e7cd1901.ee2408","name":"","server":"5a8bf4db.2d6bcc","x":1900,"y":280,"wires":[["2c10f23c.fcb11e"]]},{"id":"25b6724e.fcf97e","type":"yeelight-compat-hue-state","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":1199,"y":1580,"wires":[["b52cd23d.eabd2"]]},{"id":"2f8ed67d.22b95a","type":"yeelight-compat-hue-state","z":"2bbba447.a4759c","d":true,"name":"Luz do Banheiro","server":"56814891.18c868","x":740,"y":300,"wires":[["30922957.6bfc26"]]},{"id":"4933329e.0da91c","type":"yeelight-compat-hue-state","z":"e7cd1901.ee2408","name":"","server":"5a8bf4db.2d6bcc","x":920,"y":1000,"wires":[["b0fd8aa9.65c008"]]},{"id":"64ff672c.ba8d78","type":"yeelight-compat-hue-state","z":"5767c936.cabd18","name":"","server":"2db68ab1.bee496","x":900,"y":840,"wires":[["5d67fe55.6d3b9"]]},{"id":"33280499.5ea6bc","type":"yeelight-compat-hue-state","z":"5767c936.cabd18","name":"","server":"2db68ab1.bee496","x":1080,"y":60,"wires":[["bbdbe498.e75468"]]},{"id":"adfe724a.6dadc","type":"yeelight-compat-hue-state","z":"e7cd1901.ee2408","name":"","server":"5a8bf4db.2d6bcc","x":1510,"y":340,"wires":[["be6ae750.e08a88"]]},{"id":"89308aa8.40e6a8","type":"yeelight-compat-hue-state","z":"2bbba447.a4759c","d":true,"name":"Luz do Banheiro","server":"56814891.18c868","x":3520,"y":420,"wires":[["57b1a1b4.9a528"]]},{"id":"3290497e.d5f816","type":"yeelight-compat-hue-state","z":"5767c936.cabd18","name":"","server":"2db68ab1.bee496","x":490,"y":1780,"wires":[["4892980c.666928"]]},{"id":"9ffef5c0.172838","type":"yeelight-compat-hue-out","z":"5767c936.cabd18","name":"Luz do Escritorio","server":"14b837c9.ab10c","x":3590,"y":240,"wires":[]},{"id":"ef8cbd88.f0403","type":"yeelight-compat-hue-out","z":"e7cd1901.ee2408","name":"Luz da Sala","server":"5a8bf4db.2d6bcc","x":3770,"y":240,"wires":[]},{"id":"337c17d5.a9f378","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"Luz da Sala","server":"5a8bf4db.2d6bcc","x":1290,"y":1300,"wires":[]},{"id":"2aeb6d7.b81e592","type":"yeelight-compat-hue-out","z":"2bbba447.a4759c","d":true,"name":"Luz do Banheiro","server":"56814891.18c868","x":3300,"y":360,"wires":[]},{"id":"f127ac0f.face3","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":2030,"y":1560,"wires":[]},{"id":"b0620f12.25b7d","type":"yeelight-compat-hue-out","z":"e7cd1901.ee2408","name":"","server":"5a8bf4db.2d6bcc","x":2470,"y":1060,"wires":[]},{"id":"e432c868.e95268","type":"yeelight-compat-hue-out","z":"5767c936.cabd18","name":"","server":"14b837c9.ab10c","x":2710,"y":940,"wires":[]},{"id":"bdf393b7.4aafb","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":2030,"y":1620,"wires":[]},{"id":"e1ea9a2.31bd168","type":"yeelight-compat-hue-out","z":"2bbba447.a4759c","d":true,"name":"Luz do Banheiro","server":"56814891.18c868","x":3830,"y":420,"wires":[]},{"id":"3a30f06f.ca027","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"","server":"5a8bf4db.2d6bcc","x":1070,"y":2160,"wires":[]},{"id":"2b1b546.381d4ac","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"","server":"2db68ab1.bee496","x":1270,"y":2280,"wires":[]},{"id":"c6dd6266.3a7bb","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"Luz da Sala","server":"2db68ab1.bee496","x":1190,"y":2980,"wires":[]},{"id":"7a6c3e.100243c4","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"Luz da Sala","server":"5a8bf4db.2d6bcc","x":1170,"y":2920,"wires":[]},{"id":"6b0f1615.6cab68","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"Luz da Sala","server":"2db68ab1.bee496","x":1190,"y":3240,"wires":[]},{"id":"96807431.12f6d8","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"Luz da Sala","server":"5a8bf4db.2d6bcc","x":1170,"y":3180,"wires":[]},{"id":"71edec0.93a0814","type":"yeelight-compat-hue-out","z":"2bbba447.a4759c","d":true,"name":"Luz do Banheiro","server":"56814891.18c868","x":450,"y":740,"wires":[]},{"id":"74683cb2.be8ac4","type":"yeelight-compat-hue-out","z":"2bbba447.a4759c","d":true,"name":"Luz do Banheiro","server":"56814891.18c868","x":1370,"y":860,"wires":[]},{"id":"dd9bfc01.ea174","type":"inject","z":"2bbba447.a4759c","name":"","props":[{"p":"payload.on","v":"true","vt":"bool"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":2900,"y":380,"wires":[["eb4434ec.ed1628"]]},{"id":"89fc9ed.7aa91e","type":"yeelight-compat-hue-out","z":"5767c936.cabd18","name":"Luz do Escritorio","server":"2db68ab1.bee496","x":3450,"y":180,"wires":[]},{"id":"2c5d9c1c.9be264","type":"function","z":"5767c936.cabd18","name":"Luz do Escritorio Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_1\"\n        }\n    }};\n    node.send(newMsg)\n    \n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2\"\n        }\n    }};\n    node.send(newMsg)\n    \n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2_hk\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2441,"y":823,"wires":[["9fd07b37.426da8"]]},{"id":"9fd07b37.426da8","type":"api-call-service","z":"5767c936.cabd18","name":"Luz do Escritório 2 Off","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.luz_do_escritorio_2","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2701,"y":823,"wires":[[]]},{"id":"1af7a9e4.d79636","type":"yeelight-compat-hue-out","z":"5767c936.cabd18","name":"","server":"2db68ab1.bee496","x":2570,"y":880,"wires":[]},{"id":"ef0dad43.78086","type":"function","z":"5767c936.cabd18","name":"Luz do Escritorio On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_1\",\n            \"brightness_pct\": 100,\n            \"color_temp\": 153\n        }\n    }};\n    //node.send(newMsg)\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2\",\n            \"brightness_pct\": 100,\n            \"color_temp\": 153\n        }\n    }};\n    //node.send(newMsg)\n    \n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2_hk\",\n            \"brightness_pct\": 100,\n            \"rgb_color\": [255, 249, 242]\n        }\n    }};\n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2600,"y":1100,"wires":[["44063c91.9bb50c"]]},{"id":"44063c91.9bb50c","type":"api-call-service","z":"5767c936.cabd18","name":"Luz do Escritório On","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_escritorio","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2860,"y":1100,"wires":[[]]},{"id":"81757540.d34d7","type":"function","z":"5767c936.cabd18","name":"Add Topic","func":"var newMsg;\nif(typeof msg.ajuda !== \"undefined\"){\n    if(msg.ajuda === 1){\n        newMsg = {\"topic\":\"Luz2\", \"payload\": false};\n        flow.set(\"triggered3\", false);\n        return newMsg;\n    }\n}\nif(flow.get(\"triggered4\")===true){\n    flow.set(\"triggered4\", false);\n    if(msg.payload === \"on\")\n    {\n        newMsg = {\"topic\":\"Luz2\", \"payload\": true};\n        return newMsg;\n    }\n    if(msg.payload === \"off\")\n    {\n        newMsg = {\"topic\":\"Luz2\",\"payload\": false};\n        return newMsg;\n    }\n\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1100,"y":960,"wires":[["89b7895b.fb9a88"]]},{"id":"b4ad0947.84e188","type":"change","z":"5767c936.cabd18","name":"","rules":[{"t":"set","p":"triggered4","pt":"flow","to":"true","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":650,"y":960,"wires":[["93026f01.f8a9a","a44d5b4c.4c0be"]]},{"id":"93026f01.f8a9a","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":810,"y":900,"wires":[["718e4f93.893918"]]},{"id":"718e4f93.893918","type":"function","z":"5767c936.cabd18","name":"In Case of Error","func":"msg.ajuda = 1;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":980,"y":900,"wires":[["81757540.d34d7"]]},{"id":"89b7895b.fb9a88","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1280,"y":960,"wires":[["a4f518c2.079878"]]},{"id":"a4b1a47.d185b58","type":"change","z":"e7cd1901.ee2408","name":"","rules":[{"t":"set","p":"triggered4","pt":"flow","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"status\":\"status\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":1100,"wires":[["32b530a4.c1a65","5ab14541.fb933c"]]},{"id":"1035b59d.5c9a22","type":"function","z":"e7cd1901.ee2408","name":"Add Topic","func":"var newMsg;\nif(typeof msg.ajuda !== \"undefined\"){\n    if(msg.ajuda === 1){\n        newMsg = {\"topic\":\"LuzEntrada\", \"payload\": false};\n        flow.set(\"triggered3\", false);\n        return newMsg;\n    }\n}\nif(flow.get(\"triggered4\")===true){\n    flow.set(\"triggered4\", false);\n        if(msg.payload.state.on === true)\n        {\n            newMsg = {\"topic\":\"LuzEntrada\", \"payload\": true};\n            return newMsg;\n        }\n        if(msg.payload.state.on === false)\n        {\n            newMsg = {\"topic\":\"LuzEntrada\",\"payload\": false};\n            return newMsg;\n        }\n    \n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1140,"y":1100,"wires":[["d18d78b0.dd0e88"]]},{"id":"274c6d62.cc482a","type":"function","z":"e7cd1901.ee2408","name":"In Case of Error","func":"msg.ajuda = 1;\nreturn msg;","outputs":1,"noerr":0,"x":980,"y":1060,"wires":[["1035b59d.5c9a22"]]},{"id":"32b530a4.c1a65","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":810,"y":1060,"wires":[["274c6d62.cc482a"]]},{"id":"d18d78b0.dd0e88","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1300,"y":1100,"wires":[["b7203386.43b91"]]},{"id":"ceb656d4.09644","type":"yeelight-compat-hue-state","z":"e7cd1901.ee2408","name":"","server":"56814891.18c868","x":930,"y":1100,"wires":[["1035b59d.5c9a22"]]},{"id":"44c5f3b7.f04ac4","type":"yeelight-compat-hue-out","z":"e7cd1901.ee2408","name":"","server":"56814891.18c868","x":2480,"y":1120,"wires":[]},{"id":"33d7f2cf.e657ee","type":"function","z":"e7cd1901.ee2408","name":"Luz da Entrada Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2330,"y":880,"wires":[["be445e21.8c5018"]]},{"id":"586425e0.aad894","type":"function","z":"e7cd1901.ee2408","name":"Luz da Entrada On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\",\n            \"brightness_pct\": 100,\n            \"kelvin\": 6200\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2510,"y":920,"wires":[["be445e21.8c5018"]]},{"id":"be445e21.8c5018","type":"api-call-service","z":"e7cd1901.ee2408","name":"Luz da Entrada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"","entityId":"light.luz_da_entrada","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2720,"y":900,"wires":[[]]},{"id":"f56b8e30.19171","type":"function","z":"e7cd1901.ee2408","name":"Luz da Entrada On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\",\n            \"brightness\": msg.payload.bri,\n            \"kelvin\": msg.payload.ct\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3590,"y":60,"wires":[["57bdd3e1.87d094"]]},{"id":"57bdd3e1.87d094","type":"api-call-service","z":"e7cd1901.ee2408","name":"Luz da Entrada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_da_entrada","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3800,"y":60,"wires":[[]]},{"id":"a775b02e.913eb","type":"link in","z":"ec27da7d.cad118","name":"Quarto On","links":["d7496dca.caa2f"],"x":75,"y":300,"wires":[["7f4886f0.0875e8"]]},{"id":"56e65b9f.fc8204","type":"function","z":"ec27da7d.cad118","name":"Time Check","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\n\n\nif((Hour >= 16 && Hour <= 22)){\n    msg = {\"payload\": 1};\n    return msg;\n}\nelse if((Hour <= 8 && Hour > 22)){\n    msg = {\"payload\": 2};\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2770,"y":300,"wires":[["5cd012a9.f939c4","aa781891.2ebf6"]]},{"id":"5cd012a9.f939c4","type":"switch","z":"ec27da7d.cad118","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":2940,"y":320,"wires":[["baf177cb.e40e58","a442c7c4.7f7228"],["914e31d7.14f48","dd0d5158.67b14"]]},{"id":"30a44bf.d0c3634","type":"comment","z":"ec27da7d.cad118","name":"Alguém entrou no quarto","info":"Alguém entrou no quarto e estava com as luzes desligada.","x":1620,"y":220,"wires":[]},{"id":"91258170.3b41f8","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"30","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1730,"y":280,"wires":[["95f26990.dad3e8","2e839e1c.af03c2"]]},{"id":"e29f4d90.e8fec8","type":"inject","z":"ec27da7d.cad118","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2560,"y":340,"wires":[["56e65b9f.fc8204"]]},{"id":"aa781891.2ebf6","type":"debug","z":"ec27da7d.cad118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2920,"y":220,"wires":[]},{"id":"f1e1977a.6f1fc8","type":"function","z":"ec27da7d.cad118","name":"Check if it's already On","func":"if(msg.payload === \"off\"){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2550,"y":260,"wires":[["56e65b9f.fc8204"]]},{"id":"903722bf.f5bfd","type":"inject","z":"ec27da7d.cad118","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1180,"y":360,"wires":[["20d4a2d7.21cc9e"]]},{"id":"5e3b95d1.e42b0c","type":"debug","z":"ec27da7d.cad118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2230,"y":340,"wires":[]},{"id":"7555de2d.334b38","type":"function","z":"ec27da7d.cad118","name":"Movimento dentro?","func":"if(msg.payload === \"off\"){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1530,"y":300,"wires":[["91258170.3b41f8"]]},{"id":"95f26990.dad3e8","type":"api-current-state","z":"ec27da7d.cad118","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_maria","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1950,"y":300,"wires":[["5e3b95d1.e42b0c","4e054618.f5ace8"]]},{"id":"20d4a2d7.21cc9e","type":"api-current-state","z":"ec27da7d.cad118","name":"Movimento Aux","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_quarto_maria_aux","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1330,"y":300,"wires":[["7555de2d.334b38"]]},{"id":"bd1f6328.84ca2","type":"api-current-state","z":"859b066a.dd8128","name":"Projetor Ceu","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"light.projetor_ceu","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1410,"y":1280,"wires":[["4cf5516a.7f55"],["4cf5516a.7f55"]]},{"id":"1df6f143.b3402f","type":"yeelight-compat-hue-out","z":"e7cd1901.ee2408","name":"Luz da Sala","server":"56814891.18c868","x":3640,"y":180,"wires":[]},{"id":"a44d5b4c.4c0be","type":"api-current-state","z":"5767c936.cabd18","name":"Luz do Escriório 2 HK","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_escritorio_2_hk","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":880,"y":960,"wires":[["81757540.d34d7"]]},{"id":"2e839e1c.af03c2","type":"api-current-state","z":"ec27da7d.cad118","name":"Luz do Quarto Maria HK","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_maria_hk","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1960,"y":240,"wires":[["4e054618.f5ace8","42fe6d4f.76c4e4"]]},{"id":"581daa37.ad1a54","type":"function","z":"444fced8.33ecb","name":"Netflix","func":"if(         (msg.payload.name===\"Echo Dot da Sala\" && (\n        (\n        msg.payload.description.summary.includes('Netflix')===true\n    )))){\n    var newMsg;\n        newMsg = {payload:{}}\n    global.set(\"boaNoiteCasa\", false)\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"app\",\n          \"media_content_id\": \"11101200001\"\n        }\n    }\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":490,"y":2140,"wires":[["4be760da.d877"]]},{"id":"9704ea70.dfcb88","type":"function","z":"444fced8.33ecb","name":"Disney Plus","func":"if(         (msg.payload.name===\"Echo Dot da Sala\" && (\n        \n        msg.payload.description.summary.includes('disney plus')===true\n    ))){\n    var newMsg;\n        newMsg = {payload:{}}\n    global.set(\"boaNoiteCasa\", false)\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"app\",\n          \"media_content_id\": \"MCmYXNxgcu.DisneyPlus\"\n        }\n    }\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":2180,"wires":[["4be760da.d877"]]},{"id":"cf6e490b.bd57d8","type":"debug","z":"444fced8.33ecb","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1150,"y":2180,"wires":[]},{"id":"6c79311b.68ced","type":"server-state-changed","z":"859b066a.dd8128","name":"Movimento","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.movimento_quarto_nedi","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":360,"y":660,"wires":[["8d1f178e.806578"],["8d1f178e.806578"]]},{"id":"cc553f2f.68ab8","type":"server-state-changed","z":"859b066a.dd8128","name":"Movimento Aux","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.movimento_quarto_nedi_aux","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":380,"y":720,"wires":[["8d1f178e.806578"],["8d1f178e.806578"]]},{"id":"8d1f178e.806578","type":"function","z":"859b066a.dd8128","name":"Movimento?","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":570,"y":680,"wires":[["ad7eee9a.1e84a8"]]},{"id":"813518c3.c153b8","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"if(msg.payload == false){\n    var date = new Date();\n    var Hour = date.getHours(); //hours in 0-23\n    if(Hour > 21 || Hour < 8){\n        newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \"entity_id\": \"light.fita_cama\",\n                \"rgb_color\": [255,0,255],\n                \"brightness\": 255\n            }\n        }};\n        return newMsg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":940,"y":680,"wires":[["f04f2f6b.fb44b","cdfb9483.1eb448"]]},{"id":"1f8cffab.901a3","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.fita_cama\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1960,"y":720,"wires":[["f04f2f6b.fb44b"]]},{"id":"ad7eee9a.1e84a8","type":"api-current-state","z":"859b066a.dd8128","name":"Quarto Nédi on?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"group.luzes_do_quarto_nedi","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":760,"y":680,"wires":[["813518c3.c153b8"]]},{"id":"bf344586.9863a8","type":"server-state-changed","z":"c3fa9bdb.b5c4c8","name":"Máquina de Lavar Roupas","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.sensor_da_maquina_de_lavar_action","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":2350,"y":4540,"wires":[["3d92c90.d75af38","6052aaa5.23f7e4","c4c5e231.078db"]]},{"id":"3d92c90.d75af38","type":"function","z":"c3fa9bdb.b5c4c8","name":"Vibrando?","func":"if( msg.payload === \"vibration\" ||\n    msg.payload === \"tilt\" ||\n    msg.payload === \"drop\" \n    ){\n    vibrationCount = flow.get(\"vibrationCount\");\n    washingMachineStage = flow.get(\"washingMachineStage\")\n    if(vibrationCount > 3 || washingMachineStage == \"Lavando\"){\n        flow.set(\"vibrationCount\", vibrationCount+1);\n        flow.set(\"washingMachineStage\", \"Lavando\")\n        var newMsg;\n        newMsg = {payload:{\n                      \"domain\": \"input_select\",\n                      \"service\": \"select_option\",\n                      \"data\":{\n                      \"entity_id\": \"input_select.maquina_de_lavar_roupas\",\n                        \"option\": \"Lavando\"\n                    }\n                }\n            }\n            return newMsg;\n    \n    }\n    flow.set(\"vibrationCount\", vibrationCount+1);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2570,"y":4540,"wires":[["a991685f.ed5a28","72cc7c65.6be7a4","30ebe780.fd8ac8"]]},{"id":"9c867cd6.62ccf","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Maq Lavar Input Select","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_select","service":"select_option","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3970,"y":4520,"wires":[[]]},{"id":"e7df2829.b0fe88","type":"function","z":"c3fa9bdb.b5c4c8","name":"Acabou","func":"    var newMsg;\n    if(flow.get(\"washingMachineStage\") == \"Lavando\"){ \n        flow.set(\"vibrationCount\", 0);\n        newMsg = {payload:{\n                  \"domain\": \"input_select\",\n                  \"service\": \"select_option\",\n                  \"data\":{\n                  \"entity_id\": \"input_select.maquina_de_lavar_roupas\",\n                    \"option\": \"Pronto\"\n                }\n            }\n        }\n        flow.set(\"washingMachineStage\", \"Pronto\")\n        return newMsg;\n    }","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3220,"y":4500,"wires":[["9c867cd6.62ccf","665518b0.bbb868","dc104c0e.649cc"]]},{"id":"273820d4.f2e2f","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delayv","timeout":"25","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2920,"y":4500,"wires":[["e26a2c5c.ca85"]]},{"id":"b90f92de.0e9e6","type":"function","z":"444fced8.33ecb","name":"WoL PC","func":"if(\n    (msg.payload.description.summary.includes('liga')===true || \n    msg.payload.description.summary.includes('ligue')===true ||\n    msg.payload.description.summary.includes('desliga')===false ||\n    msg.payload.description.summary.includes('desligue')===false )&& \n    ((msg.payload.description.summary.includes('p.')===true && \n        msg.payload.description.summary.includes('c.')===true)  ||\n        msg.payload.description.summary.includes('p.c.')===true||\n        msg.payload.description.summary.includes('PC')===true\n    )\n    ){\n    var newMsg;\n    newMsg= {payload : \n                {\n                    \"domain\": \"wake_on_lan\",\n                    \"service\": \"send_magic_packet\",\n                    \"data\":{\n                        \"mac\": \"10:1f:74:38:e3:8e\"\n                    }\n                }\n            };\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":1840,"wires":[["7c52f827.a60848","41cbc1bd.13f36"]]},{"id":"7c52f827.a60848","type":"api-call-service","z":"444fced8.33ecb","name":"Liga PC","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"wake_on_lan","service":"send_magic_packet","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":740,"y":1840,"wires":[[]]},{"id":"a3d7f2c3.98fec","type":"function","z":"d3db5d74.fb8fa","name":"janela aux","func":"global.set(\"janelaSala\",msg.payload);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1910,"y":2120,"wires":[[]]},{"id":"9478d381.e15f1","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Janela Sala Direita","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.janela_sala_direita","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1700,"y":2120,"wires":[["a3d7f2c3.98fec"]]},{"id":"f04f2f6b.fb44b","type":"api-call-service","z":"859b066a.dd8128","name":"Fita Cama","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2130,"y":680,"wires":[[]]},{"id":"ddbd9add.1002e8","type":"function","z":"e7cd1901.ee2408","name":"Turn Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ventilador_da_sala\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2300,"y":1264,"wires":[["5f49e5ae.ed0ccc"]]},{"id":"5f49e5ae.ed0ccc","type":"api-call-service","z":"e7cd1901.ee2408","name":"Ventilador da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.ventilador_da_sala","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2510,"y":1264,"wires":[[]]},{"id":"7098bf85.8fa28","type":"server-state-changed","z":"e7cd1901.ee2408","name":"Desabilita Automação","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.desabilita_automacao_sala_escritorio","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":680,"y":400,"wires":[["624eb6b9.64f488"]]},{"id":"624eb6b9.64f488","type":"function","z":"e7cd1901.ee2408","name":"Aux Function","func":"if(msg.payload === \"on\"){\n    global.set(\"desabilitaAutomacao\", true)\n    var newMsg = {\"reset\": true}\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":890,"y":400,"wires":[["b2a76711.ae4398","9f86e19e.674de","897ff515.4b9148"]]},{"id":"15a0cc4b.9e0534","type":"server-state-changed","z":"5767c936.cabd18","name":"Desabilita Automação","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.desabilita_automacao_sala_escritorio","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":480,"y":380,"wires":[["4efd30af.8f616"]]},{"id":"4efd30af.8f616","type":"function","z":"5767c936.cabd18","name":"Aux Function","func":"if(msg.payload === \"on\"){\n    global.set(\"desabilitaAutomacao\", true)\n    var newMsg = {payload:\"reset\", reset: true}\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":670,"y":380,"wires":[["ba6a4e16.62ac7","8a61a341.0fa5d","dcd2984c.8ee318"]]},{"id":"3b8f46f7.b07fba","type":"comment","z":"859b066a.dd8128","name":"Ligar a luz debaixo da cama quando tiver movimento a noite","info":"","x":1200,"y":600,"wires":[]},{"id":"a696a96c.c0ecd8","type":"api-call-service","z":"e7cd1901.ee2408","name":"Ar Condicionado da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_off","entityId":"switch.ar_condicionado_sala","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2530,"y":1313,"wires":[[]]},{"id":"4c93361b.8a2798","type":"function","z":"e7cd1901.ee2408","name":"Turn Off","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ar_condicionado_sala\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2300,"y":1313,"wires":[["a696a96c.c0ecd8"]]},{"id":"271f0a9b.e32556","type":"api-call-service","z":"859b066a.dd8128","name":"Todas as Luzes do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.fita_cama","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1190,"y":3320,"wires":[[]]},{"id":"5be8420e.25cb1c","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"group.luzes_do_quarto_nedi\"\n    }\n}};\nnode.send(newMsg);\n\nnewMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"group.luzes_do_quarto_nedi\"\n    }\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":980,"y":3320,"wires":[["271f0a9b.e32556"]]},{"id":"ac7096f9.685db8","type":"api-call-service","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi_homekit","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1770,"y":2020,"wires":[[]]},{"id":"403451b.4c77ab","type":"function","z":"859b066a.dd8128","name":"Luz do Quarto On","func":"var newMsg;\nvar brightness;\nif(msg.payload === \"on\"){\n    if(msg.data.attributes.brightness*100/255 < 95){\n        brightness = parseInt(msg.data.attributes.brightness*100/255)\n        while(brightness < 95){\n            brightness = brightness + 15;\n            if(brightness < 100){\n                newMsg= {payload : {\n                    \"domain\": \"light\",\n                    \"service\": \"turn_on\",\n                    data:{\n                        \n                        \"entity_id\": \"light.luz_do_quarto_nedi_homekit\",\n                        \"brightness_pct\": brightness,\n                        \"rgb_color\": [255,255,255]\n                    }\n                    }};\n                node.send(newMsg);\n            }else{\n                newMsg= {payload : {\n                    \"domain\": \"light\",\n                    \"service\": \"turn_on\",\n                    data:{\n                        \n                        \"entity_id\": \"light.luz_do_quarto_nedi_homekit\",\n                        \"brightness_pct\": 100,\n                        \"rgb_color\": [255,255,255]\n                    }\n                    }};\n                node.send(newMsg);\n            }\n        }\n        \n    }\n}\nelse{\n        newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.luz_do_quarto_nedi_homekit\",\n                \"brightness_pct\": 1,\n                \"rgb_color\": [255,255,255]\n            }\n        }};\n        node.send(newMsg);\n        newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.luz_do_quarto_nedi\"\n            }\n        }};\n        node.send(newMsg);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1550,"y":1980,"wires":[["ac7096f9.685db8"]]},{"id":"8b3f41b3.774c3","type":"server-state-changed","z":"859b066a.dd8128","name":"Porta Armário","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.porta_do_armario_action","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":930,"y":1980,"wires":[["736e54ee.c8b8ec","8e0dbc08.ece2a"]]},{"id":"59b7617c.6557b","type":"comment","z":"859b066a.dd8128","name":"Porta do armário abre e liga a luz","info":"","x":950,"y":1740,"wires":[]},{"id":"1177050d.93763b","type":"api-current-state","z":"ec27da7d.cad118","name":"Quantos Lux?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"sensor.sensor_de_luz_quarto_maria","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":900,"y":300,"wires":[["92ca138.d2915f"]]},{"id":"92ca138.d2915f","type":"function","z":"ec27da7d.cad118","name":"Escuro?","func":"if(msg.payload < 15){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1080,"y":300,"wires":[["20d4a2d7.21cc9e"]]},{"id":"c1e06d21.5bb3b","type":"function","z":"ec27da7d.cad118","name":"Veio de onde","func":"if(msg.data.attributes.flowing === null){\n    flow.set(\"cameFrom\", \"HK\");\n}\nelse{\n    flow.set(\"cameFrom\", \"HA\")\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2350,"y":260,"wires":[["f1e1977a.6f1fc8"]]},{"id":"4e054618.f5ace8","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2190,"y":240,"wires":[["c1e06d21.5bb3b"]]},{"id":"42fe6d4f.76c4e4","type":"debug","z":"ec27da7d.cad118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":2240,"y":160,"wires":[]},{"id":"c3cdc6e2.6da458","type":"api-current-state","z":"ec27da7d.cad118","name":"Hora do Sono","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.hora_do_sono_maria","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":560,"y":300,"wires":[["2c146ffe.19e48"],["2c146ffe.19e48"]]},{"id":"2c146ffe.19e48","type":"function","z":"ec27da7d.cad118","name":"Dormindo?","func":"if(msg.payload === false){\n    global.set(\"horaDoSonoMaria\", false);\n    return msg;\n}\nelse{\n    global.set(\"horaDoSonoMaria\", true);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":730,"y":300,"wires":[["1177050d.93763b"]]},{"id":"548f56c3.b00918","type":"function","z":"444fced8.33ecb","name":"Cozy Time Maria","func":"if(\n    msg.payload.name===\"Echo Dot do Quarto Maria\" &&(\n    msg.payload.description.summary.includes('vou')===true &&\n    (\n    msg.payload.description.summary.includes('descansar')===true ||\n    msg.payload.description.summary.includes('descansa')===true || \n    msg.payload.description.summary.includes('deitar')===true||\n    msg.payload.description.summary.includes('deita')===true|| \n    msg.payload.description.summary.includes('cama')===true\n    ))){\n\n    global.set(\"turnOffDelay\", true);\n    var newMsg;\n    newMsg = {\"payload\": {\"On\": true}};\n    return newMsg;\n    \n    \n    \n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":530,"y":820,"wires":[["bb9b69d9.962478","210863f.1fbad9c","34313e25.c013c2"]]},{"id":"6d30b421.7fdb9c","type":"function","z":"444fced8.33ecb","name":"Boa Noite Maria","func":"if(\n    msg.payload.name===\"Echo Dot do Quarto Maria\" &&(\n    msg.payload.description.summary.includes('boa noite')===true ||\n    msg.payload.description.summary.includes('dormir')===true || \n    msg.payload.description.summary.includes('dormi')===true ||\n    (msg.payload.description.summary.includes('hora')===true &&\n    msg.payload.description.summary.includes('sono')===true)\n    )){\n    global.set(\"horaDoSonoMaria\", true);\n    var newMsg;\n    newMsg = {\"payload\": {\"On\": true}};\n    return newMsg;\n    \n    \n    \n    \n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":1000,"wires":[["e0daef57.33681","d8940157.5bc73","90c2bfda.c26d3","34313e25.c013c2"]]},{"id":"2df97c93.0c1ec4","type":"api-current-state","z":"ec27da7d.cad118","name":"Quantos Lux?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"sensor.sensor_de_luz_quarto_maria","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":680,"y":620,"wires":[["679b0dd4.459454"]]},{"id":"b45b9c2c.2eaf3","type":"inject","z":"ec27da7d.cad118","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"0 0-22 * * *","once":false,"onceDelay":"15","topic":"","payload":"","payloadType":"date","x":510,"y":620,"wires":[["2df97c93.0c1ec4"]]},{"id":"679b0dd4.459454","type":"function","z":"ec27da7d.cad118","name":"Funcionando?","func":"if(msg.payload > 60000){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":860,"y":620,"wires":[["7ebcdacf.62da04","cf7e2ed6.08caa","4489e602.fd0c88","7a8c104b.b9638"]]},{"id":"bb9b69d9.962478","type":"function","z":"444fced8.33ecb","name":"Pouco brilho e colorido","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.luz_do_quarto_nedi\",\n        \"brightness\": 20,\n        \"rgb_color\": [50,255,193]\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":780,"y":800,"wires":[["a39eb2da.734a"]]},{"id":"a39eb2da.734a","type":"api-call-service","z":"444fced8.33ecb","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.luz_do_quarto_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1000,"y":800,"wires":[[]]},{"id":"210863f.1fbad9c","type":"function","z":"444fced8.33ecb","name":"Galáxia On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.galaxia_maria\",\n        \"brightness\": 60\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":750,"y":860,"wires":[["d70f5eda.7069b"]]},{"id":"d70f5eda.7069b","type":"api-call-service","z":"444fced8.33ecb","name":"Galáxia Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.galaxia_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":980,"y":860,"wires":[[]]},{"id":"e0daef57.33681","type":"function","z":"444fced8.33ecb","name":"Luz Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.luz_do_quarto_maria\"\n    }\n}};\nnode.send(newMsg);\n\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.luz_do_quarto_maria_hk\"\n    }\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":740,"y":960,"wires":[["93d4fa3f.b0ee68"]]},{"id":"93d4fa3f.b0ee68","type":"api-call-service","z":"444fced8.33ecb","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.luz_do_quarto_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1002,"y":960,"wires":[[]]},{"id":"d8940157.5bc73","type":"function","z":"444fced8.33ecb","name":"Galáxia Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.galaxia_maria\",\n        \"brightness\": 5\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":750,"y":1020,"wires":[["f210ed72.ae562"]]},{"id":"f210ed72.ae562","type":"api-call-service","z":"444fced8.33ecb","name":"Galáxia Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.galaxia_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":980,"y":1020,"wires":[[]]},{"id":"90c2bfda.c26d3","type":"function","z":"444fced8.33ecb","name":"Hora do Sono On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"input_boolean.hora_do_sono_maria\"\n    }\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":770,"y":1080,"wires":[["7c734dd5.385e94"]]},{"id":"7c734dd5.385e94","type":"api-call-service","z":"444fced8.33ecb","name":"Hora do Sono Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"input_boolean.hora_do_sono_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1000,"y":1080,"wires":[[]]},{"id":"d6210037.0c3e5","type":"function","z":"d67ca66.293d758","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"input_boolean.hora_do_sono_maria\"\n    }\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":470,"y":2736,"wires":[["43780a31.7cd754"]]},{"id":"43780a31.7cd754","type":"api-call-service","z":"d67ca66.293d758","name":"Hora do Sono Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"input_boolean.hora_do_sono_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":654,"y":2736,"wires":[[]]},{"id":"7f4886f0.0875e8","type":"api-current-state","z":"ec27da7d.cad118","name":"Corredor","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_corredor","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":200,"y":300,"wires":[["2bd910fe.b30b3"],["2bd910fe.b30b3"]]},{"id":"2bd910fe.b30b3","type":"function","z":"ec27da7d.cad118","name":"Movimento?","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":370,"y":300,"wires":[["c3cdc6e2.6da458"]]},{"id":"4486ff2d.764ba","type":"api-current-state","z":"859b066a.dd8128","name":"Corredor","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_corredor","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":200,"y":220,"wires":[["f1d686af.40d548"],["f1d686af.40d548"]]},{"id":"f1d686af.40d548","type":"function","z":"859b066a.dd8128","name":"Movimento?","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":350,"y":220,"wires":[["e51e3045.5da4d"]]},{"id":"8f236e2.339c69","type":"function","z":"444fced8.33ecb","name":"Cancela Automações","func":"if(\n        (\n            msg.payload.description.summary.includes('cancela')===true || \n            msg.payload.description.summary.includes('cancelar')===true || \n            msg.payload.description.summary.includes('cancele')===true\n        ) && \n        (\n            msg.payload.description.summary.includes('automação')===true|| \n            msg.payload.description.summary.includes('automações')===true\n        )\n    ){\n        var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.desabilita_automacao_sala_escritorio\"\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":540,"y":160,"wires":[["e8b6e905.89cc98"]]},{"id":"e8b6e905.89cc98","type":"api-call-service","z":"444fced8.33ecb","name":"Add Item Shopping List","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"shopping_list","service":"add_item","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":810,"y":160,"wires":[[]]},{"id":"eb10d419.bb3698","type":"api-current-state","z":"2ea7fd8b.7e0bb2","name":"Alguém em Casa?","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.alguem_em_casa","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":950,"y":240,"wires":[["5e04f236.08948c"],["5e04f236.08948c"]]},{"id":"5e04f236.08948c","type":"function","z":"2ea7fd8b.7e0bb2","name":"True?","func":"if(msg.payload === false){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1130,"y":240,"wires":[["2f7e965e.742a2a","96c98e71.db341"]]},{"id":"7e4aedf.3862314","type":"api-call-service","z":"2ea7fd8b.7e0bb2","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Seja bem-vindo\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_do_quarto_nedi\",\"media_player.echo_dot_do_quarto\",\"media_player.echo_dot_do_quarto_maria\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1590,"y":240,"wires":[[]]},{"id":"fa95f894.fa4f98","type":"function","z":"2ea7fd8b.7e0bb2","name":"Aux","func":"return {payload: true};","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1450,"y":240,"wires":[["7e4aedf.3862314"]]},{"id":"a42e66d.212d498","type":"api-call-service","z":"859b066a.dd8128","name":"Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"group.quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3510,"y":1000,"wires":[[]]},{"id":"8d7bb5c9.c6fab8","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"group.quarto_nedi\"\n    }\n}};\nnode.send(newMsg);\n\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"group.quarto_nedi\"\n    }\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3360,"y":1000,"wires":[["a42e66d.212d498"]]},{"id":"95692a86.5657b8","type":"function","z":"444fced8.33ecb","name":"Temperatura na Sala","func":"if( \n    (\n        msg.payload.name===\"Echo Dot da Sala\" &&\n        msg.payload.description.summary.includes('aqui')===true &&\n        msg.payload.description.summary.includes('temperatura')===true\n        ) \n    ||\n    (\n        msg.payload.description.summary.includes('sala')===true &&\n        msg.payload.description.summary.includes('temperatura')===true\n        )\n    ){\n        var newMsg;\n        newMsg= { \"payload\": \"A temperatura atual da Sala está em {{ states.sensor.temperatura_sala.state | int }} °C\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_da_sala\" };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2320,"y":140,"wires":[["fabbb91c.440868"]]},{"id":"c7efcbaf.f44cd8","type":"function","z":"444fced8.33ecb","name":"Temperatura Quarto Nédi","func":"if( \n    (\n        msg.payload.name===\"Echo Dot do Quarto Nédi\" &&\n        msg.payload.description.summary.includes('aqui')===true &&\n        msg.payload.description.summary.includes('temperatura')===true\n        ) \n    ||\n    (\n        msg.payload.description.summary.includes('quarto')===true &&\n        (\n        msg.payload.description.summary.includes('nedi')===true ||\n        msg.payload.description.summary.includes('nédi')===true ||\n        msg.payload.description.summary.includes('mano')===true\n            ) &&\n        msg.payload.description.summary.includes('temperatura')===true\n        )\n    ){\n        \n        var newMsg;\n        newMsg= { \"payload\": \"A temperatura atual do quarto está em {{ states.sensor.temperatura_quarto_nedi.state | int }} °C\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_do_quarto_nedi\" };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2330,"y":260,"wires":[["414e38d.2ba2fc8"]]},{"id":"cfadd93a.8674e8","type":"function","z":"444fced8.33ecb","name":"Temperatura Quarto Maria","func":"if( \n    (\n        msg.payload.name===\"Echo Dot do Quarto Maria\" &&\n        msg.payload.description.summary.includes('aqui')===true &&\n        msg.payload.description.summary.includes('temperatura')===true\n        ) \n    ||\n    (\n        msg.payload.description.summary.includes('quarto')===true &&\n        (\n        msg.payload.description.summary.includes('maria')===true ||\n        msg.payload.description.summary.includes('mana')===true\n            ) &&\n        msg.payload.description.summary.includes('temperatura')===true\n        )\n    ){\n        \n        var newMsg;\n        newMsg= { \"payload\": \"A temperatura atual do quarto está em {{ states.sensor.temperatura_quarto_maria.state | int }} °C\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_do_quarto_maria\" };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2340,"y":380,"wires":[["62bac1e5.3749d"]]},{"id":"f8cda435.4b8738","type":"function","z":"444fced8.33ecb","name":"Temperatura Quarto Pai","func":"if( \n    (\n        msg.payload.name===\"Echo Dot do Quarto Pai\" &&\n        msg.payload.description.summary.includes('aqui')===true &&\n        msg.payload.description.summary.includes('temperatura')===true\n        ) \n    ||\n    (\n        msg.payload.description.summary.includes('quarto')===true &&\n        (\n        msg.payload.description.summary.includes('pai')===true\n            ) &&\n        msg.payload.description.summary.includes('temperatura')===true\n        )\n    ){\n        \n        var newMsg;\n        newMsg= { \"payload\": \"A temperatura atual do quarto está em {{ states.sensor.temperatura_quarto_pai.state | int }} °C\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_do_quarto_pai\" };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2330,"y":500,"wires":[["d4ead964.b4a5a8"]]},{"id":"cce7736e.0172","type":"api-call-service","z":"444fced8.33ecb","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2720,"y":140,"wires":[[]]},{"id":"957251a2.ec442","type":"api-call-service","z":"444fced8.33ecb","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2720,"y":260,"wires":[[]]},{"id":"9253ceb.9a85e3","type":"api-call-service","z":"444fced8.33ecb","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2720,"y":380,"wires":[[]]},{"id":"8a6d922c.eaf5","type":"api-call-service","z":"444fced8.33ecb","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2740,"y":500,"wires":[[]]},{"id":"fabbb91c.440868","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2560,"y":140,"wires":[["cce7736e.0172"]]},{"id":"414e38d.2ba2fc8","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2560,"y":260,"wires":[["957251a2.ec442"]]},{"id":"62bac1e5.3749d","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2560,"y":380,"wires":[["9253ceb.9a85e3"]]},{"id":"d4ead964.b4a5a8","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2560,"y":500,"wires":[["8a6d922c.eaf5"]]},{"id":"a1220ab4.8e3e38","type":"alexa-remote-event","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","event":"ws-device-activity","x":1930,"y":400,"wires":[["7b38a6c4.a923c8","6dc676e7.09c2f8","50376e8e.43342","c2a3bbfe.e2d738","39b5fb6b.9686b4","acd2c3c5.c6df","b712724a.1a07f","f7fff18d.7ee86","e998b33d.9019e","fbf8feee.e0037","95061fca.046ce","9f5c17e3.69c048","f040f242.d8f4e","8cee0e9f.ac9c1","b344c41b.9672e8","9ffba9b9.486ad8","3b44b6ba.d930ba","f8cda435.4b8738","95692a86.5657b8","c7efcbaf.f44cd8","cfadd93a.8674e8","df60da4e.1e4d3"]]},{"id":"7b38a6c4.a923c8","type":"function","z":"444fced8.33ecb","name":"Umidade na Sala","func":"if( \n    (\n        msg.payload.name===\"Echo Dot da Sala\" &&\n        msg.payload.description.summary.includes('aqui')===true &&\n        msg.payload.description.summary.includes('umidade')===true\n        ) \n    ||\n    (\n        msg.payload.description.summary.includes('sala')===true &&\n        msg.payload.description.summary.includes('umidade')===true\n        )\n    ){\n        var newMsg;\n        newMsg= { \"payload\": \"A umidade atual da Sala está em {{ states.sensor.temperatura_sala.state | int }} °C\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_da_sala\" };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2310,"y":80,"wires":[["d8630d84.5574a"]]},{"id":"6dc676e7.09c2f8","type":"function","z":"444fced8.33ecb","name":"Umidade Quarto Nédi","func":"if( \n    (\n        msg.payload.name===\"Echo Dot do Quarto Nédi\" &&\n        msg.payload.description.summary.includes('aqui')===true &&\n        msg.payload.description.summary.includes('umidade')===true\n        ) \n    ||\n    (\n        msg.payload.description.summary.includes('quarto')===true &&\n        (\n        msg.payload.description.summary.includes('nedi')===true ||\n        msg.payload.description.summary.includes('nédi')===true ||\n        msg.payload.description.summary.includes('mano')===true\n            ) &&\n        msg.payload.description.summary.includes('umidade')===true\n        )\n    ){\n        \n        var newMsg;\n        newMsg= { \"payload\": \"A umidade atual do quarto está em {{ states.sensor.umidade_quarto_nedi.state | int }} °C\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_do_quarto_nedi\" };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2320,"y":200,"wires":[["cb873ef4.abfdb"]]},{"id":"50376e8e.43342","type":"function","z":"444fced8.33ecb","name":"Umidade Quarto Maria","func":"if( \n    (\n        msg.payload.name===\"Echo Dot do Quarto Maria\" &&\n        msg.payload.description.summary.includes('aqui')===true &&\n        msg.payload.description.summary.includes('umidade')===true\n        ) \n    ||\n    (\n        msg.payload.description.summary.includes('quarto')===true &&\n        (\n        msg.payload.description.summary.includes('maria')===true ||\n        msg.payload.description.summary.includes('mana')===true\n            ) &&\n        msg.payload.description.summary.includes('umidade')===true\n        )\n    ){\n        \n        var newMsg;\n        newMsg= { \"payload\": \"A umidade atual do quarto está em {{ states.sensor.umidade_quarto_maria.state | int }} °C\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_do_quarto_maria\" };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2320,"y":320,"wires":[["63cdd8e0.eff6c8"]]},{"id":"c2a3bbfe.e2d738","type":"function","z":"444fced8.33ecb","name":"Umidade Quarto Pai","func":"if( \n    (\n        msg.payload.name===\"Echo Dot do Quarto Pai\" &&\n        msg.payload.description.summary.includes('aqui')===true &&\n        msg.payload.description.summary.includes('umidade')===true\n        ) \n    ||\n    (\n        msg.payload.description.summary.includes('quarto')===true &&\n        (\n        msg.payload.description.summary.includes('pai')===true\n            ) &&\n        msg.payload.description.summary.includes('umidade')===true\n        )\n    ){\n        \n        var newMsg;\n        newMsg= { \"payload\": \"A umidade atual do quarto está em {{ states.sensor.umidade_quarto_pai.state | int }} °C\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_do_quarto_pai\" };\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2320,"y":440,"wires":[["165d637d.19453d"]]},{"id":"4a8021b0.defb5","type":"api-call-service","z":"444fced8.33ecb","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2720,"y":80,"wires":[[]]},{"id":"6dbe49cb.cd70b8","type":"api-call-service","z":"444fced8.33ecb","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2720,"y":200,"wires":[[]]},{"id":"b3aa2729.750f78","type":"api-call-service","z":"444fced8.33ecb","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2720,"y":320,"wires":[[]]},{"id":"798dbf4f.b9ef5","type":"api-call-service","z":"444fced8.33ecb","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2720,"y":440,"wires":[[]]},{"id":"d8630d84.5574a","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2560,"y":80,"wires":[["4a8021b0.defb5"]]},{"id":"cb873ef4.abfdb","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2560,"y":200,"wires":[["6dbe49cb.cd70b8"]]},{"id":"63cdd8e0.eff6c8","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2560,"y":320,"wires":[["b3aa2729.750f78"]]},{"id":"165d637d.19453d","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2560,"y":440,"wires":[["798dbf4f.b9ef5"]]},{"id":"2688edc8.b1f4e2","type":"inject","z":"444fced8.33ecb","name":"9AM","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 09 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":2570,"y":4400,"wires":[["1753c247.b897ce","e861b797.29c178","e3d50599.74e858"]]},{"id":"257569d0.2d3636","type":"inject","z":"444fced8.33ecb","name":"11AM","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 11 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":2570,"y":4580,"wires":[["a67b3bf.74e4bc8","6dab6ec3.8804f","73a8a2fa.de07ec"]]},{"id":"3548c7b.3a43638","type":"inject","z":"444fced8.33ecb","name":"23PM","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 23 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":2560,"y":4760,"wires":[["eb3e56ec.853718","5e7560b5.d3604","be3f51fd.42734"]]},{"id":"1193e2c9.d4d07d","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"60"},"mode":{"type":"str","value":"set"},"devices":["d8ed9c7b043348ac9c818217500cec95"]}},"x":3140,"y":4440,"wires":[[]]},{"id":"dc1962fc.eed9a","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"40"},"mode":{"type":"str","value":"set"},"devices":["d8ed9c7b043348ac9c818217500cec95"]}},"x":3140,"y":4800,"wires":[[]]},{"id":"590cfd2d.5bd984","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"Luz da Sala","server":"56814891.18c868","x":1180,"y":3120,"wires":[]},{"id":"90ff44a7.0e0458","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"Luz da Sala","server":"56814891.18c868","x":1180,"y":2860,"wires":[]},{"id":"ee1dc484.379c48","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"Luz da Sala","server":"14b837c9.ab10c","x":1190,"y":3040,"wires":[]},{"id":"e325813b.ab572","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"Luz da Sala","server":"14b837c9.ab10c","x":1190,"y":3300,"wires":[]},{"id":"fbe96195.54045","type":"function","z":"d3db5d74.fb8fa","name":"Turn Off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"light.aqara_hub\",\n        }\n    }};\n    return newMsg;\n} ","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1220,"y":1580,"wires":[["9087ade6.99d3"]]},{"id":"c3558e1c.f8358","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Luz Noturna Off","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.aqara_hub","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2440,"y":1580,"wires":[[]]},{"id":"130a6775.a0e089","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delayv","timeout":"5","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1560,"y":1580,"wires":[["af71570d.6eabe8"]]},{"id":"2f9c7b9a.a87b14","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"Luz da Entrada","server":"56814891.18c868","x":1300,"y":1360,"wires":[]},{"id":"50e35619.23d9c8","type":"switch","z":"4c9c764d.9c4468","name":"","property":"payload.state.on","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1559,"y":1700,"wires":[["a720803c.fc91b"],["5c70c158.0a68b","117d06e2.d815f9"]]},{"id":"a720803c.fc91b","type":"function","z":"4c9c764d.9c4468","name":"Turn On Dim","func":"msg.payload = {\"on\": true,\"bri\":25, \"ct\": 3500};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"x":1739,"y":1680,"wires":[["882dd88a.862818"]]},{"id":"5c70c158.0a68b","type":"function","z":"4c9c764d.9c4468","name":"Turn On Dimmer","func":"msg.payload = {\"on\": true, \"bri\":5, \"ct\": 3500};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"x":1759,"y":1740,"wires":[["562e1375.d8856c"]]},{"id":"cebfe46c.10f188","type":"function","z":"4c9c764d.9c4468","name":"Trigger","func":"flow.set(\"triggered2\", true);\nmsg = {\"payload\": {\"status\": \"status\"}};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1019,"y":1700,"wires":[["6469c6ba.1296c8"]]},{"id":"f66dbec9.4f378","type":"function","z":"4c9c764d.9c4468","name":"Was Triggered?","func":"if(flow.set(\"triggered2\")===true){\n    flow.set(\"triggered2\", false);\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1409,"y":1700,"wires":[["50e35619.23d9c8"]]},{"id":"6469c6ba.1296c8","type":"yeelight-compat-hue-state","z":"4c9c764d.9c4468","name":"","server":"14b837c9.ab10c","x":1199,"y":1700,"wires":[["f66dbec9.4f378"]]},{"id":"5d5f419f.5982a","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"14b837c9.ab10c","x":2030,"y":1680,"wires":[]},{"id":"d32569d4.54bf88","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"14b837c9.ab10c","x":2030,"y":1740,"wires":[]},{"id":"39b5fb6b.9686b4","type":"function","z":"444fced8.33ecb","name":"Playstation","func":"if(\n     (\n        msg.payload.name===\"Echo Dot da Sala\" &&\n    (msg.payload.description.summary.includes('liga')===true || \n    msg.payload.description.summary.includes('ligue')===true ||\n    msg.payload.description.summary.includes('desliga')===false ||\n    msg.payload.description.summary.includes('desligue')===false )&& \n    (msg.payload.description.summary.includes('playstation')===true) || \n    \n    (msg.payload.description.summary.includes('vou')===true && \n    (msg.payload.description.summary.includes('jogar')===true||\n    msg.payload.description.summary.includes('joga')===true))\n    )\n    ){\n    global.set(\"boaNoiteCasa\", false)\n    global.set(\"tvAuxPlay\", true);\n    var newMsg;\n        newMsg = {payload:true}\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2290,"y":560,"wires":[["688bdd9c.1b1b54"]]},{"id":"4d6c4cb4.56d644","type":"function","z":"444fced8.33ecb","name":"Trabalhar","func":"if(\n     (\n        msg.payload.name===\"Echo Dot da Sala\" &&\n    \n    (msg.payload.description.summary.includes('vou')===true && \n    (msg.payload.description.summary.includes('trabalha')===true||\n    msg.payload.description.summary.includes('trabalhar')===true) ||\n    (msg.payload.description.summary.includes('estuda')===true||\n    msg.payload.description.summary.includes('estudar')===true))\n    )\n    ){  \n        \n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":1440,"wires":[["503759f7.d0e928","ab455957.7c1368","5f99e819.a3bcb8"]]},{"id":"aa766bac.334b08","type":"api-call-service","z":"444fced8.33ecb","name":"Escritório","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":960,"y":1440,"wires":[[]]},{"id":"503759f7.d0e928","type":"function","z":"444fced8.33ecb","name":"Turn On","func":"msg.payload = {\"on\": true,\"bri\":255, \"ct\": 6100};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":760,"y":1500,"wires":[["7391c692.dfef08"]]},{"id":"872229ae.023cb8","type":"yeelight-compat-hue-out","z":"444fced8.33ecb","name":"","server":"2db68ab1.bee496","x":1130,"y":1500,"wires":[]},{"id":"9b55449b.9da608","type":"yeelight-compat-hue-out","z":"444fced8.33ecb","name":"","server":"14b837c9.ab10c","x":1130,"y":1560,"wires":[]},{"id":"acd2c3c5.c6df","type":"function","z":"444fced8.33ecb","name":"Hora do Jogo","func":"if(\n     (\n        msg.payload.name===\"Echo Dot da Sala\" &&\n    (msg.payload.description.summary.includes('hora')===true && \n    (msg.payload.description.summary.includes('jogo')===true)) &&\n    (msg.payload.description.summary.includes('qual')===false) &&\n    (msg.payload.description.summary.includes('gremio')===false) &&\n    (msg.payload.description.summary.includes('inter')===false)\n    )\n    ){\n    var newMsg;\n        newMsg = {payload:true}\n    global.set(\"boaNoiteCasa\", false)\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2300,"y":620,"wires":[["77851ffb.f998f"]]},{"id":"12dc5583.14ceda","type":"inject","z":"e7cd1901.ee2408","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":910,"y":520,"wires":[["aa48fad2.d67908","190248cb.085527"]]},{"id":"b712724a.1a07f","type":"function","z":"444fced8.33ecb","name":"TV Quarto Maria On/Off","func":"var newMsg;\nif(\n     (\n        msg.payload.name===\"Echo Dot do Quarto Maria\" &&\n    \n    ((\n    msg.payload.description.summary.includes('ligar')===true||\n    msg.payload.description.summary.includes('ligue')===true||\n    msg.payload.description.summary.includes('liga')===true) &&\n    msg.payload.description.summary.includes('desliga')===false &&\n    msg.payload.description.summary.includes('desligar')===false && \n    (msg.payload.description.summary.includes('TV')===true||\n    msg.payload.description.summary.includes('t.v.')===true||\n    msg.payload.description.summary.includes('t v')===true||\n    (msg.payload.description.summary.includes('t.')===true&&\n    msg.payload.description.summary.includes('v.')===true)\n    ))\n    )\n    ){    \n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_on\",\n        \"data\":{\n          \"entity_id\": \"switch.tv_do_quarto_maria\",\n        }\n    }\n    node.send(newMsg);\n    newMsg= {payload : \n                {\n                    \"domain\": \"media_player\",\n                    \"service\": \"turn_on\",\n                    \"data\":{\n                        \"entity_id\": \"media_player.fire_tv_maria\"\n                    }\n                }\n            };\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.tv_do_quarto_maria\",\n        }\n    }\n    return newMsg;\n\n}\nif(\n     (\n        msg.payload.name===\"Echo Dot do Quarto Maria\" &&\n    \n    ((\n    msg.payload.description.summary.includes('desligar')===true||\n    msg.payload.description.summary.includes('desligue')===true||\n    msg.payload.description.summary.includes('desliga')===true) && \n    (msg.payload.description.summary.includes('TV')===true||\n    msg.payload.description.summary.includes('t.v.')===true||\n    msg.payload.description.summary.includes('t v')===true||\n    (msg.payload.description.summary.includes('t.')===true&&\n    msg.payload.description.summary.includes('v.')===true)\n    ))\n    )\n    ){   \n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_on\",\n        \"data\":{\n          \"entity_id\": \"switch.tv_do_quarto_maria\",\n        }\n    }\n    node.send(newMsg);\n    newMsg= {payload : \n                {\n                    \"domain\": \"media_player\",\n                    \"service\": \"turn_off\",\n                    \"data\":{\n                        \"entity_id\": \"media_player.fire_tv_maria\"\n                    }\n                }\n            };\n            \n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.tv_do_quarto_maria\",\n        }\n    }\n    node.send(newMsg);\n    return newMsg;\n\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2330,"y":680,"wires":[["f099b08a.13bcc"]]},{"id":"47a824b0.aad36c","type":"api-call-service","z":"444fced8.33ecb","name":"TV do Quarto IR","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"swich","service":"turn_on","entityId":"switch.tv_do_quarto_ir","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1300,"y":2580,"wires":[[]]},{"id":"f099b08a.13bcc","type":"api-call-service","z":"444fced8.33ecb","name":"TV do Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":2670,"y":700,"wires":[[]]},{"id":"34c8078e.a5c46","type":"function","z":"d3db5d74.fb8fa","name":"Botão Sala e Escritório Double","func":"if(msg.payload.entity_id === \"binary_sensor.botao_sala_e_escritorio\"){\n    if(msg.payload.event.click_type === \"double\"){\n\n        var newMsg\n            newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.luzes_do_escritorio\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.luzes_do_escritorio\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.sala\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.sala\"\n            }\n        }};\n        return newMsg;  \n    }\n}\n//remote.b286acn01\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":550,"y":660,"wires":[["8ef548f1.890268"]]},{"id":"2873d8ed.ca9528","type":"function","z":"d3db5d74.fb8fa","name":"Botão Sala e Escritório Click","func":"if(msg.payload.entity_id === \"binary_sensor.botao_sala_e_escritorio\"){\n    if(msg.payload.event.click_type === \"single\"){\n        var newMsg\n            newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.luzes_do_escritorio\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.luzes_do_escritorio\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.sala\"\n            }\n        }};\n        node.send(newMsg);  \n            newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"group.sala\"\n            }\n        }};\n        return newMsg;  \n    }\n}\n//remote.b286acn01\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":540,"y":620,"wires":[["c41e683b.b85588"]]},{"id":"8ef548f1.890268","type":"link out","z":"d3db5d74.fb8fa","name":"Sala e Escritorio Double Clique","links":["351146fa.54609a","d6ef785e.488e08","12c59f88.0c213"],"x":715,"y":660,"wires":[]},{"id":"c41e683b.b85588","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Sala e Escritorio Clique","links":["351146fa.54609a","d6ef785e.488e08","12c59f88.0c213"],"x":715,"y":620,"wires":[]},{"id":"c9fee3d9.d47888","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"","server":"14b837c9.ab10c","x":1270,"y":2340,"wires":[]},{"id":"b33859c3.c7681","type":"yeelight-compat-hue-out","z":"d67ca66.293d758","name":"","server":"56814891.18c868","x":1260,"y":2220,"wires":[]},{"id":"764d7fed.8f08c8","type":"inject","z":"859b066a.dd8128","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":190,"y":100,"wires":[["e0e99c04.912df"]]},{"id":"e0e99c04.912df","type":"api-current-state","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_nedi","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":410,"y":100,"wires":[["a89ed8bb.d32e4"],["a89ed8bb.d32e4"]]},{"id":"a89ed8bb.d32e4","type":"debug","z":"859b066a.dd8128","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":590,"y":100,"wires":[]},{"id":"80a3e029.e2661","type":"function","z":"c3fa9bdb.b5c4c8","name":"Veio?","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":870,"y":4600,"wires":[["1f654b42.851ce5"]]},{"id":"21ff783.0175288","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Clarice Veio?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.clarice_veio","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":730,"y":4600,"wires":[["80a3e029.e2661"]]},{"id":"9554ed69.10253","type":"function","z":"c3fa9bdb.b5c4c8","name":"Veio?","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":470,"y":2200,"wires":[["a6f4d0bb.f96a7"]]},{"id":"e21ef9a0.1759d8","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Clarice Veio?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.clarice_veio","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":330,"y":2200,"wires":[["9554ed69.10253"]]},{"id":"be9bab93.e46e48","type":"function","z":"c3fa9bdb.b5c4c8","name":"Veio?","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":1560,"wires":[["f24e9eb9.587c8"]]},{"id":"b777a9d8.2e33b8","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Clarice Veio?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.clarice_veio","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":370,"y":1560,"wires":[["be9bab93.e46e48"]]},{"id":"f2199195.b7288","type":"function","z":"c3fa9bdb.b5c4c8","name":"Veio?","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":470,"y":900,"wires":[["770ab6c6.431378"]]},{"id":"904067dc.365ae8","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Clarice Veio?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.clarice_veio","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":330,"y":900,"wires":[["f2199195.b7288"]]},{"id":"3d04b6bf.7ddf3a","type":"function","z":"c3fa9bdb.b5c4c8","name":"Veio?","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":280,"wires":[["1b287783.476148"]]},{"id":"6bddf58.ebf350c","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Clarice Veio?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.clarice_veio","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":370,"y":280,"wires":[["3d04b6bf.7ddf3a"]]},{"id":"f7fff18d.7ee86","type":"function","z":"444fced8.33ecb","name":"Luz do Quarto On/Off","func":"if( \n       msg.payload.description.summary.includes('desliga')===false &&\n       msg.payload.description.summary.includes('desligar')===false &&\n       msg.payload.description.summary.includes('desligue')===false && \n    (msg.payload.description.summary.includes('liga a luz do quarto maria')===true||\n    msg.payload.description.summary.includes('acende luz do quarto maria')===true||\n    msg.payload.description.summary.includes('liga luz do quarto maria')===true||\n    msg.payload.description.summary.includes('liga as luzes do quarto maria')===true||\n    msg.payload.description.summary.includes('liga luzes do quarto maria')===true ||\n    msg.payload.description.summary.includes('ligar a luz do quarto maria')===true||\n    msg.payload.description.summary.includes('ligar luz do quarto maria')===true||\n    msg.payload.description.summary.includes('ligar as luzes do quarto maria')===true||\n    msg.payload.description.summary.includes('ligar luzes do quarto maria')===true ||\n    msg.payload.description.summary.includes('acende a luz do quarto maria')===true||\n    msg.payload.description.summary.includes('acende as luzes do quarto maria')===true||\n    msg.payload.description.summary.includes('ligue a luz do quarto maria')===true||\n    msg.payload.description.summary.includes('ligue luz do quarto maria')===true||\n    msg.payload.description.summary.includes('ligue as luzes do quarto maria')===true||\n    msg.payload.description.summary.includes('ligue luzes do quarto maria')===true ||\n    (msg.payload.name===\"Echo Dot do Quarto Maria\" &&\n       (\n       msg.payload.description.summary.includes('acende a luz')===true ||\n       msg.payload.description.summary.includes('liga a luz')===true ||\n       msg.payload.description.summary.includes('liga luz')===true||\n       msg.payload.description.summary.includes('liga luzes')===true ||\n       msg.payload.description.summary.includes('liga as luzes')===true ||\n       msg.payload.description.summary.includes('ligar a luz')===true ||\n       msg.payload.description.summary.includes('ligar luz')===true||\n       msg.payload.description.summary.includes('ligar luzes')===true ||\n       msg.payload.description.summary.includes('ligar as luzes')===true||\n       msg.payload.description.summary.includes('ligue a luz')===true ||\n       msg.payload.description.summary.includes('ligue luz')===true||\n       msg.payload.description.summary.includes('ligue luzes')===true ||\n       msg.payload.description.summary.includes('ligue as luzes')===true\n       )))\n    ){\n    var newMsg;\n    var date = new Date();\n    var Hour = date.getHours();\n    if(Hour < 22){\n        newMsg= {payload : {\n                    \"domain\": \"light\",\n                    \"service\": \"turn_on\",\n                    data:{\n                        \n                        \"entity_id\": \"light.luz_do_quarto_maria\",\n                        \"brightness\": 255,\n                        \"color_temp\": 204\n                    }\n        }};    \n    }\n    else{\n        newMsg= {payload : {\n                    \"domain\": \"light\",\n                    \"service\": \"turn_on\",\n                    data:{\n                        \n                        \"entity_id\": \"light.luz_do_quarto_maria\",\n                        \"brightness\": 255,\n                        \"color_temp\": 305\n                    }\n        }};    \n    }\n    return newMsg;\n}\nif(\n    (msg.payload.description.summary.includes('desliga a luz do quarto maria')===true||\n    msg.payload.description.summary.includes('desliga luz do quarto maria')===true||\n    msg.payload.description.summary.includes('desliga as luzes do quarto maria')===true||\n    msg.payload.description.summary.includes('desliga luzes do quarto maria')===true ||\n    msg.payload.description.summary.includes('desligar a luz do quarto maria')===true||\n    msg.payload.description.summary.includes('desligar luz do quarto maria')===true||\n    msg.payload.description.summary.includes('desligar as luzes do quarto maria')===true||\n    msg.payload.description.summary.includes('desligar luzes do quarto maria')===true ||\n    msg.payload.description.summary.includes('desligue a luz do quarto maria')===true||\n    msg.payload.description.summary.includes('desligue luz do quarto maria')===true||\n    msg.payload.description.summary.includes('desligue as luzes do quarto maria')===true||\n    msg.payload.description.summary.includes('desligue luzes do quarto maria')===true ||\n    \n       msg.payload.description.summary.includes('apaga as luzes do quarto maria')===true ||\n       msg.payload.description.summary.includes('apagar as luzes do quarto maria')===true ||\n       msg.payload.description.summary.includes('apague as luzes do quarto maria')===true  ||\n       msg.payload.description.summary.includes('apaga a luz do quarto maria')===true ||\n       msg.payload.description.summary.includes('apagar a luz do quarto maria')===true ||\n       msg.payload.description.summary.includes('apague a luz do quarto maria')===true   ||\n       msg.payload.description.summary.includes('apaga luz do quarto maria')===true ||\n       msg.payload.description.summary.includes('apagar luz do quarto maria')===true ||\n       msg.payload.description.summary.includes('apague luz do quarto maria')===true   ||\n       msg.payload.description.summary.includes('apaga luzes do quarto maria')===true ||\n       msg.payload.description.summary.includes('apagar luzes do quarto maria')===true ||\n       msg.payload.description.summary.includes('apague luzes do quarto maria')===true ||\n    (msg.payload.name===\"Echo Dot do Quarto Maria\" &&\n       (\n       msg.payload.description.summary.includes('desliga a luz')===true ||\n       msg.payload.description.summary.includes('desliga luz')===true||\n       msg.payload.description.summary.includes('desliga luzes')===true ||\n       msg.payload.description.summary.includes('desliga as luzes')===true ||\n       msg.payload.description.summary.includes('desligar a luz')===true ||\n       msg.payload.description.summary.includes('desligar luz')===true||\n       msg.payload.description.summary.includes('desligar luzes')===true ||\n       msg.payload.description.summary.includes('desligar as luzes')===true||\n       msg.payload.description.summary.includes('desligue a luz')===true ||\n       msg.payload.description.summary.includes('desligue luz')===true||\n       msg.payload.description.summary.includes('desligue luzes')===true ||\n       msg.payload.description.summary.includes('desligue as luzes')===true ||\n       msg.payload.description.summary.includes('apaga as luzes')===true ||\n       msg.payload.description.summary.includes('apagar as luzes')===true ||\n       msg.payload.description.summary.includes('apague as luzes')===true  ||\n       msg.payload.description.summary.includes('apaga a luz')===true ||\n       msg.payload.description.summary.includes('apagar a luz')===true ||\n       msg.payload.description.summary.includes('apague a luz')===true   ||\n       msg.payload.description.summary.includes('apaga luz')===true ||\n       msg.payload.description.summary.includes('apagar luz')===true ||\n       msg.payload.description.summary.includes('apague luz')===true   ||\n       msg.payload.description.summary.includes('apaga luzes')===true ||\n       msg.payload.description.summary.includes('apagar luzes')===true ||\n       msg.payload.description.summary.includes('apague luzes')===true \n       )))\n    ){\n    var newMsg;\n    newMsg= {payload : {\n                \"domain\": \"light\",\n                \"service\": \"turn_off\",\n                data:{\n                    \n                    \"entity_id\": \"light.luz_do_quarto_maria_hk\"\n                }\n    }};    \n    node.send(newMsg);\n    \n    newMsg= {payload : {\n                \"domain\": \"light\",\n                \"service\": \"turn_off\",\n                data:{\n                    \n                    \"entity_id\": \"light.luz_do_quarto_maria\"\n                }\n    }};    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2320,"y":1400,"wires":[["15b2c5ff.4798da","db574882.3ed228"]]},{"id":"15b2c5ff.4798da","type":"api-call-service","z":"444fced8.33ecb","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2560,"y":1400,"wires":[[]]},{"id":"e477db0a.b41ee8","type":"function","z":"444fced8.33ecb","name":"Turn Off","func":"var newMsg;\n        newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"switch.tv_do_quarto_ir\"\n            }\n        }};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":900,"y":2920,"wires":[["afd4fae.477e508"]]},{"id":"afd4fae.477e508","type":"api-call-service","z":"444fced8.33ecb","name":"TV Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"swich","service":"turn_on","entityId":"switch.tv_do_quarto_ir","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1080,"y":2920,"wires":[[]]},{"id":"a82d5004.fa947","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":940,"y":2640,"wires":[["37ff20ad.93adf"]]},{"id":"37ff20ad.93adf","type":"function","z":"444fced8.33ecb","name":"Turn Off","func":"var newMsg;\n        newMsg= {payload : {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n                \"entity_id\": \"switch.tv_do_quarto_ir\"\n            }\n        }};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1100,"y":2640,"wires":[["47a824b0.aad36c"]]},{"id":"5629061c.c5f038","type":"server-state-changed","z":"444fced8.33ecb","name":"FireTV?","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"media_player.fire_tv","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":270,"y":2540,"wires":[["8f67b7ba.ee8b58"]]},{"id":"359f1927.973516","type":"server-state-changed","z":"444fced8.33ecb","name":"FireTV?","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"media_player.fire_tv_2","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":270,"y":2600,"wires":[["8f67b7ba.ee8b58"]]},{"id":"8f67b7ba.ee8b58","type":"function","z":"444fced8.33ecb","name":"Atividade","func":"var jaAconteceu = global.get(\"fireTVNediAtividade\");\nif(msg.payload === \"playing\"){\n    if(jaAconteceu === false){\n        global.set(\"fireTVNediAtividade\", true);\n        return msg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":2580,"wires":[["c16309d1.f94448"]]},{"id":"25a91864.7e1e18","type":"server-state-changed","z":"444fced8.33ecb","name":"FireTV?","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"media_player.fire_tv_maria","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":2270,"y":740,"wires":[["ebb95505.ab8a58"]]},{"id":"4cdbd812.6242c8","type":"server-state-changed","z":"444fced8.33ecb","name":"FireTV?","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"media_player.fire_tv_maria_android","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":2270,"y":820,"wires":[["ebb95505.ab8a58"]]},{"id":"ebb95505.ab8a58","type":"function","z":"444fced8.33ecb","name":"Atividade","func":"var jaAconteceu = global.get(\"fireTVMariaAtividade\");\nif(jaAconteceu === false){\n    global.set(\"fireTVMariaAtividade\", true);\n    if(msg.payload === \"playing\"){\n        var newMsg;\n            newMsg = {payload:{}}\n        newMsg.payload = {\n            \"domain\": \"switch\",\n            \"service\": \"turn_on\",\n            \"data\":{\n              \"entity_id\": \"switch.tv_do_quarto_maria\",\n            }\n        }\n        node.send(newMsg);\n        newMsg= {payload : \n                    {\n                        \"domain\": \"media_player\",\n                        \"service\": \"turn_on\",\n                        \"data\":{\n                            \"entity_id\": \"media_player.fire_tv_maria\"\n                        }\n                    }\n                };\n        node.send(newMsg);\n            newMsg = {payload:{}}\n        newMsg.payload = {\n            \"domain\": \"switch\",\n            \"service\": \"turn_off\",\n            \"data\":{\n              \"entity_id\": \"switch.tv_do_quarto_maria\",\n            }\n        }\n        return newMsg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2460,"y":780,"wires":[["f099b08a.13bcc"]]},{"id":"e998b33d.9019e","type":"function","z":"444fced8.33ecb","name":"Ar Condicionado On/Off","func":"var newMsg;\nif(\n    (msg.payload.name===\"Echo Dot da Sala\" &&\n       (\n       msg.payload.description.summary.includes('liga o ar')===true ||\n       msg.payload.description.summary.includes('ligar o ar')===true ||\n       msg.payload.description.summary.includes('ligue o ar')===true||\n       msg.payload.description.summary.includes('liga o ar condicionado')===true ||\n       msg.payload.description.summary.includes('ligar o ar condicionado')===true ||\n       msg.payload.description.summary.includes('ligue o ar condicionado')===true ||\n       msg.payload.description.summary.includes('liga ar')===true ||\n       msg.payload.description.summary.includes('ligar ar')===true ||\n       msg.payload.description.summary.includes('ligue ar')===true||\n       msg.payload.description.summary.includes('liga ar condicionado')===true ||\n       msg.payload.description.summary.includes('ligar ar condicionado')===true ||\n       msg.payload.description.summary.includes('ligue ar condicionado')===true\n       )&&\n       msg.payload.description.summary.includes('quarto')===false &&\n       msg.payload.description.summary.includes('desliga')===false &&\n       msg.payload.description.summary.includes('desligar')===false &&\n       msg.payload.description.summary.includes('desligue')===false\n       )\n    ){\n    newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_on\",\n                data:{\n                    \n                    \"entity_id\": \"switch.ar_condicionado_sala\"\n                }\n    }};    \n    \n    return newMsg;\n}\nif(\n    (msg.payload.name===\"Echo Dot da Sala\" &&\n       (\n       msg.payload.description.summary.includes('desliga o ar')===true ||\n       msg.payload.description.summary.includes('desligar o ar')===true ||\n       msg.payload.description.summary.includes('desligue o ar')===true||\n       msg.payload.description.summary.includes('desliga o ar condicionado')===true ||\n       msg.payload.description.summary.includes('desligar o ar condicionado')===true ||\n       msg.payload.description.summary.includes('desligue o ar condicionado')===true ||\n       msg.payload.description.summary.includes('desliga ar')===true ||\n       msg.payload.description.summary.includes('desligar ar')===true ||\n       msg.payload.description.summary.includes('desligue ar')===true||\n       msg.payload.description.summary.includes('desliga ar condicionado')===true ||\n       msg.payload.description.summary.includes('desligar ar condicionado')===true ||\n       msg.payload.description.summary.includes('desligue ar condicionado')===true\n       )&&\n       msg.payload.description.summary.includes('quarto')===false\n       )\n    ){\n    newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_off\",\n                data:{\n                    \n                    \"entity_id\": \"switch.ar_condicionado_sala\"\n                }\n    }};    \n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2330,"y":900,"wires":[["a43f1528.87a788","fb1f5313.600ad"]]},{"id":"a43f1528.87a788","type":"api-call-service","z":"444fced8.33ecb","name":"Ar Condicionado da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.ar_condicionado_sala","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2570,"y":900,"wires":[[]]},{"id":"cfc108ca.2de478","type":"api-call-service","z":"444fced8.33ecb","name":"Ar Condicionado do Quarto","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.ar_condicionado_quarto","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2580,"y":1060,"wires":[[]]},{"id":"fbf8feee.e0037","type":"function","z":"444fced8.33ecb","name":"Ar Condicionado On/Off","func":"var newMsg;\nif(\n    (msg.payload.name===\"Echo Dot do Quarto Nédi\" &&\n       (\n       msg.payload.description.summary.includes('liga o ar')===true ||\n       msg.payload.description.summary.includes('ligar o ar')===true ||\n       msg.payload.description.summary.includes('ligue o ar')===true||\n       msg.payload.description.summary.includes('liga o ar condicionado')===true ||\n       msg.payload.description.summary.includes('ligar o ar condicionado')===true ||\n       msg.payload.description.summary.includes('ligue o ar condicionado')===true ||\n       msg.payload.description.summary.includes('liga ar')===true ||\n       msg.payload.description.summary.includes('ligar ar')===true ||\n       msg.payload.description.summary.includes('ligue ar')===true||\n       msg.payload.description.summary.includes('liga ar condicionado')===true ||\n       msg.payload.description.summary.includes('ligar ar condicionado')===true ||\n       msg.payload.description.summary.includes('ligue ar condicionado')===true\n       )&&\n       msg.payload.description.summary.includes('sala')===false &&\n       msg.payload.description.summary.includes('desliga')===false &&\n       msg.payload.description.summary.includes('desligar')===false &&\n       msg.payload.description.summary.includes('desligue')===false\n       )\n    ){\n    newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_on\",\n                data:{\n                    \n                    \"entity_id\": \"switch.ar_condicionado_quarto\"\n                }\n    }};    \n    \n    return newMsg;\n}\nif(\n    (msg.payload.name===\"Echo Dot do Quarto Nédi\" &&\n       (\n       msg.payload.description.summary.includes('desliga o ar')===true ||\n       msg.payload.description.summary.includes('desligar o ar')===true ||\n       msg.payload.description.summary.includes('desligue o ar')===true||\n       msg.payload.description.summary.includes('desliga o ar condicionado')===true ||\n       msg.payload.description.summary.includes('desligar o ar condicionado')===true ||\n       msg.payload.description.summary.includes('desligue o ar condicionado')===true ||\n       msg.payload.description.summary.includes('desliga ar')===true ||\n       msg.payload.description.summary.includes('desligar ar')===true ||\n       msg.payload.description.summary.includes('desligue ar')===true||\n       msg.payload.description.summary.includes('desliga ar condicionado')===true ||\n       msg.payload.description.summary.includes('desligar ar condicionado')===true ||\n       msg.payload.description.summary.includes('desligue ar condicionado')===true\n       )&&\n       msg.payload.description.summary.includes('sala')===false\n       )\n    ){\n    newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_off\",\n                data:{\n                    \n                    \"entity_id\": \"switch.ar_condicionado_quarto\"\n                }\n    }};    \n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2330,"y":1060,"wires":[["cfc108ca.2de478","cf439f99.ba5b8"]]},{"id":"f057b86c.5276b8","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":990,"y":280,"wires":[["aa54b7b4.3a3f08"]]},{"id":"95061fca.046ce","type":"function","z":"444fced8.33ecb","name":"Ventilador On/Off","func":"var newMsg;\nif(\n    (msg.payload.name===\"Echo Dot da Sala\" &&\n       (\n       msg.payload.description.summary.includes('liga o ventilador')===true ||\n       msg.payload.description.summary.includes('ligar o ventilador')===true ||\n       msg.payload.description.summary.includes('ligue o ventilador')===true||\n       msg.payload.description.summary.includes('liga ventilador')===true ||\n       msg.payload.description.summary.includes('ligar ventilador')===true ||\n       msg.payload.description.summary.includes('ligue ventilador')===true\n       )&&\n       msg.payload.description.summary.includes('quarto')===false &&\n       msg.payload.description.summary.includes('desliga')===false &&\n       msg.payload.description.summary.includes('desligar')===false &&\n       msg.payload.description.summary.includes('desligue')===false\n       )\n    ){\n    newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_on\",\n                data:{\n                    \n                    \"entity_id\": \"switch.ventilador_da_sala\"\n                }\n    }};    \n    \n    return newMsg;\n}\n\nif(\n    (msg.payload.name===\"Echo Dot da Sala\" &&\n       (\n       msg.payload.description.summary.includes('desliga o ventilador')===true ||\n       msg.payload.description.summary.includes('desligar o ventilador')===true ||\n       msg.payload.description.summary.includes('desligue o ventilador')===true||\n       msg.payload.description.summary.includes('desliga ventilador')===true ||\n       msg.payload.description.summary.includes('desligar ventilador')===true ||\n       msg.payload.description.summary.includes('desligue ventilador')===true\n       )&&\n       msg.payload.description.summary.includes('quarto')===false\n       )\n    ){\n    newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_off\",\n                data:{\n                    \n                    \"entity_id\": \"switch.ventilador_da_sala\"\n                }\n    }};    \n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2310,"y":1000,"wires":[["f8869d6c.70f02","fb1f5313.600ad"]]},{"id":"f8869d6c.70f02","type":"api-call-service","z":"444fced8.33ecb","name":"Ventilador da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.ventilador_da_sala","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2550,"y":1000,"wires":[[]]},{"id":"965e33f8.26b12","type":"api-call-service","z":"444fced8.33ecb","name":"Ventilador do Quarto","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"switch.ventilador","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2560,"y":1160,"wires":[[]]},{"id":"9f5c17e3.69c048","type":"function","z":"444fced8.33ecb","name":"Ventilador On/Off","func":"var newMsg;\nif(\n    (msg.payload.name===\"Echo Dot do Quarto Nédi\" &&\n       (\n       msg.payload.description.summary.includes('liga o ventilador')===true ||\n       msg.payload.description.summary.includes('ligar o ventilador')===true ||\n       msg.payload.description.summary.includes('ligue o ventilador')===true||\n       msg.payload.description.summary.includes('liga ventilador')===true ||\n       msg.payload.description.summary.includes('ligar ventilador')===true ||\n       msg.payload.description.summary.includes('ligue ventilador')===true\n       ) &&\n       msg.payload.description.summary.includes('sala')===false &&\n       msg.payload.description.summary.includes('desliga')===false &&\n       msg.payload.description.summary.includes('desligar')===false &&\n       msg.payload.description.summary.includes('desligue')===false\n       )\n    ){\n    newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_on\",\n                data:{\n                    \n                    \"entity_id\": \"switch.ventilador\"\n                }\n    }};    \n    \n    return newMsg;\n}\nif(\n    (msg.payload.name===\"Echo Dot do Quarto Nédi\" &&\n       (\n       msg.payload.description.summary.includes('desliga o ventilador')===true ||\n       msg.payload.description.summary.includes('desligar o ventilador')===true ||\n       msg.payload.description.summary.includes('desligue o ventilador')===true||\n       msg.payload.description.summary.includes('desliga ventilador')===true ||\n       msg.payload.description.summary.includes('desligar ventilador')===true ||\n       msg.payload.description.summary.includes('desligue ventilador')===true\n       ) &&\n       msg.payload.description.summary.includes('quarto')===false\n       )\n    ){\n    newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_off\",\n                data:{\n                    \n                    \"entity_id\": \"switch.ventilador\"\n                }\n    }};    \n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2310,"y":1160,"wires":[["965e33f8.26b12","cf439f99.ba5b8"]]},{"id":"830ed247.f6566","type":"api-current-state","z":"859b066a.dd8128","name":"Quantos Lux?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"sensor.sensor_de_luz_quarto_nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":960,"y":200,"wires":[["8cdaac78.f22c5"]]},{"id":"8cdaac78.f22c5","type":"function","z":"859b066a.dd8128","name":"Escuro?","func":"if(msg.payload < 15){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1160,"y":220,"wires":[["8f838da2.c2148"]]},{"id":"6ad71445.4314fc","type":"api-current-state","z":"859b066a.dd8128","name":"Quantos Lux?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"sensor.sensor_de_luz_quarto_aqara","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":960,"y":260,"wires":[["8cdaac78.f22c5"]]},{"id":"8f838da2.c2148","type":"api-current-state","z":"859b066a.dd8128","name":"Vou Dormir","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.vou_dormir","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1350,"y":220,"wires":[["60668b28.01f924"],["60668b28.01f924"]]},{"id":"60668b28.01f924","type":"function","z":"859b066a.dd8128","name":"Dormindo?","func":"if(msg.payload === false){\n    global.set(\"horaDoSonoMaria\", false);\n    return msg;\n}\nelse{\n    global.set(\"horaDoSonoMaria\", true);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1530,"y":220,"wires":[["895843e4.08998"]]},{"id":"92571614.e14db8","type":"yeelight-compat-hue-state","z":"e7cd1901.ee2408","name":"","server":"5a8bf4db.2d6bcc","x":1470,"y":180,"wires":[["cd61a227.139cd","d9ecfe9c.db8c9"]]},{"id":"e70cfc56.e6d9a","type":"change","z":"e7cd1901.ee2408","name":"","rules":[{"t":"set","p":"triggered4","pt":"flow","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"status\":\"status\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":180,"wires":[["7a953736.a9e848"]]},{"id":"d9ecfe9c.db8c9","type":"debug","z":"e7cd1901.ee2408","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1670,"y":120,"wires":[]},{"id":"9eaf56fb.0da888","type":"yeelight-compat-hue-state","z":"5767c936.cabd18","name":"","server":"2db68ab1.bee496","x":1470,"y":220,"wires":[["af808a53.16f078"]]},{"id":"db6caf2c.e2ac4","type":"change","z":"5767c936.cabd18","name":"","rules":[{"t":"set","p":"triggered5","pt":"flow","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"status\":\"status\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1240,"y":220,"wires":[["974670f1.4b47c"]]},{"id":"f663ec98.82fab","type":"yeelight-compat-hue-state","z":"5767c936.cabd18","name":"","server":"2db68ab1.bee496","x":670,"y":1300,"wires":[["89d8380b.afdd68","c85d1e41.e0972"]]},{"id":"ace843be.a34e7","type":"yeelight-compat-hue-state","z":"5767c936.cabd18","name":"","server":"14b837c9.ab10c","x":670,"y":1360,"wires":[["89d8380b.afdd68"]]},{"id":"89d8380b.afdd68","type":"function","z":"5767c936.cabd18","name":"aux","func":"global.set(\"EscritorioOn\",msg.payload.state.on);\n    ","outputs":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":850,"y":1340,"wires":[]},{"id":"dac5d209.cd354","type":"yeelight-compat-hue-state","z":"e7cd1901.ee2408","name":"","server":"56814891.18c868","x":1260,"y":660,"wires":[["918da8b0.372e78"]]},{"id":"1cac4780.e4df98","type":"yeelight-compat-hue-state","z":"e7cd1901.ee2408","name":"","server":"5a8bf4db.2d6bcc","x":1270,"y":740,"wires":[["918da8b0.372e78"]]},{"id":"918da8b0.372e78","type":"function","z":"e7cd1901.ee2408","name":"aux","func":"global.set(\"SalaOn\",msg.payload.state.on);\n    ","outputs":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1430,"y":680,"wires":[]},{"id":"df23e8e7.d31c08","type":"debug","z":"5767c936.cabd18","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1780,"y":180,"wires":[]},{"id":"a991685f.ed5a28","type":"function","z":"c3fa9bdb.b5c4c8","name":"Delay + 25 min","func":"newMsg = { \"reset\": true };\nnode.send(newMsg);\nnewMsg = {\"delay\": 1500000};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2760,"y":4500,"wires":[["273820d4.f2e2f"]]},{"id":"665518b0.bbb868","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"hours","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3400,"y":4600,"wires":[["5e7102ae.783dcc"]]},{"id":"5e7102ae.783dcc","type":"function","z":"c3fa9bdb.b5c4c8","name":"Ocioso","func":"    var newMsg;\n    flow.set(\"vibrationCount\", 0);\n    newMsg = {payload:{\n              \"domain\": \"input_select\",\n              \"service\": \"select_option\",\n              \"data\":{\n              \"entity_id\": \"input_select.maquina_de_lavar_roupas\",\n                \"option\": \"Ocioso\"\n            }\n        }\n    }\n    flow.set(\"washingMachineStage\", \"Ocioso\")\n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3550,"y":4600,"wires":[["2dc4b323.2ea56c"]]},{"id":"73e3053.c96eefc","type":"function","z":"c3fa9bdb.b5c4c8","name":"Vibrando?","func":"    vibrationCount = flow.get(\"vibrationCount\");\n    if(vibrationCount < 5){\n        flow.set(\"vibrationCount\", 0);\n    }\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3090,"y":4700,"wires":[[]]},{"id":"5e405b73.b1cb44","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Nédi, é sua vez de estender a roupa.\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1550,"y":4960,"wires":[[]]},{"id":"6052aaa5.23f7e4","type":"debug","z":"c3fa9bdb.b5c4c8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2560,"y":4500,"wires":[]},{"id":"736e54ee.c8b8ec","type":"debug","z":"859b066a.dd8128","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1170,"y":1920,"wires":[]},{"id":"d1e04599.855a58","type":"mqtt in","z":"859b066a.dd8128","name":"Porta Armário","topic":"zigbee2mqtt/0x00158d0002b5f422/action","qos":"0","datatype":"auto","broker":"64936db9.640564","nl":false,"rap":false,"rh":"0","x":930,"y":1920,"wires":[["736e54ee.c8b8ec"]]},{"id":"b505abed.645648","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 15 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":330,"y":540,"wires":[["7808a35c.4235dc"]]},{"id":"7808a35c.4235dc","type":"function","z":"4c9c764d.9c4468","name":"Aux","func":"msg.payload.latitude = -30.01009828\nmsg.payload.longitude = -51.18650436\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":460,"y":540,"wires":[["dd17d6d1.214528"]]},{"id":"876134ca.f66868","type":"api-call-service","z":"4c9c764d.9c4468","name":"Luminária","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":1889,"y":1480,"wires":[[]]},{"id":"117d06e2.d815f9","type":"function","z":"4c9c764d.9c4468","name":"Turn Off","func":"    var newMsg;\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.luminaria_esquerda\",\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.luminaria_direita\",\n        }\n    }\n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1731,"y":1480,"wires":[["876134ca.f66868"]]},{"id":"fdb87cd7.4a536","type":"function","z":"4c9c764d.9c4468","name":"Turn On","func":"msg.payload = {\"on\": true,\"bri\":45, \"hex\": \"#00F8F0\"};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1020,"y":1000,"wires":[["192197a1.baae68"]]},{"id":"466a9556.18c7dc","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":1250,"y":980,"wires":[]},{"id":"ed4c24ad.4fd578","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"14b837c9.ab10c","x":1250,"y":1040,"wires":[]},{"id":"d4012601.43bbf8","type":"function","z":"4c9c764d.9c4468","name":"Playing?","func":"var ocupado = global.get(\"tvAuxFilme\");\nif(ocupado === false){\n    if(msg.payload === \"playing\"){\n        global.set(\"tvAuxFilme\", true);\n        return {payload: \"playing\"};\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":460,"y":1460,"wires":[["9c98b28c.4c8bd","cebfe46c.10f188","c4d0a5ba.4a5f78"]]},{"id":"819033b5.665a6","type":"inject","z":"c3fa9bdb.b5c4c8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":"0.1","topic":"","payload":"true","payloadType":"bool","x":2390,"y":4780,"wires":[["cf4aeb3d.09c6a8"]]},{"id":"cf4aeb3d.09c6a8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Inicia variaveis","func":"flow.set(\"vibrationCount\", 0);\nflow.set(\"washingMachineStage\", \"Ocioso\")","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2600,"y":4780,"wires":[[]]},{"id":"7a0509bc.a29978","type":"api-call-service","z":"444fced8.33ecb","name":"Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_off","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2530,"y":1220,"wires":[[]]},{"id":"f040f242.d8f4e","type":"function","z":"444fced8.33ecb","name":"Desliga o Quarto","func":"if(\n    msg.payload.name===\"Echo Dot do Quarto Nédi\" &&((\n    msg.payload.description.summary.includes('desliga')===true ||\n    msg.payload.description.summary.includes('desligar')===true||\n    msg.payload.description.summary.includes('desligue')===true) &&\n    (\n    msg.payload.description.summary.includes('quarto')===true ||\n    msg.payload.description.summary.includes('quarto nédi')===true ||\n    msg.payload.description.summary.includes('quarto net')===true ||\n    msg.payload.description.summary.includes('quarto mano')===true\n    )\n    )){\n    \n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"group.luzes_do_quarto_nedi\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"group.luzes_do_quarto_nedi\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"media_player.fire_tv\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"media_player.fire_tv_2\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_nedi\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.rgb_strip\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.umidificador\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ventilador\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.fita_cama\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ar_condicionado_quarto\"\n        }\n    }};\n    return newMsg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2310,"y":1220,"wires":[["7a0509bc.a29978","cf439f99.ba5b8"]]},{"id":"6d9fe5ab.c6b28c","type":"api-call-service","z":"444fced8.33ecb","name":"Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_off","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2530,"y":1280,"wires":[[]]},{"id":"8cee0e9f.ac9c1","type":"function","z":"444fced8.33ecb","name":"Desliga o Quarto","func":"if(\n    msg.payload.name===\"Echo Dot do Quarto Maria\" &&((\n    msg.payload.description.summary.includes('desliga')===true ||\n    msg.payload.description.summary.includes('desligar')===true||\n    msg.payload.description.summary.includes('desligue')===true) &&\n    (\n    msg.payload.description.summary.includes('quarto')===true ||\n    msg.payload.description.summary.includes('quarto maria')===true ||\n    msg.payload.description.summary.includes('quarto mana')===true\n    )\n    )){\n    \n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"group.luzes_do_quarto_maria\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"group.luzes_do_quarto_maria\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.galaxia_maria\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_maria\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_maria_hk\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.tv_do_quarto_maria\"\n        }\n    }};\n    return newMsg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2310,"y":1280,"wires":[["6d9fe5ab.c6b28c","db574882.3ed228"]]},{"id":"c4c5e231.078db","type":"function","z":"c3fa9bdb.b5c4c8","name":"Delay + 5 min","func":"if( msg.payload === \"vibration\" ||\n    msg.payload === \"tilt\" ||\n    msg.payload === \"drop\" \n    ){\n        var newMsg = { \"reset\": true };\n        node.send(newMsg);\n        newMsg = {\"delay\" : 300000};\n        return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2580,"y":4640,"wires":[["fc90d2cd.bdbf7"]]},{"id":"fc90d2cd.bdbf7","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delayv","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2740,"y":4640,"wires":[["933a76a0.1f90d8"]]},{"id":"33450829.619f48","type":"inject","z":"c3fa9bdb.b5c4c8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"1800","crontab":"","once":true,"onceDelay":"15","topic":"","payload":"","payloadType":"date","x":2370,"y":4700,"wires":[["c4c5e231.078db","73e3053.c96eefc"]]},{"id":"8737707d.3bb5d","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"As roupas estão prontas na máquina.\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\",\"media_player.echo_dot_do_quarto_nedi\",\"media_player.echo_dot_do_quarto_pai\",\"media_player.echo_dot_do_quarto_maria\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":3710,"y":4420,"wires":[["ef159e95.cded5"]]},{"id":"dc104c0e.649cc","type":"alexa-remote-routine","z":"c3fa9bdb.b5c4c8","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"3"},"mode":{"type":"str","value":"add"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":3400,"y":4420,"wires":[["f037bdfb.8fbcc"]]},{"id":"8e1b7269.68b89","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"regular","text":{"type":"str","value":"OK"},"devices":["G090XG09951227MJ"]}},"x":2721,"y":1340,"wires":[[]]},{"id":"93da222c.6ffaf","type":"function","z":"444fced8.33ecb","name":"Turn Off","func":"var newMsg;\nif(msg.payload.description.summary.includes('desliga a t.v. da sala')===true||\n   msg.payload.description.summary.includes('desliga a t. v. da sala')===true||\n   \n        (msg.payload.name===\"Echo Dot da Sala\" && \n    msg.payload.description.summary.includes('desligar')===true||\n    msg.payload.description.summary.includes('desligue')===true||\n    msg.payload.description.summary.includes('desliga')===true) &&\n    (msg.payload.description.summary.includes('TV')===true||\n    msg.payload.description.summary.includes('t.v.')===true||\n    msg.payload.description.summary.includes('t. v.')===true||\n    msg.payload.description.summary.includes('t v')===true||\n    (msg.payload.description.summary.includes('t.')===true&&\n    msg.payload.description.summary.includes('v.')===true))\n   ){\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\"\n        }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":2060,"wires":[["4be760da.d877"]]},{"id":"2e5b0b31.17bbf4","type":"inject","z":"e7cd1901.ee2408","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1050,"y":80,"wires":[["e70cfc56.e6d9a"]]},{"id":"aee1b41.116d148","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"str","x":770,"y":1180,"wires":[["fdb87cd7.4a536","d86e7a62.6c6db8","a15f542b.7479e8","c4d0a5ba.4a5f78"]]},{"id":"2766e049.4cdbf","type":"inject","z":"5767c936.cabd18","name":"Status","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/12 15-23 * * *","once":true,"onceDelay":"612","topic":"Status","payload":"{\"status\":\"status\"}","payloadType":"json","x":295,"y":1304,"wires":[["b9fdb84a.939388","255ee862.d04028"]]},{"id":"c85d1e41.e0972","type":"debug","z":"5767c936.cabd18","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":850,"y":1280,"wires":[]},{"id":"b69ddfbe.51b82","type":"inject","z":"d67ca66.293d758","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"On\":false}","payloadType":"json","x":670,"y":340,"wires":[["8c0cc7c1.3bbbb8"]]},{"id":"8111e6a1.7e5eb8","type":"inject","z":"c3fa9bdb.b5c4c8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":3230,"y":4420,"wires":[["dc104c0e.649cc"]]},{"id":"e26a2c5c.ca85","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"hour","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":3070,"y":4500,"wires":[["e7df2829.b0fe88"]]},{"id":"72cc7c65.6be7a4","type":"function","z":"c3fa9bdb.b5c4c8","name":"Reset Ocioso","func":"msg.reset = true\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3220,"y":4600,"wires":[["665518b0.bbb868"]]},{"id":"c4d0a5ba.4a5f78","type":"function","z":"4c9c764d.9c4468","name":"Desliga Automação","func":"    var newMsg;\n    global.set(\"desabilitaAutomacao\", true);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.desabilita_automacao_sala_escritorio\"\n        }\n    }};\n    return newMsg;\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1049,"y":1800,"wires":[["d4205229.97a6e","e193b984.bb20b8"]]},{"id":"e193b984.bb20b8","type":"api-call-service","z":"4c9c764d.9c4468","name":"Desabilita Automação","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.desabilita_automacao_sala_escritorio","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1640,"y":1800,"wires":[[]]},{"id":"173b8a0d.bb1566","type":"function","z":"5767c936.cabd18","name":"Turn On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.sala_ocupada_switch\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.boa_noite_casa\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2400,"y":1040,"wires":[["c635d49e.ea96a8"]]},{"id":"f0109079.cd84","type":"change","z":"5767c936.cabd18","name":"","rules":[{"t":"set","p":"triggered6","pt":"flow","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"status\":\"status\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":840,"y":120,"wires":[["a38c518a.00918"]]},{"id":"e4e654de.ca4be8","type":"yeelight-compat-hue-state","z":"5767c936.cabd18","name":"","server":"14b837c9.ab10c","x":1078,"y":120,"wires":[["7769c674.4d0128"]]},{"id":"950bacc8.dd4ff","type":"function","z":"5767c936.cabd18","name":"Turn On","func":"if(global.get(\"desabilitaAutomacao\") === false){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":680,"y":260,"wires":[["dcd2984c.8ee318"]]},{"id":"4d99acb0.658954","type":"function","z":"e7cd1901.ee2408","name":"Turn On","func":"if(global.get(\"desabilitaAutomacao\") === false){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":880,"y":140,"wires":[["9f86e19e.674de"]]},{"id":"da058ed5.3f35f","type":"inject","z":"e7cd1901.ee2408","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1710,"y":80,"wires":[["dea9e275.a6cd1"]]},{"id":"554e3bcc.cfda44","type":"inject","z":"5767c936.cabd18","name":"Status","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"Status","payload":"{\"status\": \"status\"}","payloadType":"json","x":650,"y":40,"wires":[["62da1cb0.8b2cd4","f0109079.cd84"]]},{"id":"7769c674.4d0128","type":"function","z":"5767c936.cabd18","name":"auxCT","func":"if(flow.get(\"triggered6\")===true){\n    flow.set(\"triggered6\", false);\n    if(msg.payload.state.on === true){\n        flow.set(\"auxCT\",msg.payload.state.ct);\n        if(!msg.payload.state.ct){\n            flow.set(\"auxCT\",parseInt(msg.payload.raw.ct));\n        }\n        if(!msg.payload.raw.ct){\n            flow.set(\"auxCT\",6100);\n        }\n        flow.set(\"countBrightnessLuz\",msg.payload.state.bri);\n    }\n}","outputs":0,"noerr":0,"initialize":"","finalize":"","x":1250,"y":120,"wires":[]},{"id":"5ec55b77.d22a14","type":"link out","z":"5767c936.cabd18","name":"Reset Automation 2","links":["2889a3d3.f4edac","1b697df.c112282"],"x":3710,"y":384,"wires":[]},{"id":"2889a3d3.f4edac","type":"link in","z":"5767c936.cabd18","name":"","links":["124b61c8.1527fe","5ec55b77.d22a14"],"x":895,"y":400,"wires":[["ba6a4e16.62ac7"]]},{"id":"124b61c8.1527fe","type":"link out","z":"5767c936.cabd18","name":"Reset Automation","links":["2889a3d3.f4edac"],"x":2500,"y":364,"wires":[]},{"id":"5b0dc24f.60623c","type":"link out","z":"e7cd1901.ee2408","name":"Reset Automation 2","links":["a9bcf9d2.4e8338"],"x":3955,"y":340,"wires":[]},{"id":"701ddd3a.218e34","type":"link out","z":"e7cd1901.ee2408","name":"Reset Automation","links":["a9bcf9d2.4e8338"],"x":2735,"y":320,"wires":[]},{"id":"a9bcf9d2.4e8338","type":"link in","z":"e7cd1901.ee2408","name":"","links":["5b0dc24f.60623c","701ddd3a.218e34"],"x":1095,"y":220,"wires":[["b2a76711.ae4398"]]},{"id":"933a76a0.1f90d8","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"3","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2900,"y":4640,"wires":[["73e3053.c96eefc"]]},{"id":"30ebe780.fd8ac8","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"30","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":3220,"y":4540,"wires":[["9c867cd6.62ccf"]]},{"id":"2dc4b323.2ea56c","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"30","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":3720,"y":4600,"wires":[["9c867cd6.62ccf"]]},{"id":"9fa95be4.5e5d38","type":"alexa-remote-routine","z":"c3fa9bdb.b5c4c8","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"-30"},"mode":{"type":"str","value":"add"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":4020,"y":4420,"wires":[[]]},{"id":"79e2892d.bbd1e8","type":"function","z":"859b066a.dd8128","name":"Escuro?","func":"global.set(\"luxQuarto\", msg.payload);\nvar quartoEscuro = global.get(\"quartoEscuro\");\nif(typeof QuartoEscuro !== \"undefined\"){\n    if(QuartoEscuro === true){\n        if(msg.payload > 30){\n            global.set(\"quartoEscuro\", false);\n            node.status({fill:\"yellow\",shape:\"dot\",text:\"QuartoEscuro false\"});\n        }\n    }\n    else{\n        if(msg.payload < 15 && msg.payload > 0){\n                global.set(\"quartoEscuro\", true);\n                node.status({fill:\"green\",shape:\"dot\",text:\"QuartoEscuro true\"});\n                node.send(msg);\n        }\n    }\n}\nelse{\n        if(msg.payload < 15 && msg.payload > 0){\n                global.set(\"quartoEscuro\", true);\n                node.status({fill:\"green\",shape:\"dot\",text:\"QuartoEscuro true\"});\n                node.send(msg);\n        }\n        else{\n            if(msg.payload > 30){\n                global.set(\"quartoEscuro\", false);\n                node.status({fill:\"yellow\",shape:\"dot\",text:\"QuartoEscuro false\"});\n            }\n        }\n}\n\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 15000);","outputs":1,"noerr":0,"x":860,"y":440,"wires":[[]]},{"id":"e44f4352.2fbe5","type":"mqtt in","z":"859b066a.dd8128","name":"Sensor Luz Quarto Nédi","topic":"QuartoNedi/currentLight","qos":"0","datatype":"json","broker":"64936db9.640564","nl":false,"rap":false,"rh":"0","x":410,"y":440,"wires":[["85bc1430.9d6528"]]},{"id":"85bc1430.9d6528","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":660,"y":440,"wires":[["79e2892d.bbd1e8"]]},{"id":"140d5720.b26f19","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1420,"y":1860,"wires":[["e193b984.bb20b8","a9cff849.a11ca8"]]},{"id":"d801b6d8.f3b728","type":"server-state-changed","z":"4c9c764d.9c4468","name":"Desabilita Automação","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.desabilita_automacao_sala_escritorio","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":1180,"y":320,"wires":[["668d034a.5f7a6c"]]},{"id":"668d034a.5f7a6c","type":"function","z":"4c9c764d.9c4468","name":"Aux Function","func":"if(msg.payload === \"on\"){\n    global.set(\"desabilitaAutomacao\", true)\n    var newMsg = {payload:\"reset\", reset: true}\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1370,"y":320,"wires":[["7840428.2ec55bc"]]},{"id":"a9858188.21d7c","type":"debug","z":"7b0de646.c85c78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1250,"y":4060,"wires":[]},{"id":"a00845b0.2978f8","type":"debug","z":"7b0de646.c85c78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":990,"y":4220,"wires":[]},{"id":"e8f0f070.a02ca","type":"debug","z":"7b0de646.c85c78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1210,"y":3920,"wires":[]},{"id":"9b96b45f.e89648","type":"function","z":"7b0de646.c85c78","name":"Volume","func":"msg.params = [ {volumePercent:40, device_id: msg.params[0].deviceIds[0]} ]; \nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1620,"y":3960,"wires":[["628fe55c.bc1fdc"]]},{"id":"628fe55c.bc1fdc","type":"spotify","z":"7b0de646.c85c78","name":"","auth":"3b9d50b6.bca4e","api":"setVolume","x":1790,"y":3960,"wires":[[]]},{"id":"39b352c7.4b2f3e","type":"debug","z":"7b0de646.c85c78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1450,"y":3900,"wires":[]},{"id":"532d45.1ad952bc","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1460,"y":3960,"wires":[["9b96b45f.e89648"]]},{"id":"190248cb.085527","type":"change","z":"e7cd1901.ee2408","name":"","rules":[{"t":"set","p":"triggered5","pt":"flow","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"status\":\"status\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":400,"wires":[["dc34716b.dcb6f"]]},{"id":"e1ea086.6e68cf8","type":"yeelight-compat-hue-state","z":"e7cd1901.ee2408","name":"","server":"56814891.18c868","x":1520,"y":400,"wires":[["a9712f7d.32284"]]},{"id":"a9712f7d.32284","type":"function","z":"e7cd1901.ee2408","name":"auxCT","func":"if(flow.get(\"triggered5\")=== true){\n    flow.set(\"triggered5\", false);\n    if(msg.payload.state.on === true){\n        flow.set(\"auxCT\",msg.payload.state.ct);\n        flow.set(\"countBrightness\",msg.payload.state.bri);\n    }\n}\n\n","outputs":0,"noerr":0,"initialize":"","finalize":"","x":1670,"y":400,"wires":[]},{"id":"d4205229.97a6e","type":"function","z":"4c9c764d.9c4468","name":"Desliga Automação","func":"    var newMsg;\n    \n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.desabilita_automacao_sala_escritorio\"\n        }\n    }};\n    return newMsg;\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1250,"y":1860,"wires":[["140d5720.b26f19"]]},{"id":"cfd0b69b.fd4be8","type":"api-call-service","z":"4c9c764d.9c4468","name":"Luminária","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":1180,"y":920,"wires":[[]]},{"id":"d86e7a62.6c6db8","type":"function","z":"4c9c764d.9c4468","name":"Turn Off","func":"    var newMsg;\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.luminaria_esquerda\",\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.luminaria_direita\",\n        }\n    }\n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1022,"y":920,"wires":[["cfd0b69b.fd4be8"]]},{"id":"b344c41b.9672e8","type":"function","z":"444fced8.33ecb","name":"Clarice Veio On","func":"if(((\n    msg.payload.description.summary.includes('clarice')===true ||\n    msg.payload.description.summary.includes('clarisse')===true||\n    msg.payload.description.summary.includes('clarise')===true) &&\n    (\n    msg.payload.description.summary.includes('veio')===true ||\n    msg.payload.description.summary.includes('vem')===true \n    )\n    )){\n    \n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.clarice_veio\"\n        }\n    }};\n    return newMsg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2300,"y":1540,"wires":[["fc47ebd4.755278","c54f95b7.561948"]]},{"id":"fc47ebd4.755278","type":"api-call-service","z":"444fced8.33ecb","name":"Clarice Veio","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2530,"y":1560,"wires":[[]]},{"id":"c54f95b7.561948","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"devices":["G090XG0793643C6P"]}},"x":2540,"y":1620,"wires":[[]]},{"id":"db574882.3ed228","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2540,"y":1340,"wires":[["8e1b7269.68b89"]]},{"id":"9d02cc65.57cc1","type":"inject","z":"4c9c764d.9c4468","name":"Duolingo","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"05 15 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":400,"y":2080,"wires":[["cf2d7c6a.1d1bd"]]},{"id":"6af2a66d.b4b638","type":"api-call-service","z":"4c9c764d.9c4468","name":"Luz da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1330,"y":2080,"wires":[[]]},{"id":"e7f33a4d.175e28","type":"function","z":"4c9c764d.9c4468","name":"WhatsApp Effect","func":"var newMsg;\n\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\",\n            \"effect\": \"WhatsApp\",\n            \"rgb_color\": [0, 100, 0]\n        }\n    }};\n    node.send(newMsg);\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\",\n            \"effect\": \"WhatsApp\",\n            \"rgb_color\": [0, 100, 0]\n        }\n    }};\n    node.send(newMsg);\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\"\n        }\n    }};\n    return newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":2080,"wires":[["8e5b4c4.508b6b"]]},{"id":"e0224238.70a07","type":"function","z":"4c9c764d.9c4468","name":"Home?","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg = {payload: {\"On\":true}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":730,"y":2080,"wires":[["e7f33a4d.175e28","a163ae3c.0194","e8c6c8ed.2e8908","bdc9e915.3f2808"]]},{"id":"cf2d7c6a.1d1bd","type":"api-current-state","z":"4c9c764d.9c4468","name":"Nédi home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":560,"y":2080,"wires":[["e0224238.70a07"]]},{"id":"a163ae3c.0194","type":"function","z":"4c9c764d.9c4468","name":"Abajur Flicker","func":"var newMsg;\n\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.abajur_do_escritorio_local\",\n            \"rgb_color\": [0, 255, 0],\n            \"brightness_pct\": 100\n        }\n    }};\n    node.send(newMsg);\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.abajur_do_escritorio_local\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.abajur_do_escritorio_local\",\n            \"rgb_color\": [0, 255, 0],\n            \"brightness_pct\": 100\n        }\n    }};\n    node.send(newMsg);\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.abajur_do_escritorio_local\"\n        }\n    }};\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.abajur_do_escritorio_local\",\n            \"rgb_color\": [0, 255, 0],\n            \"brightness_pct\": 100\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.abajur_do_escritorio_local\"\n        }\n    }};\n    node.send(newMsg);\n    return newMsg ;\n    ","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":920,"y":2140,"wires":[["bc74c381.903e5"]]},{"id":"cb2a513c.90da2","type":"api-call-service","z":"4c9c764d.9c4468","name":"Abajur do Escritório","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1350,"y":2140,"wires":[[]]},{"id":"8e5b4c4.508b6b","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1150,"y":2080,"wires":[["6af2a66d.b4b638"]]},{"id":"bc74c381.903e5","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1150,"y":2140,"wires":[["cb2a513c.90da2"]]},{"id":"5ccf382b.737b58","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"devices":["G090XG0793643C6P"]}},"x":2720,"y":952,"wires":[[]]},{"id":"fb1f5313.600ad","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2540,"y":952,"wires":[["5ccf382b.737b58"]]},{"id":"cf439f99.ba5b8","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2540,"y":1109,"wires":[["562c270e.f934a8"]]},{"id":"562c270e.f934a8","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"devices":["G090XG0894430B3V"]}},"x":2720,"y":1109,"wires":[[]]},{"id":"ff4db3ea.6494a","type":"debug","z":"d3db5d74.fb8fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1810,"y":2340,"wires":[]},{"id":"1a87657.8904d1b","type":"debug","z":"d3db5d74.fb8fa","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1770,"y":2480,"wires":[]},{"id":"eaa67a7f.f32758","type":"function","z":"d3db5d74.fb8fa","name":"Vento forte?","func":"var date = new Date();\nvar Day = date.getDay(); \nvar Hour = date.getHours();\nif( (msg.data.currently.summary.includes(\"rain\")=== true ||\n    msg.data.currently.summary.includes(\"Rain\")=== true  ||\n    msg.data.currently.windSpeed > 35)\n    && (Hour > 9 && Hour < 23)\n    ){\n    \n    global.set(\"ventoAux\",true);\n    return {payload:1};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1930,"y":2440,"wires":[[]]},{"id":"10dc082e.ac79a","type":"function","z":"d3db5d74.fb8fa","name":"Vento forte?","func":"if(msg.payload.includes(\"rain\")===true &&\n    msg.data.attributes.wind_speed > 35){\n    global.set(\"ventoAux\", true);\n    return {payload:1};\n}\nelse{\n    global.set(\"ventoAux\", false);\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1910,"y":2300,"wires":[[]]},{"id":"a9cff849.a11ca8","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"4","timeoutUnits":"hours","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1610,"y":1900,"wires":[["ab9302fc.8c29d"]]},{"id":"ab9302fc.8c29d","type":"function","z":"4c9c764d.9c4468","name":"Reset Aux Var","func":"\n    global.set(\"desabilitaAutomacao\", false)\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1780,"y":1900,"wires":[[]]},{"id":"e8adc93c.06d4f8","type":"function","z":"e7cd1901.ee2408","name":"Reset Aux Var","func":"\n    global.set(\"desabilitaAutomacao\", false)\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1620,"y":480,"wires":[[]]},{"id":"ff1586d2.1093f8","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"hours","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1440,"y":480,"wires":[["e8adc93c.06d4f8"]]},{"id":"4fc7f5e1.c037dc","type":"server-state-changed","z":"5767c936.cabd18","name":"Movimento Sala Aux","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.movimento_sala_aux","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":250,"y":1580,"wires":[["89f9ccf9.399a6"]]},{"id":"89f9ccf9.399a6","type":"function","z":"5767c936.cabd18","name":"Moveu?","func":"if(msg.payload === \"on\"){        \n    msg = {payload: {MotionDetected: true}};\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":420,"y":1580,"wires":[["9ee7bdef.1a795"]]},{"id":"4f18b6c5.078a28","type":"function","z":"d3db5d74.fb8fa","name":"Delay + 10min","func":"var newMsg = { \"reset\": true };\nnode.send(newMsg);\nnewMsg = {\"delay\" : 600000};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":740,"y":1460,"wires":[["d56aaec0.5c80a"]]},{"id":"9318bc52.48ab4","type":"change","z":"d3db5d74.fb8fa","name":"","rules":[{"t":"delete","p":"delay","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1070,"y":1460,"wires":[["6470363b.a6fdf8"]]},{"id":"9087ade6.99d3","type":"function","z":"d3db5d74.fb8fa","name":"Delay + 10min","func":"var newMsg = { \"reset\": true };\nnode.send(newMsg);\nnewMsg = {\"delay\" : 600000};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1400,"y":1580,"wires":[["130a6775.a0e089"]]},{"id":"af71570d.6eabe8","type":"change","z":"d3db5d74.fb8fa","name":"","rules":[{"t":"delete","p":"delay","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1730,"y":1580,"wires":[["d4a80a5e.62fce8"]]},{"id":"cdfb9483.1eb448","type":"function","z":"859b066a.dd8128","name":"Delay","func":"\nnewMsg = { \"reset\": true };\nnode.send(newMsg);\nnewMsg = { \"delay\" : 600000} \nreturn newMsg;\n ","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1090,"y":720,"wires":[["4b134ac6.c0d974"]]},{"id":"4b134ac6.c0d974","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delayv","timeout":"10","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1240,"y":720,"wires":[["cc590b2b.aac018","a3cb2715.98c348"]]},{"id":"e0a29728.f21988","type":"change","z":"859b066a.dd8128","name":"","rules":[{"t":"delete","p":"delay","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1790,"y":720,"wires":[["1f8cffab.901a3"]]},{"id":"ab6e20fa.2fccc","type":"function","z":"d67ca66.293d758","name":"","func":"global.set(\"desabilitaAutomacao\", true);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":580,"y":2860,"wires":[[]]},{"id":"311324ac.e2d41c","type":"server-state-changed","z":"e7cd1901.ee2408","name":"Alguém em Casa","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.alguem_em_casa","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"true","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":220,"y":80,"wires":[["2e8209b5.a68e96"],["2e8209b5.a68e96"]]},{"id":"2e8209b5.a68e96","type":"function","z":"e7cd1901.ee2408","name":"Alguém chegou","func":"if(msg.payload === \"on\" || msg.payload === true){\n    var date = new Date();\n    var Hour = date.getHours();\n    if(Hour > 17 || Hour < 9){\n        return msg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":440,"y":80,"wires":[["ef7a1a0d.c6fa18"]]},{"id":"1d6c795b.fc6b87","type":"function","z":"5767c936.cabd18","name":"Alguém chegou","func":"if(msg.payload === \"on\" || msg.payload === true){\n    var date = new Date();\n    var Hour = date.getHours();\n    if(Hour > 16 || Hour < 9){\n        return msg;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":320,"y":520,"wires":[["ba6a4e16.62ac7","2f2f0c14.47f9e4"]]},{"id":"f91b8c6.ee4027","type":"server-state-changed","z":"5767c936.cabd18","name":"Alguém em Casa","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.alguem_em_casa","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"true","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":140,"y":520,"wires":[["1d6c795b.fc6b87"],["1d6c795b.fc6b87"]]},{"id":"96c98e71.db341","type":"delay","z":"2ea7fd8b.7e0bb2","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1300,"y":240,"wires":[["fa95f894.fa4f98"]]},{"id":"ef7a1a0d.c6fa18","type":"function","z":"e7cd1901.ee2408","name":"Escuro?","func":"var salaEscura = global.get(\"salaEscura\")\nif (salaEscura === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":640,"y":80,"wires":[["4d99acb0.658954"]]},{"id":"2f2f0c14.47f9e4","type":"function","z":"5767c936.cabd18","name":"Escuro?","func":"var escritorioEscuro = global.get(\"escritorioEscuro\")\nif (escritorioEscuro === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":520,"wires":[["950bacc8.dd4ff"]]},{"id":"91868a33.c4af98","type":"change","z":"2bbba447.a4759c","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1780,"y":580,"wires":[["fa56b44c.6d8ce8","48a71a45.f09914"]]},{"id":"48bf75a2.de0a2c","type":"debug","z":"2bbba447.a4759c","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2270,"y":660,"wires":[]},{"id":"c1b62f28.bfdd7","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2240,"y":480,"wires":[["35d81f25.70efe"]]},{"id":"ece6e1e6.9f9c1","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2340,"y":580,"wires":[["48a71a45.f09914"]]},{"id":"eaf959ca.c2b768","type":"delay","z":"2bbba447.a4759c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1900,"y":540,"wires":[["fa56b44c.6d8ce8"]]},{"id":"7afc35c.093f9cc","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Luz Noturna","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"light.aqara_hub","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":1050,"y":1580,"wires":[["fbe96195.54045"],["fbe96195.54045"]]},{"id":"56b8f146.369a5","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Luz Noturna","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"light.aqara_hub","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1050,"y":1640,"wires":[["fbe96195.54045"],[]]},{"id":"18f45fa6.be13a","type":"inject","z":"d3db5d74.fb8fa","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"600","crontab":"","once":true,"onceDelay":"120","topic":"","payload":"true","payloadType":"bool","x":910,"y":1640,"wires":[["56b8f146.369a5"]]},{"id":"a406512.4ee3ab","type":"delay","z":"de7173c1.b1a8c","name":"","pauseType":"delayv","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":480,"y":260,"wires":[["9a9f6052.0b22c"]]},{"id":"b4c67add.4332a8","type":"api-current-state","z":"de7173c1.b1a8c","name":"Cozinha escura?","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"100","halt_if_type":"num","halt_if_compare":"lt","override_topic":false,"entity_id":"sensor.sensor_de_luz_cozinha","state_type":"num","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":650,"y":200,"wires":[["401d1fde.06374"],["401d1fde.06374"]]},{"id":"793d498f.fcd508","type":"function","z":"de7173c1.b1a8c","name":"Delay","func":"var newMsg;\nnewMsg = { \"reset\": true };\nnode.send(newMsg);\nnewMsg = { \"delay\": 900000 };\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":330,"y":260,"wires":[["a406512.4ee3ab"]]},{"id":"f250c7af.142328","type":"yeelight-compat-hue-out","z":"de7173c1.b1a8c","name":"","server":"9db1d7d0.459aa8","x":1400,"y":200,"wires":[]},{"id":"401d1fde.06374","type":"function","z":"de7173c1.b1a8c","name":"Turn On","func":"var date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nvar newMsg;\nif(Hour > 16 ||Hour < 10 || msg.payload < 30){\n    if(Hour > 15){ \n\n            newMsg = {\"payload\" : {\n                \"on\": true,\n                \"brightness\": 255,\n                \"ct\": 6200,\n                \"duration\": 2000\n            }};\n            return newMsg;\n        \n    }\n    if(Hour < 2) {\n        \n            newMsg = {\"payload\" : {\n                \"on\": true,\n                \"brightness\": 191,\n                \"ct\": 4000,\n                \"duration\": 2000\n            }};\n            return newMsg;\n    }\n    if(Hour < 9 && msg.payload < 70) {\n            newMsg = {\"payload\" : {\n                \"on\": true,\n                \"brightness\": 165,\n                \"ct\": 3000,\n                \"duration\": 1500\n            }};\n            return newMsg;\n    }\n} ","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":820,"y":200,"wires":[["2e8e5d7.37df4a2"]]},{"id":"9a9f6052.0b22c","type":"function","z":"de7173c1.b1a8c","name":"Turn Off","func":"var newMsg;\nnewMsg = {payload : {\"On\": false, \"on\": false}};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":820,"y":260,"wires":[["49a8a489.cb981c"]]},{"id":"25bef91.7b6ff06","type":"link in","z":"de7173c1.b1a8c","name":"Movimento Cozinha","links":["14440e93.eb1131"],"x":195,"y":200,"wires":[["b4c67add.4332a8","793d498f.fcd508"]]},{"id":"bf7fa2f1.7bfb","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"delay","timeout":"40","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":620,"y":1300,"wires":[["eb61e7a8.2252c8"]]},{"id":"49ff7959.acaf78","type":"switch","z":"ec27da7d.cad118","name":"","property":"payload.On","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":430,"y":1307,"wires":[["bf7fa2f1.7bfb","c146f4b9.bcc6a8"]]},{"id":"76985b00.bb5f94","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":260,"y":1307,"wires":[["49ff7959.acaf78"]]},{"id":"eb61e7a8.2252c8","type":"change","z":"ec27da7d.cad118","name":"","rules":[{"t":"set","p":"botaoQuarto","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"turnOffDelay","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":800,"y":1300,"wires":[[]]},{"id":"c146f4b9.bcc6a8","type":"change","z":"ec27da7d.cad118","name":"","rules":[{"t":"set","p":"botaoQuarto","pt":"global","to":"true","tot":"bool"},{"t":"set","p":"turnOffDelay","pt":"global","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":620,"y":1360,"wires":[[]]},{"id":"680b4884.f09218","type":"function","z":"ec27da7d.cad118","name":"","func":"var newMsg;\nnewMsg = {payload:\"on\",\n          data:{attributes:{brightness: 10}}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":250,"y":1200,"wires":[["80c9290a.43e178","26cde2d1.6506fe","925ae9f7.e35a28","6ea82b64.ad8f0c"]]},{"id":"6b2d6985.55d498","type":"function","z":"ec27da7d.cad118","name":"Turn Off","func":"if(msg.payload === true ){\n    global.set(\"quartoOn\",false);\n    var newMsg;\n    newMsg = {payload : {}};\n    newMsg.payload.on = false;\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2485,"y":1080,"wires":[["3df81b1.4ae3ee4","5528942f.327e2c","ff0bf47d.8fc2b8","a113ed77.44159"]]},{"id":"2e6f205b.63928","type":"function","z":"ec27da7d.cad118","name":"Turn On","func":"if(msg.payload === false){\n        \n    global.set(\"quartoMariaOn\",true);\n    var newMsg;\n    newMsg = {payload : {\n        \"on\": true,\n        \"bri\": 255,\n        \"ct\": 6200\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2480,"y":1140,"wires":[["cf1038e1.47d758","87dc1a42.556058","a113ed77.44159"]]},{"id":"5e461018.21956","type":"comment","z":"ec27da7d.cad118","name":"Se luz do quarto estiver ligada baixinho, aumentar o brilho","info":"","x":1750,"y":1380,"wires":[]},{"id":"687b5fdb.d7185","type":"function","z":"ec27da7d.cad118","name":"","func":"if(msg.payload === \"on\"){\n        if(msg.data.attributes.brightness < 128)\n        {\n            msg.ajuda = 1;\n            return msg;\n        }\n        else{\n            \n            msg.ajuda = 2;\n            return msg;\n        }\n}\nelse{\n    \n            msg.ajuda = 1;\n            return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":620,"y":1160,"wires":[["f4d52cbc.9f891","97472857.85c768"]]},{"id":"800b696c.ec6fd8","type":"switch","z":"ec27da7d.cad118","name":"","property":"ajuda","propertyType":"msg","rules":[{"t":"eq","v":"2","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":1030,"y":1160,"wires":[["682544d7.1d47ac","3a9bfd4b.2c31e2","7c9ff439.4b387c","d618b0e4.5b66f"],["298c59c1.8a2826"]]},{"id":"682544d7.1d47ac","type":"function","z":"ec27da7d.cad118","name":"Luz do Quarto Topic","func":"var newMsg;\nif(msg.payload === \"on\")\n{\n    global.set(\"quartoOn\",true);\n    newMsg = {\"topic\":\"Luz\",\"payload\": true};\n    return newMsg;\n}\nif(msg.payload === \"off\")\n{\n    newMsg = {\"topic\":\"Luz\",\"payload\": false};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1280,"y":1260,"wires":[["c3940dbe.b8495"]]},{"id":"d1c3ee81.577fd","type":"function","z":"ec27da7d.cad118","name":"","func":"var newMsg;\nif(msg.payload.On === true)\n{\n    global.set(\"quartoOn\",true);\n    newMsg = {\"topic\":\"Projetor Ceu\",\"payload\": true};\n    return newMsg;\n}\nif(msg.payload.On === false)\n{\n    newMsg = {\"topic\":\"Projetor Ceu\",\"payload\": false};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1540,"y":1200,"wires":[["73d01fba.9eb56"]]},{"id":"73d01fba.9eb56","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1700,"y":1200,"wires":[["8190319d.dd5f9"]]},{"id":"c3940dbe.b8495","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1700,"y":1260,"wires":[["8190319d.dd5f9"]]},{"id":"8d1c227b.23b4b","type":"debug","z":"ec27da7d.cad118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2150,"y":1020,"wires":[]},{"id":"26cde2d1.6506fe","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":450,"y":1220,"wires":[["687b5fdb.d7185"]]},{"id":"44ae79df.bb2aa8","type":"function","z":"ec27da7d.cad118","name":"","func":"flow.set(\"respondeu\", true);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":660,"y":1080,"wires":[[]]},{"id":"4ac6e851.ffbe08","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2315,"y":1080,"wires":[["6b2d6985.55d498"]]},{"id":"83130f1b.74205","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2320,"y":1140,"wires":[["2e6f205b.63928"]]},{"id":"298c59c1.8a2826","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1260,"y":1340,"wires":[["56fa9e05.3efe3","e992f316.348f4"]]},{"id":"f4d52cbc.9f891","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":820,"y":1160,"wires":[["800b696c.ec6fd8"]]},{"id":"d2099053.ea8a2","type":"debug","z":"ec27da7d.cad118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":650,"y":1020,"wires":[]},{"id":"7476a97e.8e1ac8","type":"inject","z":"ec27da7d.cad118","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":1060,"wires":[["680b4884.f09218"]]},{"id":"6550fd86.f9de14","type":"comment","z":"ec27da7d.cad118","name":"Botão foi clicado","info":"Ligar as luzes se estiverem desligadas\nDesligar as luzes se estiverem ligadas e acima de 50% de brilho\nAumentar o brilho caso estiverem abaixo de 50%","x":160,"y":1000,"wires":[]},{"id":"cf1038e1.47d758","type":"function","z":"ec27da7d.cad118","name":"Turn On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"input_boolean.quarto_ocupado\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":2860,"y":1060,"wires":[["e1fea16f.cbad5"]]},{"id":"3df81b1.4ae3ee4","type":"function","z":"ec27da7d.cad118","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"input_boolean.quarto_ocupado\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":2860,"y":1000,"wires":[["e1fea16f.cbad5"]]},{"id":"bf1670e7.f4493","type":"link in","z":"ec27da7d.cad118","name":"Botao Quarto","links":["a5bada24.753448"],"x":115,"y":1200,"wires":[["76985b00.bb5f94","680b4884.f09218"]]},{"id":"97472857.85c768","type":"debug","z":"ec27da7d.cad118","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":770,"y":1220,"wires":[]},{"id":"9a5cfa12.450d88","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1430,"y":1140,"wires":[["d1c3ee81.577fd"]]},{"id":"3a9bfd4b.2c31e2","type":"function","z":"ec27da7d.cad118","name":"In Case of Error","func":"var newMsg;\nnewMsg = {payload:{\"On\":true}}\nreturn newMsg;","outputs":1,"noerr":0,"x":1260,"y":1140,"wires":[["9a5cfa12.450d88"]]},{"id":"9aec77e5.985858","type":"inject","z":"ec27da7d.cad118","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1030,"y":1380,"wires":[["298c59c1.8a2826"]]},{"id":"80c9290a.43e178","type":"alexa-remote-smarthome","z":"ec27da7d.cad118","d":true,"name":"","account":"421d4b0d.32a884","config":{"option":"query","value":[]},"outputs":1,"x":430,"y":1160,"wires":[["687b5fdb.d7185","44ae79df.bb2aa8"]]},{"id":"e1fea16f.cbad5","type":"api-call-service","z":"ec27da7d.cad118","name":"Quarto Ocupado","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"binary_sensor.quarto_ocupado","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3050,"y":1020,"wires":[[]]},{"id":"925ae9f7.e35a28","type":"api-current-state","z":"ec27da7d.cad118","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_maria","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":440,"y":1100,"wires":[["687b5fdb.d7185","d2099053.ea8a2"]]},{"id":"8190319d.dd5f9","type":"BooleanLogicUltimate","z":"ec27da7d.cad118","name":"","filtertrue":"both","persist":false,"sInitializeWith":"WaitForPayload","triggertopic":"trigger","outputtriggeredby":"all","inputCount":"2","topic":"result","x":1920,"y":1140,"wires":[[],["8d1c227b.23b4b","4ac6e851.ffbe08","83130f1b.74205"],[]]},{"id":"7c9ff439.4b387c","type":"api-current-state","z":"ec27da7d.cad118","name":"Galáxia","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"light.galaxia_maria","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1240,"y":1200,"wires":[["d1c3ee81.577fd"],["d1c3ee81.577fd"]]},{"id":"6ea82b64.ad8f0c","type":"api-current-state","z":"ec27da7d.cad118","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_maria_hk","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":440,"y":1040,"wires":[["687b5fdb.d7185"]]},{"id":"b76cbf74.d82fb","type":"link in","z":"ec27da7d.cad118","name":"Cozy Time Maria","links":["a1c8520.4e51ab"],"x":175,"y":1480,"wires":[["191ee8af.3886e7","1575cb07.78abd5"]]},{"id":"191ee8af.3886e7","type":"function","z":"ec27da7d.cad118","name":"Pouco brilho e colorido","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.luz_do_quarto_maria\",\n        \"brightness\": 150,\n        \"rgb_color\": [50,255,193]\n    }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.luz_do_quarto_maria_hk\",\n        \"brightness\": 150,\n        \"rgb_color\": [50,255,193]\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":360,"y":1460,"wires":[["8f2c7843.2dc4c8"]]},{"id":"8f2c7843.2dc4c8","type":"api-call-service","z":"ec27da7d.cad118","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.luz_do_quarto_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":580,"y":1460,"wires":[[]]},{"id":"1575cb07.78abd5","type":"function","z":"ec27da7d.cad118","name":"Galáxia On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.galaxia_maria\",\n        \"brightness\": 60\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":330,"y":1520,"wires":[["951bb41e.ef7928"]]},{"id":"951bb41e.ef7928","type":"api-call-service","z":"ec27da7d.cad118","name":"Galáxia Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.galaxia_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":560,"y":1520,"wires":[[]]},{"id":"5528942f.327e2c","type":"function","z":"ec27da7d.cad118","name":"Turn Off","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \n        \"entity_id\": \"light.galaxia_maria\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2860,"y":1120,"wires":[["401ac49a.5ad02c"]]},{"id":"401ac49a.5ad02c","type":"api-call-service","z":"ec27da7d.cad118","name":"Galáxia","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.galaxia_maria","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3020,"y":1120,"wires":[[]]},{"id":"f5475c8f.c2f46","type":"function","z":"de7173c1.b1a8c","name":"Turn On","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg = {payload : {\n        \"on\": true,\n        \"bri\": 255,\n        \"ct\": 6100,\n        \"duration\": 2000\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2120,"y":680,"wires":[["1902382d.3b75d8"]]},{"id":"3c4328f6.a5cd88","type":"function","z":"de7173c1.b1a8c","name":"Start","func":"return msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":430,"y":680,"wires":[["34a7c617.5228fa","a7da0d9c.8d5c5","f5c73bd9.46edf8"]]},{"id":"8081d83.1012c28","type":"comment","z":"de7173c1.b1a8c","name":"Botao Cozinha foi clicado","info":"","x":290,"y":580,"wires":[]},{"id":"ddb1bdd4.17734","type":"link in","z":"de7173c1.b1a8c","name":"Botao Clique Escritorio ","links":["9ea4122e.d2c3a"],"x":115,"y":680,"wires":[["3c4328f6.a5cd88","8216c58c.aedad8"]]},{"id":"e2550c6f.f7389","type":"function","z":"de7173c1.b1a8c","name":"Add Topic","func":"var newMsg;\nif(typeof msg.ajuda !== \"undefined\"){\n    if(msg.ajuda === 1){\n        newMsg = {\"topic\":\"Luz1\", \"payload\": true};\n        flow.set(\"triggered3\", false);\n        return newMsg;\n    }\n}\nif(flow.get(\"triggered3\")===true){\n    flow.set(\"triggered3\", false);\n    if(msg.payload.state.on === true)\n    {\n        newMsg = {\"topic\":\"Luz1\", \"payload\": true};\n        return newMsg;\n    }\n    if(msg.payload.state.on === false)\n    {\n        newMsg = {\"topic\":\"Luz1\",\"payload\": false};\n        return newMsg;\n    }\n\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1120,"y":580,"wires":[["1e34fe9a.27cd61"]]},{"id":"34a7c617.5228fa","type":"change","z":"de7173c1.b1a8c","name":"","rules":[{"t":"set","p":"triggered3","pt":"flow","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"status\": \"status\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":660,"y":580,"wires":[["42e0f363.1c0d6c","cf9232f1.7a6f9"]]},{"id":"cf267433.da83f8","type":"function","z":"de7173c1.b1a8c","name":"Turn Off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg = {payload : {\"on\": false}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2120,"y":620,"wires":[["1902382d.3b75d8"]]},{"id":"3ce9898f.93a326","type":"inject","z":"de7173c1.b1a8c","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":280,"y":740,"wires":[["3c4328f6.a5cd88"]]},{"id":"42e0f363.1c0d6c","type":"delay","z":"de7173c1.b1a8c","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":830,"y":520,"wires":[["117594df.e82cab"]]},{"id":"117594df.e82cab","type":"function","z":"de7173c1.b1a8c","name":"In Case of Error","func":"msg.ajuda = 1;\nreturn msg;","outputs":1,"noerr":0,"x":1000,"y":520,"wires":[["e2550c6f.f7389"]]},{"id":"642f0670.106128","type":"debug","z":"de7173c1.b1a8c","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1770,"y":600,"wires":[]},{"id":"1e34fe9a.27cd61","type":"delay","z":"de7173c1.b1a8c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1300,"y":580,"wires":[["f8be8d99.0c2e9"]]},{"id":"f8be8d99.0c2e9","type":"BooleanLogicUltimate","z":"de7173c1.b1a8c","name":"","filtertrue":"both","persist":false,"sInitializeWith":"false","triggertopic":"trigger","outputtriggeredby":"onlyonetopic","inputCount":"3","topic":"result","x":1550,"y":680,"wires":[[],["d266f759.28e168","642f0670.106128","cf267433.da83f8"],[]]},{"id":"d266f759.28e168","type":"InvertUltimate","z":"de7173c1.b1a8c","name":"Invert","x":1830,"y":680,"wires":[["f5475c8f.c2f46"]]},{"id":"e9294587.f92ae8","type":"yeelight-compat-hue-state","z":"de7173c1.b1a8c","name":"","server":"9db1d7d0.459aa8","x":910,"y":580,"wires":[["e2550c6f.f7389"]]},{"id":"243087c9.22fa68","type":"yeelight-compat-hue-out","z":"de7173c1.b1a8c","name":"","server":"9db1d7d0.459aa8","x":2380,"y":640,"wires":[]},{"id":"4df02595.c0529c","type":"function","z":"de7173c1.b1a8c","name":"Add Topic","func":"var newMsg;\nif(typeof msg.ajuda !== \"undefined\"){\n    if(msg.ajuda === 1){\n        newMsg = {\"topic\":\"Luz2\", \"payload\": true};\n        flow.set(\"triggered3\", false);\n        return newMsg;\n    }\n}\nif(flow.get(\"triggered4\")===true){\n    flow.set(\"triggered4\", false);\n    if(msg.payload === \"on\")\n    {\n        newMsg = {\"topic\":\"Luz2\", \"payload\": true};\n        return newMsg;\n    }\n    if(msg.payload === \"off\")\n    {\n        newMsg = {\"topic\":\"Luz2\",\"payload\": false};\n        return newMsg;\n    }\n\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1120,"y":700,"wires":[["899ce996.07cb98"]]},{"id":"a7da0d9c.8d5c5","type":"change","z":"de7173c1.b1a8c","name":"","rules":[{"t":"set","p":"triggered4","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":670,"y":700,"wires":[["3d022baf.13eb04","bdfe7694.ab6798"]]},{"id":"3d022baf.13eb04","type":"delay","z":"de7173c1.b1a8c","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":830,"y":640,"wires":[["7e5657c9.9e22d8"]]},{"id":"7e5657c9.9e22d8","type":"function","z":"de7173c1.b1a8c","name":"In Case of Error","func":"msg.ajuda = 1;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1000,"y":640,"wires":[["4df02595.c0529c"]]},{"id":"899ce996.07cb98","type":"delay","z":"de7173c1.b1a8c","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1300,"y":700,"wires":[["f8be8d99.0c2e9"]]},{"id":"bdfe7694.ab6798","type":"api-current-state","z":"de7173c1.b1a8c","name":"Luz da Cozinha","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_da_cozinha","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":880,"y":700,"wires":[["4df02595.c0529c"]]},{"id":"f99c7f0b.3d30d","type":"comment","z":"de7173c1.b1a8c","name":"Trocar pra Luz da Cozinha","info":"","x":870,"y":480,"wires":[]},{"id":"33a3a6e2.a907ca","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"350","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":630,"y":1180,"wires":[["bd1063d0.32879"]]},{"id":"bd1063d0.32879","type":"function","z":"e7cd1901.ee2408","name":"Add Topic","func":"var newMsg;\nnewMsg = {\"topic\":\"trigger\", \"payload\": false};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1300,"y":1180,"wires":[["b7203386.43b91"]]},{"id":"2837e772.a35338","type":"function","z":"5767c936.cabd18","name":"Add Topic","func":"var newMsg;\nnewMsg = {\"topic\":\"trigger\", \"payload\": false};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1300,"y":1040,"wires":[["a4f518c2.079878"]]},{"id":"44824a8e.596a94","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"350","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":630,"y":1040,"wires":[["2837e772.a35338"]]},{"id":"ab61f5d5.6dc488","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2300,"y":1020,"wires":[["532314fa.f2012c"]]},{"id":"544a034e.fdb21c","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2300,"y":920,"wires":[["586425e0.aad894"]]},{"id":"f3e49289.041b7","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2400,"y":1100,"wires":[["ef0dad43.78086"]]},{"id":"f085972.585a668","type":"function","z":"5767c936.cabd18","name":"Abajures Escritorio On","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"switch.abajur_escritorio\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"switch.luminaria_esquerda\"\n        }\n    }};\n    node.send(newMsg);\n    \n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"switch.luminaria_direita\"\n        }\n    }};\n    \n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2440,"y":1160,"wires":[["1d0f6961.fccf07"]]},{"id":"1d0f6961.fccf07","type":"api-call-service","z":"5767c936.cabd18","name":"Abajures","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.abajur_direita","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2660,"y":1160,"wires":[[]]},{"id":"3cdaf074.5db4f","type":"function","z":"bbb64533.9844f8","name":"Turn On","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg = {payload : {\n        \"on\": true,\n        \"bri\": 255,\n        \"ct\": 6100,\n        \"duration\": 2000\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2120,"y":300,"wires":[["8c6ac0c.f71714"]]},{"id":"59d8aaa7.eb0534","type":"function","z":"bbb64533.9844f8","name":"Start","func":"return msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":430,"y":300,"wires":[["2df8c031.3a154","df56f1ae.4a62e","679ecdfb.0845a4"]]},{"id":"1fff84f6.dbd9db","type":"comment","z":"bbb64533.9844f8","name":"Botao Cantinho foi clicado","info":"","x":290,"y":200,"wires":[]},{"id":"53dcae2c.a36a2","type":"link in","z":"bbb64533.9844f8","name":"Botao Clique Cantinho","links":["814a7101.cae35"],"x":255,"y":300,"wires":[["59d8aaa7.eb0534"]]},{"id":"e14e7ae5.c0e458","type":"function","z":"bbb64533.9844f8","name":"Add Topic","func":"var newMsg;\nif(typeof msg.ajuda !== \"undefined\"){\n    if(msg.ajuda === 1){\n        newMsg = {\"topic\":\"Luz1\", \"payload\": true};\n        flow.set(\"triggered3\", false);\n        return newMsg;\n    }\n}\nif(flow.get(\"triggered3\")===true){\n    flow.set(\"triggered3\", false);\n    if(msg.payload.state.on === true)\n    {\n        newMsg = {\"topic\":\"Luz1\", \"payload\": true};\n        return newMsg;\n    }\n    if(msg.payload.state.on === false)\n    {\n        newMsg = {\"topic\":\"Luz1\",\"payload\": false};\n        return newMsg;\n    }\n\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1120,"y":200,"wires":[["d025ff47.cd7d6"]]},{"id":"2df8c031.3a154","type":"change","z":"bbb64533.9844f8","name":"","rules":[{"t":"set","p":"triggered3","pt":"flow","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"status\": \"status\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":660,"y":200,"wires":[["7dcf7bd3.421ca4","7383cdd.6e1a634"]]},{"id":"26e7b9e.aedfb46","type":"function","z":"bbb64533.9844f8","name":"Turn Off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg = {payload : {\"On\": false, \"on\": false}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2120,"y":240,"wires":[["8c6ac0c.f71714"]]},{"id":"6b6cda8a.8980f4","type":"inject","z":"bbb64533.9844f8","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":280,"y":360,"wires":[["59d8aaa7.eb0534"]]},{"id":"7383cdd.6e1a634","type":"delay","z":"bbb64533.9844f8","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":830,"y":140,"wires":[["845117d0.873e38"]]},{"id":"845117d0.873e38","type":"function","z":"bbb64533.9844f8","name":"In Case of Error","func":"msg.ajuda = 1;\nreturn msg;","outputs":1,"noerr":0,"x":1000,"y":140,"wires":[["e14e7ae5.c0e458"]]},{"id":"f7ba00e9.af1ae","type":"debug","z":"bbb64533.9844f8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1770,"y":220,"wires":[]},{"id":"d025ff47.cd7d6","type":"delay","z":"bbb64533.9844f8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1300,"y":200,"wires":[["a2987d0a.6c8a3"]]},{"id":"a2987d0a.6c8a3","type":"BooleanLogicUltimate","z":"bbb64533.9844f8","name":"","filtertrue":"both","persist":false,"sInitializeWith":"false","triggertopic":"trigger","outputtriggeredby":"onlyonetopic","inputCount":"3","topic":"result","x":1550,"y":300,"wires":[[],["3608ba8a.33faa6","f7ba00e9.af1ae","26e7b9e.aedfb46"],[]]},{"id":"3608ba8a.33faa6","type":"InvertUltimate","z":"bbb64533.9844f8","name":"Invert","x":1830,"y":300,"wires":[["3cdaf074.5db4f"]]},{"id":"7dcf7bd3.421ca4","type":"yeelight-compat-hue-state","z":"bbb64533.9844f8","name":"","server":"2812cb35.9c26a4","x":910,"y":200,"wires":[["e14e7ae5.c0e458"]]},{"id":"9c84d5ae.e9dd38","type":"yeelight-compat-hue-out","z":"bbb64533.9844f8","name":"","server":"bd7d7dee.f60af","x":2460,"y":240,"wires":[]},{"id":"df56f1ae.4a62e","type":"change","z":"bbb64533.9844f8","name":"","rules":[{"t":"set","p":"triggered4","pt":"flow","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"status\": \"status\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":660,"y":320,"wires":[["8fcca278.ac3f2","6665cb1d.815d84"]]},{"id":"3389ddcc.848222","type":"delay","z":"bbb64533.9844f8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1300,"y":320,"wires":[["a2987d0a.6c8a3"]]},{"id":"a4964caa.4813c","type":"comment","z":"de7173c1.b1a8c","name":"Movimento na Cozinha","info":"","x":320,"y":120,"wires":[]},{"id":"b3061b2a.42a488","type":"link in","z":"4c9c764d.9c4468","name":"Movimento Sala ou Escritório a noite","links":["1f03bb0a.233655","3e5f80d2.529f1"],"x":275,"y":2480,"wires":[["8e779643.bba058"]]},{"id":"5f1a4b06.f08244","type":"function","z":"4c9c764d.9c4468","name":"Moveu?","func":"var date = new Date();\nvar Hour = date.getHours();\nif(Hour > 20 || (Hour < 9 && msg.payload < 70)){    \n    if(\n        global.get(\"boaNoiteCasa\") === true &&\n        global.get(\"tvAuxFilme\") === false &&\n        global.get(\"tvAuxPlay\") === false &&\n        global.get(\"horaDoFilme\") === false &&\n        global.get(\"EscritorioOn\") === false &&\n        global.get(\"SalaOn\") === false &&\n        global.get(\"desabilitaAutomacao\") === false\n        ){\n            return msg;\n        }\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":560,"y":2480,"wires":[["ef50d8fa.73e338"]]},{"id":"ef50d8fa.73e338","type":"api-current-state","z":"4c9c764d.9c4468","name":"TV On?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"media_player.tv_da_sala","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":740,"y":2480,"wires":[["9a3a136b.85b3c"]]},{"id":"9a3a136b.85b3c","type":"function","z":"4c9c764d.9c4468","name":"Home?","func":"if(msg.payload === false){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":920,"y":2480,"wires":[["209fa50d.41ea5a","83e5e3e6.aeb5c"]]},{"id":"83e5e3e6.aeb5c","type":"function","z":"4c9c764d.9c4468","name":"Turn On","func":"var newMsg;\nif(global.get(\"salaOnNoite\") === false){\n    global.set(\"salaOnNoite\", true);\n    newMsg = {payload : {\n            \"on\": true,\n            \"bri\": 1,\n            \"ct\": 3000\n    }};\n    node.send(newMsg);\n    newMsg = {payload : {\n            \"on\": true,\n            \"bri\": 25,\n            \"ct\": 3500,\n            \"duration\": 2500\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1120,"y":2480,"wires":[["322f7fc0.0a59a"]]},{"id":"1ccc0505.2d80ab","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":1830,"y":2420,"wires":[]},{"id":"88204b14.396228","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"56814891.18c868","x":1819,"y":2609,"wires":[]},{"id":"5ab4abef.478e84","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delayv","timeout":"10","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1300,"y":2780,"wires":[["d05a503e.dacae"]]},{"id":"bd6511fe.20fea","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":2610,"y":2660,"wires":[]},{"id":"e5b3f35f.d05bc","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"56814891.18c868","x":2599,"y":2849,"wires":[]},{"id":"a12278b9.ef7ca8","type":"function","z":"4c9c764d.9c4468","name":"Turn Off","func":"var newMsg;\n\nglobal.set(\"salaOnNoite\", false);\nnewMsg = {payload : {\n        \"on\": false,\n        \"duration\": 2500\n}};\nglobal.set(\"SalaOn\", false);\nglobal.set(\"EscritorioOn\", false);\nglobal.set(\"boaNoiteCasa\", true);\nglobal.set(\"desabilitaAutomacao\", false);\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2180,"y":2780,"wires":[["95def43f.e94fd8"]]},{"id":"50e19147.2ed4b","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"false","payloadType":"bool","x":750,"y":2560,"wires":[["9a3a136b.85b3c"]]},{"id":"27cc9661.88529a","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1590,"y":2480,"wires":[["1ccc0505.2d80ab","88204b14.396228","c484baa1.0cf908","1d0c8fcb.db4ed","f53c0906.685008","6b47a09f.49dea"]]},{"id":"d05a503e.dacae","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"10","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1460,"y":2780,"wires":[["61ed0093.2a149","a23aec8c.ba2ea"]]},{"id":"f003a8c9.62dd48","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"},{"p":"reset","v":"true","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"reset","payload":"reset","payloadType":"str","x":1140,"y":2860,"wires":[["5ab4abef.478e84"]]},{"id":"bf780311.d9c6b","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Tracks","auth":"3b9d50b6.bca4e","api":"getUserPlaylists","x":430,"y":3840,"wires":[["8a9a6caa.7e3b7"]]},{"id":"b0ed9b4e.cc7078","type":"inject","z":"7b0de646.c85c78","name":"","props":[{"p":"params","v":"[    {\"offset\": 0}     ]","vt":"json"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":250,"y":3840,"wires":[["bf780311.d9c6b"]]},{"id":"8a9a6caa.7e3b7","type":"debug","z":"7b0de646.c85c78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":620,"y":3840,"wires":[]},{"id":"757019f9.355f18","type":"inject","z":"ec27da7d.cad118","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":160,"y":1580,"wires":[["1575cb07.78abd5","191ee8af.3886e7"]]},{"id":"a5cdafa0.24208","type":"function","z":"d3db5d74.fb8fa","name":"Janela Fechada","func":"if(msg.topic === \"binary_sensor.janela_sala\"){\n    if(msg.payload === false){\n        global.set(\"janelaSala\",false);\n        msg.reset = true;\n        msg.payload = \"reset\"; \n        return msg;\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":2520,"wires":[["86c97a42.dedca8"]]},{"id":"f5060f92.9d594","type":"function","z":"d3db5d74.fb8fa","name":"Janela Aberta","func":"if(msg.topic === \"binary_sensor.janela_sala\"){\n    if(msg.payload === true){\n        global.set(\"janelaSala\",true);\n        return msg;\n    }\n}\n//sensor_magnet.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":2460,"wires":[["86c97a42.dedca8"]]},{"id":"619b8463.3e7cdc","type":"server-state-changed","z":"d3db5d74.fb8fa","name":"Janela Sala Esquerda","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.janela_sala_esquerda","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":320,"y":2500,"wires":[["f5060f92.9d594"],["a5cdafa0.24208"]]},{"id":"b9dc8e30.7f553","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":740,"y":2120,"wires":[["3a03e9ad.c6b0d6"]]},{"id":"3a03e9ad.c6b0d6","type":"function","z":"d3db5d74.fb8fa","name":"Turn Off","func":"var newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_off\",\n                data:{\n                    \"entity_id\": \"switch.ar_condicionado_quarto\"\n                }\n        }};\nnode.send(newMsg);\nnewMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_off\",\n                data:{\n                    \"entity_id\": \"switch.ventilador\"\n                }\n        }};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":880,"y":2120,"wires":[["6ae80fb3.6c708"]]},{"id":"6ae80fb3.6c708","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Ar Condicionado do Quarto","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.ar_condicionado_quarto","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1080,"y":2120,"wires":[[]]},{"id":"86c97a42.dedca8","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":740,"y":2420,"wires":[["7e80e7ff.24abc8"]]},{"id":"7e80e7ff.24abc8","type":"function","z":"d3db5d74.fb8fa","name":"Turn Off","func":"var newMsg= {payload : {\n                \"domain\": \"switch\",\n                \"service\": \"turn_off\",\n                data:{\n                    \"entity_id\": \"switch.ar_condicionado_quarto\"\n                }\n        }};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":880,"y":2420,"wires":[["1188d9d4.70e7c6"]]},{"id":"1188d9d4.70e7c6","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Ar Condicionado do Quarto","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.ar_condicionado_quarto","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1080,"y":2420,"wires":[[]]},{"id":"31004291.3865b6","type":"function","z":"4c9c764d.9c4468","name":"TV Off?","func":"    if(msg.payload === \"off\"){\n        global.set(\"tvAuxFilme\", false);\n        global.set(\"tvAuxPlay\", false);\n        global.set(\"horaDoFilme\", false);\n    }\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":460,"y":1540,"wires":[[]]},{"id":"a5e306d0.f215b8","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":3230,"y":2040,"wires":[["3732fb0d.03ca34"]]},{"id":"f241371a.736b48","type":"spotify","z":"7b0de646.c85c78","name":"Getting Archive Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1800,"y":2040,"wires":[["f4d1a59f.8acec8","af67a910.6dfb78"]]},{"id":"c92f5f3d.515ad","type":"function","z":"7b0de646.c85c78","name":"2020-2022","func":"flow.set(\"20211-ArrayAux\", msg.tracks)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '4MMFbdbRfywp2lSB5umAqC',\n        {offset: 0}\n    ]\n}\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1410,"y":2040,"wires":[["92e2cccb.2c154"]]},{"id":"f4d1a59f.8acec8","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"20202022-OldAux\");\nvar oldArrayAux = flow.get(\"20202022-OldArrayAux\");\n\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"20202022-OldArrayAux\", newOldArrayAux);\nflow.set(\"20202022-OldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2020,"y":2040,"wires":[["d4653a82.72a218"]]},{"id":"c3f4ddfc.507e5","type":"inject","z":"7b0de646.c85c78","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"30 14 * * 1,3,5","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":2040,"wires":[["fc346196.25d04"]]},{"id":"fc346196.25d04","type":"function","z":"7b0de646.c85c78","name":"2021/1","func":"var newMsg;\nflow.set(\"20211-OldAux\", 0);\nflow.set(\"20211-OldArrayAux\", []);\nflow.set(\"20211-OldOffset\",100);\nflow.set(\"20211-ArrayAux\", []);\nflow.set(\"20202022-OldAux\", 0);\nflow.set(\"20202022-OldArrayAux\", []);\nflow.set(\"20202022-Offset\",100);\nflow.set(\"20202022-ArrayAux\", []);\nnewMsg = {\n    \"params\":[\n        '3szB690Xq6L24GyDRfkk7W'\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":330,"y":2040,"wires":[["75fe0365.108c3c"]]},{"id":"b4d87916.7cdcc8","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":2420,"y":2040,"wires":[["a9459dc3.a9fc9"],["3c036e44.010572","23d8f198.59c9ae"]]},{"id":"a9459dc3.a9fc9","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"discoverWeeklyOffset = flow.get(\"20202022-Offset\");\nflow.set(\"20202022-Offset\",discoverWeeklyOffset+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '4MMFbdbRfywp2lSB5umAqC',\n        {offset: discoverWeeklyOffset}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2340,"y":1960,"wires":[["f241371a.736b48"]]},{"id":"3c036e44.010572","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"20211-ArrayAux\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nvar i;\n        for(i=0; i<newTracks.length; i++) {\n            alreadyIn = false;\n            for(var j=0; j<oldTracks.length; j++) {\n                if(newTracks[i].track.id === oldTracks[j].track.id){\n                    alreadyIn = true\n                }\n            }\n            if(alreadyIn === false){\n                auxString = \"['\" + newTracks[i].track.uri + \"']\"\n                newMsg = {\n                    \"params\":[\n                        \"4MMFbdbRfywp2lSB5umAqC\",\n                        [newTracks[i].track.uri]\n                    ]}\n                node.send(newMsg);\n        \n            }\n        }\nflow.set(\"20211-OldArrayAux\", []);\nflow.set(\"20211-ArrayAux\", []);\nflow.set(\"20202022-OldArrayAux\", []);\nflow.set(\"20202022-ArrayAux\", []);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2750,"y":2040,"wires":[["aa442837.525778","105bf037.c7851"]]},{"id":"d4653a82.72a218","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2210,"y":2040,"wires":[["b4d87916.7cdcc8"]]},{"id":"23d8f198.59c9ae","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2740,"y":2120,"wires":[]},{"id":"92e2cccb.2c154","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1580,"y":2040,"wires":[["f241371a.736b48"]]},{"id":"aa442837.525778","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2990,"y":2040,"wires":[["a5e306d0.f215b8"]]},{"id":"105bf037.c7851","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3030,"y":2120,"wires":[]},{"id":"3732fb0d.03ca34","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3430,"y":2120,"wires":[]},{"id":"af67a910.6dfb78","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1990,"y":2100,"wires":[]},{"id":"c484baa1.0cf908","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","d":true,"name":"","server":"5a8bf4db.2d6bcc","x":1809,"y":2549,"wires":[]},{"id":"1d0c8fcb.db4ed","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","d":true,"name":"","server":"14b837c9.ab10c","x":1830,"y":2480,"wires":[]},{"id":"f70dc065.70dbf","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","d":true,"name":"","server":"14b837c9.ab10c","x":2610,"y":2720,"wires":[]},{"id":"1859ba82.068f25","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","d":true,"name":"","server":"5a8bf4db.2d6bcc","x":2589,"y":2789,"wires":[]},{"id":"ab451a74.316f08","type":"function","z":"d3db5d74.fb8fa","name":"Botão Cozinha Click","func":"if(msg.payload.entity_id === \"binary_sensor.botao_cozinha\" && msg.payload.event.click_type === \"single\"){\n\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":240,"wires":[["9ea4122e.d2c3a"]]},{"id":"9ea4122e.d2c3a","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Clique Cozinha","links":["ddb1bdd4.17734"],"x":715,"y":240,"wires":[]},{"id":"e54d1ba1.72c538","type":"function","z":"d3db5d74.fb8fa","name":"Botão Cozinha Double","func":"if(msg.payload.entity_id === \"binary_sensor.botao_cozinha\" && msg.payload.event.click_type === \"double\"){\n\n    \n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":280,"wires":[["c7267d79.d76bf"]]},{"id":"c7267d79.d76bf","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Duplo Clique Cozinha","links":[],"x":715,"y":280,"wires":[]},{"id":"82e9383c.0ad5a8","type":"function","z":"d3db5d74.fb8fa","name":"Botão Cantinho Click","func":"if(msg.payload.entity_id === \"binary_sensor.botao_cantinho\" && msg.payload.event.click_type === \"single\"){\n\n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":940,"wires":[["814a7101.cae35"]]},{"id":"814a7101.cae35","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Clique Cantinho","links":["53dcae2c.a36a2"],"x":715,"y":940,"wires":[]},{"id":"d829fdb7.3d40f","type":"function","z":"d3db5d74.fb8fa","name":"Botão Cantinho Double","func":"if(msg.payload.entity_id === \"binary_sensor.botao_cantinho\" && msg.payload.event.click_type === \"double\"){\n\n    \n    return msg;\n}\n//sensor_switch.aq2\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":530,"y":980,"wires":[["6610f07f.808fa"]]},{"id":"6610f07f.808fa","type":"link out","z":"d3db5d74.fb8fa","name":"Botao Duplo Clique Cantinho","links":[],"x":715,"y":980,"wires":[]},{"id":"d94b5100.3d98b","type":"function","z":"bbb64533.9844f8","name":"Add Topic","func":"var newMsg;\nif(typeof msg.ajuda !== \"undefined\"){\n    if(msg.ajuda === 1){\n        newMsg = {\"topic\":\"Luz2\", \"payload\": true};\n        flow.set(\"triggered3\", false);\n        return newMsg;\n    }\n}\nif(flow.get(\"triggered4\")===true){\n    flow.set(\"triggered4\", false);\n    if(msg.payload.state.on === true)\n    {\n        newMsg = {\"topic\":\"Luz2\", \"payload\": true};\n        return newMsg;\n    }\n    if(msg.payload.state.on === false)\n    {\n        newMsg = {\"topic\":\"Luz2\",\"payload\": false};\n        return newMsg;\n    }\n\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1120,"y":320,"wires":[["3389ddcc.848222"]]},{"id":"8fcca278.ac3f2","type":"delay","z":"bbb64533.9844f8","name":"","pauseType":"delay","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":830,"y":260,"wires":[["89abbdbe.cf1f8"]]},{"id":"89abbdbe.cf1f8","type":"function","z":"bbb64533.9844f8","name":"In Case of Error","func":"msg.ajuda = 1;\nreturn msg;","outputs":1,"noerr":0,"x":1000,"y":260,"wires":[["d94b5100.3d98b"]]},{"id":"64003ec5.6a43e","type":"yeelight-compat-hue-state","z":"bbb64533.9844f8","name":"","server":"bd7d7dee.f60af","x":920,"y":320,"wires":[["d94b5100.3d98b"]]},{"id":"ede41e59.cb0e4","type":"yeelight-compat-hue-out","z":"bbb64533.9844f8","name":"","server":"2812cb35.9c26a4","x":2440,"y":300,"wires":[]},{"id":"f5c73bd9.46edf8","type":"delay","z":"de7173c1.b1a8c","name":"","pauseType":"delay","timeout":"350","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":650,"y":760,"wires":[["85ca2080.72ad5"]]},{"id":"85ca2080.72ad5","type":"function","z":"de7173c1.b1a8c","name":"Add Topic","func":"var newMsg;\nnewMsg = {\"topic\":\"trigger\", \"payload\": false};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1320,"y":760,"wires":[["f8be8d99.0c2e9"]]},{"id":"679ecdfb.0845a4","type":"delay","z":"bbb64533.9844f8","name":"","pauseType":"delay","timeout":"350","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":650,"y":380,"wires":[["ae1bd743.5e9488"]]},{"id":"ae1bd743.5e9488","type":"function","z":"bbb64533.9844f8","name":"Add Topic","func":"var newMsg;\nnewMsg = {\"topic\":\"trigger\", \"payload\": false};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1320,"y":380,"wires":[["a2987d0a.6c8a3"]]},{"id":"381169a.db1de96","type":"link in","z":"4c9c764d.9c4468","name":"Desliga a Casa","links":["d57439e1.373828"],"x":355,"y":3460,"wires":[["5d3ea5e2.2a08bc","ee142b54.faf3e8","107980eb.15121f","b581ab7.07c8658"]]},{"id":"5d3ea5e2.2a08bc","type":"function","z":"4c9c764d.9c4468","name":"Desliga Casa","func":"    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"media_player.fire_tv\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"media_player.tv_da_sala\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_nedi\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.rgb_strip\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.projetor_ceu\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.umidificador\"\n        }\n    }};\n    \n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\"\n        }\n    }};\n    node.send(newMsg);\n\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_1\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2_hk\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_maria\"\n        }\n    }};\n    node.send(newMsg);\n\n\n\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_maria_hk\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.galaxia_maria\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ventilador_da_sala\"\n        }\n    }};\n    node.send(newMsg);\n\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ventilador\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.luminaria_direita\"\n        }\n    }};\n    node.send(newMsg);\n\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.luminaria_esquerda\"\n        }\n    }};\n    node.send(newMsg);\n\n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ar_condicionado_sala\"\n        }\n    }};\n    node.send(newMsg);    \n    newMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"switch.ar_condicionado_quarto\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.fita_cama\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.alguem_em_casa\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.sala_ocupada_switch\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.quarto_nedi_ocupado_switch\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.quarto_maria_ocupado_switch\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_cozinha\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sacada_sala\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_cantinho\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.abajur_escritorio\"\n        }\n    }};\n    node.send(newMsg);\n\nglobal.set(\"contEscritorio\", 2800)\nglobal.set(\"desabilitaAutomacao\", true)\nglobal.set(\"overrideEscritorio\", false)\nglobal.set(\"tvAuxFilme\", false)\nglobal.set(\"tvAuxPlay\", false)\nglobal.set(\"vouDormir\", false)\nglobal.set(\"horaDoFilme\", false)\nglobal.set(\"horaDoSonoMaria\", false)\nglobal.set(\"SalaOn\", false)\nglobal.set(\"EscritorioOn\", false)\nglobal.set(\"SalaOnFirstTime\", false)\nglobal.set(\"EscritorioOnFirstTime\", false)\nglobal.set(\"boaNoiteCasa\", false)\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":3520,"wires":[["8b7f5cf8.deca1"]]},{"id":"195e2890.aa0b47","type":"api-call-service","z":"4c9c764d.9c4468","name":"Echo Fala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":690,"y":3580,"wires":[[]]},{"id":"ee142b54.faf3e8","type":"function","z":"4c9c764d.9c4468","name":"Fala tchau","func":"        var newMsg;\n        newMsg= { \"payload\": \"Tchau, até logo!\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_da_sala\" };\n        return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":510,"y":3580,"wires":[["195e2890.aa0b47"]]},{"id":"8b7f5cf8.deca1","type":"api-call-service","z":"4c9c764d.9c4468","name":"Casa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"","service":"","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":690,"y":3520,"wires":[[]]},{"id":"107980eb.15121f","type":"function","z":"4c9c764d.9c4468","name":"Turn Off","func":"var newMsg;\nnewMsg = {payload : {\n        \"on\": false,\n        \"duration\": 2500\n}};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":3280,"wires":[["5ec548f5.d5ea68"]]},{"id":"4a1425a2.db543c","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"56814891.18c868","x":1060,"y":3080,"wires":[]},{"id":"4d27662f.48b518","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":1070,"y":3140,"wires":[]},{"id":"972f7720.a13ec8","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"14b837c9.ab10c","x":1070,"y":3200,"wires":[]},{"id":"e6f2407a.0d866","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2812cb35.9c26a4","x":1060,"y":3260,"wires":[]},{"id":"1432ae4b.db0122","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"9db1d7d0.459aa8","x":1060,"y":3380,"wires":[]},{"id":"ee72fc5c.00463","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"3e6ae01c.bd204","x":1080,"y":3440,"wires":[]},{"id":"52b5b752.987af8","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"bd7d7dee.f60af","x":1080,"y":3320,"wires":[]},{"id":"f53c0906.685008","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"bd7d7dee.f60af","x":1840,"y":2360,"wires":[]},{"id":"6b47a09f.49dea","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2812cb35.9c26a4","x":1820,"y":2300,"wires":[]},{"id":"a118c87a.5bf698","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2812cb35.9c26a4","x":2600,"y":2920,"wires":[]},{"id":"384159c3.257dd6","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"bd7d7dee.f60af","x":2620,"y":2980,"wires":[]},{"id":"ae53388.ba33ac8","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"milliseconds","rate":"3","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":470,"y":3800,"wires":[["a79065b7.b78358"]]},{"id":"76dae1d1.3b3ee","type":"function","z":"4c9c764d.9c4468","name":"Turn Off Sala","func":"var newMsg;     \nglobal.set(\"tvAuxFilme\", false);\nglobal.set(\"tvAuxPlay\", false);\nglobal.set(\"horaDoFilme\", false);\nglobal.set(\"EscritorioOn\", false);\nglobal.set(\"SalaOn\", false);\nglobal.set(\"desabilitaAutomacao\", false);\nglobal.set(\"salaOnNoite\", false);\nvar date = new Date();\nvar Hour = date.getHours(); //hours in 0-23\nif(Hour > 18 || Hour < 9){\n    global.set(\"boaNoiteCasa\", true);\n}\n\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"light.luz_da_cozinha\"\n        }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"light.luz_do_cantinho\"\n        }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"light.luz_da_sacada_sala\"\n        }\n}};\nnode.send(newMsg);\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"group.sala\"\n        }\n}};\nnode.send(newMsg)\n\nnewMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"group.sala\"\n        }\n}};\nnode.send(newMsg)\n\nnewMsg= {payload : {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"group.sala\"\n        }\n}};\nnode.send(newMsg);\n\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"group.luzes_do_escritorio\"\n        }\n}};\nnode.send(newMsg)\n\nnewMsg= {payload : {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        data:{\n            \"entity_id\": \"group.luzes_do_escritorio\"\n        }\n}};\n        \nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":850,"y":3800,"wires":[["812b0e69.7c32d"]]},{"id":"a79065b7.b78358","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":640,"y":3800,"wires":[["76dae1d1.3b3ee","362abe18.aadf02"]]},{"id":"12c59f88.0c213","type":"link in","z":"4c9c764d.9c4468","name":"Desliga Sala Botão","links":["8ef548f1.890268","c41e683b.b85588","ccc80da.d5973f"],"x":355,"y":3800,"wires":[["ae53388.ba33ac8"]]},{"id":"812b0e69.7c32d","type":"api-call-service","z":"4c9c764d.9c4468","name":"Home Assistant","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"group.luzes_da_sala, group.luzes_do_escritorio","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1080,"y":3800,"wires":[[]]},{"id":"362abe18.aadf02","type":"function","z":"4c9c764d.9c4468","name":"Turn Off","func":"var newMsg;\nnewMsg = {payload : {\n        \"on\": false,\n        \"duration\": 2500\n}};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":860,"y":4000,"wires":[["6581d3f5.54a43c"]]},{"id":"8a1d7a02.0338d8","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"5a8bf4db.2d6bcc","x":1330,"y":3920,"wires":[]},{"id":"ae7116e.962f6e8","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":1350,"y":3980,"wires":[]},{"id":"5abaedb5.26d254","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"14b837c9.ab10c","x":1350,"y":4040,"wires":[]},{"id":"25eebcec.40e154","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"56814891.18c868","x":1340,"y":4100,"wires":[]},{"id":"c47e8e7.1ac447","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"9db1d7d0.459aa8","x":1340,"y":4220,"wires":[]},{"id":"324ff746.b81568","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"bd7d7dee.f60af","x":1360,"y":4160,"wires":[]},{"id":"43564927.31a4c8","type":"comment","z":"4c9c764d.9c4468","name":"Desliga a Sala e Escritório pelo Botão","info":"","x":310,"y":3720,"wires":[]},{"id":"d808be4a.29a6f","type":"comment","z":"4c9c764d.9c4468","name":"Desliga a casa toda pelo Botão","info":"","x":250,"y":3220,"wires":[]},{"id":"681b8535.1a6a4c","type":"comment","z":"4c9c764d.9c4468","name":"Liga as luzes fraco, tem movimento na sala e todo já tinham ido dormir.","info":"","x":530,"y":2420,"wires":[]},{"id":"7447a7fa.4c77f8","type":"comment","z":"4c9c764d.9c4468","name":"Hora do Duolingo","info":"","x":280,"y":2020,"wires":[]},{"id":"5cf7e8e4.b41938","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"350","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1410,"y":1040,"wires":[["b32e941b.d9e7d8"]]},{"id":"b32e941b.d9e7d8","type":"function","z":"859b066a.dd8128","name":"Add Topic","func":"var newMsg;\nnewMsg = {\"topic\":\"trigger\", \"payload\": false};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1880,"y":1040,"wires":[["980435a0.32ea78"]]},{"id":"d618b0e4.5b66f","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"delay","timeout":"350","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1250,"y":1060,"wires":[["4f079107.f2b6c"]]},{"id":"4f079107.f2b6c","type":"function","z":"ec27da7d.cad118","name":"Add Topic","func":"var newMsg;\nnewMsg = {\"topic\":\"trigger\", \"payload\": false};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1700,"y":1060,"wires":[["8190319d.dd5f9"]]},{"id":"1e482dbd.bfadb2","type":"function","z":"d3db5d74.fb8fa","name":"Turn Off","func":"var newMsg;\nglobal.set(\"luzNoturnaOn\", false);\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_off\",\n    data:{\n        \"entity_id\": \"light.aqara_hub\",\n    }\n}};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2260,"y":1580,"wires":[["c3558e1c.f8358"]]},{"id":"322f7fc0.0a59a","type":"change","z":"4c9c764d.9c4468","name":"","rules":[{"t":"delete","p":"reset","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1290,"y":2480,"wires":[["c12be2b6.07349"]]},{"id":"897ff515.4b9148","type":"change","z":"e7cd1901.ee2408","name":"","rules":[{"t":"delete","p":"reset","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1270,"y":480,"wires":[["ff1586d2.1093f8"]]},{"id":"49a8a489.cb981c","type":"api-current-state","z":"de7173c1.b1a8c","name":"Movimento ainda?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_cozinha","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":990,"y":260,"wires":[["c3b14597.436588","27c73a5f.fb4d06"]]},{"id":"c3b14597.436588","type":"function","z":"de7173c1.b1a8c","name":"Não tem","func":"if(msg.payload === false){\n    msg = {\"payload\" : {\"on\": false}};\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1160,"y":260,"wires":[["2e8e5d7.37df4a2"]]},{"id":"61ed0093.2a149","type":"api-current-state","z":"4c9c764d.9c4468","name":"Movimento ainda?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_escritorio","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1670,"y":2840,"wires":[["7606cd10.5001e4","be05df82.3c64e"]]},{"id":"7606cd10.5001e4","type":"function","z":"4c9c764d.9c4468","name":"Não tem","func":"if(msg.payload === false){\n    msg = {payload : {\"On\": false, \"on\": false}};\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1840,"y":2840,"wires":[["c70a76df.e1da08"]]},{"id":"a23aec8c.ba2ea","type":"api-current-state","z":"4c9c764d.9c4468","name":"Movimento ainda?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_sala","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1670,"y":2720,"wires":[["cd21bc90.af9f5","be05df82.3c64e"]]},{"id":"cd21bc90.af9f5","type":"function","z":"4c9c764d.9c4468","name":"Não tem","func":"if(msg.payload === false){\n    msg = {payload : {\"On\": false, \"on\": false}};\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1840,"y":2720,"wires":[["c70a76df.e1da08"]]},{"id":"c70a76df.e1da08","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2010,"y":2780,"wires":[["a12278b9.ef7ca8"]]},{"id":"cc590b2b.aac018","type":"api-current-state","z":"859b066a.dd8128","name":"Movimento ainda?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_quarto_nedi","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1430,"y":720,"wires":[["d87df91e.c2aa28","fcdd5826.c73558"]]},{"id":"d87df91e.c2aa28","type":"function","z":"859b066a.dd8128","name":"Não tem","func":"if(msg.payload === false){\n    msg = {payload : {\"On\": false, \"on\": false}};\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1600,"y":720,"wires":[["e0a29728.f21988"]]},{"id":"a3cb2715.98c348","type":"api-current-state","z":"859b066a.dd8128","name":"Movimento ainda?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_quarto_nedi_aux","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1430,"y":820,"wires":[["dafb0c34.34aed","fcdd5826.c73558"]]},{"id":"dafb0c34.34aed","type":"function","z":"859b066a.dd8128","name":"Não tem","func":"if(msg.payload === false){\n    msg = {payload : {\"On\": false, \"on\": false}};\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1600,"y":820,"wires":[["e0a29728.f21988"]]},{"id":"fcdd5826.c73558","type":"function","z":"859b066a.dd8128","name":"Ainda tem","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1600,"y":780,"wires":[["cdfb9483.1eb448"]]},{"id":"27c73a5f.fb4d06","type":"function","z":"de7173c1.b1a8c","name":"Ainda tem","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1160,"y":320,"wires":[["793d498f.fcd508"]]},{"id":"be05df82.3c64e","type":"function","z":"4c9c764d.9c4468","name":"Ainda tem","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1840,"y":2780,"wires":[["209fa50d.41ea5a"]]},{"id":"209fa50d.41ea5a","type":"function","z":"4c9c764d.9c4468","name":"Delay + 5min","func":"var newMsg = { \"reset\": true };\nnode.send(newMsg);\nnewMsg = {\"delay\" : 600000};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1130,"y":2780,"wires":[["5ab4abef.478e84"]]},{"id":"e8c6c8ed.2e8908","type":"function","z":"4c9c764d.9c4468","name":"Luz do Quarto Flicker","func":"var newMsg;\n\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_nedi\",\n            \"rgb_color\": [0, 255, 0],\n            \"brightness_pct\": 100\n        }\n    }};\n    node.send(newMsg);\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_nedi\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_nedi\",\n            \"rgb_color\": [0, 255, 0],\n            \"brightness_pct\": 100\n        }\n    }};\n    node.send(newMsg);\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_nedi\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_nedi\",\n            \"rgb_color\": [0, 255, 0],\n            \"brightness_pct\": 100\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_nedi\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_nedi\",\n            \"rgb_color\": [255, 255, 255],\n            \"brightness_pct\": 1\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_do_quarto_nedi\"\n        }\n    }};\n    node.send(newMsg);\n    return newMsg ;\n    ","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":940,"y":2200,"wires":[["4f73cc90.1a7a84"]]},{"id":"e001f716.378a08","type":"api-call-service","z":"4c9c764d.9c4468","name":"Abajur do Escritório","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1350,"y":2200,"wires":[[]]},{"id":"4f73cc90.1a7a84","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1150,"y":2200,"wires":[["e001f716.378a08"]]},{"id":"bdc9e915.3f2808","type":"function","z":"4c9c764d.9c4468","name":"Abajur Flicker","func":"var newMsg;\n\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.abajur_quarto\",\n            \"rgb_color\": [0, 255, 0],\n            \"brightness_pct\": 100\n        }\n    }};\n    node.send(newMsg);\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.abajur_quarto\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.abajur_quarto\",\n            \"rgb_color\": [0, 255, 0],\n            \"brightness_pct\": 100\n        }\n    }};\n    node.send(newMsg);\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.abajur_quarto\"\n        }\n    }};\nnewMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"light.abajur_quarto\",\n            \"rgb_color\": [0, 255, 0],\n            \"brightness_pct\": 100\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.abajur_quarto\"\n        }\n    }};\n    node.send(newMsg);\n    return newMsg ;\n    ","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":920,"y":2260,"wires":[["7e015225.9c3d7c"]]},{"id":"7e015225.9c3d7c","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1150,"y":2260,"wires":[["f29a59a.b3d4fa8"]]},{"id":"f29a59a.b3d4fa8","type":"api-call-service","z":"4c9c764d.9c4468","name":"Abajur do Escritório","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1350,"y":2260,"wires":[[]]},{"id":"9385f918.5a2b08","type":"server-state-changed","z":"4c9c764d.9c4468","name":"Sensor de Luz Escritório Aqara","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.sensor_de_luz_escritorio_aqara","entityidfiltertype":"exact","outputinitially":false,"state_type":"num","haltifstate":"","halt_if_type":"num","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":330,"y":260,"wires":[["1f9e3931.bcd327"]]},{"id":"8216c58c.aedad8","type":"change","z":"de7173c1.b1a8c","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":420,"wires":[["a406512.4ee3ab"]]},{"id":"b581ab7.07c8658","type":"alexa-remote-smarthome","z":"4c9c764d.9c4468","name":"Sala Off","account":"421d4b0d.32a884","config":{"option":"action","value":[{"entity":"f6def6a8-9910-4698-a968-903b1c06d599","action":"turnOff"},{"entity":"96f75249-7aef-4e5e-ba1d-63370b924adc","action":"turnOff"}]},"outputs":1,"x":500,"y":3200,"wires":[[]]},{"id":"75fe0365.108c3c","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":580,"y":2040,"wires":[["18eb1497.ac36db","4c8b312b.7fb3f"]]},{"id":"18eb1497.ac36db","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"20211-OldAux\");\nvar oldArrayAux = flow.get(\"20211-OldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"20211-OldArrayAux\", newOldArrayAux);\nflow.set(\"20211-OldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux && msg.payload.next != null){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":800,"y":2040,"wires":[["3bf688e1.7fe5b8"]]},{"id":"a9b08989.a1a158","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1200,"y":2040,"wires":[["e21bcaa6.9e02a8"],["c92f5f3d.515ad"]]},{"id":"e21bcaa6.9e02a8","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"discoverWeeklyOffset = flow.get(\"20211-OldOffset\");\nflow.set(\"20211-OldOffset\",discoverWeeklyOffset+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '3szB690Xq6L24GyDRfkk7W',\n        {offset: discoverWeeklyOffset}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1120,"y":1960,"wires":[["75fe0365.108c3c"]]},{"id":"3bf688e1.7fe5b8","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":990,"y":2040,"wires":[["a9b08989.a1a158","4bfcefd5.f4c"]]},{"id":"4c8b312b.7fb3f","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":770,"y":2100,"wires":[]},{"id":"4bfcefd5.f4c","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1170,"y":2120,"wires":[]},{"id":"65977984.d3db78","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":3230,"y":2360,"wires":[["9f9d997.d8a1868"]]},{"id":"b3fcfb3d.436488","type":"spotify","z":"7b0de646.c85c78","name":"Getting Archive Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1800,"y":2360,"wires":[["d2d94662.fe5de8","8d18f855.1ed758"]]},{"id":"504d570c.fd2ff8","type":"function","z":"7b0de646.c85c78","name":"2021/1","func":"flow.set(\"20211Part2-ArrayAux\", msg.tracks)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '3szB690Xq6L24GyDRfkk7W',\n        {offset: 0}\n    ]\n}\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1390,"y":2360,"wires":[["b30374b5.955948"]]},{"id":"d2d94662.fe5de8","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"20211-OldAux\");\nvar oldArrayAux = flow.get(\"20211-OldArrayAux\");\n\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"20211-OldArrayAux\", newOldArrayAux);\nflow.set(\"20211-OldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2020,"y":2360,"wires":[["a910b472.2560d8"]]},{"id":"757519f0.4d1ed8","type":"inject","z":"7b0de646.c85c78","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"30 14 * * 1,3,5","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":2360,"wires":[["e3c76c88.f2fa2"]]},{"id":"e3c76c88.f2fa2","type":"function","z":"7b0de646.c85c78","name":"2021/1 Part 2","func":"var newMsg;\nflow.set(\"20211Part2-OldAux\", 0);\nflow.set(\"20211Part2-OldArrayAux\", []);\nflow.set(\"20211Part2-OldOffset\",100);\nflow.set(\"20211Part2-ArrayAux\", []);\nflow.set(\"20211-OldAux\", 0);\nflow.set(\"20211-OldArrayAux\", []);\nflow.set(\"20211-Offset\",100);\nflow.set(\"20211-ArrayAux\", []);\nnewMsg = {\n    \"params\":[\n        '4RVONFu915xstm93er9ouf'\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":360,"y":2360,"wires":[["305f2d6a.4c3ec2"]]},{"id":"1abc3b19.014df5","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":2420,"y":2360,"wires":[["4b348365.541c0c"],["dac34716.bcec28","40b79a67.87e9e4"]]},{"id":"4b348365.541c0c","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"discoverWeeklyOffset = flow.get(\"20211-Offset\");\nflow.set(\"20211-Offset\",discoverWeeklyOffset+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '3szB690Xq6L24GyDRfkk7W',\n        {offset: discoverWeeklyOffset}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2340,"y":2280,"wires":[["b3fcfb3d.436488"]]},{"id":"dac34716.bcec28","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"20211Part2-ArrayAux\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nvar i;\n        for(i=0; i<newTracks.length; i++) {\n            alreadyIn = false;\n            for(var j=0; j<oldTracks.length; j++) {\n                if(newTracks[i].track.id === oldTracks[j].track.id){\n                    alreadyIn = true\n                }\n            }\n            if(alreadyIn === false){\n                auxString = \"['\" + newTracks[i].track.uri + \"']\"\n                newMsg = {\n                    \"params\":[\n                        \"3szB690Xq6L24GyDRfkk7W\",\n                        [newTracks[i].track.uri]\n                    ]}\n                node.send(newMsg);\n        \n            }\n        }\n        \nflow.set(\"20211Part2-OldArrayAux\", []);\nflow.set(\"20211Part2-ArrayAux\", []);\nflow.set(\"20211-OldArrayAux\", []);\nflow.set(\"20211-ArrayAux\", []);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2750,"y":2360,"wires":[["daec8e52.d5465","aeb48a4d.436d98"]]},{"id":"a910b472.2560d8","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2210,"y":2360,"wires":[["1abc3b19.014df5"]]},{"id":"40b79a67.87e9e4","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2740,"y":2440,"wires":[]},{"id":"b30374b5.955948","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1580,"y":2360,"wires":[["b3fcfb3d.436488"]]},{"id":"daec8e52.d5465","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2990,"y":2360,"wires":[["65977984.d3db78"]]},{"id":"aeb48a4d.436d98","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3030,"y":2440,"wires":[]},{"id":"9f9d997.d8a1868","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3430,"y":2440,"wires":[]},{"id":"8d18f855.1ed758","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1990,"y":2420,"wires":[]},{"id":"305f2d6a.4c3ec2","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":600,"y":2360,"wires":[["8b3cbc6d.6b333","b1243a13.4f4458"]]},{"id":"8b3cbc6d.6b333","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"20211Part2-OldAux\");\nvar oldArrayAux = flow.get(\"20211Part2-OldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"20211Part2-OldArrayAux\", newOldArrayAux);\nflow.set(\"20211Part2-OldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux && msg.payload.next != null){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":800,"y":2360,"wires":[["9e6d65b2.c87f08"]]},{"id":"619707b6.87ff38","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1200,"y":2360,"wires":[["26c93799.9f28d8"],["504d570c.fd2ff8"]]},{"id":"26c93799.9f28d8","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"discoverWeeklyOffset = flow.get(\"20211Part2-OldOffset\");\nflow.set(\"20211Part2-OldOffset\",discoverWeeklyOffset+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '4RVONFu915xstm93er9ouf',\n        {offset: discoverWeeklyOffset}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1120,"y":2280,"wires":[["305f2d6a.4c3ec2"]]},{"id":"9e6d65b2.c87f08","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":990,"y":2360,"wires":[["619707b6.87ff38","9128477d.30f658"]]},{"id":"b1243a13.4f4458","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":770,"y":2420,"wires":[]},{"id":"9128477d.30f658","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1170,"y":2440,"wires":[]},{"id":"8e779643.bba058","type":"api-current-state","z":"4c9c764d.9c4468","name":"Sala escura?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"num","halt_if_compare":"is","override_topic":false,"entity_id":"sensor.sensor_de_luz_escritorio_aqara","state_type":"num","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":390,"y":2480,"wires":[["5f1a4b06.f08244"]]},{"id":"687f768e.e93778","type":"api-call-service","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi_homekit","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3330,"y":1340,"wires":[[]]},{"id":"711a179a.c64f68","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \"entity_id\": \"light.luz_do_quarto_nedi_homekit\",\n        \"rgb_color\": [255, 255, 255],\n        \"brightness_pct\": 100,\n        \"transition\": 100\n    }\n}};\nnode.send(newMsg);\n\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3000,"y":1340,"wires":[["e1b5f0cb.7c281"]]},{"id":"a4c1d4c6.6d3728","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"var newMsg;\nfor(var i = 0; i < 10 ; i++){\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_nedi_homekit\",\n            \"rgb_color\": [255, 255, 255],\n            \"brightness_step_pct\": 10,\n            \"transition\": 100\n        }\n    }};\n    node.send(newMsg);\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1720,"y":1620,"wires":[["1809ffbe.e26e3"]]},{"id":"b124077d.0096a8","type":"api-call-service","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi_homekit","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2090,"y":1620,"wires":[[]]},{"id":"1c4332ad.1287ad","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"0.5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1090,"y":1400,"wires":[["5e4ab241.037a1c"]]},{"id":"6470363b.a6fdf8","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Movimento ainda?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_corredor","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1290,"y":1460,"wires":[["95712e04.8cf36","ac0366ba.5808d8"]]},{"id":"95712e04.8cf36","type":"function","z":"d3db5d74.fb8fa","name":"Não tem","func":"if(msg.payload === false){\n    msg = {payload : {\"On\": false, \"on\": false}};\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1480,"y":1460,"wires":[["b27ad273.029bd"]]},{"id":"ac0366ba.5808d8","type":"function","z":"d3db5d74.fb8fa","name":"Ainda tem","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1480,"y":1520,"wires":[["4f18b6c5.078a28"]]},{"id":"cdc75df3.ca9f1","type":"function","z":"d3db5d74.fb8fa","name":"Não tem","func":"if(msg.payload === false){\n    msg = {payload : {\"On\": false, \"on\": false}};\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2120,"y":1580,"wires":[["1e482dbd.bfadb2"]]},{"id":"3674f800.e0fa78","type":"function","z":"d3db5d74.fb8fa","name":"Ainda tem","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2120,"y":1640,"wires":[["9087ade6.99d3"]]},{"id":"d4a80a5e.62fce8","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Movimento ainda?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"binary_sensor.movimento_corredor","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1930,"y":1580,"wires":[["cdc75df3.ca9f1","3674f800.e0fa78"]]},{"id":"179e2ea7.fa6e51","type":"inject","z":"e7cd1901.ee2408","name":"Status","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/15 15-23 * * *","once":true,"onceDelay":"360","topic":"Status","payload":"{\"Status\" : \"Status\"}","payloadType":"json","x":860,"y":740,"wires":[["2d1bfea1.069f92"]]},{"id":"c69fbd16.1b0b1","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":310,"y":3900,"wires":[["ae53388.ba33ac8"]]},{"id":"a362ed36.a2656","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":190,"y":2560,"wires":[["8e779643.bba058"]]},{"id":"e1b5f0cb.7c281","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"0,25","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3150,"y":1340,"wires":[["687f768e.e93778"]]},{"id":"1809ffbe.e26e3","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"0,25","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1890,"y":1620,"wires":[["b124077d.0096a8"]]},{"id":"265f1a78.958cc6","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":3230,"y":2600,"wires":[["9ce5e7cd.b362e8"]]},{"id":"c3384a0d.99e588","type":"spotify","z":"7b0de646.c85c78","name":"Getting Archive Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1800,"y":2600,"wires":[["59da4a38.554554","a53121dd.afa66"]]},{"id":"8135aec9.23e2b","type":"function","z":"7b0de646.c85c78","name":"My Morning Shuffle","func":"flow.set(\"2020-2022-ArrayAux\", msg.tracks)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '0ToZ2vbkCUjfLMy2VhrReY',\n        {offset: 0}\n    ]\n}\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1410,"y":2600,"wires":[["65032f85.61773"]]},{"id":"59da4a38.554554","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"MorningRoutine-OldAux\");\nvar oldArrayAux = flow.get(\"MorningRoutine-OldArrayAux\");\n\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"MorningRoutine-OldArrayAux\", newOldArrayAux);\nflow.set(\"MorningRoutine-OldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2020,"y":2600,"wires":[["28c0c5af.d0831a"]]},{"id":"11206594.8eb9aa","type":"inject","z":"7b0de646.c85c78","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"30 05 * * 2,4,6","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":2600,"wires":[["3c34d2ea.617d8e"]]},{"id":"3c34d2ea.617d8e","type":"function","z":"7b0de646.c85c78","name":"2020-2022","func":"var newMsg;\nflow.set(\"2020-2022-OldAux\", 0);\nflow.set(\"2020-2022-OldArrayAux\", []);\nflow.set(\"2020-2022-OldOffset\",100);\nflow.set(\"2020-2022-ArrayAux\", []);\nflow.set(\"MorningRoutine-OldAux\", 0);\nflow.set(\"MorningRoutine-OldArrayAux\", []);\nflow.set(\"MorningRoutine-Offset\",100);\nflow.set(\"MorningRoutine-ArrayAux\", []);\nnewMsg = {\n    \"params\":[\n        '4MMFbdbRfywp2lSB5umAqC'\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":350,"y":2600,"wires":[["fccf458a.3a6f68"]]},{"id":"b35304d.37ee2f8","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":2420,"y":2600,"wires":[["1e259e53.2aa942"],["e19985e9.30a968","8fa0848e.63a048"]]},{"id":"1e259e53.2aa942","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"discoverWeeklyOffset = flow.get(\"MorningRoutine-Offset\");\nflow.set(\"MorningRoutine-Offset\",discoverWeeklyOffset+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '0ToZ2vbkCUjfLMy2VhrReY',\n        {offset: discoverWeeklyOffset}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2340,"y":2520,"wires":[["c3384a0d.99e588"]]},{"id":"e19985e9.30a968","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"2020-2022-ArrayAux\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nvar i;\n        for(i=0; i<newTracks.length; i++) {\n            alreadyIn = false;\n            for(var j=0; j<oldTracks.length; j++) {\n                if(newTracks[i].track.id === oldTracks[j].track.id){\n                    alreadyIn = true\n                }\n            }\n            if(alreadyIn === false){\n                auxString = \"['\" + newTracks[i].track.uri + \"']\"\n                newMsg = {\n                    \"params\":[\n                        \"0ToZ2vbkCUjfLMy2VhrReY\",\n                        [newTracks[i].track.uri]\n                    ]}\n                node.send(newMsg);\n        \n            }\n        }\n        \nflow.set(\"2020-2022-OldArrayAux\", []);\nflow.set(\"2020-2022-ArrayAux\", []);\nflow.set(\"MorningRoutine-OldArrayAux\", []);\nflow.set(\"MorningRoutine-ArrayAux\", []);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2750,"y":2600,"wires":[["ad33768f.741e18","d77e883e.c5eb78"]]},{"id":"28c0c5af.d0831a","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2210,"y":2600,"wires":[["b35304d.37ee2f8"]]},{"id":"8fa0848e.63a048","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2740,"y":2680,"wires":[]},{"id":"65032f85.61773","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1600,"y":2600,"wires":[["c3384a0d.99e588"]]},{"id":"ad33768f.741e18","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2990,"y":2600,"wires":[["265f1a78.958cc6"]]},{"id":"d77e883e.c5eb78","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3030,"y":2680,"wires":[]},{"id":"9ce5e7cd.b362e8","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":3430,"y":2680,"wires":[]},{"id":"a53121dd.afa66","type":"debug","z":"7b0de646.c85c78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1990,"y":2660,"wires":[]},{"id":"fccf458a.3a6f68","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":600,"y":2600,"wires":[["eae2f166.4e90f","791ec161.594a1"]]},{"id":"eae2f166.4e90f","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"2020-2022-OldAux\");\nvar oldArrayAux = flow.get(\"2020-2022-OldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"2020-2022-OldArrayAux\", newOldArrayAux);\nflow.set(\"2020-2022-OldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux && msg.payload.next != null){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":800,"y":2600,"wires":[["3618d6e0.cb72ca"]]},{"id":"b977775e.fc19b8","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1200,"y":2600,"wires":[["ff6f4759.f661b8"],["8135aec9.23e2b"]]},{"id":"ff6f4759.f661b8","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"discoverWeeklyOffset = flow.get(\"2020-2022-OldOffset\");\nflow.set(\"2020-2022-OldOffset\",discoverWeeklyOffset+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '4MMFbdbRfywp2lSB5umAqC',\n        {offset: discoverWeeklyOffset}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1120,"y":2520,"wires":[["fccf458a.3a6f68"]]},{"id":"3618d6e0.cb72ca","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":990,"y":2600,"wires":[["b977775e.fc19b8","3ba21eea.0cbbc2"]]},{"id":"791ec161.594a1","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":770,"y":2660,"wires":[]},{"id":"3ba21eea.0cbbc2","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1170,"y":2680,"wires":[]},{"id":"e831ba3a.9c9b28","type":"inject","z":"d67ca66.293d758","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"On\":true}","payloadType":"json","x":660,"y":380,"wires":[["8c0cc7c1.3bbbb8"]]},{"id":"d0a29117.770ac","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"5a8bf4db.2d6bcc","x":870,"y":3000,"wires":[]},{"id":"b6af0d28.a7dd4","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2812cb35.9c26a4","x":1340,"y":4280,"wires":[]},{"id":"ee069fc5.e6d4c","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"60"},"mode":{"type":"str","value":"set"},"devices":["d8ed9c7b043348ac9c818217500cec95"]}},"x":3140,"y":4620,"wires":[[]]},{"id":"71f165bb.f5820c","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"40"},"mode":{"type":"str","value":"set"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":3140,"y":4380,"wires":[[]]},{"id":"1753c247.b897ce","type":"function","z":"444fced8.33ecb","name":"Set Volume 40 Cômodos Sociais","func":"msg = {\"type\": 'speakAtVolume', \n       \"payload\":{ \"type\": 'regular', \n                   \"text\": '                    ', \n                   \"volume\": 40,\n                   \"devices\": ['Cômodos Sociais']\n       }\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2880,"y":4380,"wires":[["71f165bb.f5820c"]]},{"id":"f4e7d4d5.298268","type":"function","z":"444fced8.33ecb","name":"Set Volume 60 Quartos","func":"msg = {\"type\": 'speakAtVolume', \n       \"payload\":{ \"type\": 'regular', \n                   \"text\": '                    ', \n                   \"volume\": 60,\n                   \"devices\": ['Quartos']\n       }\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2910,"y":4440,"wires":[["1193e2c9.d4d07d"]]},{"id":"a67b3bf.74e4bc8","type":"function","z":"444fced8.33ecb","name":"Set Volume 60 Cômodos Sociais","func":"msg = {\"type\": 'speakAtVolume', \n       \"payload\":{ \"type\": 'regular', \n                   \"text\": '                    ', \n                   \"volume\": 60,\n                   \"devices\": ['Cômodos Sociais']\n       }\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2880,"y":4560,"wires":[["361af739.569f88"]]},{"id":"9761914a.ad12a","type":"function","z":"444fced8.33ecb","name":"Set Volume 60 Quartos","func":"msg = {\"type\": 'speakAtVolume', \n       \"payload\":{ \"type\": 'regular', \n                   \"text\": '                    ', \n                   \"volume\": 60,\n                   \"devices\": ['Quartos']\n       }\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2910,"y":4620,"wires":[["ee069fc5.e6d4c"]]},{"id":"eb3e56ec.853718","type":"function","z":"444fced8.33ecb","name":"Set Volume 30 Cômodos Sociais","func":"msg = {\"type\": 'speakAtVolume', \n       \"payload\":{ \"type\": 'regular', \n                   \"text\": '                    ', \n                   \"volume\": 40,\n                   \"devices\": ['Cômodos Sociais']\n       }\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2880,"y":4740,"wires":[["48fde1ee.fb5ca"]]},{"id":"f9b19f0b.e31bd","type":"function","z":"444fced8.33ecb","name":"Set Volume 40 Quartos","func":"msg = {\"type\": 'speakAtVolume', \n       \"payload\":{ \"type\": 'regular', \n                   \"text\": '                    ', \n                   \"volume\": 40,\n                   \"devices\": ['Quartos']\n       }\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2910,"y":4800,"wires":[["dc1962fc.eed9a"]]},{"id":"e861b797.29c178","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2720,"y":4440,"wires":[["f4e7d4d5.298268"]]},{"id":"6dab6ec3.8804f","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2720,"y":4620,"wires":[["9761914a.ad12a"]]},{"id":"5e7560b5.d3604","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2720,"y":4800,"wires":[["f9b19f0b.e31bd"]]},{"id":"48fde1ee.fb5ca","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"40"},"mode":{"type":"str","value":"set"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":3140,"y":4740,"wires":[[]]},{"id":"361af739.569f88","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"60"},"mode":{"type":"str","value":"set"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":3140,"y":4560,"wires":[[]]},{"id":"a39bf2cc.88a75","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"node","payload":{"type":"serial","children":[{"type":"volume","payload":{"value":{"type":"num","value":"40"},"mode":{"type":"str","value":"set"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},{"type":"volume","payload":{"value":{"type":"num","value":"60"},"mode":{"type":"str","value":"set"},"devices":["d8ed9c7b043348ac9c818217500cec95"]}}]}},"x":3140,"y":4500,"wires":[[]]},{"id":"a7753783.9a05d8","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"node","payload":{"type":"serial","children":[{"type":"volume","payload":{"value":{"type":"num","value":"60"},"mode":{"type":"str","value":"set"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},{"type":"volume","payload":{"value":{"type":"num","value":"60"},"mode":{"type":"str","value":"set"},"devices":["d8ed9c7b043348ac9c818217500cec95"]}}]}},"x":3140,"y":4680,"wires":[[]]},{"id":"db6839bf.329518","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"node","payload":{"type":"serial","children":[{"type":"volume","payload":{"value":{"type":"num","value":"40"},"mode":{"type":"str","value":"set"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},{"type":"volume","payload":{"value":{"type":"num","value":"40"},"mode":{"type":"str","value":"set"},"devices":["d8ed9c7b043348ac9c818217500cec95"]}}]}},"x":3140,"y":4860,"wires":[[]]},{"id":"e3d50599.74e858","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"60","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2720,"y":4500,"wires":[["a39bf2cc.88a75"]]},{"id":"73a8a2fa.de07ec","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"60","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2720,"y":4680,"wires":[["a7753783.9a05d8"]]},{"id":"be3f51fd.42734","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"60","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2720,"y":4860,"wires":[["db6839bf.329518"]]},{"id":"4e4292d2.8e9b7c","type":"inject","z":"444fced8.33ecb","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":2570,"y":4340,"wires":[["faa3bd45.ad084"]]},{"id":"faa3bd45.ad084","type":"alexa-remote-echo","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","config":{"option":"get","value":{"what":"device","device":{"type":"str","value":"01ad947c2b044ca9bb59a7eade8383ab"}}},"x":2740,"y":4300,"wires":[["354c5350.e251ac"]]},{"id":"354c5350.e251ac","type":"debug","z":"444fced8.33ecb","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2970,"y":4280,"wires":[]},{"id":"4e624f3b.a6be7","type":"comment","z":"444fced8.33ecb","name":"Alexa Init","info":"","x":3640,"y":4460,"wires":[]},{"id":"c83c2094.8620e","type":"inject","z":"444fced8.33ecb","name":"4 Ore","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"14400","crontab":"","once":true,"onceDelay":"60","topic":"A","payload":"refresh","payloadType":"str","x":3770,"y":4520,"wires":[["c4aa73f2.628cd"]]},{"id":"d1a9bab0.1d8278","type":"inject","z":"444fced8.33ecb","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"Started!","payloadType":"str","x":3770,"y":4580,"wires":[["8481fed6.53b41"]]},{"id":"3fc4284d.63b8e8","type":"inject","z":"444fced8.33ecb","name":"5 Minuto","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"18000","crontab":"","once":true,"onceDelay":"40","topic":"A","payload":"true","payloadType":"bool","x":3640,"y":4660,"wires":[["be808341.db167"]]},{"id":"8481fed6.53b41","type":"change","z":"444fced8.33ecb","name":"set","rules":[{"t":"set","p":"payload","pt":"msg","to":"alexa","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":3950,"y":4580,"wires":[["c4aa73f2.628cd","4b9a17e2.739fd8"]]},{"id":"4b9a17e2.739fd8","type":"function","z":"444fced8.33ecb","name":"Valorizza","func":"global.set(\"alexa\", msg.payload);\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":4140,"y":4580,"wires":[[]]},{"id":"7623e172.fabbd","type":"function","z":"444fced8.33ecb","name":"","func":"//var x=global.get(\"Rain\");\nglobal.set(\"Alexa__\",0); \nif(msg.payload!=true)\n{\n msg.payload=\"refresh\";\n return msg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":4260,"y":4660,"wires":[["c4aa73f2.628cd"]]},{"id":"c4aa73f2.628cd","type":"alexa-remote-init","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","option":"initialise","x":4320,"y":4520,"wires":[["f8a70c94.64e7b"]]},{"id":"f8a70c94.64e7b","type":"change","z":"444fced8.33ecb","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.csrf","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":4500,"y":4520,"wires":[[]]},{"id":"e6eb4bb5.e56a88","type":"alexa-remote-other","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","config":{"option":"checkAuthentication"},"x":4000,"y":4660,"wires":[["7623e172.fabbd"]]},{"id":"be808341.db167","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"0","randomLast":"5","randomUnits":"seconds","drop":false,"x":3800,"y":4660,"wires":[["e6eb4bb5.e56a88"]]},{"id":"11dfae94.56b541","type":"catch","z":"444fced8.33ecb","name":"Check Authentication","scope":["e6eb4bb5.e56a88"],"uncaught":false,"x":3600,"y":4740,"wires":[["dcf250e7.7d62e"]]},{"id":"dcf250e7.7d62e","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3780,"y":4740,"wires":[["e6eb4bb5.e56a88"]]},{"id":"6079875b.47c588","type":"catch","z":"444fced8.33ecb","name":"Initialise","scope":["c4aa73f2.628cd"],"uncaught":false,"x":3820,"y":4460,"wires":[["b4aff410.944be8"]]},{"id":"b4aff410.944be8","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"delay","timeout":"30","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3950,"y":4460,"wires":[["b4c386c0.767c08"]]},{"id":"b4c386c0.767c08","type":"change","z":"444fced8.33ecb","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"refresh","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":4110,"y":4460,"wires":[["c4aa73f2.628cd"]]},{"id":"2643b3f7.84dd8c","type":"debug","z":"4c9c764d.9c4468","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":570,"y":1660,"wires":[]},{"id":"68f72c5a.9fa5f4","type":"api-current-state","z":"4c9c764d.9c4468","name":"TV da Sala","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"media_player.tv_da_sala","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":410,"y":1640,"wires":[["2643b3f7.84dd8c"]]},{"id":"481a161d.ec1f38","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":250,"y":1620,"wires":[["68f72c5a.9fa5f4"]]},{"id":"9ffba9b9.486ad8","type":"function","z":"444fced8.33ecb","name":"Hora da Festa","func":"if(((\n    msg.payload.description.summary.includes('hora')===true) &&\n    (\n    msg.payload.description.summary.includes('festa')===true ||\n    msg.payload.description.summary.includes('festas')===true ||\n    msg.payload.description.summary.includes('festinha')===true \n    ) &&(\n    msg.payload.description.summary.includes('forte')===true ||\n    msg.payload.description.summary.includes('hard')===true ||\n    msg.payload.description.summary.includes('de verdade')===true ||\n    msg.payload.description.summary.includes('pesada')===true \n    ) &&\n    msg.payload.description.summary.includes('leve')===false \n    \n    )){\n    \n    var newMsg;\n    global.set(\"boaNoiteCasa\", false)\n    newMsg= {\"payload\" : true};\n    return newMsg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2300,"y":1680,"wires":[["2aa0eca8.c6ac44"]]},{"id":"3b44b6ba.d930ba","type":"function","z":"444fced8.33ecb","name":"Hora da Festa","func":"if((\n    msg.payload.description.summary.includes('hora')===true) &&\n    msg.payload.description.summary.includes('festa')===true ||\n    msg.payload.description.summary.includes('festinha')===true &&\n    msg.payload.description.summary.includes('forte')===false && \n    msg.payload.description.summary.includes('hard')===false && \n    msg.payload.description.summary.includes('de verdade')===false&& \n    msg.payload.description.summary.includes('pesada')===false\n    ){\n    \n    var newMsg;\n    global.set(\"boaNoiteCasa\", false)\n    newMsg= {\"payload\" : true};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2300,"y":1740,"wires":[["e2fc2f6.6a235d"]]},{"id":"5f2b24be.7303cc","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"45","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":840,"y":3320,"wires":[["5be8420e.25cb1c"]]},{"id":"fbcaf420.0b0748","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1210,"y":3680,"wires":[["75578844.506568"]]},{"id":"cde6e589.1206d8","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"if(msg.payload === \"on\"){\n    var newMsg\n    for(var i = 0; i < 8 ; i++){\n        newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.projetor_ceu_local\",\n                \"rgb_color\": [255, 255, 255],\n                \"brightness_step_pct\": -10,\n                \"transition\": 100\n            }\n        }};\n        node.send(newMsg);\n        newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.projetor_ceu\",\n                \"rgb_color\": [255, 255, 255],\n                \"brightness_step_pct\": -10,\n                \"transition\": 100\n            }\n        }};\n        node.send(newMsg);\n    }\n    \n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \n            \"entity_id\": \"light.projetor_ceu_local\",\n            \"transition\": 100\n        }\n    }};\n    node.send(newMsg);    \n    \n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \n            \"entity_id\": \"light.projetor_ceu\",\n            \"transition\": 100\n        }\n    }};\n    node.send(newMsg);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1060,"y":3620,"wires":[["6914f5d8.6d03bc"]]},{"id":"8f189069.9fd68","type":"api-call-service","z":"859b066a.dd8128","name":"Projetor Céu","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.projetor_ceu_local, light.projetor_ceu","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1370,"y":3620,"wires":[[]]},{"id":"de7289f.2511178","type":"api-current-state","z":"859b066a.dd8128","name":"Projetor Céu","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.projetor_ceu_local","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":850,"y":3620,"wires":[["cde6e589.1206d8"]]},{"id":"6914f5d8.6d03bc","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1210,"y":3620,"wires":[["8f189069.9fd68"]]},{"id":"d9dccb7a.846bd8","type":"function","z":"859b066a.dd8128","name":"Turn Off","func":"if(msg.payload === \"on\"){\n    var newMsg\n    for(var i = 0; i < 7 ; i++){\n        newMsg= {payload : {\n            \"domain\": \"light\",\n            \"service\": \"turn_on\",\n            data:{\n                \n                \"entity_id\": \"light.abajur_quarto\",\n                \"rgb_color\": [255, 255, 255],\n                \"brightness_step_pct\": -10,\n                \"transition\": 100\n            }\n        }};\n        node.send(newMsg);\n    }\n    \n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \n            \"entity_id\": \"light.abajur_quarto\",\n            \"transition\": 100\n        }\n    }};\n    node.send(newMsg);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1060,"y":3560,"wires":[["b945fcbe.c1891"]]},{"id":"872ba870.407178","type":"api-call-service","z":"859b066a.dd8128","name":"Abajur Quarto","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.abajur_quarto","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1380,"y":3560,"wires":[[]]},{"id":"6153407f.e6c52","type":"api-current-state","z":"859b066a.dd8128","name":"Abajur Quarto","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.abajur_quarto","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":860,"y":3560,"wires":[["d9dccb7a.846bd8"]]},{"id":"b945fcbe.c1891","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1210,"y":3560,"wires":[["872ba870.407178"]]},{"id":"e811a5a3.9878d8","type":"server-state-changed","z":"4c9c764d.9c4468","name":"Movie Night Aux","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.movie_night","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":760,"y":1020,"wires":[["d86e7a62.6c6db8","fdb87cd7.4a536","7fd58a3e.124184","19554fb4.898e3","c4d0a5ba.4a5f78"]]},{"id":"71374a4e.f6c104","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2400,"y":3960,"wires":[["6f7b68ab.9cc3d8"]]},{"id":"6a4717d3.699a38","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2400,"y":3880,"wires":[["8f2e5163.64172"]]},{"id":"fb0bb1c0.fcb84","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2400,"y":3920,"wires":[["23a4e6a6.200c7a"]]},{"id":"30fd2b44.328e64","type":"api-call-service","z":"4c9c764d.9c4468","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"tts\",\"method\":\"all\"},\"message\":\"{{ [\\\"<speak> <say-as interpret-as='interjection'> graças a deus uma festinha</say-as></speak>\\\", \\\"<speak>  <say-as interpret-as='interjection'> olha </say-as></speak>\\\", \\\"<speak>  <say-as interpret-as='interjection'> oh </say-as> </speak>\\\", \\\"<speak>  <say-as interpret-as='interjection'> oba </say-as>, uma festinha. </speak>\\\", \\\"<speak>  <say-as interpret-as='interjection'> irra </say-as></speak>\\\", \\\"<speak>  <say-as interpret-as='interjection'> uh huh </say-as></speak>\\\", \\\"<speak>  <say-as interpret-as='interjection'> mano do céu </say-as>, eu tava esperando por isso. </speak>\\\",]|random }}\",\"target\":[\"media_player.echo_dot_da_sala\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":2450,"y":3660,"wires":[[]]},{"id":"44b9a31f.59ff2c","type":"function","z":"4c9c764d.9c4468","name":"Hora da Festa","func":"var newMsg;\nglobal.set(\"desabilitaAutomacao\", true)\nnewMsg= {\"payload\" : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"input_boolean.desabilita_automacao_sala_escritorio\"\n}\n}};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.boa_noite_casa\"\n        }\n    }};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_da_sala\",\n            \"rgb_color\": [255,0,0],\n            \"brightness_pct\": 1\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\",\n            \"rgb_color\": [0, 126, 255],\n            \"brightness_pct\": 20\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2\",\n            \"rgb_color\": [0,0,255],\n            \"brightness_pct\": 90\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_1\",\n            \"rgb_color\": [255,0,190],\n            \"brightness_pct\": 50\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_off\",\n    \"data\":{\n            \"entity_id\": \"input_boolean.party_light\"\n            \n}\n}};\nreturn newMsg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2660,"y":4100,"wires":[["7279c40d.0872fc"]]},{"id":"7279c40d.0872fc","type":"api-call-service","z":"4c9c764d.9c4468","name":"Luzes da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2860,"y":4100,"wires":[[]]},{"id":"8dfaf576.e71738","type":"random","z":"4c9c764d.9c4468","name":"","low":1,"high":"4","inte":"true","property":"payload","x":2310,"y":4160,"wires":[["432e097a.1761b8"]]},{"id":"432e097a.1761b8","type":"switch","z":"4c9c764d.9c4468","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"},{"t":"eq","v":"3","vt":"num"},{"t":"eq","v":"4","vt":"num"}],"checkall":"true","repair":false,"outputs":4,"x":2450,"y":4160,"wires":[["44b9a31f.59ff2c"],["2a7f89ca.2ba5e6"],["114da641.767a2a"],["7dca0e22.32a1e"]]},{"id":"2a7f89ca.2ba5e6","type":"function","z":"4c9c764d.9c4468","name":"Hora da Festa","func":"var newMsg;\nglobal.set(\"desabilitaAutomacao\", true)\nnewMsg= {\"payload\" : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"input_boolean.desabilita_automacao_sala_escritorio\"\n}\n}};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.boa_noite_casa\"\n        }\n    }};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_da_sala\",\n            \"hs_color\":[20, 100],\n            \"brightness_pct\": 1\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\",\n            \"rgb_color\": [0,255,0],\n            \"brightness_pct\": 60\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2\",\n            \"rgb_color\": [0,0,255],\n            \"brightness_pct\": 90\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2_hk\",\n            \"rgb_color\": [0,0,255],\n            \"brightness_pct\": 90\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_1\",\n            \"hs_color\":[310, 100],\n            \"brightness_pct\": 50\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_off\",\n    \"data\":{\n            \"entity_id\": \"input_boolean.party_light\"\n            \n}\n}};\nreturn newMsg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2660,"y":4160,"wires":[["1b71d4e5.25500b"]]},{"id":"1b71d4e5.25500b","type":"api-call-service","z":"4c9c764d.9c4468","name":"Luzes da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2860,"y":4160,"wires":[[]]},{"id":"114da641.767a2a","type":"function","z":"4c9c764d.9c4468","name":"Hora da Festa","func":"var newMsg;\nglobal.set(\"desabilitaAutomacao\", true)\nnewMsg= {\"payload\" : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"input_boolean.desabilita_automacao_sala_escritorio\"\n}\n}};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.boa_noite_casa\"\n        }\n    }};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_da_sala\",\n            \"rgb_color\": [0, 126, 255],\n            \"brightness_pct\": 1\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\",\n            \"rgb_color\": [255,0,190],\n            \"brightness_pct\": 50\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2\",\n            \"rgb_color\": [0,255,0],\n            \"brightness_pct\": 75\n}\n}};\nnode.send(newMsg);newMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2_hk\",\n            \"rgb_color\": [0,255,0],\n            \"brightness_pct\": 75\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_1\",\n            \"rgb_color\": [255,0,0],\n            \"brightness_pct\": 50\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_off\",\n    \"data\":{\n            \"entity_id\": \"input_boolean.party_light\"\n            \n}\n}};\nreturn newMsg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2660,"y":4220,"wires":[["e9a6efc7.4b8a"]]},{"id":"e9a6efc7.4b8a","type":"api-call-service","z":"4c9c764d.9c4468","name":"Luzes da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2860,"y":4220,"wires":[[]]},{"id":"227721b6.15b1ce","type":"random","z":"4c9c764d.9c4468","name":"","low":1,"high":"3","inte":"true","property":"payload","x":2300,"y":3780,"wires":[["53722731.f3a718"]]},{"id":"53722731.f3a718","type":"switch","z":"4c9c764d.9c4468","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"},{"t":"eq","v":"3","vt":"num"}],"checkall":"true","repair":false,"outputs":3,"x":2440,"y":3780,"wires":[["8f2e5163.64172"],["23a4e6a6.200c7a"],["6f7b68ab.9cc3d8"]]},{"id":"23a4e6a6.200c7a","type":"function","z":"4c9c764d.9c4468","name":"Hora da Festa","func":"var newMsg;\nglobal.set(\"desabilitaAutomacao\", true)\nnewMsg= {\"payload\" : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"input_boolean.desabilita_automacao_sala_escritorio\"\n}\n}};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.boa_noite_casa\"\n        }\n    }};\nnode.send(newMsg);\n\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_da_sala\",\n            \"rgb_color\": [120,0,255],\n            \"brightness_pct\": 2\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\",\n            \"effect\": \"Police\",\n            \"brightness_pct\": 100\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2\",\n            \"effect\": \"Strobe color\",\n            \"brightness_pct\": 100\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_1\",\n            \"effect\": \"Police\",\n            \"brightness_pct\": 100\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_cantinho\",\n            \"color_temp\": 370,\n            \"brightness_pct\": 100\n            \n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_da_sacada_sala\",\n            \"color_temp\": 370,\n            \"brightness_pct\": 100\n            \n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_off\",\n    \"data\":{\n            \"entity_id\": \"input_boolean.party_hard\"\n            \n}\n}};\nreturn newMsg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2650,"y":3780,"wires":[["19598cd4.0590b3"]]},{"id":"19598cd4.0590b3","type":"api-call-service","z":"4c9c764d.9c4468","name":"Luzes da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2850,"y":3780,"wires":[[]]},{"id":"6f7b68ab.9cc3d8","type":"function","z":"4c9c764d.9c4468","name":"Hora da Festa","func":"var newMsg;\nglobal.set(\"desabilitaAutomacao\", true)\nnewMsg= {\"payload\" : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"input_boolean.desabilita_automacao_sala_escritorio\"\n}\n}};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.boa_noite_casa\"\n        }\n    }};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_da_sala\",\n            \"effect\": \"Strobe color\",\n            \"brightness_pct\": 100\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\",\n            \"effect\": \"Police\",\n            \"brightness_pct\": 100\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2\",\n            \"effect\": \"Strobe color\",\n            \"brightness_pct\": 100\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_1\",\n            \"effect\": \"Police2\",\n            \"brightness_pct\": 100\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_cantinho\",\n            \"color_temp\": 370,\n            \"brightness_pct\": 100\n            \n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_da_sacada_sala\",\n            \"color_temp\": 370,\n            \"brightness_pct\": 100\n            \n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_off\",\n    \"data\":{\n            \"entity_id\": \"input_boolean.party_hard\"\n            \n}\n}};\nreturn newMsg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2650,"y":3840,"wires":[["512c844e.cb89ec"]]},{"id":"512c844e.cb89ec","type":"api-call-service","z":"4c9c764d.9c4468","name":"Luzes da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2850,"y":3840,"wires":[[]]},{"id":"8f2e5163.64172","type":"function","z":"4c9c764d.9c4468","name":"Hora da Festa","func":"var newMsg;\nglobal.set(\"desabilitaAutomacao\", true)\nnewMsg= {\"payload\" : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"input_boolean.desabilita_automacao_sala_escritorio\"\n}\n}};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.boa_noite_casa\"\n        }\n    }};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_da_sala\",\n            \"rgb_color\": [0,0,255],\n            \"brightness_pct\": 2\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\",\n            \"effect\": \"Strobe color\",\n            \"brightness_pct\": 100\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2\",\n            \"effect\": \"Strobe color\",\n            \"brightness_pct\": 100\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_1\",\n            \"effect\": \"Police\",\n            \"brightness_pct\": 100\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_cantinho\",\n            \"color_temp\": 370,\n            \"brightness_pct\": 100\n            \n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_da_sacada_sala\",\n            \"color_temp\": 370,\n            \"brightness_pct\": 100\n            \n}\n}};\n\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_off\",\n    \"data\":{\n            \"entity_id\": \"input_boolean.party_hard\"\n            \n}\n}};\nreturn newMsg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2650,"y":3720,"wires":[["c24a0a38.cf1658"]]},{"id":"c24a0a38.cf1658","type":"api-call-service","z":"4c9c764d.9c4468","name":"Luzes da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2850,"y":3720,"wires":[[]]},{"id":"5c1f9823.9bac58","type":"api-call-service","z":"4c9c764d.9c4468","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"tts\",\"method\":\"all\"},\"message\":\"{{ [\\\"<speak> <say-as interpret-as='interjection'> graças a deus uma festinha</say-as></speak>\\\", \\\"<speak>  <say-as interpret-as='interjection'> olha </say-as></speak>\\\", \\\"<speak>  <say-as interpret-as='interjection'> oh </say-as> </speak>\\\", \\\"<speak>  <say-as interpret-as='interjection'> oba </say-as>, uma festinha. </speak>\\\", \\\"<speak>  <say-as interpret-as='interjection'> irra </say-as></speak>\\\", \\\"<speak>  <say-as interpret-as='interjection'> uh huh </say-as></speak>\\\", \\\"<speak>  <say-as interpret-as='interjection'> mano do céu </say-as>, eu tava esperando por isso. </speak>\\\",]|random }}\",\"target\":[\"media_player.echo_dot_da_sala\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":2470,"y":4040,"wires":[[]]},{"id":"982e720d.5f2fe","type":"alexa-remote-routine","z":"4c9c764d.9c4468","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"60"},"mode":{"type":"str","value":"set"},"devices":["G090XG0793643C6P"]}},"x":2320,"y":3840,"wires":[[]]},{"id":"9dd9c8b4.32a778","type":"alexa-remote-routine","z":"4c9c764d.9c4468","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"60"},"mode":{"type":"str","value":"set"},"devices":["G090XG0793643C6P"]}},"x":2330,"y":4220,"wires":[[]]},{"id":"a8c761f.ed107a","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2400,"y":4340,"wires":[["114da641.767a2a"]]},{"id":"b4e77447.b01b08","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2400,"y":4260,"wires":[["44b9a31f.59ff2c"]]},{"id":"e5936cb8.0ad07","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2400,"y":4300,"wires":[["2a7f89ca.2ba5e6"]]},{"id":"84b8b1ac.144b","type":"server-state-changed","z":"4c9c764d.9c4468","name":"Party Hard Aux","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.party_hard","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":1920,"y":3800,"wires":[["5ec51c8b.479884"]]},{"id":"aebb219f.72dd4","type":"server-state-changed","z":"4c9c764d.9c4468","name":"Party Light Aux","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.party_light","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":1860,"y":4160,"wires":[["3366a6c6.12a74a"]]},{"id":"91f02b78.556ca8","type":"link in","z":"4c9c764d.9c4468","name":"Party Hard","links":["2aa0eca8.c6ac44","bc5ccdba.472318"],"x":1975,"y":3720,"wires":[["5ec51c8b.479884"]]},{"id":"35f3e816.3c0708","type":"link in","z":"4c9c764d.9c4468","name":"Party Light","links":["e2fc2f6.6a235d","b6a68443.c552d"],"x":1935,"y":4060,"wires":[["3366a6c6.12a74a"]]},{"id":"2aa0eca8.c6ac44","type":"link out","z":"444fced8.33ecb","name":"Party Hard","links":["91f02b78.556ca8","4cf81eb1.96baa","6998c13b.6eaeb"],"x":2435,"y":1680,"wires":[]},{"id":"e2fc2f6.6a235d","type":"link out","z":"444fced8.33ecb","name":"Party Light","links":["35f3e816.3c0708","4cf81eb1.96baa","6998c13b.6eaeb"],"x":2435,"y":1740,"wires":[]},{"id":"1698060.e974ffa","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2320,"y":4040,"wires":[["5c1f9823.9bac58"]]},{"id":"76bcef83.4fcaa","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2300,"y":3660,"wires":[["30fd2b44.328e64"]]},{"id":"21d08a78.8505b6","type":"link out","z":"444fced8.33ecb","name":"Café","links":["664e017f.72259"],"x":715,"y":1320,"wires":[]},{"id":"664e017f.72259","type":"link in","z":"d67ca66.293d758","name":"Café","links":["21d08a78.8505b6"],"x":455,"y":1680,"wires":[["64fce5b5.d5d89c"]]},{"id":"3563e0c5.dee9c","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2180,"y":600,"wires":[["4e83d610.850008"]]},{"id":"1b872ca8.a6a9c3","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2180,"y":660,"wires":[["3067d64b.235f7a"]]},{"id":"f0e2c5bc.1b5a88","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2180,"y":720,"wires":[["d954a94f.87d838"]]},{"id":"36f0e7bb.f40568","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2180,"y":780,"wires":[["191701e1.2efd8e"]]},{"id":"8911b89e.7ee178","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2180,"y":840,"wires":[["ad86ca5.ad85838","21183082.f248d","ce76280d.0e7218"]]},{"id":"e90008ad.d910a8","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2180,"y":940,"wires":[["ccb67883.599c78"]]},{"id":"21183082.f248d","type":"delay","z":"554bb518.994efc","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2480,"y":900,"wires":[["673f981.34a9268"]]},{"id":"ce76280d.0e7218","type":"delay","z":"554bb518.994efc","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2600,"y":800,"wires":[["943216a9.4f8a28"]]},{"id":"f4382c36.b84e4","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2180,"y":1000,"wires":[["2f101a.08d7bfe6"]]},{"id":"ea9563a1.cc5fa","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= { \"payload\": \"Olá\", \"data\": { \"type\": \"tts\" }, \"target\": \"media_player.echo_dot_da_sala\" };\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3130,"y":980,"wires":[["333c90f6.f25c5"]]},{"id":"e455ebf6.0d0028","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2980,"y":980,"wires":[["ea9563a1.cc5fa"]]},{"id":"522be0ba.84b38","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"amzn_sfx_doorbell_01\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":3130,"y":180,"wires":[["b0c9a798.37fb28"]]},{"id":"239f312c.9f235e","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2980,"y":180,"wires":[["522be0ba.84b38"]]},{"id":"afe751bc.f78aa","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"amzn_sfx_doorbell_chime_01\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":3130,"y":240,"wires":[["4555018d.fb997"]]},{"id":"1e22f525.97844b","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2980,"y":240,"wires":[["afe751bc.f78aa"]]},{"id":"ddbb56d9.1f99e8","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_do_quarto_nedi\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_do_quarto_nedi\",\n      \"media_content_id\": \"amzn_sfx_doorbell_chime_02\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":3130,"y":300,"wires":[["fe559c92.31d48"]]},{"id":"d5c0d02c.dc638","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2980,"y":300,"wires":[["ddbb56d9.1f99e8"]]},{"id":"ac7edf48.5e3c8","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"christmas_05\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":3130,"y":360,"wires":[["8d24b86d.787548"]]},{"id":"9d7d03c9.e8e3b","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2980,"y":360,"wires":[["ac7edf48.5e3c8"]]},{"id":"ed44080.a0346f8","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"horror_10\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3130,"y":420,"wires":[["d2680b42.5fc438"]]},{"id":"87256e29.91a32","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2980,"y":420,"wires":[["ed44080.a0346f8"]]},{"id":"ddb104a8.a32b38","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"amzn_sfx_large_crowd_cheer_01\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":3130,"y":480,"wires":[["997de98c.c96c78"]]},{"id":"43279234.2483fc","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2980,"y":480,"wires":[["ddb104a8.a32b38"]]},{"id":"a1b2607e.a7c11","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"zap_01\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":3130,"y":540,"wires":[["b484c1ff.6d887"]]},{"id":"ba17a8b1.4a3f88","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2980,"y":540,"wires":[["a1b2607e.a7c11"]]},{"id":"7c2c2ecf.97abc","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"clock_01\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3130,"y":600,"wires":[["ea833d8f.09831"]]},{"id":"38247ffd.07108","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2980,"y":600,"wires":[["7c2c2ecf.97abc"]]},{"id":"babdc3fd.b0a3c","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"amzn_sfx_rooster_crow_01\",\n      \"media_content_type\": \"sound\"\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":3130,"y":660,"wires":[["e9a9636f.73b6e"]]},{"id":"4e2c379a.1d69b8","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2980,"y":660,"wires":[["babdc3fd.b0a3c"]]},{"id":"64313d21.dd34f4","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"Alexa.Joke.Play\",\n      \"media_content_type\": \"sequence\"\n  }}\n};\nreturn newMsg;\n\n\n/*\noutras sequencias:\n\nAlexa.Weather.Play\nAlexa.Traffic.Play\nAlexa.FlashBriefing.Play\nAlexa.GoodMorning.Play\nAlexa.GoodNight.Play\nAlexa.SingASong.Play\nAlexa.TellStory.Play\nAlexa.FunFact.Play\nAlexa.Joke.Play\nAlexa.Music.PlaySearchPhrase\nAlexa.Calendar.PlayTomorrow\nAlexa.Calendar.PlayToday\nAlexa.Calendar.PlayNext\nAlexa.CleanUp.Play\nAlexa.ImHome.Play\n*/\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3130,"y":760,"wires":[["cade9394.1ebb2"]]},{"id":"28c12a06.8faa26","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2980,"y":760,"wires":[["64313d21.dd34f4"]]},{"id":"c7f08716.397bf8","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_sala\",\n  \"data\":{\n      \"entity_id\": \"media_player.echo_dot_da_sala\",\n      \"media_content_id\": \"Alexa.Music.PlaySearchPhrase\",\n      \"media_content_type\": \"sequence\"\n  }}\n};\nreturn newMsg;\n\n\n/*\noutras sequencias:\n\nAlexa.Weather.Play\nAlexa.Traffic.Play\nAlexa.FlashBriefing.Play\nAlexa.GoodMorning.Play\nAlexa.GoodNight.Play\nAlexa.SingASong.Play\nAlexa.TellStory.Play\nAlexa.FunFact.Play\nAlexa.Joke.Play\nAlexa.Music.PlaySearchPhrase\nAlexa.Calendar.PlayTomorrow\nAlexa.Calendar.PlayToday\nAlexa.Calendar.PlayNext\nAlexa.CleanUp.Play\nAlexa.ImHome.Play\n*/\n","outputs":1,"noerr":0,"x":3130,"y":820,"wires":[["63afd282.4cb80c"]]},{"id":"636a6719.5410d8","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2980,"y":820,"wires":[["c7f08716.397bf8"]]},{"id":"6f58a398.14caec","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_do_quarto\",\n  \"data\":{\n          \"entity_id\": \"media_player.echo_dot_do_quarto\",\n          \"media_content_id\": \"Teste\",\n          \"media_content_type\": \"routine\"\n\n  }}\n};\nreturn newMsg;","outputs":1,"noerr":0,"x":3130,"y":900,"wires":[["8bcf7c45.f1046"]]},{"id":"f45919f0.e35dd8","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2980,"y":900,"wires":[["6f58a398.14caec"]]},{"id":"e66568fa.e2d8d8","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2180,"y":1060,"wires":[["4801689d.7302e8"]]},{"id":"12a7da02.249c76","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= { \"payload\": \"Olá\", \"data\": { \"type\": \"tts\" }, \"target\": \"alexa_media_echo_dot_da_sala\" };\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3130,"y":1060,"wires":[["8cdddac9.ed2258"]]},{"id":"5bcde95e.c27598","type":"inject","z":"554bb518.994efc","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2980,"y":1060,"wires":[["12a7da02.249c76"]]},{"id":"4e83d610.850008","type":"alexa-remote-routine","z":"554bb518.994efc","name":"Fala rouca","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"ssml","text":{"type":"ssml","value":"<speak><prosody pitch=\"-50%\" \trate=\"80%\" volume=\"+0dB\">\tIsto é um teste! <break time='100ms'/> Como posso te ajudar? \t</prosody></speak>"},"devices":["7c757a5cc13e48da91a35e14b6ac58f3"]}},"x":2350,"y":600,"wires":[[]]},{"id":"3067d64b.235f7a","type":"alexa-remote-routine","z":"554bb518.994efc","name":"Fala \"soft\"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"ssml","text":{"type":"ssml","value":"<speak><amazon:effect phonation=\"soft\">\tIsto é um teste! <break time='100ms'/> Como posso te ajudar? \t</amazon:effect></speak>"},"devices":["G090XG0793643C6P"]}},"x":2350,"y":660,"wires":[[]]},{"id":"d954a94f.87d838","type":"alexa-remote-routine","z":"554bb518.994efc","name":"Fala que nem monstro","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"ssml","text":{"type":"ssml","value":"<speak><amazon:effect vocal-tract-length=\"+80%\">\tIsto é um teste! <break time='100ms'/> Como posso te ajudar? \t</amazon:effect></speak>"},"devices":["G090XG0793643C6P"]}},"x":2380,"y":720,"wires":[[]]},{"id":"191701e1.2efd8e","type":"alexa-remote-routine","z":"554bb518.994efc","name":"Rapido cochicho ","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"ssml","text":{"type":"ssml","value":"<speak>   <prosody rate=\"150%\" pitch=      \"+50%\"                         volume      =      \"x-soft\">    Rapido cuchicho   </prosody> </speak>"},"devices":["G090XG0793643C6P"]}},"x":2370,"y":780,"wires":[[]]},{"id":"943216a9.4f8a28","type":"alexa-remote-routine","z":"554bb518.994efc","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"ssml","text":{"type":"ssml","value":"<speak>     <prosody volume=\"x-loud\"><amazon:effect name=\"whispered\">Eu não sou um humano real </amazon:effect></prosody> </speak>"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":2800,"y":800,"wires":[[]]},{"id":"ccb67883.599c78","type":"alexa-remote-routine","z":"554bb518.994efc","name":"Wow","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"ssml","text":{"type":"ssml","value":"<speak>     <say-as interpret-as=\"interjection\">Wow</say-as>, Não vi isso vindo </speak>\t"},"devices":["G090XG0793643C6P"]}},"x":2330,"y":940,"wires":[[]]},{"id":"ad86ca5.ad85838","type":"alexa-remote-routine","z":"554bb518.994efc","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":""},"volume":{"type":"num","value":"100"},"mode":"set","devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":2510,"y":840,"wires":[[]]},{"id":"673f981.34a9268","type":"alexa-remote-routine","z":"554bb518.994efc","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":""},"volume":{"type":"num","value":"40"},"mode":"set","devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":2730,"y":900,"wires":[[]]},{"id":"2f101a.08d7bfe6","type":"alexa-remote-routine","z":"554bb518.994efc","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"ssml","text":{"type":"ssml","value":"<speak> <voice name=\"Kendra\"><lang xml:lang=\"en-US\">Normal speech.   <amazon:emotion name=\"excited\" intensity=\"medium\"> I am excited - medium.  </amazon:emotion>  <amazon:emotion name=\"excited\" intensity=\"medium\"> I am excited - medium.  </amazon:emotion>  <amazon:emotion name=\"excited\" intensity=\"low\"> I am excited - low.  </amazon:emotion>  <amazon:emotion name=\"excited\" intensity=\"high\"> I am excited - high.  </amazon:emotion>  Now back to normal speech. </lang></voice></speak>"},"devices":["G090XG0793643C6P"]}},"x":2360,"y":1000,"wires":[[]]},{"id":"4801689d.7302e8","type":"alexa-remote-routine","z":"554bb518.994efc","name":"Varias vozes","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"ssml","text":{"type":"str","value":"<speak> Posso ficar mudando <voice name=\"Ricardo\">pra voz do Ricardo</voice> <voice name=\"Camila\">pra voz da Camila, ou </voice>, <lang xml:lang=\"en-US\"> <voice name=\"Joanna\">And change languages mid-sentence, and even change to other voices in these languages like, </voice>   <voice name=\"Ivy\">to Ivy</voice>  <voice name=\"Joanna\">to Joanna</voice>  <voice name=\"Joey\">to Joey</voice>  <voice name=\"Justin\">to Justin</voice>  <voice name=\"Kendra\">to Kendra</voice>  <voice name=\"Kimberly\">to Kimberly</voice>  <voice name=\"Matthew\">to Matthew</voice>  <voice name=\"Salli\">to Salli</voice>  </lang>  </speak>"},"volume":{"type":"num","value":"50"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":2350,"y":1060,"wires":[[]]},{"id":"333c90f6.f25c5","type":"api-call-service","z":"554bb518.994efc","name":"Alexa fala Olá pelo HA","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{target}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3340,"y":980,"wires":[[]]},{"id":"b0c9a798.37fb28","type":"api-call-service","z":"554bb518.994efc","name":"Alexa toca campainha 1","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3350,"y":180,"wires":[[]]},{"id":"4555018d.fb997","type":"api-call-service","z":"554bb518.994efc","name":"Alexa toca campainha 2","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3350,"y":240,"wires":[[]]},{"id":"fe559c92.31d48","type":"api-call-service","z":"554bb518.994efc","name":"Alexa toca campainha 3","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3350,"y":300,"wires":[[]]},{"id":"8d24b86d.787548","type":"api-call-service","z":"554bb518.994efc","name":"Alexa som de natal","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3330,"y":360,"wires":[[]]},{"id":"d2680b42.5fc438","type":"api-call-service","z":"554bb518.994efc","name":"Alexa barulho de terror","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3340,"y":420,"wires":[[]]},{"id":"997de98c.c96c78","type":"api-call-service","z":"554bb518.994efc","name":"Alexa cheer","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3310,"y":480,"wires":[[]]},{"id":"b484c1ff.6d887","type":"api-call-service","z":"554bb518.994efc","name":"Alexa barulho de zap","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3340,"y":540,"wires":[[]]},{"id":"ea833d8f.09831","type":"api-call-service","z":"554bb518.994efc","name":"Alexa barulho de relogio","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3350,"y":600,"wires":[[]]},{"id":"e9a9636f.73b6e","type":"api-call-service","z":"554bb518.994efc","name":"Alexa barulho de galo","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3340,"y":660,"wires":[[]]},{"id":"cade9394.1ebb2","type":"api-call-service","z":"554bb518.994efc","name":"Alexa conta piada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3330,"y":760,"wires":[[]]},{"id":"63afd282.4cb80c","type":"api-call-service","z":"554bb518.994efc","name":"Alexa conta piada","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3330,"y":820,"wires":[[]]},{"id":"8bcf7c45.f1046","type":"api-call-service","z":"554bb518.994efc","name":"Liga rotina da Alexa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3330,"y":900,"wires":[[]]},{"id":"8cdddac9.ed2258","type":"api-call-service","z":"554bb518.994efc","name":"Alexa anuncia Olá pelo HA","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media_echo_dot_do_quarto","entityId":"","data":"{\"message\":\"{{payload}}\",\"data\":{\"type\":\"tts\"},\"target\":\"{{service}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":3360,"y":1060,"wires":[[]]},{"id":"484bb2c6.3482bc","type":"api-call-service","z":"4c9c764d.9c4468","name":"Playstation","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":3170,"y":280,"wires":[[]]},{"id":"a92c0a2c.407ec8","type":"switch","z":"4c9c764d.9c4468","name":"","property":"payload.state.on","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"false","repair":false,"outputs":2,"x":3530,"y":340,"wires":[["b42a26aa.e7b388"],["55201690.f74958","b4eab79e.038f88"]]},{"id":"b42a26aa.e7b388","type":"function","z":"4c9c764d.9c4468","name":"Turn On Dim","func":"msg.payload = {\"on\": true,\"bri\":50, \"ct\": 3500};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3770,"y":300,"wires":[["207623bf.d7258c"]]},{"id":"55201690.f74958","type":"function","z":"4c9c764d.9c4468","name":"Turn On Color","func":"msg.payload = {\"on\": true, \"bri\":15, \"hex\": \"32FFC1\"};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3780,"y":360,"wires":[["e6f965ad.6787b8"]]},{"id":"ace47689.a7dfe8","type":"function","z":"4c9c764d.9c4468","name":"Trigger","func":"flow.set(\"triggered\", true);\nmsg = {\"payload\": {\"status\": \"status\"}};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2960,"y":340,"wires":[["c90c495d.dc7a88"]]},{"id":"ef258f42.fbfd","type":"function","z":"4c9c764d.9c4468","name":"Was Triggered?","func":"if(flow.set(\"triggered\")===true){\n    flow.set(\"triggered\", false);\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3380,"y":340,"wires":[["a92c0a2c.407ec8"]]},{"id":"10281ea8.c36541","type":"yeelight-compat-hue-state","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":3190,"y":340,"wires":[["ef258f42.fbfd"]]},{"id":"207623bf.d7258c","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":4090,"y":300,"wires":[]},{"id":"e6f965ad.6787b8","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":4090,"y":360,"wires":[]},{"id":"3d045ff7.d9f0d","type":"switch","z":"4c9c764d.9c4468","name":"","property":"payload.state.on","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"false","repair":false,"outputs":2,"x":3530,"y":460,"wires":[["83f0ccb0.97456"],["9543370.38aaac8","b4eab79e.038f88"]]},{"id":"83f0ccb0.97456","type":"function","z":"4c9c764d.9c4468","name":"Turn On Dim","func":"msg.payload = {\"on\": true,\"bri\":50, \"ct\": 3500};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3770,"y":420,"wires":[["bfc0ee8f.6934b"]]},{"id":"9543370.38aaac8","type":"function","z":"4c9c764d.9c4468","name":"Turn On Color","func":"msg.payload = {\"on\": true, \"bri\":15, \"hex\": \"32FFC1\"};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3780,"y":480,"wires":[["cad6877a.b87b68"]]},{"id":"25167b60.406d24","type":"function","z":"4c9c764d.9c4468","name":"Trigger","func":"flow.set(\"triggered2\", true);\nmsg = {\"payload\": {\"status\": \"status\"}};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2960,"y":460,"wires":[["57659679.a9ee18"]]},{"id":"cd3e29c3.2bb188","type":"function","z":"4c9c764d.9c4468","name":"Was Triggered?","func":"if(flow.set(\"triggered2\")===true){\n    flow.set(\"triggered2\", false);\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3380,"y":460,"wires":[["3d045ff7.d9f0d"]]},{"id":"7410bb38.fd2a44","type":"yeelight-compat-hue-state","z":"4c9c764d.9c4468","name":"","server":"14b837c9.ab10c","x":3190,"y":460,"wires":[["cd3e29c3.2bb188"]]},{"id":"387af76.4f3a508","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"14b837c9.ab10c","x":4090,"y":420,"wires":[]},{"id":"cad6877a.b87b68","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"14b837c9.ab10c","x":4090,"y":480,"wires":[]},{"id":"b0e030f3.b2189","type":"api-call-service","z":"4c9c764d.9c4468","name":"Luminária","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":3960,"y":560,"wires":[[]]},{"id":"b4eab79e.038f88","type":"function","z":"4c9c764d.9c4468","name":"Turn Off","func":"    var newMsg;\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.luminaria_esquerda\",\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.luminaria_direita\",\n        }\n    }\n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3802,"y":560,"wires":[["b0e030f3.b2189"]]},{"id":"a813c358.8a787","type":"api-call-service","z":"4c9c764d.9c4468","name":"Playstation","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"turn_on","entityId":"","data":"","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":false,"x":3150,"y":980,"wires":[[]]},{"id":"98505d09.b9fed","type":"function","z":"4c9c764d.9c4468","name":"Turn On Color","func":"msg.payload = {\"on\": true, \"bri\":15, \"hex\": \"32FFC1\"};\n\n    node.send(msg);\n    node.status({text:\"Ligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2980,"y":1040,"wires":[["6d740173.6fe3"]]},{"id":"df0a39de.b474d8","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"2db68ab1.bee496","x":3350,"y":1040,"wires":[]},{"id":"d1028b2c.e09638","type":"alexa-remote-routine","z":"4c9c764d.9c4468","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"Bom jogo."},"volume":{"type":"num","value":"50"},"mode":"set","devices":["G090XG0793643C6P"]}},"x":3310,"y":520,"wires":[[]]},{"id":"ee11e7c0.449218","type":"function","z":"4c9c764d.9c4468","name":"Playstation","func":"\n    var newMsg;\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_on\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_HDMI3\"\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"select_source\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"source\": \"Playstation\"\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\"\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\"\n        }\n    }        \n    \n    node.send(newMsg);\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.abajur_escritorio\",\n        }\n    }\n    node.send(newMsg);\n    newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.luminaria_esquerda\",\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_off\",\n        \"data\":{\n          \"entity_id\": \"switch.luminaria_direita\",\n        }\n    }\n    return newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2970,"y":980,"wires":[["a813c358.8a787"]]},{"id":"a5f866b.8f8ad98","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"20","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":3000,"y":520,"wires":[["d1028b2c.e09638"]]},{"id":"38c6a7b9.d8a1b8","type":"function","z":"4c9c764d.9c4468","name":"Aux","func":"var newMsg;\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_on\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"play_media\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"media_content_type\": \"send_key\",\n          \"media_content_id\": \"ST_HDMI3\"\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"select_source\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n          \"source\": \"Playstation\"\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_sala\"\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\"\n        }\n    }\n    return newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2950,"y":280,"wires":[["484bb2c6.3482bc"]]},{"id":"a437492d.b8ac28","type":"function","z":"4c9c764d.9c4468","name":"Turn Off","func":"msg.payload = {\"on\": false};\n\n    node.send(msg);\n    node.status({text:\"Desligou\"});\n    setTimeout(function(){\n    node.status({text:\"\"});\n    }, 3000);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2960,"y":860,"wires":[["19d9ed37.0838c3"]]},{"id":"1bc5fd0f.4cf593","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"56814891.18c868","x":3340,"y":860,"wires":[]},{"id":"2c958f27.a2346","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"5a8bf4db.2d6bcc","x":3330,"y":920,"wires":[]},{"id":"eede83b3.2ef5f","type":"function","z":"4c9c764d.9c4468","name":"Desliga Automação","func":"    var newMsg;\n    global.set(\"desabilitaAutomacao\", true);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_on\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.desabilita_automacao_sala_escritorio\"\n        }\n    }};\n    return newMsg;\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2990,"y":720,"wires":[["6dd3e8cf.7f2b38","27b691cc.d441ee"]]},{"id":"27b691cc.d441ee","type":"api-call-service","z":"4c9c764d.9c4468","name":"Desabilita Automação","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_boolean","service":"turn_on","entityId":"input_boolean.desabilita_automacao_sala_escritorio","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3581,"y":720,"wires":[[]]},{"id":"2d1303c9.c9d70c","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3361,"y":780,"wires":[["27b691cc.d441ee","9f15e3c0.0b3ba"]]},{"id":"6dd3e8cf.7f2b38","type":"function","z":"4c9c764d.9c4468","name":"Desliga Automação","func":"    var newMsg;\n    \n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.desabilita_automacao_sala_escritorio\"\n        }\n    }};\n    return newMsg;\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3191,"y":780,"wires":[["2d1303c9.c9d70c"]]},{"id":"9f15e3c0.0b3ba","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"hours","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3540,"y":820,"wires":[["cfdfd47a.636cb8"]]},{"id":"cfdfd47a.636cb8","type":"function","z":"4c9c764d.9c4468","name":"Reset Aux Var","func":"global.set(\"desabilitaAutomacao\", false)\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3710,"y":820,"wires":[[]]},{"id":"f469cf49.5337e","type":"yeelight-compat-hue-out","z":"4c9c764d.9c4468","name":"","server":"14b837c9.ab10c","x":3350,"y":1100,"wires":[]},{"id":"42fdbcf3.547684","type":"server-state-changed","z":"4c9c764d.9c4468","name":"Play Time Aux","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.play_time","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":2670,"y":820,"wires":[["98505d09.b9fed","ee11e7c0.449218","a5f866b.8f8ad98","a437492d.b8ac28"]]},{"id":"5897cddc.af32a4","type":"function","z":"4c9c764d.9c4468","name":"Jogando?","func":"var ocupado = global.get(\"tvAuxPlay\");\nif(ocupado === false){\n    if(msg.data.new_state.attributes.media_title === \"Playstation\"){\n        global.set(\"tvAuxPlay\", true);\n        return {payload: \"playing\"};\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2660,"y":380,"wires":[["ace47689.a7dfe8","25167b60.406d24","a5f866b.8f8ad98","38c6a7b9.d8a1b8","a437492d.b8ac28","eede83b3.2ef5f"]]},{"id":"fd4599ce.6285e8","type":"server-state-changed","z":"4c9c764d.9c4468","name":"Playstation?","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"media_player.tv_da_sala","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":2490,"y":380,"wires":[["5897cddc.af32a4"]]},{"id":"a5260402.42df78","type":"link in","z":"4c9c764d.9c4468","name":"Playstation","links":["688bdd9c.1b1b54"],"x":2715,"y":260,"wires":[["38c6a7b9.d8a1b8","ace47689.a7dfe8","25167b60.406d24","a5f866b.8f8ad98","eede83b3.2ef5f","a437492d.b8ac28"]]},{"id":"5bc1e831.a641f8","type":"link in","z":"4c9c764d.9c4468","name":"Hora do jogo","links":["77851ffb.f998f"],"x":2715,"y":980,"wires":[["a5f866b.8f8ad98","eede83b3.2ef5f","a437492d.b8ac28","ee11e7c0.449218","98505d09.b9fed"]]},{"id":"77851ffb.f998f","type":"link out","z":"444fced8.33ecb","name":"Hora do Jogo","links":["5bc1e831.a641f8"],"x":2465,"y":620,"wires":[]},{"id":"688bdd9c.1b1b54","type":"link out","z":"444fced8.33ecb","name":"Playstation","links":["a5260402.42df78"],"x":2455,"y":560,"wires":[]},{"id":"be0b4dbe.3a5e1","type":"mqtt out","z":"859b066a.dd8128","name":"Rainbow Slow","topic":"QuartoNedi/setMode08","qos":"0","retain":"false","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"64936db9.640564","x":1220,"y":2340,"wires":[]},{"id":"88e44919.c42b18","type":"function","z":"859b066a.dd8128","d":true,"name":"Liga","func":"msg = {payload:1};\nreturn msg;","outputs":1,"noerr":0,"x":790,"y":2340,"wires":[["be0b4dbe.3a5e1"]]},{"id":"fe379991.b2d528","type":"function","z":"859b066a.dd8128","name":"Pouco brilho e turquesa","func":"var newMsg;\nvar brightness;\nif(msg.payload === \"on\"){\n    if(msg.data.attributes.brightness > 17){\n        brightness = msg.data.attributes.brightness;\n        while(brightness > 7){\n            brightness = brightness - 10;\n            if(brightness > 0 && brightness <= 100){\n                newMsg= {payload : {\n                    \"domain\": \"light\",\n                    \"service\": \"turn_on\",\n                    data:{\n                        \n                        \"entity_id\": \"light.luz_do_quarto_nedi_homekit\",\n                        \"brightness_pct\": brightness,\n                        \"rgb_color\": [0,255,212]\n                    }\n                    }};\n                node.send(newMsg);\n            }\n        }\n    }\n    if(msg.data.attributes.brightness < 5){\n        while(brightness < 7){\n            brightness = brightness + 1;\n            \n            if(brightness > 0 && brightness <= 100){\n                newMsg= {payload : {\n                    \"domain\": \"light\",\n                    \"service\": \"turn_on\",\n                    data:{\n                        \n                        \"entity_id\": \"light.luz_do_quarto_nedi_homekit\",\n                        \"brightness_pct\": brightness,\n                        \"rgb_color\": [0,255,212]\n                    }\n                    }};\n                node.send(newMsg);\n            }\n        }\n        \n    }\n}\nelse{\n    brightness = 1;\n    while(brightness < 10){\n        \n        if(brightness > 0 && brightness <= 100){\n            newMsg= {payload : {\n                \"domain\": \"light\",\n                \"service\": \"turn_on\",\n                data:{\n                    \n                    \"entity_id\": \"light.luz_do_quarto_nedi_homekit\",\n                    \"brightness_pct\": brightness,\n                    \"rgb_color\": [0,255,212]\n                }\n            }};\n            node.send(newMsg);\n        }\n        brightness = brightness + 1;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1050,"y":2460,"wires":[["a06b6f5c.db3f6"]]},{"id":"1423c75c.e0b339","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"var newMsg;\nnewMsg= {payload : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    data:{\n        \n        \"entity_id\": \"light.rainbow_slow\"\n    }\n}};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":800,"y":2400,"wires":[["8a5c9d83.055a7"]]},{"id":"69fb23fe.b6678c","type":"api-call-service","z":"859b066a.dd8128","name":"Luz do Quarto","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"light.luz_do_quarto_nedi_homekit","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1420,"y":2460,"wires":[[]]},{"id":"a5aea003.cd58a","type":"api-call-service","z":"859b066a.dd8128","name":"Rainbow Slow","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.rainbow_slow","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1220,"y":2400,"wires":[[]]},{"id":"c446b975.1588e8","type":"function","z":"859b066a.dd8128","name":"Projetor On","func":"var newMsg;\nvar brightness;\nif(msg.payload === \"on\"){\n    if(msg.data.attributes.brightness*100/255 > 52){\n        brightness = msg.data.attributes.brightness*100/255;\n        while(brightness > 52){\n            brightness = brightness - 3;\n            if(brightness > 0 && brightness <= 100){\n                newMsg= {payload : {\n                    \"domain\": \"light\",\n                    \"service\": \"turn_on\",\n                    data:{\n                        \n                        \"entity_id\": \"light.projetor_ceu\",\n                        \"brightness_pct\": brightness,\n                        \"rgb_color\": [63,200,255]\n                    }\n                    }};\n                node.send(newMsg);\n            \n                newMsg= {payload : {\n                    \"domain\": \"light\",\n                    \"service\": \"turn_on\",\n                    data:{\n                        \n                        \"entity_id\": \"light.projetor_ceu_local\",\n                        \"brightness_pct\": brightness,\n                        \"rgb_color\": [63,200,255]\n                    }\n                    }};\n                node.send(newMsg);\n            }\n        }\n    }\n    if(msg.data.attributes.brightness < 52){\n        brightness = msg.data.attributes.brightness*100/255;\n        while(brightness < 50){\n            brightness = brightness + 3;\n            \n            if(brightness > 0 && brightness <= 100){\n                newMsg= {payload : {\n                    \"domain\": \"light\",\n                    \"service\": \"turn_on\",\n                    data:{\n                        \n                        \"entity_id\": \"light.projetor_ceu\",\n                        \"brightness_pct\": brightness,\n                        \"rgb_color\": [63,200,255]\n                    }\n                    }};\n                node.send(newMsg);\n                newMsg= {payload : {\n                    \"domain\": \"light\",\n                    \"service\": \"turn_on\",\n                    data:{\n                        \n                        \"entity_id\": \"light.projetor_ceu_local\",\n                        \"brightness_pct\": brightness,\n                        \"rgb_color\": [63,200,255]\n                    }\n                    }};\n                node.send(newMsg);\n            }\n                \n            }\n        \n    }\n}\nelse{\n    brightness = 1;\n    while(brightness < 50){\n        \n        if(brightness > 0 && brightness <= 100){\n            newMsg= {payload : {\n                \"domain\": \"light\",\n                \"service\": \"turn_on\",\n                data:{\n                    \n                    \"entity_id\": \"light.projetor_ceu\",\n                    \"brightness_pct\": brightness,\n                    \"rgb_color\": [63,200,255]\n                }\n            }};\n            node.send(newMsg);\n            newMsg= {payload : {\n                \"domain\": \"light\",\n                \"service\": \"turn_on\",\n                data:{\n                    \n                    \"entity_id\": \"light.projetor_ceu_local\",\n                    \"brightness_pct\": brightness,\n                    \"rgb_color\": [63,200,255]\n                }\n            }};\n            node.send(newMsg);\n        }\n        brightness = brightness + 3;\n    }\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1010,"y":2520,"wires":[["eb700cf2.89d3b"]]},{"id":"42b83647.5d87a8","type":"api-call-service","z":"859b066a.dd8128","name":"Projetor Ceu","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.projetor_ceu","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1410,"y":2520,"wires":[[]]},{"id":"686ae5dd.bfe81c","type":"change","z":"859b066a.dd8128","name":"","rules":[{"t":"delete","p":"payload","pt":"msg"},{"t":"set","p":"payload.On","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":520,"y":2420,"wires":[["88e44919.c42b18","1423c75c.e0b339","5d582742.0206a8","90a8951f.8cec68"]]},{"id":"2707961c.839a4a","type":"link in","z":"859b066a.dd8128","name":"Cozy Time","links":["36ae8580.9cd94a","b97bc34b.2fbc2","2741fe30.9edf62"],"x":375,"y":2420,"wires":[["686ae5dd.bfe81c"]]},{"id":"2741fe30.9edf62","type":"link out","z":"444fced8.33ecb","name":"","links":["2707961c.839a4a"],"x":665,"y":680,"wires":[]},{"id":"eb700cf2.89d3b","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1250,"y":2520,"wires":[["42b83647.5d87a8"]]},{"id":"a06b6f5c.db3f6","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1250,"y":2460,"wires":[["69fb23fe.b6678c"]]},{"id":"8a5c9d83.055a7","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1050,"y":2400,"wires":[["a5aea003.cd58a"]]},{"id":"c48d4c24.75d5","type":"comment","z":"859b066a.dd8128","name":"Cozy Time","info":"","x":420,"y":2320,"wires":[]},{"id":"9461a024.cde13","type":"comment","z":"859b066a.dd8128","name":"Vou dormir","info":"","x":300,"y":3400,"wires":[]},{"id":"34313e25.c013c2","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speakAtVolume","payload":{"type":"regular","text":{"type":"str","value":"                                                                      "},"volume":{"type":"num","value":"30"},"mode":"set","devices":["G090XG09951227MJ"]}},"x":790,"y":900,"wires":[[]]},{"id":"408b10c6.097e4","type":"comment","z":"4c9c764d.9c4468","name":"Play Time","info":"","x":2410,"y":200,"wires":[]},{"id":"f8dea0d4.a3fda","type":"comment","z":"4c9c764d.9c4468","name":"Party Hard Time","info":"","x":1980,"y":3580,"wires":[]},{"id":"3244047d.455c9c","type":"comment","z":"4c9c764d.9c4468","name":"Party Light Time","info":"","x":1960,"y":4000,"wires":[]},{"id":"de88c140.3ae29","type":"function","z":"2ea7fd8b.7e0bb2","name":"At home?","func":"if(msg.payload === \"on\"){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":560,"y":1220,"wires":[["eb10d419.bb3698"]]},{"id":"ea81c164.f1eb9","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"HomeKit Location","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.family_location_helper","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":370,"y":1220,"wires":[["de88c140.3ae29","2f84d89c.00d838"]]},{"id":"2f84d89c.00d838","type":"function","z":"2ea7fd8b.7e0bb2","name":"At home?","func":"if(msg.payload === \"off\"){\n    var newMsg;\n    newMsg= {payload: {\n      \"domain\": \"input_boolean\",\n      \"service\": \"turn_on\",\n      \"entity_id\": \"input_boolean.quarto_nedi_ocupado_switch\"\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":560,"y":1280,"wires":[["3fcd9b73.acc8d4","e8b377fb.080e78"]]},{"id":"ebd1c5cb.d14288","type":"inject","z":"d67ca66.293d758","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":790,"y":1840,"wires":[["cdde1573.915d88"]]},{"id":"7dca0e22.32a1e","type":"function","z":"4c9c764d.9c4468","name":"Hora da Festa","func":"var newMsg;\nglobal.set(\"desabilitaAutomacao\", true)\nnewMsg= {\"payload\" : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"input_boolean.desabilita_automacao_sala_escritorio\"\n}\n}};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.boa_noite_casa\"\n        }\n    }};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_da_sala\",\n            \"rgb_color\": [255,0,126],\n            \"brightness_pct\": 1\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_da_entrada\",\n            \"rgb_color\": [0,0,255],\n            \"brightness_pct\": 50\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2\",\n            \"rgb_color\": [0, 126, 255],\n            \"brightness_pct\": 60\n}\n}};\nnode.send(newMsg);newMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_2_hk\",\n            \"rgb_color\": [0, 126, 255],\n            \"brightness_pct\": 60\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"light\",\n    \"service\": \"turn_on\",\n    \"data\":{\n            \"entity_id\": \"light.luz_do_escritorio_1\",\n            \"rgb_color\": [255,0,0],\n            \"brightness_pct\": 50\n}\n}};\nnode.send(newMsg);\nnewMsg= {\"payload\" : {\n    \"domain\": \"input_boolean\",\n    \"service\": \"turn_off\",\n    \"data\":{\n            \"entity_id\": \"input_boolean.party_light\"\n            \n}\n}};\nreturn newMsg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2660,"y":4280,"wires":[["eb21471c.1daed8"]]},{"id":"eb21471c.1daed8","type":"api-call-service","z":"4c9c764d.9c4468","name":"Luzes da Sala","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2860,"y":4280,"wires":[[]]},{"id":"e8649ea9.654f8","type":"inject","z":"4c9c764d.9c4468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2400,"y":4380,"wires":[["7dca0e22.32a1e"]]},{"id":"250cb2cf.f20f0e","type":"function","z":"2ea7fd8b.7e0bb2","name":"Detected?","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg= {payload: {\n          \"domain\": \"input_boolean\",\n          \"service\": \"turn_on\",\n          \"entity_id\": \"input_boolean.alguem_em_casa\",\n\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":570,"y":260,"wires":[["2f7e965e.742a2a"]]},{"id":"655160d4.66816","type":"server-state-changed","z":"2ea7fd8b.7e0bb2","name":"WiFi","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.wifi","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":410,"y":260,"wires":[["250cb2cf.f20f0e"]]},{"id":"b9fdb84a.939388","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":440,"y":1360,"wires":[["ee83b57e.bb8668"]]},{"id":"f7746f7c.67576","type":"change","z":"5767c936.cabd18","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"status\":\"status\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":1780,"wires":[["1d746afe.d07d85"]]},{"id":"baf177cb.e40e58","type":"function","z":"ec27da7d.cad118","d":true,"name":"Turn On","func":"var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria\",\n            \"rgb_color\": [255, 255, 255],\n            \"brightness_pct\": 1,\n            \"transition\": 5\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria_hk\",\n            \"rgb_color\": [255, 255, 255],\n            \"brightness_pct\": 1,\n            \"transition\": 5\n        }\n    }};\n    node.send(newMsg);\nfor(var i = 0; i < 10 ; i++){\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria\",\n            \"rgb_color\": [255, 255, 255],\n            \"brightness_step_pct\": 15,\n            \"transition\": 5\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria_hk\",\n            \"rgb_color\": [255, 255, 255],\n            \"brightness_step_pct\": 15,\n            \"transition\": 5\n        }\n    }};\n    node.send(newMsg);\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3100,"y":320,"wires":[["1b163488.96e2eb"]]},{"id":"b39df832.0d6e68","type":"api-call-service","z":"ec27da7d.cad118","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3440,"y":320,"wires":[[]]},{"id":"c980d582.0f3ce8","type":"api-call-service","z":"ec27da7d.cad118","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3440,"y":380,"wires":[[]]},{"id":"914e31d7.14f48","type":"function","z":"ec27da7d.cad118","d":true,"name":"Turn On","func":"var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria\",\n            \"rgb_color\":[255,160, 66],\n            \"brightness_pct\": 1,\n            \"transition\": 5\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria_hk\",\n            \"rgb_color\":[255,160, 66],\n            \"brightness_pct\": 1,\n            \"transition\": 5\n        }\n    }};\n    node.send(newMsg);\nfor(var i = 0; i < 2 ; i++){\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria\",\n            \"rgb_color\":[255,160, 66],\n            \"brightness_step_pct\": 15,\n            \"transition\": 5\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria_hk\",\n            \"rgb_color\":[255,160, 66],\n            \"brightness_step_pct\": 15,\n            \"transition\": 5\n        }\n    }};\n    node.send(newMsg);\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3100,"y":380,"wires":[["654c85de.c43ebc"]]},{"id":"1b163488.96e2eb","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3250,"y":320,"wires":[["b39df832.0d6e68"]]},{"id":"654c85de.c43ebc","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3250,"y":380,"wires":[["c980d582.0f3ce8"]]},{"id":"56fa9e05.3efe3","type":"function","z":"ec27da7d.cad118","d":true,"name":"Turn On","func":"var newMsg;\nfor(var i = 0; i < 10 ; i++){\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria\",\n            \"color_temp\": 204,\n            \"brightness_step_pct\": 15,\n            \"transition\": 5\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria_hk\",\n            \"color_temp\": 204,\n            \"brightness_step_pct\": 15,\n            \"transition\": 5\n        }\n    }};\n    node.send(newMsg);\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1480,"y":1440,"wires":[["d7936ec5.d7deb"]]},{"id":"e3be1350.08a8c","type":"api-call-service","z":"ec27da7d.cad118","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1820,"y":1440,"wires":[[]]},{"id":"d7936ec5.d7deb","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1630,"y":1440,"wires":[["e3be1350.08a8c"]]},{"id":"87dc1a42.556058","type":"function","z":"ec27da7d.cad118","d":true,"name":"Turn On","func":"var newMsg;\nfor(var i = 0; i < 4 ; i++){\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria\",\n            \"color_temp\": 204,\n            \"brightness_step_pct\": 30,\n            \"transition\": 2\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria_hk\",\n            \"color_temp\": 204,\n            \"brightness_step_pct\": 30,\n            \"transition\": 2\n        }\n    }};\n    node.send(newMsg);\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2860,"y":1180,"wires":[["e43194d9.2f5d48"]]},{"id":"f640db6.2600628","type":"api-call-service","z":"ec27da7d.cad118","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3220,"y":1180,"wires":[[]]},{"id":"e43194d9.2f5d48","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3010,"y":1180,"wires":[["f640db6.2600628"]]},{"id":"ff0bf47d.8fc2b8","type":"function","z":"ec27da7d.cad118","d":true,"name":"Turn Off","func":"var newMsg;\nfor(var i = 0; i < 2 ; i++){\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria\",\n            \"brightness_step_pct\": -50,\n            \"transition\": 2\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria_hk\",\n            \"brightness_step_pct\": -50,\n            \"transition\": 2\n        }\n    }};\n    node.send(newMsg);\n}\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria\"\n        }\n    }};\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_off\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_maria_hk\"\n        }\n    }};\n    node.send(newMsg);\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2860,"y":1240,"wires":[["fc982fdc.3351e"]]},{"id":"ed8427d5.08c378","type":"api-call-service","z":"ec27da7d.cad118","name":"Luz do Quarto Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3220,"y":1240,"wires":[[]]},{"id":"fc982fdc.3351e","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"2","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3010,"y":1240,"wires":[["ed8427d5.08c378"]]},{"id":"dc292b39.826848","type":"yeelight-compat-hue-out","z":"ec27da7d.cad118","name":"","server":"3e6ae01c.bd204","x":2960,"y":1300,"wires":[]},{"id":"a442c7c4.7f7228","type":"function","z":"ec27da7d.cad118","name":"Turn On","func":"if(msg.payload === false){\n        \n    global.set(\"quartoMariaOn\",true);\n    var newMsg;\n    newMsg = {payload : {\n        \"on\": true,\n        \"bri\": 255,\n        \"ct\": 6200,\n        \"duration\": 2000\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3100,"y":260,"wires":[["bff2e4a4.34ed58"]]},{"id":"4697e522.de6b6c","type":"yeelight-compat-hue-out","z":"ec27da7d.cad118","name":"","server":"3e6ae01c.bd204","x":3360,"y":260,"wires":[]},{"id":"dd0d5158.67b14","type":"function","z":"ec27da7d.cad118","name":"Turn On","func":"if(msg.payload === false){\n        \n    global.set(\"quartoMariaOn\",true);\n    var newMsg;\n    newMsg = {payload : {\n        \"on\": true,\n        \"bri\": 128,\n        \"ct\": 4000,\n        \"duration\": 2000\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3100,"y":440,"wires":[["6ac7a501.79dd8c"]]},{"id":"6ac7a501.79dd8c","type":"yeelight-compat-hue-out","z":"ec27da7d.cad118","name":"","server":"3e6ae01c.bd204","x":3380,"y":440,"wires":[]},{"id":"e992f316.348f4","type":"function","z":"ec27da7d.cad118","name":"Turn On","func":"if(msg.payload === false){\n        \n    global.set(\"quartoMariaOn\",true);\n    var newMsg;\n    newMsg = {payload : {\n        \"on\": true,\n        \"bri\": 255,\n        \"ct\": 6200\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1480,"y":1500,"wires":[["dd64de7b.0ec87"]]},{"id":"aa359c8.e40bc6","type":"yeelight-compat-hue-out","z":"ec27da7d.cad118","name":"","server":"3e6ae01c.bd204","x":1720,"y":1500,"wires":[]},{"id":"69998772.ddcb88","type":"api-call-service","z":"554bb518.994efc","name":"Liga rotina da Alexa","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"media_player","service":"play_media","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1310,"y":600,"wires":[[]]},{"id":"51f2feb6.91138","type":"function","z":"554bb518.994efc","name":"","func":"var newMsg;\nnewMsg= {payload:{\n  \"domain\": \"media_player\",\n  \"service\": \"play_media\",\n   \"entity_id\": \"media_player.echo_dot_da_cozinha\",\n  \"data\":{\n          \"entity_id\": \"media_player.echo_dot_da_cozinha\",\n          \"media_content_id\": \"Faz o café\",\n          \"media_content_type\": \"routine\"\n\n  }}\n};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1120,"y":600,"wires":[["69998772.ddcb88"]]},{"id":"ab455957.7c1368","type":"function","z":"444fced8.33ecb","name":"Turn On","func":"var newMsg;\n        newMsg = {payload:{}}\nglobal.set(\"boaNoiteCasa\", false);\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_on\",\n        \"data\":{\n          \"entity_id\": \"switch.abajur_escritorio\",\n        }\n    }\n    node.send(newMsg);\n    newMsg= {payload : {\n        \"domain\": \"input_boolean\",\n        \"service\": \"turn_off\",\n        \"data\":{\n            \"entity_id\": \"input_boolean.boa_noite_casa\"\n        }\n    }};\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_on\",\n        \"data\":{\n          \"entity_id\": \"switch.luminaria_esquerda\",\n        }\n    }\n    node.send(newMsg);\n        newMsg = {payload:{}}\n    newMsg.payload = {\n        \"domain\": \"switch\",\n        \"service\": \"turn_on\",\n        \"data\":{\n          \"entity_id\": \"switch.luminaria_direita\",\n        }\n    }\n    return newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":760,"y":1440,"wires":[["aa766bac.334b08"]]},{"id":"636854a.1629dac","type":"function","z":"d67ca66.293d758","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_nedi_title_aux\",\n    \"data\":{\n        \"value\": \"Atenção na Sala\",\n    \"entity_id\":\"input_text.notify_nedi_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_nedi_text_aux\",\n    \"data\":{         \n        \"value\": \"Sensores não estão respondendo.\",\n    \"entity_id\":\"input_text.notify_nedi_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1410,"y":3740,"wires":[["88d77fa8.cd0af"]]},{"id":"88d77fa8.cd0af","type":"api-call-service","z":"d67ca66.293d758","name":"Notifica","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1580,"y":3740,"wires":[[]]},{"id":"5d2effa8.41552","type":"function","z":"d67ca66.293d758","name":"Reset Tomada","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_off\",\n    data:{\n        entity_id: \"switch.tomada_dos_sensores_da_sala\"\n    }\n    }};\n    node.send(newMsg);\n    \n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    data:{\n        entity_id: \"switch.tomada_dos_sensores_da_sala\"\n    }\n    }};\n    node.send(newMsg);\n    ","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1420,"y":3660,"wires":[["47b57f25.5176"]]},{"id":"47b57f25.5176","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"rate","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1620,"y":3660,"wires":[["f7131471.b227d8"]]},{"id":"f7131471.b227d8","type":"api-call-service","z":"d67ca66.293d758","name":"Sensores","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.tomada_dos_sensores_da_sala","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1780,"y":3660,"wires":[[]]},{"id":"6cdd567b.df0558","type":"comment","z":"d67ca66.293d758","name":"Reset Sensores da Sala","info":"","x":290,"y":3540,"wires":[]},{"id":"d779c36.fc6b74","type":"function","z":"d67ca66.293d758","name":"Delay + 2h","func":"var newMsg;\nnewMsg = { \"reset\": true };\nnode.send(newMsg);\nnewMsg = { \"delay\": 7200000 };\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":4000,"wires":[["fd7e123f.6efbb"]]},{"id":"fd7e123f.6efbb","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"delayv","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":900,"y":4000,"wires":[["2dd33dff.5cef72","d779c36.fc6b74","25d1d334.8185dc"]]},{"id":"2646f5ad.77c03a","type":"function","z":"d67ca66.293d758","name":"Notificação","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"mqtt\",\n    \"service\": \"publish\",\n    data:{\n        \n          topic: \"iotlink/workgroup/soft-pc/commands/notify\",\n          payload: '{ \"title\": \"Atenção no Quarto Nédi\", \"message\": \"Sensores não estão respondendo.\"}'\n  \n\n    }\n    }};\n    node.send(newMsg);\n    \n    newMsg= {payload : {\n    \"domain\": \"notify\",\n    \"service\": \"mobile_app_nedis_iphone\",\n    data:{\n        \"title\": \"Atenção no Quarto Nédi\",\n        \"message\": \"Sensores não estão respondendo.\"\n\n    }\n    }};\n    return newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1410,"y":4180,"wires":[["fbdaea41.c8e598"]]},{"id":"fbdaea41.c8e598","type":"api-call-service","z":"d67ca66.293d758","name":"Notifica","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"mobile_app_nedis_iphone","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1560,"y":4180,"wires":[[]]},{"id":"a90a88e9.84e958","type":"function","z":"d67ca66.293d758","name":"Reset Tomada","func":"var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_off\",\n    data:{\n        entity_id: \"switch.tomada_dos_sensores_quarto_nedi\"\n    }\n    }};\n    node.send(newMsg);\n    \n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    data:{\n        entity_id: \"switch.tomada_dos_sensores_quarto_nedi\"\n    }\n    }};\n    node.send(newMsg);\n    ","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1420,"y":4100,"wires":[["a164b9e7.c87f58"]]},{"id":"a164b9e7.c87f58","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"rate","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1600,"y":4100,"wires":[["cb42edf.186261"]]},{"id":"cb42edf.186261","type":"api-call-service","z":"d67ca66.293d758","name":"Sensores","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_off","entityId":"switch.tomada_dos_sensores_da_sala","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":1760,"y":4100,"wires":[[]]},{"id":"93b32ebb.f6e26","type":"comment","z":"d67ca66.293d758","name":"Reset Sensores do Quarto Nédi","info":"","x":310,"y":3960,"wires":[]},{"id":"30c6fcdb.f09224","type":"server-state-changed","z":"d67ca66.293d758","name":"Temperatura Quarto Nédi","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.temperatura_quarto_nedi","entityidfiltertype":"exact","outputinitially":false,"state_type":"num","haltifstate":"","halt_if_type":"num","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":310,"y":4180,"wires":[["272cfdfc.2eee42","60d2f243.d298fc"]]},{"id":"3d816e5d.a0fe12","type":"server-state-changed","z":"d67ca66.293d758","name":"Sensor de Luz Quarto Nédi","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.sensor_de_luz_quarto_nedi","entityidfiltertype":"exact","outputinitially":false,"state_type":"num","haltifstate":"","halt_if_type":"num","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":310,"y":4060,"wires":[["1b51eb37.087a85","2d9b1ed8.29af22"]]},{"id":"272cfdfc.2eee42","type":"function","z":"d67ca66.293d758","name":"Sem problemas","func":"if(\n    msg.payload !== \"unknown\" &&\n    msg.payload !== \"unavailable\" &&\n    msg.payload < 45 \n){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":4120,"wires":[["5969ea80.44f774"]]},{"id":"1b51eb37.087a85","type":"function","z":"d67ca66.293d758","name":"Sem problemas","func":"if(\n    msg.payload !== \"unknown\" &&\n    msg.payload !== \"unavailable\" &&\n    msg.payload < 2000 \n){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":4000,"wires":[["d779c36.fc6b74"]]},{"id":"60d2f243.d298fc","type":"function","z":"d67ca66.293d758","name":"Problema no sensor","func":"if(\n    msg.payload === \"unknown\" || \n    msg.payload === \"unavailable\" ||\n    msg.payload > 45 \n){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":840,"y":4180,"wires":[["2dd33dff.5cef72","ebbbc401.3b1c08"]]},{"id":"2d9b1ed8.29af22","type":"function","z":"d67ca66.293d758","name":"Problema no sensor","func":"if(\n    msg.payload === \"unknown\" || \n    msg.payload === \"unavailable\" ||\n    msg.payload > 2000 ||\n    msg.payload < 0\n){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":840,"y":4060,"wires":[["2dd33dff.5cef72","ebbbc401.3b1c08"]]},{"id":"a728da1c.dd8e98","type":"function","z":"d67ca66.293d758","name":"Delay + 2h","func":"var newMsg;\nnewMsg = { \"reset\": true };\nnode.send(newMsg);\nnewMsg = { \"delay\": 7200000 };\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":3580,"wires":[["465656d.1ad69a8"]]},{"id":"465656d.1ad69a8","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"delayv","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":900,"y":3580,"wires":[["2435c33c.c0ef8c","a728da1c.dd8e98","cef90947.bc0718"]]},{"id":"adf2321d.d1c76","type":"server-state-changed","z":"d67ca66.293d758","name":"Temperatura Sala","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.temperatura_sala","entityidfiltertype":"exact","outputinitially":false,"state_type":"num","haltifstate":"","halt_if_type":"num","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":290,"y":3760,"wires":[["51f451d1.d343b","7e9b4dc7.d45404"]]},{"id":"1494a37a.f2ad2d","type":"server-state-changed","z":"d67ca66.293d758","name":"Sensor de Luz Sala","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.sensor_de_luz_sala","entityidfiltertype":"exact","outputinitially":false,"state_type":"num","haltifstate":"","halt_if_type":"num","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":290,"y":3640,"wires":[["ccc62513.812408","612a23a7.8cfa5c"]]},{"id":"51f451d1.d343b","type":"function","z":"d67ca66.293d758","name":"Sem problemas","func":"if(\n    msg.payload !== \"unknown\" &&\n    msg.payload !== \"unavailable\" &&\n    msg.payload < 45 \n){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":3700,"wires":[["d80ee7ee.7325f8"]]},{"id":"ccc62513.812408","type":"function","z":"d67ca66.293d758","name":"Sem problemas","func":"if(\n    msg.payload !== \"unknown\" &&\n    msg.payload !== \"unavailable\" &&\n    msg.payload < 2000 \n){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":3580,"wires":[["a728da1c.dd8e98"]]},{"id":"7e9b4dc7.d45404","type":"function","z":"d67ca66.293d758","name":"Problema no sensor","func":"if(\n    msg.payload === \"unknown\" || \n    msg.payload === \"unavailable\" ||\n    msg.payload > 45 \n){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":840,"y":3760,"wires":[["2435c33c.c0ef8c","19c54024.6f6ec"]]},{"id":"612a23a7.8cfa5c","type":"function","z":"d67ca66.293d758","name":"Problema no sensor","func":"if(\n    msg.payload === \"unknown\" || \n    msg.payload === \"unavailable\" ||\n    msg.payload > 2000 ||\n    msg.payload < 0\n){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":840,"y":3640,"wires":[["2435c33c.c0ef8c","19c54024.6f6ec"]]},{"id":"d182aed8.519e","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"0.5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":750,"y":2060,"wires":[["d893df70.4923f","41cbc1bd.13f36"]]},{"id":"41cbc1bd.13f36","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"0.5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"30","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":980,"y":1920,"wires":[["6f4a0d7c.b00f04"]]},{"id":"1a384f84.6f652","type":"alexa-remote-routine","z":"444fced8.33ecb","name":"","account":"421d4b0d.32a884","routineNode":{"type":"speak","payload":{"type":"regular","text":{"type":"str","value":"Bom Trabalho ou estudos!"},"devices":["G090XG0894430B3V"]}},"x":980,"y":1380,"wires":[[]]},{"id":"5f99e819.a3bcb8","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"0.5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"30","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":780,"y":1380,"wires":[["1a384f84.6f652"]]},{"id":"7391c692.dfef08","type":"json","z":"444fced8.33ecb","name":"","property":"payload","action":"obj","pretty":false,"x":950,"y":1500,"wires":[["872229ae.023cb8","9b55449b.9da608"]]},{"id":"c12be2b6.07349","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":1455,"y":2480,"wires":[["27cc9661.88529a"]],"l":false},{"id":"95def43f.e94fd8","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":2295,"y":2780,"wires":[["bd6511fe.20fea","e5b3f35f.d05bc","a118c87a.5bf698","384159c3.257dd6","1859ba82.068f25","f70dc065.70dbf"]],"l":false},{"id":"5ec548f5.d5ea68","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":615,"y":3280,"wires":[["d0a29117.770ac","d3ca8fa4.fb454","85254593.30d388","116ede4b.308c92","23c70bd.f2ae6f4","4ef5c98.f30cc38","a8079f5e.01589","17004d78.bab173"]],"l":false},{"id":"6581d3f5.54a43c","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":975,"y":4000,"wires":[["390647d7.4e1f48","388e4fb3.3dea8","e7a7680.1698f98","79aeb49f.3b7d9c","cc6db577.a62b08","356a7902.1cd9f6","2d6f2fa9.a3cf7"]],"l":false},{"id":"19d9ed37.0838c3","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":3115,"y":860,"wires":[["1bc5fd0f.4cf593","2c958f27.a2346"]],"l":false},{"id":"6d740173.6fe3","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":3115,"y":1040,"wires":[["df0a39de.b474d8","f469cf49.5337e"]],"l":false},{"id":"d1a774bf.1bfc48","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":3915,"y":300,"wires":[[]],"l":false},{"id":"4b7d9edb.55065","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":3915,"y":360,"wires":[[]],"l":false},{"id":"bfc0ee8f.6934b","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":3915,"y":420,"wires":[["387af76.4f3a508"]],"l":false},{"id":"7f265e7.96ed1a","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":3915,"y":480,"wires":[[]],"l":false},{"id":"3b44099e.38c446","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":1175,"y":1300,"wires":[["337c17d5.a9f378","2f9c7b9a.a87b14"]],"l":false},{"id":"192197a1.baae68","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":1115,"y":1000,"wires":[["466a9556.18c7dc","ed4c24ad.4fd578"]],"l":false},{"id":"a9be70be.445fc","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":1895,"y":1560,"wires":[[]],"l":false},{"id":"6494e447.1fb45c","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":1895,"y":1620,"wires":[["bdf393b7.4aafb"]],"l":false},{"id":"882dd88a.862818","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":1895,"y":1680,"wires":[["5d5f419f.5982a"]],"l":false},{"id":"562e1375.d8856c","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":1895,"y":1740,"wires":[["d32569d4.54bf88"]],"l":false},{"id":"57659679.a9ee18","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":3055,"y":460,"wires":[["7410bb38.fd2a44"]],"l":false},{"id":"c90c495d.dc7a88","type":"json","z":"4c9c764d.9c4468","name":"","property":"payload","action":"obj","pretty":false,"x":3055,"y":340,"wires":[["10281ea8.c36541"]],"l":false},{"id":"2d1bfea1.069f92","type":"json","z":"e7cd1901.ee2408","name":"","property":"payload","action":"obj","pretty":false,"x":975,"y":740,"wires":[["dac5d209.cd354","b22195ef.e6b948"]],"l":false},{"id":"d701e49c.510258","type":"json","z":"e7cd1901.ee2408","name":"","property":"payload","action":"obj","pretty":false,"x":795,"y":1000,"wires":[["4933329e.0da91c"]],"l":false},{"id":"5ab14541.fb933c","type":"json","z":"e7cd1901.ee2408","name":"","property":"payload","action":"obj","pretty":false,"x":795,"y":1100,"wires":[["ceb656d4.09644"]],"l":false},{"id":"4fed96c8.787008","type":"json","z":"e7cd1901.ee2408","name":"","property":"payload","action":"obj","pretty":false,"x":2255,"y":1080,"wires":[["b0620f12.25b7d","44c5f3b7.f04ac4"]],"l":false},{"id":"3db30869.31be08","type":"json","z":"e7cd1901.ee2408","name":"","property":"payload","action":"obj","pretty":false,"x":1395,"y":340,"wires":[["adfe724a.6dadc"]],"l":false},{"id":"dc34716b.dcb6f","type":"json","z":"e7cd1901.ee2408","name":"","property":"payload","action":"obj","pretty":false,"x":1395,"y":400,"wires":[["e1ea086.6e68cf8"]],"l":false},{"id":"7a953736.a9e848","type":"json","z":"e7cd1901.ee2408","name":"","property":"payload","action":"obj","pretty":false,"x":1375,"y":180,"wires":[["92571614.e14db8"]],"l":false},{"id":"532bb30e.51d0dc","type":"json","z":"e7cd1901.ee2408","name":"","property":"payload","action":"obj","pretty":false,"x":1795,"y":280,"wires":[["d36d2c87.c9cc8"]],"l":false},{"id":"8da5c7fb.88b508","type":"json","z":"e7cd1901.ee2408","name":"","property":"payload","action":"obj","pretty":false,"x":3515,"y":200,"wires":[["1df6f143.b3402f","d8f33e85.87e79"]],"l":false},{"id":"4cbb11d6.ab35","type":"json","z":"5767c936.cabd18","name":"","property":"payload","action":"obj","pretty":false,"x":955,"y":60,"wires":[["33280499.5ea6bc"]],"l":false},{"id":"a38c518a.00918","type":"json","z":"5767c936.cabd18","name":"","property":"payload","action":"obj","pretty":false,"x":955,"y":120,"wires":[["e4e654de.ca4be8"]],"l":false},{"id":"974670f1.4b47c","type":"json","z":"5767c936.cabd18","name":"","property":"payload","action":"obj","pretty":false,"x":1355,"y":220,"wires":[["9eaf56fb.0da888"]],"l":false},{"id":"fc28320f.6df3","type":"json","z":"5767c936.cabd18","name":"","property":"payload","action":"obj","pretty":false,"x":1495,"y":340,"wires":[["22c1a09f.a9a0d"]],"l":false},{"id":"f9ec74d2.448bd8","type":"json","z":"5767c936.cabd18","name":"","property":"payload","action":"obj","pretty":false,"x":3315,"y":200,"wires":[["89fc9ed.7aa91e","7addf581.2a943c"]],"l":false},{"id":"a66eb3dd.9d41a","type":"json","z":"5767c936.cabd18","name":"","property":"payload","action":"obj","pretty":false,"x":775,"y":840,"wires":[["64ff672c.ba8d78"]],"l":false},{"id":"6f5b3cf0.be2454","type":"json","z":"5767c936.cabd18","name":"","property":"payload","action":"obj","pretty":false,"x":2355,"y":920,"wires":[["1af7a9e4.d79636","9629b50d.9d69b8"]],"l":false},{"id":"ee83b57e.bb8668","type":"json","z":"5767c936.cabd18","name":"","property":"payload","action":"obj","pretty":false,"x":535,"y":1360,"wires":[["ace843be.a34e7"]],"l":false},{"id":"255ee862.d04028","type":"json","z":"5767c936.cabd18","name":"","property":"payload","action":"obj","pretty":false,"x":535,"y":1300,"wires":[["f663ec98.82fab"]],"l":false},{"id":"1d746afe.d07d85","type":"json","z":"5767c936.cabd18","name":"","property":"payload","action":"obj","pretty":false,"x":355,"y":1780,"wires":[["3290497e.d5f816"]],"l":false},{"id":"bff2e4a4.34ed58","type":"json","z":"ec27da7d.cad118","name":"","property":"payload","action":"obj","pretty":false,"x":3215,"y":260,"wires":[["4697e522.de6b6c"]],"l":false},{"id":"261cdfc6.18854","type":"json","z":"ec27da7d.cad118","name":"","property":"payload","action":"obj","pretty":false,"x":3215,"y":440,"wires":[[]],"l":false},{"id":"a113ed77.44159","type":"json","z":"ec27da7d.cad118","name":"","property":"payload","action":"obj","pretty":false,"x":2815,"y":1300,"wires":[["dc292b39.826848"]],"l":false},{"id":"dd64de7b.0ec87","type":"json","z":"ec27da7d.cad118","name":"","property":"payload","action":"obj","pretty":false,"x":1575,"y":1500,"wires":[["aa359c8.e40bc6"]],"l":false},{"id":"d8f33e85.87e79","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3620,"y":240,"wires":[["ef8cbd88.f0403"]]},{"id":"7addf581.2a943c","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3420,"y":240,"wires":[["9ffef5c0.172838"]]},{"id":"9629b50d.9d69b8","type":"delay","z":"5767c936.cabd18","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2540,"y":940,"wires":[["e432c868.e95268"]]},{"id":"d3ca8fa4.fb454","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":850,"y":3080,"wires":[["4a1425a2.db543c"]]},{"id":"85254593.30d388","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"1000","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":860,"y":3140,"wires":[["4d27662f.48b518"]]},{"id":"116ede4b.308c92","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"1500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":860,"y":3200,"wires":[["972f7720.a13ec8"]]},{"id":"23c70bd.f2ae6f4","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"2000","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":850,"y":3260,"wires":[["e6f2407a.0d866"]]},{"id":"4ef5c98.f30cc38","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"2500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":860,"y":3320,"wires":[["52b5b752.987af8"]]},{"id":"a8079f5e.01589","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"3000","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":860,"y":3380,"wires":[["1432ae4b.db0122"]]},{"id":"17004d78.bab173","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"3500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":860,"y":3440,"wires":[["ee72fc5c.00463"]]},{"id":"390647d7.4e1f48","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1150,"y":3920,"wires":[["8a1d7a02.0338d8"]]},{"id":"388e4fb3.3dea8","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"1000","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1160,"y":3980,"wires":[["ae7116e.962f6e8"]]},{"id":"e7a7680.1698f98","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"1500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1160,"y":4040,"wires":[["5abaedb5.26d254"]]},{"id":"79aeb49f.3b7d9c","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"2000","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1160,"y":4100,"wires":[["25eebcec.40e154"]]},{"id":"cc6db577.a62b08","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"2500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1160,"y":4160,"wires":[["324ff746.b81568"]]},{"id":"356a7902.1cd9f6","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"3000","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1160,"y":4220,"wires":[["c47e8e7.1ac447"]]},{"id":"2d6f2fa9.a3cf7","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"delay","timeout":"3500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1160,"y":4280,"wires":[["b6af0d28.a7dd4"]]},{"id":"b22195ef.e6b948","type":"delay","z":"e7cd1901.ee2408","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1120,"y":740,"wires":[["1cac4780.e4df98"]]},{"id":"aede74be.a867a8","type":"json","z":"d67ca66.293d758","name":"","property":"payload","action":"obj","pretty":false,"x":915,"y":2300,"wires":[["3a30f06f.ca027","63c31016.fd372","a8e2d170.cd1ee","d730bed6.4d021"]],"l":false},{"id":"63c31016.fd372","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"delay","timeout":"500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1070,"y":2220,"wires":[["b33859c3.c7681"]]},{"id":"a8e2d170.cd1ee","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"delay","timeout":"1000","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1080,"y":2280,"wires":[["2b1b546.381d4ac"]]},{"id":"d730bed6.4d021","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"delay","timeout":"1500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1080,"y":2340,"wires":[["c9fee3d9.d47888"]]},{"id":"f3732032.9a3cb","type":"json","z":"d67ca66.293d758","name":"","property":"payload","action":"obj","pretty":false,"x":935,"y":2920,"wires":[["90ff44a7.0e0458","7a6c3e.100243c4","c6dd6266.3a7bb","ee1dc484.379c48"]],"l":false},{"id":"81c1d4f6.674d58","type":"json","z":"d67ca66.293d758","name":"","property":"payload","action":"obj","pretty":false,"x":935,"y":3180,"wires":[["590cfd2d.5bd984","96807431.12f6d8","6b0f1615.6cab68","e325813b.ab572"]],"l":false},{"id":"8c6ac0c.f71714","type":"json","z":"bbb64533.9844f8","name":"","property":"payload","action":"obj","pretty":false,"x":2275,"y":260,"wires":[["9c84d5ae.e9dd38","ede41e59.cb0e4"]],"l":false},{"id":"ef0281c1.b2e84","type":"json","z":"bbb64533.9844f8","name":"","property":"payload","action":"obj","pretty":false,"x":795,"y":200,"wires":[[]],"l":false},{"id":"6665cb1d.815d84","type":"json","z":"bbb64533.9844f8","name":"","property":"payload","action":"obj","pretty":false,"x":795,"y":320,"wires":[["64003ec5.6a43e"]],"l":false},{"id":"2e8e5d7.37df4a2","type":"json","z":"de7173c1.b1a8c","name":"","property":"payload","action":"obj","pretty":false,"x":1275,"y":200,"wires":[["f250c7af.142328"]],"l":false},{"id":"cf9232f1.7a6f9","type":"json","z":"de7173c1.b1a8c","name":"","property":"payload","action":"obj","pretty":false,"x":795,"y":580,"wires":[["e9294587.f92ae8"]],"l":false},{"id":"1902382d.3b75d8","type":"json","z":"de7173c1.b1a8c","name":"","property":"payload","action":"obj","pretty":false,"x":2255,"y":640,"wires":[["243087c9.22fa68"]],"l":false},{"id":"f6cc9ad1.7dfda8","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"hour","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1520,"y":4820,"wires":[["93a15a3a.164d48","cf6ffdbe.2c237"]]},{"id":"9bc14da8.26264","type":"function","z":"444fced8.33ecb","name":"Create Error Message","func":"if(\n    msg.payload.includes('alexa-remote-init') === true || \n    msg.payload.includes('Authentication') === true ||  \n    msg.payload.includes('Initialisation') === true || \n    msg.payload.includes('account') === true || \n    msg.payload.includes('initial') === true\n    ){\n        return msg;\n    }","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1320,"y":4820,"wires":[["f6cc9ad1.7dfda8","50b6beaf.109aa"]]},{"id":"9b2713ec.a2e68","type":"function","z":"444fced8.33ecb","name":"Create Error Message","func":"if(\n    msg.payload.includes('alexa-remote-init') === false &&\n    msg.payload.includes('Authentication') === false &&  \n    msg.payload.includes('Initialisation') === false && \n    msg.payload.includes('account') === false &&\n    msg.payload.includes('initial') === false\n    ){\n        return msg;\n    }","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1320,"y":4880,"wires":[["93a15a3a.164d48","3b2b1ba5.92e3d4","cf6ffdbe.2c237","71d3b57a.6fb6cc"]]},{"id":"4cf81eb1.96baa","type":"link in","z":"e7cd1901.ee2408","name":"Party Aux Resets","links":["2aa0eca8.c6ac44","58465d19.995fe4","75ee7a63.9ae964","e2fc2f6.6a235d"],"x":815,"y":460,"wires":[["a801a322.91b67"]]},{"id":"a801a322.91b67","type":"function","z":"e7cd1901.ee2408","name":"Reset","func":"msg.reset = true;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":910,"y":460,"wires":[["b2a76711.ae4398"]]},{"id":"75ee7a63.9ae964","type":"link out","z":"4c9c764d.9c4468","name":"Party Light Reset","links":["4cf81eb1.96baa","6998c13b.6eaeb"],"x":2265,"y":4100,"wires":[]},{"id":"58465d19.995fe4","type":"link out","z":"4c9c764d.9c4468","name":"Party Hard Reset","links":["4cf81eb1.96baa","6998c13b.6eaeb"],"x":2255,"y":3720,"wires":[]},{"id":"6998c13b.6eaeb","type":"link in","z":"5767c936.cabd18","name":"Party Aux Resets","links":["2aa0eca8.c6ac44","58465d19.995fe4","75ee7a63.9ae964","e2fc2f6.6a235d"],"x":695,"y":500,"wires":[["dffb5a9b.e31a08"]]},{"id":"dffb5a9b.e31a08","type":"function","z":"5767c936.cabd18","name":"Reset","func":"msg.reset = true;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":790,"y":500,"wires":[["ba6a4e16.62ac7"]]},{"id":"5969ea80.44f774","type":"function","z":"d67ca66.293d758","name":"Delay + 2h","func":"var newMsg;\nnewMsg = { \"reset\": true };\nnode.send(newMsg);\nnewMsg = { \"delay\": 7200000 };\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":4120,"wires":[["cb907dbd.d9862"]]},{"id":"cb907dbd.d9862","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"delayv","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":900,"y":4120,"wires":[["2dd33dff.5cef72","5969ea80.44f774","25d1d334.8185dc"]]},{"id":"d80ee7ee.7325f8","type":"function","z":"d67ca66.293d758","name":"Delay + 2h","func":"var newMsg;\nnewMsg = { \"reset\": true };\nnode.send(newMsg);\nnewMsg = { \"delay\": 7200000 };\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":3700,"wires":[["2cb99f45.477e8"]]},{"id":"2cb99f45.477e8","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"delayv","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":900,"y":3700,"wires":[["2435c33c.c0ef8c","d80ee7ee.7325f8","cef90947.bc0718"]]},{"id":"2435c33c.c0ef8c","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"rate","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"hour","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1170,"y":3700,"wires":[["5d2effa8.41552","636854a.1629dac"]]},{"id":"2dd33dff.5cef72","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"rate","timeout":"15","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"hour","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1170,"y":4140,"wires":[["a90a88e9.84e958","2646f5ad.77c03a"]]},{"id":"71d3b57a.6fb6cc","type":"debug","z":"444fced8.33ecb","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1470,"y":4940,"wires":[]},{"id":"50b6beaf.109aa","type":"debug","z":"444fced8.33ecb","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1510,"y":4760,"wires":[]},{"id":"3366a6c6.12a74a","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2090,"y":4120,"wires":[["1698060.e974ffa","8dfaf576.e71738","9dd9c8b4.32a778","75ee7a63.9ae964"]]},{"id":"5ec51c8b.479884","type":"delay","z":"4c9c764d.9c4468","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2110,"y":3760,"wires":[["76bcef83.4fcaa","227721b6.15b1ce","982e720d.5f2fe","58465d19.995fe4"]]},{"id":"766dd695.a618f8","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Tracks","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":570,"y":1540,"wires":[["a570f599.6205a8","4ef6974b.ea61b8"]]},{"id":"645d816.8acd28","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":2690,"y":1540,"wires":[["9837fced.0121a"]]},{"id":"6fb6a23f.cd72ac","type":"spotify","z":"7b0de646.c85c78","name":"Getting Old Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1270,"y":1540,"wires":[["9766f8bb.aa2da8","bc51470a.19dea8"]]},{"id":"a570f599.6205a8","type":"function","z":"7b0de646.c85c78","name":"Top Finland Archive","func":"flow.set(\"releaseRadarTracks\", msg.payload.items)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '1S8ly2OgcUcnXM44a5co2q',\n        {offset: 0}\n    ]\n}\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":790,"y":1540,"wires":[["aaa327e4.e5f098"]]},{"id":"9766f8bb.aa2da8","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"releaseRadarOldAux\");\nvar oldArrayAux = flow.get(\"releaseRadarOldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"releaseRadarOldArrayAux\", newOldArrayAux);\nflow.set(\"releaseRadarOldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1480,"y":1540,"wires":[["117b3ffd.67f2e"]]},{"id":"ae2c7938.c6ade8","type":"inject","z":"7b0de646.c85c78","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"15 09 * * 1,3,4,6","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":1540,"wires":[["23c0f635.f1157a"]]},{"id":"23c0f635.f1157a","type":"function","z":"7b0de646.c85c78","name":"Release Radar","func":"var newMsg;\nflow.set(\"releaseRadarOldAux\", 0);\nflow.set(\"releaseRadarOldArrayAux\", []);\nflow.set(\"releaseRadarTracks\", [])\nflow.set(\"releaseRadarOffset\",100);\nnewMsg = {\n    \"params\":[\n        '37i9dQZEVXbnr2pYWmmOqJ'\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":360,"y":1540,"wires":[["766dd695.a618f8"]]},{"id":"6fdc2dc4.f1ec34","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1880,"y":1540,"wires":[["7a00ce6c.be664"],["95473101.a2698","49907d9c.0ed274"]]},{"id":"7a00ce6c.be664","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"discoverWeeklyOffset = flow.get(\"releaseRadarOffset\");\nflow.set(\"releaseRadarOffset\",discoverWeeklyOffset+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '1S8ly2OgcUcnXM44a5co2q',\n        {offset: discoverWeeklyOffset}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1800,"y":1460,"wires":[["6fb6a23f.cd72ac"]]},{"id":"95473101.a2698","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"releaseRadarTracks\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nvar i;\n        for(i=0; i<newTracks.length; i++) {\n            alreadyIn = false;\n            for(var j=0; j<oldTracks.length; j++) {\n                if(newTracks[i].track.id === oldTracks[j].track.id){\n                    alreadyIn = true\n                }\n            }\n            if(alreadyIn === false){\n                auxString = \"['\" + newTracks[i].track.uri + \"']\"\n                newMsg = {\n                    \"params\":[\n                        \"1S8ly2OgcUcnXM44a5co2q\",\n                        [newTracks[i].track.uri]\n                    ]}\n                node.send(newMsg);\n        \n            }\n        }\nflow.set(\"releaseRadarOldArrayAux\", []);\nflow.set(\"releaseRadarTracks\", [])","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":1540,"wires":[["a9bd4495.732168","a08db065.33632"]]},{"id":"117b3ffd.67f2e","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":1540,"wires":[["6fdc2dc4.f1ec34"]]},{"id":"49907d9c.0ed274","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2170,"y":1620,"wires":[]},{"id":"aaa327e4.e5f098","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1040,"y":1540,"wires":[["6fb6a23f.cd72ac"]]},{"id":"a9bd4495.732168","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2450,"y":1540,"wires":[["645d816.8acd28"]]},{"id":"4ef6974b.ea61b8","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":760,"y":1600,"wires":[]},{"id":"a08db065.33632","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2460,"y":1620,"wires":[]},{"id":"9837fced.0121a","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2860,"y":1620,"wires":[]},{"id":"bc51470a.19dea8","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1450,"y":1600,"wires":[]},{"id":"1c739f71.b877a1","type":"spotify","z":"7b0de646.c85c78","name":"Getting New Tracks","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":590,"y":1740,"wires":[["a34ca8fb.8913a8","34ef9028.0af3e"]]},{"id":"8df6e62c.6a58e8","type":"spotify","z":"7b0de646.c85c78","name":"Adding to playlist","auth":"3b9d50b6.bca4e","api":"addTracksToPlaylist","x":2680,"y":1740,"wires":[["9714453a.ee5938"]]},{"id":"532c1185.ff146","type":"spotify","z":"7b0de646.c85c78","name":"Getting Old Playlist","auth":"3b9d50b6.bca4e","api":"getPlaylistTracks","x":1260,"y":1740,"wires":[["1cce9dda.3fead2","9021d073.892cb"]]},{"id":"a34ca8fb.8913a8","type":"function","z":"7b0de646.c85c78","name":"Top Finland Archive","func":"flow.set(\"newMusicDeutschTracks\", msg.payload.items)\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '7mfatWl90Nn8nCxkrgmm7I',\n        {offset: 0}\n    ]\n}\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":790,"y":1740,"wires":[["50feb0e9.00159"]]},{"id":"1cce9dda.3fead2","type":"function","z":"7b0de646.c85c78","name":"Got all tracks?","func":"var oldAux = flow.get(\"newMusicDeutschOldAux\");\nvar oldArrayAux = flow.get(\"newMusicDeutschOldArrayAux\");\nvar newMsg;\nvar newOldArrayAux;\nif (typeof msg.payload !== 'undefined' ){\n    if (typeof msg.payload.items !== 'undefined' ){\n        newOldArrayAux = oldArrayAux.concat(msg.payload.items);\n    }\n    else{\n        newOldArrayAux = [];\n    }\n}\nelse{\n    newOldArrayAux = [];\n}\n\nfor(var i=0; i<newOldArrayAux.length; ++i) {\n    for(var j=i+1; j<newOldArrayAux.length; ++j) {\n        if(newOldArrayAux[i] === newOldArrayAux[j])\n            newOldArrayAux.splice(j--, 1);\n    }\n}\nflow.set(\"newMusicDeutschOldArrayAux\", newOldArrayAux);\nflow.set(\"newMusicDeutschOldAux\", oldAux+msg.payload.limit);\nif(msg.payload.total > oldAux){\n    newMsg = {\"ajuda\":true};\n}\nelse{\n    newMsg = {\"ajuda\":false,\n        \"tracks\": newOldArrayAux\n    };\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1470,"y":1740,"wires":[["6836d1fc.4fea"]]},{"id":"d7252cd1.77673","type":"inject","z":"7b0de646.c85c78","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 04 * * 5,6","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":190,"y":1740,"wires":[["219019d5.d60a16"]]},{"id":"219019d5.d60a16","type":"function","z":"7b0de646.c85c78","name":"NewMusicFriday Deutsch","func":"var newMsg;\nflow.set(\"newMusicDeutschOldAux\", 0);\nflow.set(\"newMusicDeutschOldArrayAux\", []);\nflow.set(\"newMusicDeutschTracks\", [])\nflow.set(\"newMusicDeutschOffset\",100);\nnewMsg = {\n    \"params\":[\n        '37i9dQZF1DWUW2bvSkjcJ6'\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":370,"y":1740,"wires":[["1c739f71.b877a1"]]},{"id":"3bff539b.583c3c","type":"switch","z":"7b0de646.c85c78","name":"Ajuda?","property":"ajuda","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1870,"y":1740,"wires":[["1734601b.9f1a7"],["82deeb5c.a8be88","4ce0f94c.c48c08"]]},{"id":"1734601b.9f1a7","type":"function","z":"7b0de646.c85c78","name":"Get Next Array","func":"discoverWeeklyOffset = flow.get(\"newMusicDeutschOffset\");\nflow.set(\"newMusicDeutschOffset\",discoverWeeklyOffset+100);\n\nvar newMsg;\nnewMsg = {\n    \"params\":[\n        '7mfatWl90Nn8nCxkrgmm7I',\n        {offset: discoverWeeklyOffset}\n    ]\n}\nreturn newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1790,"y":1660,"wires":[["532c1185.ff146"]]},{"id":"82deeb5c.a8be88","type":"function","z":"7b0de646.c85c78","name":"New playlist is already added?","func":"var newTracks = flow.get(\"newMusicDeutschTracks\");\nvar oldTracks = msg.tracks;\nvar alreadyIn = false;\nvar newMsg;\nvar auxString;\nvar i;\n        for(i=0; i<newTracks.length; i++) {\n            alreadyIn = false;\n            for(var j=0; j<oldTracks.length; j++) {\n                if(newTracks[i].track.id === oldTracks[j].track.id){\n                    alreadyIn = true\n                }\n            }\n            if(alreadyIn === false){\n                auxString = \"['\" + newTracks[i].track.uri + \"']\"\n                newMsg = {\n                    \"params\":[\n                        \"7mfatWl90Nn8nCxkrgmm7I\",\n                        [newTracks[i].track.uri]\n                    ]}\n                node.send(newMsg);\n        \n            }\n        }\n\nflow.set(\"newMusicDeutschOldArrayAux\", []);\nflow.set(\"newMusicDeutschTracks\", [])","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2200,"y":1740,"wires":[["778ec2d7.a97c0c","3eb966fc.7171fa"]]},{"id":"6836d1fc.4fea","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1670,"y":1740,"wires":[["3bff539b.583c3c"]]},{"id":"4ce0f94c.c48c08","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2190,"y":1820,"wires":[]},{"id":"50feb0e9.00159","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1030,"y":1740,"wires":[["532c1185.ff146"]]},{"id":"778ec2d7.a97c0c","type":"delay","z":"7b0de646.c85c78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2440,"y":1740,"wires":[["8df6e62c.6a58e8"]]},{"id":"34ef9028.0af3e","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":780,"y":1800,"wires":[]},{"id":"3eb966fc.7171fa","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2480,"y":1820,"wires":[]},{"id":"9714453a.ee5938","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2880,"y":1820,"wires":[]},{"id":"9021d073.892cb","type":"debug","z":"7b0de646.c85c78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1440,"y":1800,"wires":[]},{"id":"5d582742.0206a8","type":"api-current-state","z":"859b066a.dd8128","name":"Projetor Céu","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.projetor_ceu_local","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":810,"y":2520,"wires":[["c446b975.1588e8"]]},{"id":"90a8951f.8cec68","type":"api-current-state","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_nedi_homekit","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":830,"y":2460,"wires":[["fe379991.b2d528"]]},{"id":"5f9559c1.a65ee8","type":"api-current-state","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_nedi_homekit","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":1350,"y":1980,"wires":[["403451b.4c77ab","2d0b920f.d492f6"]]},{"id":"8e0dbc08.ece2a","type":"function","z":"859b066a.dd8128","name":"Luz do Quarto On","func":"if(\n    msg.payload === \"vibration\" ||\n    msg.payload === \"tilt\" ||\n    msg.payload === \"drop\" \n    ){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1130,"y":1980,"wires":[["5f9559c1.a65ee8"]]},{"id":"19c54024.6f6ec","type":"debug","z":"d67ca66.293d758","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1150,"y":3620,"wires":[]},{"id":"cef90947.bc0718","type":"debug","z":"d67ca66.293d758","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1150,"y":3580,"wires":[]},{"id":"25d1d334.8185dc","type":"debug","z":"d67ca66.293d758","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1170,"y":4000,"wires":[]},{"id":"ebbbc401.3b1c08","type":"debug","z":"d67ca66.293d758","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1170,"y":4040,"wires":[]},{"id":"bccc7285.fe6dd","type":"server-state-changed","z":"d67ca66.293d758","name":"Umidade Quarto Nédi","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.umidade_quarto_nedi","entityidfiltertype":"exact","outputinitially":false,"state_type":"num","haltifstate":"","halt_if_type":"num","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":300,"y":4320,"wires":[["196792a5.9f32cd","ee590729.7d4dd8"]]},{"id":"196792a5.9f32cd","type":"function","z":"d67ca66.293d758","name":"Sem problemas","func":"if(\n    msg.payload !== \"unknown\" &&\n    msg.payload !== \"unavailable\" &&\n    msg.payload <= 100 && \n    msg.payload > 0 \n){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":4260,"wires":[["5969ea80.44f774"]]},{"id":"ee590729.7d4dd8","type":"function","z":"d67ca66.293d758","name":"Problema no sensor","func":"if(\n    msg.payload === \"unknown\" || \n    msg.payload === \"unavailable\" ||\n    msg.payload > 100 || \n    msg.payload < 0\n){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":840,"y":4320,"wires":[["2dd33dff.5cef72"]]},{"id":"b721f59c.354bb8","type":"server-state-changed","z":"d67ca66.293d758","name":"Umidade Sala","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.umidade_sala","entityidfiltertype":"exact","outputinitially":false,"state_type":"num","haltifstate":"","halt_if_type":"num","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":"","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":270,"y":3880,"wires":[["f22af6d2.68c2c8","d939c338.8c8bd"]]},{"id":"f22af6d2.68c2c8","type":"function","z":"d67ca66.293d758","name":"Sem problemas","func":"if(\n    msg.payload !== \"unknown\" &&\n    msg.payload !== \"unavailable\" &&\n    msg.payload <= 100 && \n    msg.payload > 0 \n){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":520,"y":3820,"wires":[["d80ee7ee.7325f8"]]},{"id":"d939c338.8c8bd","type":"function","z":"d67ca66.293d758","name":"Problema no sensor","func":"if(\n    msg.payload === \"unknown\" || \n    msg.payload === \"unavailable\" ||\n    msg.payload > 100 || \n    msg.payload < 0\n){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":840,"y":3880,"wires":[["2435c33c.c0ef8c"]]},{"id":"e97637b4.032c88","type":"inject","z":"c3fa9bdb.b5c4c8","name":"10:00","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 10 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":2170,"y":240,"wires":[["7fd21228.2b6a6c"]]},{"id":"eb4b68b9.56c778","type":"inject","z":"c3fa9bdb.b5c4c8","name":"13:30","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"30 13 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":2170,"y":300,"wires":[["d8bdb110.ae6de"]]},{"id":"1d72d3b0.fbac4c","type":"inject","z":"c3fa9bdb.b5c4c8","name":"16:00","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 16 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":2170,"y":360,"wires":[["6068c0db.b35c5"]]},{"id":"69dcc163.1ed45","type":"inject","z":"c3fa9bdb.b5c4c8","name":"20:45","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"45 20 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":2170,"y":420,"wires":[["34f1ea83.c1f1f6"]]},{"id":"f037bdfb.8fbcc","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3560,"y":4420,"wires":[["8737707d.3bb5d"]]},{"id":"ef159e95.cded5","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3860,"y":4420,"wires":[["9fa95be4.5e5d38"]]},{"id":"5977c60f.730be8","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cleusa. Está na hora dos seus remédios da manhã.\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":2990,"y":240,"wires":[["6bafde9d.137af"]]},{"id":"7ce79f29.ab4f3","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2840,"y":240,"wires":[["5977c60f.730be8"]]},{"id":"6bafde9d.137af","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"10","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3140,"y":240,"wires":[["883bfd3f.5f326"]]},{"id":"883bfd3f.5f326","type":"alexa-remote-routine","z":"c3fa9bdb.b5c4c8","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"50"},"mode":{"type":"str","value":"set"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":3300,"y":240,"wires":[[]]},{"id":"6e2a9d1c.0f7404","type":"alexa-remote-routine","z":"c3fa9bdb.b5c4c8","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"60"},"mode":{"type":"str","value":"set"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":2680,"y":240,"wires":[["7ce79f29.ab4f3"]]},{"id":"902a223.65a42e","type":"function","z":"c3fa9bdb.b5c4c8","name":"Verdade?","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2500,"y":420,"wires":[["64bdfedd.e5177"]]},{"id":"34f1ea83.c1f1f6","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Vó em Casa?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.vo_em_casa","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2340,"y":420,"wires":[["902a223.65a42e"]]},{"id":"4ec8c2e4.b39b0c","type":"function","z":"c3fa9bdb.b5c4c8","name":"Verdade?","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2500,"y":240,"wires":[["6e2a9d1c.0f7404"]]},{"id":"7fd21228.2b6a6c","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Vó em Casa?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.vo_em_casa","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2340,"y":240,"wires":[["4ec8c2e4.b39b0c"]]},{"id":"ed0dceb3.83e04","type":"function","z":"c3fa9bdb.b5c4c8","name":"Verdade?","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2500,"y":300,"wires":[["d5f9eaff.25bbd8"]]},{"id":"d8bdb110.ae6de","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Vó em Casa?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.vo_em_casa","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2340,"y":300,"wires":[["ed0dceb3.83e04"]]},{"id":"d55c9586.c40568","type":"function","z":"c3fa9bdb.b5c4c8","name":"Verdade?","func":"if(msg.payload === true){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2500,"y":360,"wires":[["5bb615c7.404b3c"]]},{"id":"6068c0db.b35c5","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Vó em Casa?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"input_boolean.vo_em_casa","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2340,"y":360,"wires":[["d55c9586.c40568"]]},{"id":"4d8df557.ec3ecc","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cleusa. Está na hora dos seus remédios do almoço.\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":2990,"y":300,"wires":[["54372945.8b1d18"]]},{"id":"bbd50d31.29146","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2840,"y":300,"wires":[["4d8df557.ec3ecc"]]},{"id":"54372945.8b1d18","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"10","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3140,"y":300,"wires":[["feb34c22.a38c1"]]},{"id":"feb34c22.a38c1","type":"alexa-remote-routine","z":"c3fa9bdb.b5c4c8","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"50"},"mode":{"type":"str","value":"set"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":3300,"y":300,"wires":[[]]},{"id":"d5f9eaff.25bbd8","type":"alexa-remote-routine","z":"c3fa9bdb.b5c4c8","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"60"},"mode":{"type":"str","value":"set"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":2680,"y":300,"wires":[["bbd50d31.29146"]]},{"id":"697185c.b4bf07c","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cleusa. Está na hora dos seus remédios da tarde.\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":2990,"y":360,"wires":[["a296b410.c8df18"]]},{"id":"3820fb54.899db4","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2840,"y":360,"wires":[["697185c.b4bf07c"]]},{"id":"a296b410.c8df18","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"10","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3140,"y":360,"wires":[["1a6efd02.978f63"]]},{"id":"1a6efd02.978f63","type":"alexa-remote-routine","z":"c3fa9bdb.b5c4c8","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"50"},"mode":{"type":"str","value":"set"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":3300,"y":360,"wires":[[]]},{"id":"5bb615c7.404b3c","type":"alexa-remote-routine","z":"c3fa9bdb.b5c4c8","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"60"},"mode":{"type":"str","value":"set"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":2680,"y":360,"wires":[["3820fb54.899db4"]]},{"id":"7c265cbd.1b9de4","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"Cleusa. Está na hora dos seus remédios da noite.\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_da_cozinha\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":2990,"y":420,"wires":[["dab49dc9.ada1"]]},{"id":"4256f490.13ca4c","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2840,"y":420,"wires":[["7c265cbd.1b9de4"]]},{"id":"dab49dc9.ada1","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"10","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3140,"y":420,"wires":[["d0ad8c90.cea59"]]},{"id":"d0ad8c90.cea59","type":"alexa-remote-routine","z":"c3fa9bdb.b5c4c8","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"50"},"mode":{"type":"str","value":"set"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":3300,"y":420,"wires":[[]]},{"id":"64bdfedd.e5177","type":"alexa-remote-routine","z":"c3fa9bdb.b5c4c8","name":"","account":"421d4b0d.32a884","routineNode":{"type":"volume","payload":{"value":{"type":"num","value":"60"},"mode":{"type":"str","value":"set"},"devices":["780b5ed6cb0145c0a01f25806a441220"]}},"x":2680,"y":420,"wires":[["4256f490.13ca4c"]]},{"id":"2c5a87e5.c3436","type":"api-call-service","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi_homekit","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3050,"y":240,"wires":[[]]},{"id":"17851e1b.05b0da","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n\n        \"entity_id\": \"light.luz_do_quarto_nedi_homekit\",\n        \"rgb_color\": [255, 255, 255],\n        \"brightness_pct\": 1,\n        }\n    }};\n    node.send(newMsg);\n        \n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_nedi\",\n        }\n    }};\n    node.send(newMsg);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2820,"y":240,"wires":[["2c5a87e5.c3436"]]},{"id":"9879af65.10ae48","type":"link in","z":"859b066a.dd8128","name":"Duplo Clique Botão","links":["3e659e3a.ee1442"],"x":2535,"y":1100,"wires":[["99a5588e.1075d8"]]},{"id":"d0f4c5c4.b63d28","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1370,"y":1820,"wires":[["1ae5f225.e369fe"]]},{"id":"305e0bcb.9067ac","type":"catch","z":"d67ca66.293d758","name":"","scope":["1ae5f225.e369fe"],"uncaught":false,"x":1370,"y":1700,"wires":[["b3d4af2d.d3f1b8"]]},{"id":"b3d4af2d.d3f1b8","type":"debug","z":"d67ca66.293d758","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1520,"y":1680,"wires":[]},{"id":"46242ddd.8b1464","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1180,"y":1880,"wires":[["f63c5372.830788"]]},{"id":"f63c5372.830788","type":"function","z":"d67ca66.293d758","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_nedi_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_nedi_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1350,"y":1880,"wires":[["71b836f2.72d8a8"]]},{"id":"71b836f2.72d8a8","type":"api-call-service","z":"d67ca66.293d758","name":"Notify Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":1530,"y":1880,"wires":[[]]},{"id":"df8dda9.e0cb2a8","type":"function","z":"d67ca66.293d758","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_cristofer_title_aux\",\n    \"data\":{\n        \"value\": \"Café\",\n    \"entity_id\":\"input_text.notify_cristofer_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_cristofer_text_aux\",\n    \"data\":{         \n        \"value\": `{{ [ \"O Café está pronto.\", \"O Café está prontinho.\", \"Tem café quentinho na cozinha.\", \"Tem café na cozinha.\", \"Corre pra cozinha, o café está pronto.\", \"O Café está pronto na cozinha.\", \"O Café está quentinho te esperando.\"]|random }}`,\n    \"entity_id\":\"input_text.notify_cristofer_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1190,"y":1940,"wires":[["5e679fd6.03153"]]},{"id":"16a61287.b304fd","type":"api-call-service","z":"d67ca66.293d758","name":"Notify Papai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_cristofer_text_aux, input_text.notify_cristofer_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1530,"y":1940,"wires":[[]]},{"id":"5e679fd6.03153","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1370,"y":1940,"wires":[["16a61287.b304fd"]]},{"id":"8c767c8b.4b7048","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1180,"y":2000,"wires":[["5cd74e12.87bf88"]]},{"id":"5cd74e12.87bf88","type":"function","z":"d67ca66.293d758","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_cristofer_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_cristofer_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1350,"y":2000,"wires":[["eb9e03fe.17932"]]},{"id":"eb9e03fe.17932","type":"api-call-service","z":"d67ca66.293d758","name":"Notify Papai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":1530,"y":2000,"wires":[[]]},{"id":"65babc5f.59bf0c","type":"function","z":"d67ca66.293d758","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_tahisa_title_aux\",\n    \"data\":{\n        \"value\": \"Café\",\n    \"entity_id\":\"input_text.notify_tahisa_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_tahisa_text_aux\",\n    \"data\":{         \n        \"value\": `{{ [ \"O Café está pronto.\", \"O Café está prontinho.\", \"Tem café quentinho na cozinha.\", \"Tem café na cozinha.\", \"Corre pra cozinha, o café está pronto.\", \"O Café está pronto na cozinha.\", \"O Café está quentinho te esperando.\"]|random }}`,\n    \"entity_id\":\"input_text.notify_tahisa_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1190,"y":2060,"wires":[["1132ba36.d623a6"]]},{"id":"c7700431.fdff48","type":"api-call-service","z":"d67ca66.293d758","name":"Notify Mae","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_tahisa_text_aux, input_text.notify_tahisa_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1530,"y":2060,"wires":[[]]},{"id":"1132ba36.d623a6","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1370,"y":2060,"wires":[["c7700431.fdff48"]]},{"id":"46909283.83a09c","type":"delay","z":"d67ca66.293d758","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1180,"y":2120,"wires":[["325fb756.477d"]]},{"id":"325fb756.477d","type":"function","z":"d67ca66.293d758","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_tahisa_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_tahisa_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1350,"y":2120,"wires":[["c3e8d491.8fe3f"]]},{"id":"c3e8d491.8fe3f","type":"api-call-service","z":"d67ca66.293d758","name":"Notify Mae","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":1530,"y":2120,"wires":[[]]},{"id":"d0d5856d.88cc1","type":"api-current-state","z":"d67ca66.293d758","name":"Mae home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.tahisa","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":990,"y":2060,"wires":[["65babc5f.59bf0c","46909283.83a09c"]]},{"id":"e0653496.be27f8","type":"function","z":"d3db5d74.fb8fa","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_nedi_title_aux\",\n    \"data\":{\n        \"value\": \"Chuva\",\n    \"entity_id\":\"input_text.notify_nedi_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_nedi_text_aux\",\n    \"data\":{         \n        \"value\": `Há chance de chover agora e a(s) janela(s) {% if is_state(\"binary_sensor.janela_quarto_maria\", \"on\") -%} do Quarto Maria, {%- endif %} {% if is_state(\"binary_sensor.janela_quarto_nedi\", \"on\") -%} do Quarto Nédi,{%- endif %} {% if is_state(\"binary_sensor.janela_quarto_pai\", \"on\") -%} do Quarto Pai,{%- endif %} {% if is_state(\"binary_sensor.janela_sala\", \"on\") -%} da Sala {%- endif %} está/estão aberta(s)`,\n    \"entity_id\":\"input_text.notify_nedi_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2570,"y":2300,"wires":[["f450bbf8.8c70d8"]]},{"id":"39dc14c8.be905c","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Notify Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_nedi_text_aux, input_text.notify_nedi_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":2910,"y":2300,"wires":[[]]},{"id":"8fd21924.6c132","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Nédi home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2370,"y":2300,"wires":[["e0653496.be27f8","29285835.608a48"]]},{"id":"d263cd78.55659","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Papai home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.cristofer","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2370,"y":2420,"wires":[["55f54641.ea4438","ae2d176a.90c06"]]},{"id":"f450bbf8.8c70d8","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2750,"y":2300,"wires":[["39dc14c8.be905c"]]},{"id":"29285835.608a48","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2560,"y":2360,"wires":[["aedfd53.3dbfa28"]]},{"id":"aedfd53.3dbfa28","type":"function","z":"d3db5d74.fb8fa","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_nedi_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_nedi_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2730,"y":2360,"wires":[["c85ee998.d3696"]]},{"id":"c85ee998.d3696","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Notify Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":2910,"y":2360,"wires":[[]]},{"id":"55f54641.ea4438","type":"function","z":"d3db5d74.fb8fa","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_cristofer_title_aux\",\n    \"data\":{\n        \"value\": \"Chuva\",\n    \"entity_id\":\"input_text.notify_cristofer_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_cristofer_text_aux\",\n    \"data\":{         \n        \"value\": `Há chance de chover agora e a(s) janela(s) {% if is_state(\"binary_sensor.janela_quarto_maria\", \"on\") -%} do Quarto Maria, {%- endif %} {% if is_state(\"binary_sensor.janela_quarto_nedi\", \"on\") -%} do Quarto Nédi,{%- endif %} {% if is_state(\"binary_sensor.janela_quarto_pai\", \"on\") -%} do Quarto Pai,{%- endif %} {% if is_state(\"binary_sensor.janela_sala\", \"on\") -%} da Sala {%- endif %} está/estão aberta(s)`,\n    \"entity_id\":\"input_text.notify_cristofer_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2570,"y":2420,"wires":[["65bc7bab.59afc4"]]},{"id":"1cdda112.bf11b7","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Notify Papai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_cristofer_text_aux, input_text.notify_cristofer_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":2910,"y":2420,"wires":[[]]},{"id":"65bc7bab.59afc4","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2750,"y":2420,"wires":[["1cdda112.bf11b7"]]},{"id":"ae2d176a.90c06","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2560,"y":2480,"wires":[["3d1fb49d.909c44"]]},{"id":"3d1fb49d.909c44","type":"function","z":"d3db5d74.fb8fa","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_cristofer_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_cristofer_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2730,"y":2480,"wires":[["59b0a512.9531a4"]]},{"id":"59b0a512.9531a4","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Notify Papai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":2910,"y":2480,"wires":[[]]},{"id":"c7666f82.3236e8","type":"function","z":"d3db5d74.fb8fa","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_tahisa_title_aux\",\n    \"data\":{\n        \"value\": \"Chuva\",\n    \"entity_id\":\"input_text.notify_tahisa_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_tahisa_text_aux\",\n    \"data\":{         \n        \"value\": `Há chance de chover agora e a(s) janela(s) {% if is_state(\"binary_sensor.janela_quarto_maria\", \"on\") -%} do Quarto Maria, {%- endif %} {% if is_state(\"binary_sensor.janela_quarto_nedi\", \"on\") -%} do Quarto Nédi,{%- endif %} {% if is_state(\"binary_sensor.janela_quarto_pai\", \"on\") -%} do Quarto Pai,{%- endif %} {% if is_state(\"binary_sensor.janela_sala\", \"on\") -%} da Sala {%- endif %} está/estão aberta(s)`,\n    \"entity_id\":\"input_text.notify_tahisa_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2570,"y":2540,"wires":[["7d32d1a9.d74f7"]]},{"id":"8462ac72.0210f8","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Notify Mae","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_tahisa_text_aux, input_text.notify_tahisa_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":2910,"y":2540,"wires":[[]]},{"id":"7d32d1a9.d74f7","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2750,"y":2540,"wires":[["8462ac72.0210f8"]]},{"id":"2b7547d1.bd5ad","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2560,"y":2600,"wires":[["68f5c3de.452404"]]},{"id":"68f5c3de.452404","type":"function","z":"d3db5d74.fb8fa","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_tahisa_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_tahisa_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2730,"y":2600,"wires":[["556d8fbc.f58d7"]]},{"id":"556d8fbc.f58d7","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Notify Mae","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":2910,"y":2600,"wires":[[]]},{"id":"201ebd4d.350902","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Mae home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.tahisa","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2370,"y":2540,"wires":[["c7666f82.3236e8","2b7547d1.bd5ad"]]},{"id":"37f5e8ea.c4746","type":"function","z":"d3db5d74.fb8fa","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_maria_title_aux\",\n    \"data\":{\n        \"value\": \"Chuva\",\n    \"entity_id\":\"input_text.notify_maria_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_maria_text_aux\",\n    \"data\":{         \n        \"value\": `Há chance de chover agora e a(s) janela(s) {% if is_state(\"binary_sensor.janela_quarto_maria\", \"on\") -%} do Quarto Maria, {%- endif %} {% if is_state(\"binary_sensor.janela_quarto_nedi\", \"on\") -%} do Quarto Nédi,{%- endif %} {% if is_state(\"binary_sensor.janela_quarto_pai\", \"on\") -%} do Quarto Pai,{%- endif %} {% if is_state(\"binary_sensor.janela_sala\", \"on\") -%} da Sala {%- endif %} está/estão aberta(s)`,\n    \"entity_id\":\"input_text.notify_maria_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2570,"y":2660,"wires":[["c45e581f.307e1"]]},{"id":"9bd89678.7a5a28","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_maria_text_aux, input_text.notify_maria_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":2910,"y":2660,"wires":[[]]},{"id":"c45e581f.307e1","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2750,"y":2660,"wires":[["9bd89678.7a5a28"]]},{"id":"eaa40768.4d0fb8","type":"delay","z":"d3db5d74.fb8fa","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2560,"y":2720,"wires":[["d352dd74.ebb87"]]},{"id":"d352dd74.ebb87","type":"function","z":"d3db5d74.fb8fa","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_maria_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_maria_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2730,"y":2720,"wires":[["dc1d9c4d.9cb9"]]},{"id":"dc1d9c4d.9cb9","type":"api-call-service","z":"d3db5d74.fb8fa","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":2910,"y":2720,"wires":[[]]},{"id":"be2416d8.56baa","type":"api-current-state","z":"d3db5d74.fb8fa","name":"Maria home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.maria","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2370,"y":2660,"wires":[["37f5e8ea.c4746","eaa40768.4d0fb8"]]},{"id":"c967930a.b3464","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_nedi_title_aux\",\n    \"data\":{\n        \"value\": \"Louça\",\n    \"entity_id\":\"input_text.notify_nedi_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_nedi_text_aux\",\n    \"data\":{         \n        \"value\": `Hoje é seu dia de lavar a louça`,\n    \"entity_id\":\"input_text.notify_nedi_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1150,"y":520,"wires":[["aefaa88e.17e0a8"]]},{"id":"2d7bb241.e5233e","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_nedi_text_aux, input_text.notify_nedi_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1490,"y":520,"wires":[[]]},{"id":"aefaa88e.17e0a8","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1330,"y":520,"wires":[["2d7bb241.e5233e"]]},{"id":"ecb4430d.70b848","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1140,"y":580,"wires":[["611fd8d.9089e28"]]},{"id":"611fd8d.9089e28","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_nedi_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_nedi_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1310,"y":580,"wires":[["9f086e38.4afb88"]]},{"id":"9f086e38.4afb88","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":1490,"y":580,"wires":[[]]},{"id":"cff68409.de53f8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_cristofer_title_aux\",\n    \"data\":{\n        \"value\": \"Louça\",\n    \"entity_id\":\"input_text.notify_cristofer_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_cristofer_text_aux\",\n    \"data\":{         \n        \"value\": `Hoje é seu dia de lavar a louça`,\n        \"entity_id\":\"input_text.notify_cristofer_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1150,"y":340,"wires":[["bdd950.8ce32eb"]]},{"id":"cc73f4e6.3d20c","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Papai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_cristofer_text_aux, input_text.notify_cristofer_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1490,"y":340,"wires":[[]]},{"id":"bdd950.8ce32eb","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1330,"y":340,"wires":[["cc73f4e6.3d20c"]]},{"id":"a147996f.835798","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1140,"y":400,"wires":[["60c27648.9fb578"]]},{"id":"60c27648.9fb578","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_cristofer_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_cristofer_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1310,"y":400,"wires":[["8759859e.7ca6f"]]},{"id":"8759859e.7ca6f","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Papai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":1490,"y":400,"wires":[[]]},{"id":"1923568d.1f84e9","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_maria_title_aux\",\n    \"data\":{\n        \"value\": \"Louça\",\n    \"entity_id\":\"input_text.notify_maria_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_maria_text_aux\",\n    \"data\":{         \n\n        \"value\": `Hoje é seu dia de lavar a louça`,\n        \"entity_id\":\"input_text.notify_maria_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1150,"y":220,"wires":[["767eb07.c895e5"]]},{"id":"947d8ec4.51e758","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_maria_text_aux, input_text.notify_maria_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1490,"y":220,"wires":[[]]},{"id":"767eb07.c895e5","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1330,"y":220,"wires":[["947d8ec4.51e758"]]},{"id":"e425d305.db9848","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1140,"y":280,"wires":[["587e7190.96271"]]},{"id":"587e7190.96271","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_maria_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_maria_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1310,"y":280,"wires":[["38594f90.81e56"]]},{"id":"38594f90.81e56","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":1490,"y":280,"wires":[[]]},{"id":"54b83cc6.f86b8c","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_nedi_title_aux\",\n    \"data\":{\n        \"value\": \"Arrumar a Mesa\",\n    \"entity_id\":\"input_text.notify_nedi_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_nedi_text_aux\",\n    \"data\":{         \n        \"value\": `Hoje é seu dia de arrumar a mesa`,\n    \"entity_id\":\"input_text.notify_nedi_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1150,"y":1233,"wires":[["12099195.d2b686"]]},{"id":"ad26946.b1ee5e8","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_nedi_text_aux, input_text.notify_nedi_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1490,"y":1233,"wires":[[]]},{"id":"12099195.d2b686","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1330,"y":1233,"wires":[["ad26946.b1ee5e8"]]},{"id":"f1b1b65b.5e48b8","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1140,"y":1293,"wires":[["8b545821.ba4768"]]},{"id":"8b545821.ba4768","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_nedi_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_nedi_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1310,"y":1293,"wires":[["58c1ac0e.8b6144"]]},{"id":"58c1ac0e.8b6144","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":1490,"y":1293,"wires":[[]]},{"id":"2be595c7.b9174a","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_cristofer_title_aux\",\n    \"data\":{\n        \"value\": \"Arrumar a Mesa\",\n    \"entity_id\":\"input_text.notify_cristofer_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_cristofer_text_aux\",\n    \"data\":{         \n        \"value\": `Hoje é seu dia de arrumar a mesa`,\n        \"entity_id\":\"input_text.notify_cristofer_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1150,"y":1060,"wires":[["dc07c98d.851ea8"]]},{"id":"a713dfc7.355ac","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Papai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_cristofer_text_aux, input_text.notify_cristofer_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1490,"y":1060,"wires":[[]]},{"id":"dc07c98d.851ea8","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1330,"y":1060,"wires":[["a713dfc7.355ac"]]},{"id":"1b944d5f.d33da3","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1140,"y":1120,"wires":[["89ad972c.fd5bd"]]},{"id":"89ad972c.fd5bd","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_cristofer_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_cristofer_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1310,"y":1120,"wires":[["f7ac1adc.d0e318"]]},{"id":"f7ac1adc.d0e318","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Papai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":1490,"y":1120,"wires":[[]]},{"id":"e3e3ccca.406778","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_maria_title_aux\",\n    \"data\":{\n        \"value\": \"Arrumar a Mesa\",\n    \"entity_id\":\"input_text.notify_maria_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_maria_text_aux\",\n    \"data\":{         \n\n        \"value\": `Hoje é seu dia de arrumar a mesa`,\n        \"entity_id\":\"input_text.notify_maria_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1150,"y":900,"wires":[["c69544fa.5000c8"]]},{"id":"120c23bf.81584c","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_maria_text_aux, input_text.notify_maria_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1490,"y":900,"wires":[[]]},{"id":"c69544fa.5000c8","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1330,"y":900,"wires":[["120c23bf.81584c"]]},{"id":"5469e753.84b74","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1140,"y":960,"wires":[["a2ba9b6.6bdc2e8"]]},{"id":"a2ba9b6.6bdc2e8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_maria_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_maria_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1310,"y":960,"wires":[["351c24d3.801d7c"]]},{"id":"351c24d3.801d7c","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":1490,"y":960,"wires":[[]]},{"id":"36fa4d26.dff44a","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_nedi_title_aux\",\n    \"data\":{\n        \"value\": \"Arrumar a Cozinha\",\n    \"entity_id\":\"input_text.notify_nedi_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_nedi_text_aux\",\n    \"data\":{         \n        \"value\": 'Hoje é seu dia de arrumar e limpar a cozinha',\n    \"entity_id\":\"input_text.notify_nedi_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1150,"y":1865,"wires":[["75cfa08.db7dce"]]},{"id":"d1e53c64.0c289","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_nedi_text_aux, input_text.notify_nedi_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1490,"y":1865,"wires":[[]]},{"id":"75cfa08.db7dce","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1330,"y":1865,"wires":[["d1e53c64.0c289"]]},{"id":"fe625450.bb6ac","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1140,"y":1925,"wires":[["fb6524ed.3753a"]]},{"id":"fb6524ed.3753a","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_nedi_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_nedi_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1310,"y":1925,"wires":[["da58db5a.7984d"]]},{"id":"da58db5a.7984d","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":1490,"y":1925,"wires":[[]]},{"id":"67ff6714.77b288","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_cristofer_title_aux\",\n    \"data\":{\n        \"value\": \"Arrumar a Cozinha\",\n    \"entity_id\":\"input_text.notify_cristofer_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_cristofer_text_aux\",\n    \"data\":{         \n        \"value\": 'Hoje é seu dia de arrumar e limpar a cozinha',\n        \"entity_id\":\"input_text.notify_cristofer_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1150,"y":1692,"wires":[["bd0ba939.bf0648"]]},{"id":"8bd2510a.8c8318","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Papai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_cristofer_text_aux, input_text.notify_cristofer_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1490,"y":1692,"wires":[[]]},{"id":"bd0ba939.bf0648","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1330,"y":1692,"wires":[["8bd2510a.8c8318"]]},{"id":"d1bd29a8.228bd","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1140,"y":1752,"wires":[["2bce3f82.951be"]]},{"id":"2bce3f82.951be","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_cristofer_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_cristofer_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1310,"y":1752,"wires":[["9baaffbe.a818f"]]},{"id":"9baaffbe.a818f","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Papai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":1490,"y":1752,"wires":[[]]},{"id":"d56e1594.d075d8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_maria_title_aux\",\n    \"data\":{\n        \"value\": \"Arrumar a Cozinha\",\n    \"entity_id\":\"input_text.notify_maria_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_maria_text_aux\",\n    \"data\":{         \n\n        \"value\": 'Hoje é seu dia de arrumar e limpar a cozinha',\n        \"entity_id\":\"input_text.notify_maria_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1150,"y":1532,"wires":[["70b38a28.689c0c"]]},{"id":"c9dab83b.ddefa8","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_maria_text_aux, input_text.notify_maria_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1490,"y":1532,"wires":[[]]},{"id":"70b38a28.689c0c","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1330,"y":1532,"wires":[["c9dab83b.ddefa8"]]},{"id":"83d09121.3487c8","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1140,"y":1592,"wires":[["f4f16bd7.34cf1"]]},{"id":"f4f16bd7.34cf1","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_maria_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_maria_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1310,"y":1592,"wires":[["d37fe147.3b9698"]]},{"id":"d37fe147.3b9698","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":1490,"y":1592,"wires":[[]]},{"id":"4489e602.fd0c88","type":"function","z":"ec27da7d.cad118","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_nedi_title_aux\",\n    \"data\":{\n        \"value\": \"Atenção no Quarto nedi\",\n    \"entity_id\":\"input_text.notify_nedi_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_nedi_text_aux\",\n    \"data\":{         \n\n        \"value\": \"Erro no Lux Quarto nedi\",\n        \"entity_id\":\"input_text.notify_nedi_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1130,"y":660,"wires":[["d14c849b.1cf5d8"]]},{"id":"159f75c8.693a62","type":"api-call-service","z":"ec27da7d.cad118","name":"Notify Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_nedi_text_aux, input_text.notify_nedi_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1470,"y":660,"wires":[[]]},{"id":"d14c849b.1cf5d8","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1310,"y":660,"wires":[["159f75c8.693a62"]]},{"id":"7a8c104b.b9638","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1120,"y":720,"wires":[["f46d8645.d19d8"]]},{"id":"f46d8645.d19d8","type":"function","z":"ec27da7d.cad118","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_nedi_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_nedi_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1290,"y":720,"wires":[["a6995061.039a2"]]},{"id":"a6995061.039a2","type":"api-call-service","z":"ec27da7d.cad118","name":"Notify Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":1470,"y":720,"wires":[[]]},{"id":"7ebcdacf.62da04","type":"function","z":"ec27da7d.cad118","name":"Notificação","func":"    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_maria_title_aux\",\n    \"data\":{\n        \"value\": \"Atenção no Quarto Maria\",\n    \"entity_id\":\"input_text.notify_maria_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_maria_text_aux\",\n    \"data\":{         \n\n        \"value\": \"Erro no Lux Quarto Maria\",\n        \"entity_id\":\"input_text.notify_maria_text_aux\",\n    }}};\n    return newMsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1130,"y":532,"wires":[["479117ba.71b6e"]]},{"id":"ecc68cd6.5f183","type":"api-call-service","z":"ec27da7d.cad118","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_maria_text_aux, input_text.notify_maria_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":1470,"y":532,"wires":[[]]},{"id":"479117ba.71b6e","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1310,"y":532,"wires":[["ecc68cd6.5f183"]]},{"id":"cf7e2ed6.08caa","type":"delay","z":"ec27da7d.cad118","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1120,"y":592,"wires":[["f4efd0f1.c4272"]]},{"id":"f4efd0f1.c4272","type":"function","z":"ec27da7d.cad118","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_maria_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_maria_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1290,"y":592,"wires":[["2221958d.0826aa"]]},{"id":"2221958d.0826aa","type":"api-call-service","z":"ec27da7d.cad118","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":1470,"y":592,"wires":[[]]},{"id":"1155bfd0.e8b278","type":"debug","z":"d67ca66.293d758","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":510,"y":2080,"wires":[]},{"id":"ebb8fb92.25afb","type":"function","z":"d67ca66.293d758","name":"Party Hard?","func":"if(\n    msg.payload.event.actionName === \"party_hard\"\n    ){\n    return {\"payload\": {\"On\": false, \"on\": false}};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":2460,"wires":[["bc5ccdba.472318"]]},{"id":"28866276.68a91e","type":"function","z":"d67ca66.293d758","name":"Party Light?","func":"if(\n    msg.payload.event.actionName === \"party_light\"\n    ){\n    return {\"payload\": {\"On\": false, \"on\": false}};\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":510,"y":2520,"wires":[["b6a68443.c552d"]]},{"id":"bc5ccdba.472318","type":"link out","z":"d67ca66.293d758","name":"Party Hard Action","links":["91f02b78.556ca8"],"x":635,"y":2460,"wires":[]},{"id":"b6a68443.c552d","type":"link out","z":"d67ca66.293d758","name":"Party Light Action","links":["35f3e816.3c0708"],"x":635,"y":2520,"wires":[]},{"id":"df60da4e.1e4d3","type":"function","z":"444fced8.33ecb","name":"Cadê meu celular","func":"if(\n    (\n        msg.payload.description.summary.includes('cade')===true ||\n        msg.payload.description.summary.includes('cadê')===true||\n        msg.payload.description.summary.includes('onde esta')===true||\n        msg.payload.description.summary.includes('onde está')===true||\n        msg.payload.description.summary.includes('onde ta')===true||\n        msg.payload.description.summary.includes('onde tá')===true) \n    &&\n    (\n        msg.payload.description.summary.includes('celular')===true ||\n        msg.payload.description.summary.includes('iPhone')===true ||\n        msg.payload.description.summary.includes('celulares')===true\n    )&&(\n        (\n            msg.payload.name===\"Echo Dot do Quarto Maria\" &&\n            msg.payload.description.summary.includes('meu')===true\n        ) ||\n            msg.payload.description.summary.includes('Maria')===true\n        )\n    ){\n    msg = {\n        \"payload\":\"mobile_app_marias_iphone\"\n    }\n    return msg;\n}\nif(\n    (\n        msg.payload.description.summary.includes('cade')===true ||\n        msg.payload.description.summary.includes('cadê')===true||\n        msg.payload.description.summary.includes('onde esta')===true||\n        msg.payload.description.summary.includes('onde está')===true||\n        msg.payload.description.summary.includes('onde ta')===true||\n        msg.payload.description.summary.includes('onde tá')===true) \n    &&\n    (\n        msg.payload.description.summary.includes('celular')===true ||\n        msg.payload.description.summary.includes('iPhone')===true ||\n        msg.payload.description.summary.includes('celulares')===true\n    )&&(\n        (\n            msg.payload.name===\"Echo Dot do Quarto Nédi\" &&\n            msg.payload.description.summary.includes('meu')===true\n        ) ||\n            msg.payload.description.summary.includes('Nédi')===true||\n            msg.payload.description.summary.includes('mano')===true\n        )\n    ){\n    msg = {\n        \"payload\":\"mobile_app_nedis_iphone\"\n    }\n    return msg;\n}if(\n    (\n        msg.payload.description.summary.includes('cade')===true ||\n        msg.payload.description.summary.includes('cadê')===true||\n        msg.payload.description.summary.includes('onde esta')===true||\n        msg.payload.description.summary.includes('onde está')===true||\n        msg.payload.description.summary.includes('onde ta')===true||\n        msg.payload.description.summary.includes('onde tá')===true) \n    &&\n    (\n        msg.payload.description.summary.includes('celular')===true ||\n        msg.payload.description.summary.includes('iPhone')===true ||\n        msg.payload.description.summary.includes('celulares')===true\n    )&&(\n            msg.payload.description.summary.includes('cristofer')===true\n        )\n    ){\n    msg = {\n        \"payload\":\"mobile_app_soft_celular\"\n    }\n    return msg;\n}if(\n    (\n        msg.payload.description.summary.includes('cade')===true ||\n        msg.payload.description.summary.includes('cadê')===true||\n        msg.payload.description.summary.includes('onde esta')===true||\n        msg.payload.description.summary.includes('onde está')===true||\n        msg.payload.description.summary.includes('onde ta')===true||\n        msg.payload.description.summary.includes('onde tá')===true) \n    &&\n    (\n        msg.payload.description.summary.includes('celular')===true ||\n        msg.payload.description.summary.includes('iPhone')===true ||\n        msg.payload.description.summary.includes('celulares')===true\n    )&&(\n            msg.payload.description.summary.includes('tahisa')===true\n        )\n    ){\n    msg = {\n        \"payload\":\"mobile_app_iphone_de_tahisa\"\n    }\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2310,"y":1820,"wires":[["de481f61.833fd8"]]},{"id":"de481f61.833fd8","type":"function","z":"444fced8.33ecb","name":"Critically Notify","func":"var newMsg;\nnewMsg =\n    {\n    \"payload\":{\n        \"domain\": \"notify\",\n        \"service\": msg.payload,\n        \"data\":{\n          \"title\": \"Wake up!\",\n          \"message\": \"The house is on fire and the cat's stuck in the dryer!\",\n          \"data\":{\n            \"push\":{\n              \"sound\":{\n                \"name\": \"default\",\n                \"critical\": 1,\n                \"volume\": 1.0\n              }\n            }\n          }\n        }\n    }\n}\nif(msg.payload === \"mobile_app_soft_celular\"){\n    newMsg =\n        {\n        \"payload\":{\n            \"domain\": \"notify\",\n            \"service\": msg.payload,\n            \"data\":{\n              \"title\": \"Wake up!\",\n              \"message\": \"The house is on fire and the cat's stuck in the dryer!\",\n              \"data\":{\n                \"ttl\":0,\n                \"priority\": \"high\"\n              }\n            }\n        }\n    }\n}\nfor(var i = 0 ; i < 5 ; i++){\n    node.send(newMsg);\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2520,"y":1820,"wires":[["721e79c4.54b538"]]},{"id":"b06fc006.df31d8","type":"function","z":"444fced8.33ecb","name":"","func":"\n    msg = {\n        \"payload\":\"mobile_app_nedis_iphone\"\n    }\n    return msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2330,"y":1920,"wires":[["de481f61.833fd8"]]},{"id":"1f0129a3.4faa86","type":"inject","z":"444fced8.33ecb","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2170,"y":1940,"wires":[["b06fc006.df31d8"]]},{"id":"5c68b92c.047a8","type":"api-call-service","z":"444fced8.33ecb","name":"Notify","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":2910,"y":1820,"wires":[[]]},{"id":"721e79c4.54b538","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2740,"y":1820,"wires":[["5c68b92c.047a8"]]},{"id":"834a6685.ae0bf","type":"function","z":"444fced8.33ecb","name":"Turn On","func":"var newMsg;\nif((msg.payload.description.summary.includes('liga a t.v. da sala')===true||\n   msg.payload.description.summary.includes('liga a t. v. da sala')===true||\n   \n    (msg.payload.name===\"Echo Dot da Sala\" && \n   \n   (msg.payload.description.summary.includes('ligar a t.v.')===true ||\n   msg.payload.description.summary.includes('ligar a t. v.')===true||\n   msg.payload.description.summary.includes('ligar t.v.')===true ||\n   msg.payload.description.summary.includes('ligar t. v.')===true ||\n   msg.payload.description.summary.includes('liga a t.v.')===true ||\n   msg.payload.description.summary.includes('liga a t. v.')===true||\n   msg.payload.description.summary.includes('liga t.v.')===true ||\n   msg.payload.description.summary.includes('liga t. v.')===true ||\n   msg.payload.description.summary.includes('ligue a t.v.')===true ||\n   msg.payload.description.summary.includes('ligue a t. v.')===true||\n   msg.payload.description.summary.includes('ligue t.v.')===true ||\n   msg.payload.description.summary.includes('ligue t. v.')===true ||\n    ((msg.payload.description.summary.includes('liga')===true  ||\n    msg.payload.description.summary.includes('ligar')===true  ||\n    msg.payload.description.summary.includes('ligue')===true ) &&\n    msg.payload.description.summary.includes('t.')===true &&\n    msg.payload.description.summary.includes('v.')===true)))) && \n    msg.payload.description.summary.includes('desliga') === false &&\n    msg.payload.description.summary.includes('desligue') === false\n    \n   ){\n        newMsg = {payload:{}}\n    global.set(\"boaNoiteCasa\", false)\n    newMsg.payload = {\n        \"domain\": \"media_player\",\n        \"service\": \"turn_on\",\n        \"entity_id\": \"media_player.tv_da_sala\",\n        \"data\":{\n          \"entity_id\": \"media_player.tv_da_sala\",\n        }\n    }\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":500,"y":2020,"wires":[["4be760da.d877"]]},{"id":"2d0b920f.d492f6","type":"debug","z":"859b066a.dd8128","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1510,"y":1920,"wires":[]},{"id":"ccc80da.d5973f","type":"link out","z":"444fced8.33ecb","name":"Hora do filme","links":["12c59f88.0c213"],"x":715,"y":1560,"wires":[]},{"id":"584ffb66.730834","type":"server-state-changed","z":"4c9c764d.9c4468","name":"Boa Noite Casa","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.boa_noite_casa","entityidfiltertype":"exact","outputinitially":false,"state_type":"habool","haltifstate":"true","halt_if_type":"bool","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":220,"y":3980,"wires":[["550d18d5.fba1d"],["550d18d5.fba1d"]]},{"id":"550d18d5.fba1d","type":"function","z":"4c9c764d.9c4468","name":"if Boa Noite true","func":"global.set(\"boaNoiteCasa\", msg.payload)\nif(msg.payload === true){\n    return msg;\n} ","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":420,"y":3980,"wires":[["ae53388.ba33ac8"]]},{"id":"92015d19.b3c1e","type":"api-current-state","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"outputs":2,"halt_if":"true","halt_if_type":"bool","halt_if_compare":"is","override_topic":false,"entity_id":"light.luz_do_quarto_nedi","state_type":"habool","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":3030,"y":940,"wires":[["fc00c0ab.c53cd8"],["17e376ff.054ff9"]]},{"id":"fc00c0ab.c53cd8","type":"function","z":"859b066a.dd8128","name":"Turn On low before turn off","func":"if(msg.payload === true){\n    var newMsg;\n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_nedi_homekit\",\n            \"brightness\": 4\n        }\n    }};\n    node.send(newMsg);\n    \n    newMsg= {payload : {\n        \"domain\": \"light\",\n        \"service\": \"turn_on\",\n        data:{\n            \n            \"entity_id\": \"light.luz_do_quarto_nedi_homekit\",\n            \"brightness\": 0\n        }\n    }};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3300,"y":940,"wires":[["17e376ff.054ff9","81a9e0e2.26b3a8"]]},{"id":"17e376ff.054ff9","type":"delay","z":"859b066a.dd8128","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":3220,"y":1000,"wires":[["8d7bb5c9.c6fab8"]]},{"id":"81a9e0e2.26b3a8","type":"api-call-service","z":"859b066a.dd8128","name":"Luz do Quarto Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"light.luz_do_quarto_nedi","data":"{}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":3550,"y":940,"wires":[[]]},{"id":"47a7ace5.a05614","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\" || msg.payload === \"on\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_nedi_title_aux\",\n    \"data\":{\n        \"value\": \"Almoço\",\n    \"entity_id\":\"input_text.notify_nedi_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_nedi_text_aux\",\n    \"data\":{         \n        \"value\": `{{ [\\\"O almoço está pronto.\\\", \\\"O almoço está prontinho.\\\",\\\"Tem almoço quentinho na mesa.\\\",\\\"O almoço está na mesa.\\\",\\\"Corre pra mesa, o almoço está pronto.\\\",\\\"O almoço está pronto na mesa.\\\",\\\"O almoço está quentinho te esperando.\\\"]|random }}`,\n    \"entity_id\":\"input_text.notify_nedi_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2630,"y":720,"wires":[["6f60f452.93b414"]]},{"id":"58caa34f.a21ecc","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_nedi_text_aux, input_text.notify_nedi_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":2970,"y":720,"wires":[[]]},{"id":"fdf8891a.7e4dd","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Nédi home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.nedi","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2430,"y":720,"wires":[["47a7ace5.a05614","6e25d449.f099f4","4740687c.86af"]]},{"id":"fe732bfb.0589","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Papai home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.cristofer","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2430,"y":840,"wires":[["c1ed7500.b9bdb8","d766d20d.bcf718"]]},{"id":"6f60f452.93b414","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2810,"y":720,"wires":[["58caa34f.a21ecc"]]},{"id":"6e25d449.f099f4","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2620,"y":780,"wires":[["b9c797e2.2c90a8"]]},{"id":"b9c797e2.2c90a8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_nedi_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_nedi_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2790,"y":780,"wires":[["a9b4ef0a.c9b33"]]},{"id":"a9b4ef0a.c9b33","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Nédi","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":2970,"y":780,"wires":[[]]},{"id":"c1ed7500.b9bdb8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_cristofer_title_aux\",\n    \"data\":{\n        \"value\": \"Almoço\",\n    \"entity_id\":\"input_text.notify_cristofer_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_cristofer_text_aux\",\n    \"data\":{         \n        \"value\": `{{ [\\\"O almoço está pronto.\\\", \\\"O almoço está prontinho.\\\",\\\"Tem almoço quentinho na mesa.\\\",\\\"O almoço está na mesa.\\\",\\\"Corre pra mesa, o almoço está pronto.\\\",\\\"O almoço está pronto na mesa.\\\",\\\"O almoço está quentinho te esperando.\\\"]|random }}`,\n    \"entity_id\":\"input_text.notify_cristofer_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2630,"y":840,"wires":[["ca5b735b.405b5"]]},{"id":"9633783c.a57e","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Papai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_cristofer_text_aux, input_text.notify_cristofer_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":2970,"y":840,"wires":[[]]},{"id":"ca5b735b.405b5","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2810,"y":840,"wires":[["9633783c.a57e"]]},{"id":"d766d20d.bcf718","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2620,"y":900,"wires":[["1997787d.b5489"]]},{"id":"1997787d.b5489","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_cristofer_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_cristofer_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2790,"y":900,"wires":[["4d970d28.834b5c"]]},{"id":"4d970d28.834b5c","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Papai","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":2970,"y":900,"wires":[[]]},{"id":"77aad6c6.e85e18","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_tahisa_title_aux\",\n    \"data\":{\n        \"value\": \"Almoço\",\n    \"entity_id\":\"input_text.notify_tahisa_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_tahisa_text_aux\",\n    \"data\":{         \n        \"value\": `{{ [\\\"O almoço está pronto.\\\", \\\"O almoço está prontinho.\\\",\\\"Tem almoço quentinho na mesa.\\\",\\\"O almoço está na mesa.\\\",\\\"Corre pra mesa, o almoço está pronto.\\\",\\\"O almoço está pronto na mesa.\\\",\\\"O almoço está quentinho te esperando.\\\"]|random }}`,\n    \"entity_id\":\"input_text.notify_tahisa_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2630,"y":960,"wires":[["6b0f0f6c.1a368"]]},{"id":"be70127c.be08d","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Mae","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_tahisa_text_aux, input_text.notify_tahisa_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":2970,"y":960,"wires":[[]]},{"id":"6b0f0f6c.1a368","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2810,"y":960,"wires":[["be70127c.be08d"]]},{"id":"3baa3403.a6bcb4","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2620,"y":1020,"wires":[["d10a751c.30997"]]},{"id":"d10a751c.30997","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_tahisa_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_tahisa_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2790,"y":1020,"wires":[["9490def7.c5c908"]]},{"id":"9490def7.c5c908","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Mae","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":2970,"y":1020,"wires":[[]]},{"id":"5630ccc8.fb6df4","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Mae home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.tahisa","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2430,"y":960,"wires":[["77aad6c6.e85e18","3baa3403.a6bcb4"]]},{"id":"1868a925.54ae7f","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    var newMsg;\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_maria_title_aux\",\n    \"data\":{\n        \"value\": \"Almoço\",\n    \"entity_id\":\"input_text.notify_maria_title_aux\",\n    }}};\n    node.send(newMsg)\n    newMsg= {payload : {\n    \"domain\": \"input_text\",\n    \"service\": \"set_value\",\n    \"entity_id\":\"input_text.notify_maria_text_aux\",\n    \"data\":{         \n        \"value\": `{{ [\\\"O almoço está pronto.\\\", \\\"O almoço está prontinho.\\\",\\\"Tem almoço quentinho na mesa.\\\",\\\"O almoço está na mesa.\\\",\\\"Corre pra mesa, o almoço está pronto.\\\",\\\"O almoço está pronto na mesa.\\\",\\\"O almoço está quentinho te esperando.\\\"]|random }}`,\n    \"entity_id\":\"input_text.notify_maria_text_aux\",\n    }}};\n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2630,"y":1080,"wires":[["d0754435.97b928"]]},{"id":"83207ae7.786f18","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"input_text","service":"set_value","entityId":"input_text.notify_maria_text_aux, input_text.notify_maria_title_aux","data":"{\"value\":\"{{payload}}\"}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":2970,"y":1080,"wires":[[]]},{"id":"d0754435.97b928","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2810,"y":1080,"wires":[["83207ae7.786f18"]]},{"id":"9d07014d.1204c","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2620,"y":1140,"wires":[["13cdabdd.4fcf6c"]]},{"id":"13cdabdd.4fcf6c","type":"function","z":"c3fa9bdb.b5c4c8","name":"Notificação","func":"if(msg.payload === \"home\"){\n    newMsg= {payload : {\n    \"domain\": \"switch\",\n    \"service\": \"turn_on\",\n    \"entity_id\": \"switch.notify_maria_switch\",\n    data:{\n        \"entity_id\": \"switch.notify_maria_switch\"\n    }\n    }};\n    \n    return newMsg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2790,"y":1140,"wires":[["42ea4d45.60749c"]]},{"id":"42ea4d45.60749c","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Maria","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"switch","service":"turn_on","entityId":"","data":"{}","dataType":"json","mergecontext":"","output_location":"payload","output_location_type":"msg","mustacheAltTags":true,"x":2970,"y":1140,"wires":[[]]},{"id":"81ba63b6.69df58","type":"api-current-state","z":"c3fa9bdb.b5c4c8","name":"Maria home?","server":"d14d7300.ae20c","version":1,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","override_topic":false,"entity_id":"person.maria","state_type":"str","state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","blockInputOverrides":false,"x":2430,"y":1080,"wires":[["1868a925.54ae7f","9d07014d.1204c"]]},{"id":"8396419c.1ecde","type":"link out","z":"444fced8.33ecb","name":"Anunciar Almoço","links":["f3a48035.f0d698"],"x":835,"y":2340,"wires":[]},{"id":"d07ee5e7.20e3c8","type":"delay","z":"c3fa9bdb.b5c4c8","name":"","pauseType":"rate","timeout":"0.5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"20","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2440,"y":640,"wires":[["dd2bea78.c25318"]]},{"id":"dd2bea78.c25318","type":"api-call-service","z":"c3fa9bdb.b5c4c8","name":"Notify Alexas","server":"d14d7300.ae20c","version":1,"debugenabled":false,"service_domain":"notify","service":"alexa_media","entityId":"","data":"{\"data\":{\"type\":\"announce\",\"method\":\"all\"},\"message\":\"{{ [\\\"O almoço está pronto.\\\", \\\"O almoço está prontinho.\\\",\\\"Tem almoço quentinho na mesa.\\\",\\\"O almoço está na mesa.\\\",\\\"Corre pra mesa, o almoço está pronto.\\\",\\\"O almoço está pronto na mesa.\\\",\\\"O almoço está quentinho te esperando.\\\"]|random }}\",\"target\":[\"media_player.echo_dot_da_sala\",\"media_player.echo_dot_do_quarto_nedi\",\"media_player.echo_dot_do_quarto_maria\",\"media_player.echo_dot_do_quarto_pai\"]}","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":true,"x":2630,"y":640,"wires":[[]]},{"id":"f3a48035.f0d698","type":"link in","z":"c3fa9bdb.b5c4c8","name":"Anunciar almoço","links":["8396419c.1ecde"],"x":2035,"y":780,"wires":[["a775a171.93fcc8"]]},{"id":"58efd41a.208bec","type":"delay","z":"444fced8.33ecb","name":"","pauseType":"rate","timeout":"0.5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"30","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":700,"y":2340,"wires":[["8396419c.1ecde"]]},{"id":"a775a171.93fcc8","type":"function","z":"c3fa9bdb.b5c4c8","name":"Aux","func":"var newMsg;\nnewMsg= {payload : true};\nreturn newMsg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2150,"y":780,"wires":[["d07ee5e7.20e3c8","fdf8891a.7e4dd","fe732bfb.0589","5630ccc8.fb6df4","81ba63b6.69df58"]]},{"id":"4740687c.86af","type":"debug","z":"c3fa9bdb.b5c4c8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2610,"y":580,"wires":[]},{"id":"66144dbf.e1020c","type":"inject","z":"c3fa9bdb.b5c4c8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1980,"y":720,"wires":[["a775a171.93fcc8"]]},{"id":"24a27170.9ca8fe","type":"server-state-changed","z":"859b066a.dd8128","name":"Cozy Time Auxiliary","server":"d14d7300.ae20c","version":1,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"input_boolean.cozy_time","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"x":170,"y":2480,"wires":[["a802e8db.b6eca"]]},{"id":"a802e8db.b6eca","type":"function","z":"859b066a.dd8128","name":"Turn On","func":"if(msg.payload === \"on\"){\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":2480,"wires":[["686ae5dd.bfe81c"]]},{"id":"302646f6.02187a","type":"inject","z":"859b066a.dd8128","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":2690,"y":320,"wires":[["17851e1b.05b0da"]]}]